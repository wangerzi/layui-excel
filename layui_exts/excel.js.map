{"version":3,"sources":["webpack://lay-excel/./src/excel.js","webpack://lay-excel/./src/jszip.js","webpack://lay-excel/./src/xlsx.js","webpack://lay-excel/./node_modules/babel-polyfill/lib/index.js","webpack://lay-excel/./node_modules/blob/main.js","webpack://lay-excel/./node_modules/core-js/fn/regexp/escape.js","webpack://lay-excel/./node_modules/core-js/modules/_a-function.js","webpack://lay-excel/./node_modules/core-js/modules/_a-number-value.js","webpack://lay-excel/./node_modules/core-js/modules/_add-to-unscopables.js","webpack://lay-excel/./node_modules/core-js/modules/_advance-string-index.js","webpack://lay-excel/./node_modules/core-js/modules/_an-instance.js","webpack://lay-excel/./node_modules/core-js/modules/_an-object.js","webpack://lay-excel/./node_modules/core-js/modules/_array-copy-within.js","webpack://lay-excel/./node_modules/core-js/modules/_array-fill.js","webpack://lay-excel/./node_modules/core-js/modules/_array-from-iterable.js","webpack://lay-excel/./node_modules/core-js/modules/_array-includes.js","webpack://lay-excel/./node_modules/core-js/modules/_array-methods.js","webpack://lay-excel/./node_modules/core-js/modules/_array-reduce.js","webpack://lay-excel/./node_modules/core-js/modules/_array-species-constructor.js","webpack://lay-excel/./node_modules/core-js/modules/_array-species-create.js","webpack://lay-excel/./node_modules/core-js/modules/_bind.js","webpack://lay-excel/./node_modules/core-js/modules/_classof.js","webpack://lay-excel/./node_modules/core-js/modules/_cof.js","webpack://lay-excel/./node_modules/core-js/modules/_collection-strong.js","webpack://lay-excel/./node_modules/core-js/modules/_collection-to-json.js","webpack://lay-excel/./node_modules/core-js/modules/_collection-weak.js","webpack://lay-excel/./node_modules/core-js/modules/_collection.js","webpack://lay-excel/./node_modules/core-js/modules/_core.js","webpack://lay-excel/./node_modules/core-js/modules/_create-property.js","webpack://lay-excel/./node_modules/core-js/modules/_ctx.js","webpack://lay-excel/./node_modules/core-js/modules/_date-to-iso-string.js","webpack://lay-excel/./node_modules/core-js/modules/_date-to-primitive.js","webpack://lay-excel/./node_modules/core-js/modules/_defined.js","webpack://lay-excel/./node_modules/core-js/modules/_descriptors.js","webpack://lay-excel/./node_modules/core-js/modules/_dom-create.js","webpack://lay-excel/./node_modules/core-js/modules/_enum-bug-keys.js","webpack://lay-excel/./node_modules/core-js/modules/_enum-keys.js","webpack://lay-excel/./node_modules/core-js/modules/_export.js","webpack://lay-excel/./node_modules/core-js/modules/_fails-is-regexp.js","webpack://lay-excel/./node_modules/core-js/modules/_fails.js","webpack://lay-excel/./node_modules/core-js/modules/_fix-re-wks.js","webpack://lay-excel/./node_modules/core-js/modules/_flags.js","webpack://lay-excel/./node_modules/core-js/modules/_flatten-into-array.js","webpack://lay-excel/./node_modules/core-js/modules/_for-of.js","webpack://lay-excel/./node_modules/core-js/modules/_function-to-string.js","webpack://lay-excel/./node_modules/core-js/modules/_global.js","webpack://lay-excel/./node_modules/core-js/modules/_has.js","webpack://lay-excel/./node_modules/core-js/modules/_hide.js","webpack://lay-excel/./node_modules/core-js/modules/_html.js","webpack://lay-excel/./node_modules/core-js/modules/_ie8-dom-define.js","webpack://lay-excel/./node_modules/core-js/modules/_inherit-if-required.js","webpack://lay-excel/./node_modules/core-js/modules/_invoke.js","webpack://lay-excel/./node_modules/core-js/modules/_iobject.js","webpack://lay-excel/./node_modules/core-js/modules/_is-array-iter.js","webpack://lay-excel/./node_modules/core-js/modules/_is-array.js","webpack://lay-excel/./node_modules/core-js/modules/_is-integer.js","webpack://lay-excel/./node_modules/core-js/modules/_is-object.js","webpack://lay-excel/./node_modules/core-js/modules/_is-regexp.js","webpack://lay-excel/./node_modules/core-js/modules/_iter-call.js","webpack://lay-excel/./node_modules/core-js/modules/_iter-create.js","webpack://lay-excel/./node_modules/core-js/modules/_iter-define.js","webpack://lay-excel/./node_modules/core-js/modules/_iter-detect.js","webpack://lay-excel/./node_modules/core-js/modules/_iter-step.js","webpack://lay-excel/./node_modules/core-js/modules/_iterators.js","webpack://lay-excel/./node_modules/core-js/modules/_library.js","webpack://lay-excel/./node_modules/core-js/modules/_math-expm1.js","webpack://lay-excel/./node_modules/core-js/modules/_math-fround.js","webpack://lay-excel/./node_modules/core-js/modules/_math-log1p.js","webpack://lay-excel/./node_modules/core-js/modules/_math-scale.js","webpack://lay-excel/./node_modules/core-js/modules/_math-sign.js","webpack://lay-excel/./node_modules/core-js/modules/_meta.js","webpack://lay-excel/./node_modules/core-js/modules/_metadata.js","webpack://lay-excel/./node_modules/core-js/modules/_microtask.js","webpack://lay-excel/./node_modules/core-js/modules/_new-promise-capability.js","webpack://lay-excel/./node_modules/core-js/modules/_object-assign.js","webpack://lay-excel/./node_modules/core-js/modules/_object-create.js","webpack://lay-excel/./node_modules/core-js/modules/_object-dp.js","webpack://lay-excel/./node_modules/core-js/modules/_object-dps.js","webpack://lay-excel/./node_modules/core-js/modules/_object-forced-pam.js","webpack://lay-excel/./node_modules/core-js/modules/_object-gopd.js","webpack://lay-excel/./node_modules/core-js/modules/_object-gopn-ext.js","webpack://lay-excel/./node_modules/core-js/modules/_object-gopn.js","webpack://lay-excel/./node_modules/core-js/modules/_object-gops.js","webpack://lay-excel/./node_modules/core-js/modules/_object-gpo.js","webpack://lay-excel/./node_modules/core-js/modules/_object-keys-internal.js","webpack://lay-excel/./node_modules/core-js/modules/_object-keys.js","webpack://lay-excel/./node_modules/core-js/modules/_object-pie.js","webpack://lay-excel/./node_modules/core-js/modules/_object-sap.js","webpack://lay-excel/./node_modules/core-js/modules/_object-to-array.js","webpack://lay-excel/./node_modules/core-js/modules/_own-keys.js","webpack://lay-excel/./node_modules/core-js/modules/_parse-float.js","webpack://lay-excel/./node_modules/core-js/modules/_parse-int.js","webpack://lay-excel/./node_modules/core-js/modules/_perform.js","webpack://lay-excel/./node_modules/core-js/modules/_promise-resolve.js","webpack://lay-excel/./node_modules/core-js/modules/_property-desc.js","webpack://lay-excel/./node_modules/core-js/modules/_redefine-all.js","webpack://lay-excel/./node_modules/core-js/modules/_redefine.js","webpack://lay-excel/./node_modules/core-js/modules/_regexp-exec-abstract.js","webpack://lay-excel/./node_modules/core-js/modules/_regexp-exec.js","webpack://lay-excel/./node_modules/core-js/modules/_replacer.js","webpack://lay-excel/./node_modules/core-js/modules/_same-value.js","webpack://lay-excel/./node_modules/core-js/modules/_set-collection-from.js","webpack://lay-excel/./node_modules/core-js/modules/_set-collection-of.js","webpack://lay-excel/./node_modules/core-js/modules/_set-proto.js","webpack://lay-excel/./node_modules/core-js/modules/_set-species.js","webpack://lay-excel/./node_modules/core-js/modules/_set-to-string-tag.js","webpack://lay-excel/./node_modules/core-js/modules/_shared-key.js","webpack://lay-excel/./node_modules/core-js/modules/_shared.js","webpack://lay-excel/./node_modules/core-js/modules/_species-constructor.js","webpack://lay-excel/./node_modules/core-js/modules/_strict-method.js","webpack://lay-excel/./node_modules/core-js/modules/_string-at.js","webpack://lay-excel/./node_modules/core-js/modules/_string-context.js","webpack://lay-excel/./node_modules/core-js/modules/_string-html.js","webpack://lay-excel/./node_modules/core-js/modules/_string-pad.js","webpack://lay-excel/./node_modules/core-js/modules/_string-repeat.js","webpack://lay-excel/./node_modules/core-js/modules/_string-trim.js","webpack://lay-excel/./node_modules/core-js/modules/_string-ws.js","webpack://lay-excel/./node_modules/core-js/modules/_task.js","webpack://lay-excel/./node_modules/core-js/modules/_to-absolute-index.js","webpack://lay-excel/./node_modules/core-js/modules/_to-index.js","webpack://lay-excel/./node_modules/core-js/modules/_to-integer.js","webpack://lay-excel/./node_modules/core-js/modules/_to-iobject.js","webpack://lay-excel/./node_modules/core-js/modules/_to-length.js","webpack://lay-excel/./node_modules/core-js/modules/_to-object.js","webpack://lay-excel/./node_modules/core-js/modules/_to-primitive.js","webpack://lay-excel/./node_modules/core-js/modules/_typed-array.js","webpack://lay-excel/./node_modules/core-js/modules/_typed-buffer.js","webpack://lay-excel/./node_modules/core-js/modules/_typed.js","webpack://lay-excel/./node_modules/core-js/modules/_uid.js","webpack://lay-excel/./node_modules/core-js/modules/_user-agent.js","webpack://lay-excel/./node_modules/core-js/modules/_validate-collection.js","webpack://lay-excel/./node_modules/core-js/modules/_wks-define.js","webpack://lay-excel/./node_modules/core-js/modules/_wks-ext.js","webpack://lay-excel/./node_modules/core-js/modules/_wks.js","webpack://lay-excel/./node_modules/core-js/modules/core.get-iterator-method.js","webpack://lay-excel/./node_modules/core-js/modules/core.regexp.escape.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.copy-within.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.every.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.fill.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.filter.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.find-index.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.find.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.for-each.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.from.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.index-of.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.is-array.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.iterator.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.join.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.last-index-of.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.map.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.of.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.reduce-right.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.reduce.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.slice.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.some.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.sort.js","webpack://lay-excel/./node_modules/core-js/modules/es6.array.species.js","webpack://lay-excel/./node_modules/core-js/modules/es6.date.now.js","webpack://lay-excel/./node_modules/core-js/modules/es6.date.to-iso-string.js","webpack://lay-excel/./node_modules/core-js/modules/es6.date.to-json.js","webpack://lay-excel/./node_modules/core-js/modules/es6.date.to-primitive.js","webpack://lay-excel/./node_modules/core-js/modules/es6.date.to-string.js","webpack://lay-excel/./node_modules/core-js/modules/es6.function.bind.js","webpack://lay-excel/./node_modules/core-js/modules/es6.function.has-instance.js","webpack://lay-excel/./node_modules/core-js/modules/es6.function.name.js","webpack://lay-excel/./node_modules/core-js/modules/es6.map.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.acosh.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.asinh.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.atanh.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.cbrt.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.clz32.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.cosh.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.expm1.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.fround.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.hypot.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.imul.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.log10.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.log1p.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.log2.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.sign.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.sinh.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.tanh.js","webpack://lay-excel/./node_modules/core-js/modules/es6.math.trunc.js","webpack://lay-excel/./node_modules/core-js/modules/es6.number.constructor.js","webpack://lay-excel/./node_modules/core-js/modules/es6.number.epsilon.js","webpack://lay-excel/./node_modules/core-js/modules/es6.number.is-finite.js","webpack://lay-excel/./node_modules/core-js/modules/es6.number.is-integer.js","webpack://lay-excel/./node_modules/core-js/modules/es6.number.is-nan.js","webpack://lay-excel/./node_modules/core-js/modules/es6.number.is-safe-integer.js","webpack://lay-excel/./node_modules/core-js/modules/es6.number.max-safe-integer.js","webpack://lay-excel/./node_modules/core-js/modules/es6.number.min-safe-integer.js","webpack://lay-excel/./node_modules/core-js/modules/es6.number.parse-float.js","webpack://lay-excel/./node_modules/core-js/modules/es6.number.parse-int.js","webpack://lay-excel/./node_modules/core-js/modules/es6.number.to-fixed.js","webpack://lay-excel/./node_modules/core-js/modules/es6.number.to-precision.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.assign.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.create.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.define-properties.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.define-property.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.freeze.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.get-own-property-descriptor.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.get-own-property-names.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.get-prototype-of.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.is-extensible.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.is-frozen.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.is-sealed.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.is.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.keys.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.prevent-extensions.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.seal.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.set-prototype-of.js","webpack://lay-excel/./node_modules/core-js/modules/es6.object.to-string.js","webpack://lay-excel/./node_modules/core-js/modules/es6.parse-float.js","webpack://lay-excel/./node_modules/core-js/modules/es6.parse-int.js","webpack://lay-excel/./node_modules/core-js/modules/es6.promise.js","webpack://lay-excel/./node_modules/core-js/modules/es6.reflect.apply.js","webpack://lay-excel/./node_modules/core-js/modules/es6.reflect.construct.js","webpack://lay-excel/./node_modules/core-js/modules/es6.reflect.define-property.js","webpack://lay-excel/./node_modules/core-js/modules/es6.reflect.delete-property.js","webpack://lay-excel/./node_modules/core-js/modules/es6.reflect.enumerate.js","webpack://lay-excel/./node_modules/core-js/modules/es6.reflect.get-own-property-descriptor.js","webpack://lay-excel/./node_modules/core-js/modules/es6.reflect.get-prototype-of.js","webpack://lay-excel/./node_modules/core-js/modules/es6.reflect.get.js","webpack://lay-excel/./node_modules/core-js/modules/es6.reflect.has.js","webpack://lay-excel/./node_modules/core-js/modules/es6.reflect.is-extensible.js","webpack://lay-excel/./node_modules/core-js/modules/es6.reflect.own-keys.js","webpack://lay-excel/./node_modules/core-js/modules/es6.reflect.prevent-extensions.js","webpack://lay-excel/./node_modules/core-js/modules/es6.reflect.set-prototype-of.js","webpack://lay-excel/./node_modules/core-js/modules/es6.reflect.set.js","webpack://lay-excel/./node_modules/core-js/modules/es6.regexp.constructor.js","webpack://lay-excel/./node_modules/core-js/modules/es6.regexp.exec.js","webpack://lay-excel/./node_modules/core-js/modules/es6.regexp.flags.js","webpack://lay-excel/./node_modules/core-js/modules/es6.regexp.match.js","webpack://lay-excel/./node_modules/core-js/modules/es6.regexp.replace.js","webpack://lay-excel/./node_modules/core-js/modules/es6.regexp.search.js","webpack://lay-excel/./node_modules/core-js/modules/es6.regexp.split.js","webpack://lay-excel/./node_modules/core-js/modules/es6.regexp.to-string.js","webpack://lay-excel/./node_modules/core-js/modules/es6.set.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.anchor.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.big.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.blink.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.bold.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.code-point-at.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.ends-with.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.fixed.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.fontcolor.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.fontsize.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.from-code-point.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.includes.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.italics.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.iterator.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.link.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.raw.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.repeat.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.small.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.starts-with.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.strike.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.sub.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.sup.js","webpack://lay-excel/./node_modules/core-js/modules/es6.string.trim.js","webpack://lay-excel/./node_modules/core-js/modules/es6.symbol.js","webpack://lay-excel/./node_modules/core-js/modules/es6.typed.array-buffer.js","webpack://lay-excel/./node_modules/core-js/modules/es6.typed.data-view.js","webpack://lay-excel/./node_modules/core-js/modules/es6.typed.float32-array.js","webpack://lay-excel/./node_modules/core-js/modules/es6.typed.float64-array.js","webpack://lay-excel/./node_modules/core-js/modules/es6.typed.int16-array.js","webpack://lay-excel/./node_modules/core-js/modules/es6.typed.int32-array.js","webpack://lay-excel/./node_modules/core-js/modules/es6.typed.int8-array.js","webpack://lay-excel/./node_modules/core-js/modules/es6.typed.uint16-array.js","webpack://lay-excel/./node_modules/core-js/modules/es6.typed.uint32-array.js","webpack://lay-excel/./node_modules/core-js/modules/es6.typed.uint8-array.js","webpack://lay-excel/./node_modules/core-js/modules/es6.typed.uint8-clamped-array.js","webpack://lay-excel/./node_modules/core-js/modules/es6.weak-map.js","webpack://lay-excel/./node_modules/core-js/modules/es6.weak-set.js","webpack://lay-excel/./node_modules/core-js/modules/es7.array.flat-map.js","webpack://lay-excel/./node_modules/core-js/modules/es7.array.flatten.js","webpack://lay-excel/./node_modules/core-js/modules/es7.array.includes.js","webpack://lay-excel/./node_modules/core-js/modules/es7.asap.js","webpack://lay-excel/./node_modules/core-js/modules/es7.error.is-error.js","webpack://lay-excel/./node_modules/core-js/modules/es7.global.js","webpack://lay-excel/./node_modules/core-js/modules/es7.map.from.js","webpack://lay-excel/./node_modules/core-js/modules/es7.map.of.js","webpack://lay-excel/./node_modules/core-js/modules/es7.map.to-json.js","webpack://lay-excel/./node_modules/core-js/modules/es7.math.clamp.js","webpack://lay-excel/./node_modules/core-js/modules/es7.math.deg-per-rad.js","webpack://lay-excel/./node_modules/core-js/modules/es7.math.degrees.js","webpack://lay-excel/./node_modules/core-js/modules/es7.math.fscale.js","webpack://lay-excel/./node_modules/core-js/modules/es7.math.iaddh.js","webpack://lay-excel/./node_modules/core-js/modules/es7.math.imulh.js","webpack://lay-excel/./node_modules/core-js/modules/es7.math.isubh.js","webpack://lay-excel/./node_modules/core-js/modules/es7.math.rad-per-deg.js","webpack://lay-excel/./node_modules/core-js/modules/es7.math.radians.js","webpack://lay-excel/./node_modules/core-js/modules/es7.math.scale.js","webpack://lay-excel/./node_modules/core-js/modules/es7.math.signbit.js","webpack://lay-excel/./node_modules/core-js/modules/es7.math.umulh.js","webpack://lay-excel/./node_modules/core-js/modules/es7.object.define-getter.js","webpack://lay-excel/./node_modules/core-js/modules/es7.object.define-setter.js","webpack://lay-excel/./node_modules/core-js/modules/es7.object.entries.js","webpack://lay-excel/./node_modules/core-js/modules/es7.object.get-own-property-descriptors.js","webpack://lay-excel/./node_modules/core-js/modules/es7.object.lookup-getter.js","webpack://lay-excel/./node_modules/core-js/modules/es7.object.lookup-setter.js","webpack://lay-excel/./node_modules/core-js/modules/es7.object.values.js","webpack://lay-excel/./node_modules/core-js/modules/es7.observable.js","webpack://lay-excel/./node_modules/core-js/modules/es7.promise.finally.js","webpack://lay-excel/./node_modules/core-js/modules/es7.promise.try.js","webpack://lay-excel/./node_modules/core-js/modules/es7.reflect.define-metadata.js","webpack://lay-excel/./node_modules/core-js/modules/es7.reflect.delete-metadata.js","webpack://lay-excel/./node_modules/core-js/modules/es7.reflect.get-metadata-keys.js","webpack://lay-excel/./node_modules/core-js/modules/es7.reflect.get-metadata.js","webpack://lay-excel/./node_modules/core-js/modules/es7.reflect.get-own-metadata-keys.js","webpack://lay-excel/./node_modules/core-js/modules/es7.reflect.get-own-metadata.js","webpack://lay-excel/./node_modules/core-js/modules/es7.reflect.has-metadata.js","webpack://lay-excel/./node_modules/core-js/modules/es7.reflect.has-own-metadata.js","webpack://lay-excel/./node_modules/core-js/modules/es7.reflect.metadata.js","webpack://lay-excel/./node_modules/core-js/modules/es7.set.from.js","webpack://lay-excel/./node_modules/core-js/modules/es7.set.of.js","webpack://lay-excel/./node_modules/core-js/modules/es7.set.to-json.js","webpack://lay-excel/./node_modules/core-js/modules/es7.string.at.js","webpack://lay-excel/./node_modules/core-js/modules/es7.string.match-all.js","webpack://lay-excel/./node_modules/core-js/modules/es7.string.pad-end.js","webpack://lay-excel/./node_modules/core-js/modules/es7.string.pad-start.js","webpack://lay-excel/./node_modules/core-js/modules/es7.string.trim-left.js","webpack://lay-excel/./node_modules/core-js/modules/es7.string.trim-right.js","webpack://lay-excel/./node_modules/core-js/modules/es7.symbol.async-iterator.js","webpack://lay-excel/./node_modules/core-js/modules/es7.symbol.observable.js","webpack://lay-excel/./node_modules/core-js/modules/es7.system.global.js","webpack://lay-excel/./node_modules/core-js/modules/es7.weak-map.from.js","webpack://lay-excel/./node_modules/core-js/modules/es7.weak-map.of.js","webpack://lay-excel/./node_modules/core-js/modules/es7.weak-set.from.js","webpack://lay-excel/./node_modules/core-js/modules/es7.weak-set.of.js","webpack://lay-excel/./node_modules/core-js/modules/web.dom.iterable.js","webpack://lay-excel/./node_modules/core-js/modules/web.immediate.js","webpack://lay-excel/./node_modules/core-js/modules/web.timers.js","webpack://lay-excel/./node_modules/core-js/shim.js","webpack://lay-excel/./node_modules/file-saver/dist/FileSaver.min.js","webpack://lay-excel/./node_modules/regenerator-runtime/runtime.js","webpack://lay-excel/webpack/bootstrap","webpack://lay-excel/webpack/runtime/define property getters","webpack://lay-excel/webpack/runtime/global","webpack://lay-excel/webpack/runtime/hasOwnProperty shorthand","webpack://lay-excel/webpack/runtime/make namespace object","webpack://lay-excel/webpack/startup"],"names":["make_lay_excel","global","VERSION","objectExtend","Object","assign","apply","this","arguments","each","object","callback","k","hasOwnProperty","Array","isArray","parseInt","downloadExl","data","filename","type","exportExcel","sheet1","opt","wb","XLSX","utils","book_new","Props","Title","Subject","Author","Manager","Company","Category","Keywords","Comments","LastAuthor","CreatedData","Date","compression","wbExtend","key","extend","sheet_name","content","SheetNames","push","is_aoa","length","ws","aoa_to_sheet","option","headers","unshift","skipHeader","splitRes","splitContent","json_to_sheet","mergeCellOpt","style","Sheets","wbout","write","bookType","cellStyles","FileSaver","saveAs","Blob","s2ab","styleContent","line","lineData","rowIndex","row","rowData","numToTitle","v","s","alignment","horizontal","rowOpt","otherOpt","i","tableToJson","dom","querySelectorAll","that","handleLineNode","lineDomList","res","val","innerText","headDom","bodyDom","head","body","numsTitleCache","titleNumsCache","num","remainder","left","Math","floor","ans","String","fromCharCode","titleToNum","title","len","total","index","charCodeAt","pow","getDefaultRange","range","fieldKeys","keys","startPos","c","r","endPos","rangeArr","split","splitPosition","console","error","setCellStyle","config","filter","currentRow","currentCol","cell","newCell","setRoundBorder","rangeObj","border","top","diagonal","diagonalUp","diagonalDown","right","bottom","setExportCellStyle","makeMergeConfig","origin","merge","e","makeColConfig","defaultNum","change","startIndex","item","match","currentIndex","wpx","makeRowConfig","hpx","pos","buf","ArrayBuffer","view","Uint8Array","filterDataToAoaData","filterData","aoaData","itemData","filterExportData","fields","exportData","true_fields","new_field_name","old_field_name","window","filterImportData","fileindex","xlsx","sheetname","importExcel","files","header","checkMime","code","supportReadMime","indexOf","message","name","book","reader","FileReader","onload","ev","read","target","result","excelData","sheet","sheetObj","defval","sheet_to_json","readAsBinaryString","dateCodeToDate","obj","SSF","parse_date_code","y","m","d","H","M","S","strPad","str","maxLength","padString","repeatCount","exceptStr","substr","dateFormat","date","format","YYYY","getFullYear","YY","getMonth","MM","D","getDate","DD","getHours","HH","getMinutes","ii","getSeconds","reg","RegExp","replace","dateCodeFormat","layui","define","exports","LAY_EXCEL","DO_NOT_EXPORT_JSZIP","module","JSZipSync","f","$","self","t","n","o","u","Error","call","1","_dereq_","_keyStr","encode","input","utf8","chr1","chr2","chr3","enc1","enc2","enc3","enc4","output","isNaN","charAt","decode","2","CompressedObject","compressedSize","uncompressedSize","crc32","compressionMethod","compressedContent","prototype","getContent","getCompressedContent","3","STORE","magic","compress","uncompress","compressInputType","uncompressInputType","DEFLATE","4","table","crc","getTypeOf","b","iTop","5","DataReader","checkOffset","offset","checkIndex","newIndex","setIndex","skip","byteAt","readInt","size","readString","transformTo","readData","lastIndexOfSignature","sig","readDate","dostime","6","base64","binary","dir","createFolders","comment","7","string2binary","string2Uint8Array","uint8Array2String","array","string2Blob","buffer","arrayBuffer2Blob","outputType","checkSupport","MAX_VALUE_16BITS","MAX_VALUE_32BITS","pretty","findCompression","isRegExp","8","USE_TYPEDARRAY","Uint16Array","Uint32Array","pako","deflateRaw","inflateRaw","9","options","root","load","clone","newObj","support","defaults","compressions","10","ZipEntries","zipEntries","file","fileName","decompressed","optimizedBinaryString","fileComment","zipComment","11","Buffer","Buffer_from","nbfs","from","enc","bind","alloc","encoding","test","isBuffer","undefined","12","Uint8ArrayReader","NodeBufferReader","slice","13","signature","nodeBuffer","StringWriter","Uint8ArrayWriter","getRawData","_data","copy","set","getBinaryData","nodebuffer","asBinary","dataToString","asUTF8","out","utf8decode","utf8encode","ZipObject","_initialMetadata","asText","asNodeBuffer","asUint8Array","asArrayBuffer","decToHex","dec","bytes","hex","attr","fileAdd","parent","dataType","toUpperCase","prepareFileAttrs","parentFolder","folderAdd","path","substring","lastSlash","lastIndexOf","generateCompressedObjectFrom","generateZipParts","compressedObject","dosTime","dosDate","utfEncodedFileName","utfEncodedComment","useUTF8ForFileName","useUTF8ForComment","extraFields","unicodePathExtraField","unicodeCommentExtraField","fileRecord","LOCAL_FILE_HEADER","dirRecord","CENTRAL_FILE_HEADER","stream","search","relativePath","fileClone","regexp","folder","arg","newFolder","ret","remove","kids","generate","writer","dirEnd","zipData","localDirLength","centralDirLength","compressionName","zipPart","CENTRAL_DIRECTORY_END","typeName","toLowerCase","append","zip","finalize","string","14","ZIP64_CENTRAL_DIRECTORY_LOCATOR","ZIP64_CENTRAL_DIRECTORY_END","DATA_DESCRIPTOR","15","StringReader","16","join","17","arraybuffer","uint8array","blob","builder","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","getBlob","18","sig0","sig1","sig2","sig3","subarray","19","20","_utf8len","utf8border","max","buf2string","c_len","utf16buf","applyFromCharCode","c2","m_pos","str_len","buf_len","string2buf","toString","nextBoundary","min","21","identity","stringToArrayLike","arrayLikeToString","chunk","canUseApply","resultStr","arrayLikeToArrayLike","arrayFrom","arrayTo","transform","byteLength","inputType","method","22","ZipEntry","jszipProto","loadOptions","checkSignature","expectedSignature","readBlockEndOfCentral","diskNumber","diskWithCentralDirStart","centralDirRecordsOnThisDisk","centralDirRecords","centralDirSize","centralDirOffset","zipCommentLength","readBlockZip64EndOfCentral","zip64EndOfCentralSize","versionMadeBy","versionNeeded","zip64ExtensibleData","extraFieldId","extraFieldLength","extraFieldValue","extraDataSize","id","value","readBlockZip64EndOfCentralLocator","diskWithZip64CentralDirStart","relativeOffsetEndOfZip64CentralDir","disksCount","readLocalFiles","localHeaderOffset","readLocalPart","handleUTF8","readCentralDir","zip64","readCentralPart","readEndOfCentral","prepareReader","23","isEncrypted","bitFlag","useUTF8","prepareCompressedContent","previousIndex","compressedFileData","prepareContent","uncompressedFileData","localExtraFieldsLength","fileNameLength","checkCRC32","extraFieldsLength","fileCommentLength","diskNumberStart","internalFileAttributes","externalFileAttributes","readExtraFields","parseZIP64ExtraField","extraReader","start","upath","findExtraFieldUnicodePath","ucomment","findExtraFieldUnicodeComment","upathField","ucommentField","24","25","zlib_deflate","strings","msg","zstream","Deflate","level","chunkSize","windowBits","memLevel","strategy","to","raw","gzip","err","ended","chunks","strm","avail_out","status","deflateInit2","deflateSetHeader","deflate","deflator","mode","_mode","next_in","avail_in","Buf8","next_out","onEnd","onData","buf2binstring","shrinkBuf","deflateEnd","flattenChunks","26","zlib_inflate","gzheader","Inflate","inflateInit2","Z_OK","inflateGetHeader","inflate","inflator","next_out_utf8","tail","utf8str","Z_FINISH","Z_NO_FLUSH","binstring2buf","Z_STREAM_END","arraySet","inflateEnd","ungzip","27","TYPED_OK","Int32Array","sources","source","shift","TypeError","p","fnTyped","dest","src","src_offs","dest_offs","l","fnUntyped","concat","setTyped","on","Buf16","Buf32","28","STR_APPLY_OK","STR_APPLY_UIA_OK","__","29","adler","s1","s2","30","Z_PARTIAL_FLUSH","Z_SYNC_FLUSH","Z_FULL_FLUSH","Z_BLOCK","Z_TREES","Z_NEED_DICT","Z_ERRNO","Z_STREAM_ERROR","Z_DATA_ERROR","Z_BUF_ERROR","Z_NO_COMPRESSION","Z_BEST_SPEED","Z_BEST_COMPRESSION","Z_DEFAULT_COMPRESSION","Z_FILTERED","Z_HUFFMAN_ONLY","Z_RLE","Z_FIXED","Z_DEFAULT_STRATEGY","Z_BINARY","Z_TEXT","Z_UNKNOWN","Z_DEFLATED","31","crcTable","makeTable","end","32","trees","adler32","MAX_MATCH","MIN_LOOKAHEAD","HCRC_STATE","BUSY_STATE","FINISH_STATE","errorCode","rank","zero","flush_pending","state","pending","pending_buf","pending_out","total_out","flush_block_only","last","_tr_flush_block","block_start","strstart","put_byte","putShortMSB","longest_match","cur_match","chain_length","max_chain_length","scan","best_len","prev_length","nice_match","limit","w_size","_win","wmask","w_mask","prev","strend","scan_end1","scan_end","good_match","lookahead","match_start","fill_window","more","_w_size","window_size","hash_size","wrap","total_in","insert","ins_h","hash_shift","hash_mask","deflate_fast","flush","hash_head","bflush","match_length","_tr_tally","max_lazy_match","MIN_MATCH","last_lit","deflate_slow","max_insert","prev_match","match_available","configuration_table","Config","good_length","max_lazy","nice_length","max_chain","func","DeflateState","pending_buf_size","gzhead","gzindex","last_flush","w_bits","hash_bits","dyn_ltree","HEAP_SIZE","dyn_dtree","bl_tree","l_desc","d_desc","bl_desc","bl_count","MAX_BITS","heap","heap_len","heap_max","depth","l_buf","lit_bufsize","d_buf","opt_len","static_len","matches","bi_buf","bi_valid","deflateResetKeep","data_type","_tr_init","deflateReset","max_block_size","max_start","deflateInit","old_flush","beg","text","hcrc","extra","time","os","bstate","deflate_huff","deflate_rle","_tr_align","_tr_stored_block","deflateInfo","33","xflags","extra_len","done","34","_in","_out","dmax","wsize","whave","wnext","hold","bits","lcode","dcode","lmask","dmask","here","op","dist","from_source","lencode","distcode","lenbits","distbits","dolen","dodist","sane","35","inflate_fast","inflate_table","TYPE","BAD","ZSWAP32","q","InflateState","havedict","flags","check","wbits","ncode","nlen","ndist","have","next","lens","work","lendyn","distdyn","back","was","inflateResetKeep","inflateReset","inflateReset2","lenfix","distfix","virgin","fixedtables","sym","inflateInit","put","here_bits","here_op","here_val","last_bits","last_op","last_val","opts","hbuf","order","inf_leave","updatewindow","inflateInfo","36","lbase","lext","dbase","dext","lens_index","codes","table_index","incr","fill","low","mask","curr","drop","used","huff","base","base_index","count","MAXBITS","offs","extra_index","37","38","extra_lbits","extra_dbits","extra_blbits","bl_order","static_ltree","static_dtree","D_CODES","_dist_code","_length_code","base_length","base_dist","static_l_desc","static_d_desc","static_bl_desc","StaticTreeDesc","static_tree","extra_bits","extra_base","elems","max_length","has_stree","TreeDesc","dyn_tree","stat_desc","max_code","d_code","put_short","w","send_bits","send_code","tree","bi_reverse","gen_codes","next_code","init_block","LITERALS","END_BLOCK","bi_windup","smaller","_n2","_m2","pqdownheap","j","compress_block","ltree","dtree","lc","lx","build_tree","desc","node","stree","h","xbits","overflow","gen_bitlen","scan_tree","curlen","prevlen","nextlen","max_count","min_count","REP_3_6","REPZ_3_10","REPZ_11_138","send_tree","static_init_done","stored_len","copy_block","LENGTH_CODES","L_CODES","tr_static_init","opt_lenb","static_lenb","max_blindex","black_mask","detect_data_type","BL_CODES","build_bl_tree","lcodes","dcodes","blcodes","send_all_trees","STATIC_TREES","bi_flush","39","version","current_codepage","current_ansi","cptable","VALID_ANSI","CS2CP","0","77","128","129","130","134","136","161","162","163","177","178","186","204","222","238","255","69","set_ansi","cp","set_cp","reset_cp","char_codes","debom","c1","utf16leread","utf16beread","_getchar","x","map","Base64","c3","e1","e2","e3","e4","has_buf","process","versions","allocUnsafe","new_raw_buf","new_unsafe_buf","s2a","a2s","_chr","ab2a","bconcat","bufs","chr0","make_ssf","_strrev","pad0","pad_","rpad_","p2_32","pad0r","round","pad0r1","pad0r2","isgeneral","days","months","init_table","table_fmt","frac","mixed","sgn","B","P_2","P_1","P","Q_2","Q_1","Q","A","b2","dow","dout","T","abs","date1904","setDate","getDay","basedate","dnthresh","getTime","base1904","datenum_local","epoch","getTimezoneOffset","general_fmt_int","_general_int","general_fmt_num","gnr1","gnr2","gnr4","gnr5","gnr6","gfn5","V","log","LOG10E","toPrecision","toFixed","toExponential","gfn2","gfn3","gfn4","general_fmt","write_date","fmt","ss0","ss","tt","outl","commaify","_general_num","_general","write_num","pct1","write_num_exp","idx","period","ee","fakee","$$","$1","$2","$3","frac1","dec1","closeparen","phone","hashq","cc","rnd","dd","write_num_flt","ffmt","write_num_cm","sfmt","mul","write_num_pct","ri","ff","aval","sign","den","rr","myn","myd","write_num_f1","carry","oa","lres","rres","flr","write_num_exp2","write_num_int","write_num_cm2","write_num_pct2","write_num_f2","split_fmt","in_str","_split","abstime","fmt_is_date","eval_fmt","flen","dt","lst","hr","ssm","bt","jj","nstr","myv","ostr","vv","decpt","lasti","retval","is_date","_eval","cfregex","cfregex2","chkcond","thresh","parseFloat","dateNF","lat","m1","m2","choose_fmt","load_entry","_table","get_table","load_table","tbl","CRC32","XLMLFormatMap","SSFImplicit","dateNFregex","signed_crc_table","bstr","seed","C","L","crc32_buf_8","factory","_fs","CFB","fs","dirname","write_dos_date","hms","write_shift","ymd","parse_extra_field","prep_blob","read_shift","sz","tgt","mtime","atime","ctime","mt","parse","parse_zip","mver","nmfs","difat_sec_cnt","dir_start","minifat_start","difat_start","ssz","fat_addrs","mv","chk","HEADER_SIGNATURE","HEADER_CLSID","check_get_mver","check_shifts","dir_cnt","sectors","nsectors","ceil","sectorify","sleuth_fat","sector_list","sl","chkd","buf_chain","modulus","addr","__readInt32LE","nodes","__toBuffer","make_sector_list","ENDOFCHAIN","Paths","FileIndex","FullPaths","mini","minifat_store","pl","sector","namelen","__utf16le","color","R","clsid","ct","read_date","storage","get_sector_list","get_mfat_entry","read_directory","FI","FP","dad","build_full_paths","entry","payload","MSSZ","new_buf","cnt","__readUInt32LE","init_cfb","cfb","CLSID","nm","find","rebuild_cfb","seed_cfb","gc","_file","pop","now","sort","Z","namecmp","elt","_write","_opts","fileType","cdirs","start_cd","fcnt","fp","fi","crcs","sz_cd","namebuf","outbuf","_deflateRawSync","write_zip","mini_size","fat_size","mfat_cnt","fat_base","fat_cnt","difat_cnt","HEADER_SIG","chainit","consts","DIFSECT","FATSECT","_nm","_zlib","MAXREGSECT","FREESECT","HEADER_MINOR_VERSION","MAXREGSID","NOSTREAM","EntryTypes","deflateRawSync","_deflate","CLEN_ORDER","LEN_LN","DST_LN","use_typed_arrays","bitswap8","bit_swap_n","rev","read_bits_2","bl","read_bits_3","read_bits_5","read_bits_7","read_bits_n","realloc","a","zero_fill_array","_deflateRaw","boff","off","clens","cmap","MAX","maxlen","ccode","ctree","cleni","fix_lmap","fix_dmap","dlens","dyn_lmap","dyn_dmap","dyn_cmap","dyn_len_1","dyn_len_2","dyn","_HLIT","_HDIST","_HCLEN","read_bits_4","hcodes","h1","h2","_inflate","usz","woff","OL","max_len_1","max_len_2","len_eb","dst_eb","dst","warn_or_throw","wrn","csz","efsz","fcsz","EF","parse_local_file","meth","setMilliseconds","setFullYear","setMonth","setHours","setMinutes","setSeconds","parse_dos_date","_csz","_usz","ef","InflRaw","InflateRaw","_processChunk","_finishFlushFlag","bytesRead","_inflateRawSync","_crc32","cfb_add","unsafe","fpath","cfb_gc","UCFullPaths","UCPaths","UCPath","readFileSync","read_file","writeFileSync","writeFile","cfb_new","cfb_del","splice","cfb_mov","old_name","new_name","ReadShift","CheckField","use_zlib","zlib","_inflateRaw","require","blobify","a2u","write_dl","fname","utf8write","IE_SaveFile","navigator","msSaveBlob","URL","document","createElement","createObjectURL","url","chrome","downloads","download","revokeObjectURL","setTimeout","href","appendChild","click","removeChild","File","Folder","open","close","ks","o2","evert_key","K","evert","evert_num","datenum","numdate","setTime","parse_isodur","sec","good_pd_date","good_pd","parseDate","fixdate","cc2str","arr","dup","JSON","stringify","fuzzynum","Number","wt","fuzzydate","NaN","getYear","jszip","safe_split_regex","getdatastr","safegetzipfile","g","getzipfile","getzipdata","safe","getdatabin","getzipstr","resolve_path","step","XML_HEADER","attregexg","tagregex","nsregex","nsregex2","parsexmltag","tag","skip_root","z","eq","quot","trim","strip_ns","encregex","coderegex","encodings","rencoding","unescapexml","decregex","charegex","escapexml","escapexmltag","htmlcharegex","escapehtml","xlml_fixstr","entregex","entrepl","parsexmlbool","utf8read","orig","utf8readb","ww","corpus","utf8readc","mtcache","entities","vt_cache","matchtag","htmldecode","vtregex","vtvregex","vtmregex","parseVector","baseType","WTF","forEach","wtregex","writetag","wxt_helper","writextag","write_w3cdtf","toISOString","__lpp4","___lpp4","XMLNS","XLMLNS","___toBuffer","__readUInt16LE","___utf16le","__hexlify","___hexlify","__utf8","__readUInt8","___utf8","__lpstr","___lpstr","__cpstr","___cpstr","__lpwstr","___lpwstr","__double","___double","__8lpp4","___8lpp4","Infinity","read_double_le","is_buf","readUInt32LE","readDoubleLE","__readInt16LE","__readInt32BE","oI","oR","loc","oo","__writeUInt16LE","WriteShift","__writeUInt32LE","bs","av","isFinite","LN2","write_double_le","__writeInt32LE","hexstr","fld","parsenoop","recordhopper","cb","tmpbyte","cntbyte","RT","XLSBRecordEnum","buf_array","blksz","newblk","curbuf","endbuf","_bufs","write_record","ba","XLSBRE","shift_cell_xls","cRel","rRel","biff","shift_range_xls","encode_cell_xls","encode_cell","encode_range_xls","encode_row","encode_col","decode_row","rowstr","decode_col","colstr","col","split_cell","cstr","decode_cell","splt","decode_range","encode_range","cs","ce","safe_decode_range","format_cell","XF","numFmtId","safe_format_cell","sheet_to_workbook","sheets","sheet_add_aoa","_ws","dense","_R","_C","_origin","_range","__R","__C","sheetStubs","cellDates","write_UInt32LE","parse_XLWideString","cchCharacters","write_XLWideString","_null","parse_StrRun","ich","ifnt","parse_RichStr","rgsStrRun","dwSizeStrRun","O","_crypto","crypto","rc4","md5","createHash","update","digest","make_offcrypto","parse_BrtCommentText","parse_XLSBCell","iStyleRef","write_XLSBCell","parse_XLSBCodeName","write_XLSBCodeName","parse_XLNullableWideString","write_XLNullableWideString","parse_XLNameWideString","parse_RelID","write_RelID","parse_RkNumber","fX100","fInt","RK","parse_RfX","parse_UncheckedRfX","write_UncheckedRfX","parse_Xnum","write_Xnum","BErr","RBErr","write_BrtColor","auto","theme","nTS","tint","rgb","parse_ClipboardFormatOrString","VT_STRING","VT_CUSTOM","DocSummaryPIDDSI","VT_VECTOR","SummaryPIDSI","SpecialProperties","DocSummaryRE","SummaryRE","CountryEnum","XLSFillPattern","XLSIcv","ct2type","CT_LIST","workbooks","xlsm","xlsb","xlam","xltx","strs","comments","charts","dialogs","macros","styles","type2ct","evert_arr","CT","CTYPE_XML_ROOT","xsd","xsi","CTYPE_DEFAULTS","rels","RELS","WB","SHEET","HLINK","VML","VBA","get_rels_path","parse_rels","currentFilePath","hash","rel","Type","Target","Id","TargetMode","canonictarget","RELS_ROOT","write_rels","rid","add_rels","rId","relobj","write_rdf_type","write_meta_ods","CORE_PROPS","CORE_PROPS_REGEX","parse_core_props","cur","CORE_PROPS_XML_ROOT","dc","dcterms","dcmitype","cp_doit","EXT_PROPS","load_props_pairs","HP","TOP","props","hp","parts","Worksheets","NamedRanges","DefinedNames","Chartsheets","ChartNames","EXT_PROPS_XML_ROOT","vt","CUST_PROPS","custregex","CUST_PROPS_XML_ROOT","XLMLDocPropsMap","RevNumber","Application","LastPrinted","CreatedDate","ModifiedDate","AppVersion","ContentStatus","Identifier","Language","evert_XLMLDPM","xlml_set_prop","parse_FILETIME","dwLowDateTime","dwHighDateTime","parse_lpstr","pad","parse_lpwstr","parse_VtStringBase","stringType","parse_VtString","parse_VtHeadingPair","parse_TypedPropertyValue","parse_dictionary","CodePage","dict","pid","parse_BLOB","Size","parse_ClipboardData","parse_VtUnalignedString","cElements","parse_VtVecHeadingPairValue","parse_VtVecHeadingPair","parse_VtVecUnalignedLpstrValue","parse_VtVecUnalignedLpstr","write_TypedPropertyValue","write_FILETIME","parse_PropertySet","PIDSI","start_addr","NumProps","Dictionary","DictObj","PropID","Offset","PropH","fail","piddsi","oldpos","parsebool","XLSPSSkip","guess_property_type","write_PropertySet","entries","RE","hdr","piao","prop","pr","pio","pinfo","parse_PropertySetStream","NumSets","FMTID0","FMTID1","Offset0","Offset1","SystemIdentifier","PSet1","PSet0","rval","FMTID","write_PropertySetStream","entries2","clsid2","ps0","ps1","parsenoop2","writebool","parseuint16","writeuint16","parseuint16a","parslurp","parse_ShortXLUnicodeString","cch","parse_XLUnicodeRichExtendedString","cbExtRst","fExtSt","fRichSt","width","cRun","parse_XLUnicodeStringNoCch","parse_XLUnicodeString","parse_XLUnicodeString2","write_XLUnicodeString","parse_HyperlinkString","write_Hyperlink","hl","F","parse_LongRGBA","parse_LongRGB","parse_XLSCell","ixfe","write_XLSCell","parse_XTI","parse_RkRec","parse_Ref8U","rwFirst","rwLast","write_Ref8U","parse_RefU","parse_Ref","parse_FtCmo","ot","parse_FtSkip","FtTab","cf","fSharedNote","parse_BOF","BIFFVer","write_BOF","write_BoundSheet8","hs","parse_DefaultRowHeight","miyRw","Unsynced","DyZero","ExAsc","ExDsc","write_Format","b5","parse_BIFF2Format","parse_Dimensions","write_XF","ixfeP","parse_BoolErr","parse_Bes","parse_XLHeaderFooter","parse_ExternName","fBuiltIn","fWantAdvise","fWantPict","fOle","fOleLink","fIcon","sbcch","udfName","parse_AddinUdf","Name","XLSLblBuiltIn","parse_Lbl","chKey","cce","itab","npflen","rgce","rgcb","parse_Rgce","parse_RgbExtra","parse_NameParsedFormula","parse_ExternSheet","parse_BIFF5ExternSheet","parse_Array","ref","parse_ArrayParsedFormula","parse_BIFF5OT","write_HLink","write_HLinkTooltip","TT","Tooltip","parse_ColInfo","colFirst","colLast","coldx","cchName","parse_Blank","parse_Scl","parse_String","DBF","dbf_codepage_map","dbf_to_sheet","ft","memo","vfp","l7","nrow","fpos","rlen","current_cp","field","hend","sheetRows","dbf_to_aoa","_RLEN","to_workbook","to_sheet","from_sheet","aoa","hcnt","coltypes","guess","_guess","hf","_f","hb","rout","_s","SYLK","sylk_to_aoa_str","records","rj","formats","next_cell_format","sht","rowinfo","colinfo","cw","Mval","rstr","record","C_seen_K","C_seen_X","codepage","formula","rc_to_a1","F_seen","hidden","wch","process_col","hpt","pt2px","sylk_to_sheet","aoasht","sylk_to_aoa","write_ws_cell_sylk","a1_to_rc","preamble","RS","rec","width2px","px2char","rows","px2pt","write_ws_rows_sylk","coord","DIF","dif_to_aoa_str","metadata","dif_to_sheet","dif_to_aoa","push_field","push_value","topic","ETH","eth_to_sheet","eth_to_aoa","sep","meta","sheet_to_eth_data","PRN","set_text_arr","guess_seps","guess_sep_weights","prn_to_sheet_str","instr","guess_sep","sepcc","_re","finish_cell","Y","datestr","timestr","dateNF_fix","cellText","cellNF","outer","dsv_to_sheet_str","lines","prn_to_aoa_str","prn_to_sheet","firstbyte","WK_","lotus_to_workbook_buf","sidx","snames","refguess","Enum","WK1Enum","WK3Enum","qpro","lotushopper","Rn","vers","parse_cell","parse_LABEL","parse_cell_3","parse_NUMBER_17","v1","v2","parse_NUMBER_27","parse_rs","tregex","rpregex","rregex","rend","nlregex","parse_r","terms","rpr","intro","outro","font","align","pass","shadow","outline","strike","uval","family","parse_rpr","rs","sitregex","sirregex","sirphregex","parse_si","html","cellHTML","sstr0","sstr1","sstr2","SST","straywsregex","write_sst_xml","sst","bookSST","xmlns","main","Count","uniqueCount","Unique","sitag","write_BrtSSTItem","write_sst_bin","write_BrtBeginSst","_JS2ANSI","parse_CRYPTOVersion","Major","Minor","parse_DataSpaceMapEntry","comps","parse_EncryptionHeader","Flags","AlgID","valid","AlgIDHash","KeySize","ProviderType","CSPName","parse_EncryptionVerifier","Salt","Verifier","VerifierHash","parse_EncInfoStd","parse_EncInfoExt","parse_EncInfoAgl","KeyData","xml","encryptedHmacKey","encryptedHmacValue","encs","uri","crypto_CreatePasswordVerifier_Method1","Password","PasswordArray","PasswordDecoded","PadArray","InitialCode","XorMatrix","XorRor","crypto_CreateXorArray_Method1","byte1","byte2","Byte","password","Temp","PasswordLastChar","PadIndex","XorKey","CurrentElement","Char","CreateXorKey_Method1","Index","ObfuscationArray","RTF","rtf_to_sheet","rtf_to_sheet_str","rgb2Hex","rgb_tint","hsl","G","H6","L2","rgb2HSL","hex2RGB","X","h6","hsl2RGB","MDW","px","char2width","chr","cycle_width","collw","find_mdw_colw","delta","_MDW","coll","customWidth","pt","numFmtRegex","cellXfRegex","fillsRegex","fontsRegex","bordersRegex","XLMLPatternTypeMap","cellXF_uint","cellXF_bool","parse_sty_xml","themes","NumberFmt","formatCode","parse_numFmts","Fonts","bold","italic","underline","condense","vertAlign","scheme","indexed","icv","themeElements","clrScheme","parse_fonts","Fills","patternType","bgColor","fgColor","parse_fills","Borders","parse_borders","xf","CellXf","vertical","textRotation","indent","wrapText","parse_cellXfs","STYLES_XML_ROOT","write_sty_xml","style_builder","toXml","NF","write_numFmts","cellXfs","write_cellXfs","write_BrtFmt","STY","rev_XLSBFillPTNames","parse_BrtFill","write_BrtFill","fls","write_BrtXF","write_Blxf","parse_BrtBorder","write_sty_bin","write_FMTS_bin","grbit","write_FontFlags","sss","charset","write_BrtFont","write_FONTS_bin","write_FILLS_bin","write_BrtBorder","write_BORDERS_bin","fontId","fillId","borderId","write_CELLSTYLEXFS_bin","write_CELLXFS_bin","xfId","builtinId","write_BrtStyle","write_STYLES_bin","write_DXFS_bin","defTableStyle","defPivotStyle","write_BrtBeginTableStyles","write_TABLESTYLES_bin","parse_clrScheme","lastClr","parse_fontScheme","parse_fmtScheme","THEME","clrsregex","fntsregex","fmtsregex","themeltregex","parse_theme_xml","write_theme","parse_themeElements","Themes","themeXLSX","parse_ExtProp","extType","xclrType","nTintShade","xclrValue","parse_IcvXF","parse_ColorTheme","parse_FullColorExt","parse_XFExtGradient","IMG","DRAW","_shapeid","write_comments_vml","csize","bbox","joinstyle","gradientshapeok","coordsize","fillcolor","strokecolor","insertCommentsIntoSheet","sheetName","encoded","author","CMNT","CMNT_XML_ROOT","write_comments_xml","iauthor","parse_BrtCommentAuthor","write_comments_bin","write_BrtCommentAuthor","write_BrtBeginComment","run","write_StrRun","write_BrtCommentText","VBAFMTS","DS","MS","rcregex","rcbase","rcfunc","$4","$5","fstr","crefregex","$0","shift_formula_xlsx","shift_formula_str","_xlfn","parseread1","parse_ColRelU","parse_RgceArea","parse_RgceArea_BIFF2","parse_RgceLoc","parse_RgceLoc_BIFF2","parse_RgceElfLoc","fQuoted","parse_PtgAttrSpaceType","parse_SerAr","parse_PtgExtraMem","parse_PtgExtraArray","cols","parse_PtgElfLoc","parse_PtgElfNoop","parse_PtgElfCol","parse_PtgElfColS","parse_PtgElfColSV","parse_PtgElfColV","parse_PtgElfLel","parse_PtgElfRadical","parse_PtgElfRadicalLel","parse_PtgElfRadicalS","parse_PtgElfRw","parse_PtgElfRwV","PtgListRT","PtgTypes","iftab","FtabArgc","Ftab","cparams","tab","parsetab","Cetab","nameindex","rl","parse_RgceLocRel_BIFF2","cl","parse_RgceLocRel","parse_RgceAreaRel","ixti","parse_PtgNameX_BIFF5","PtgDupes","Ptg18","coltype","rt","Ptg19","bitSemi","bitIf","bitGoto","ptgs","stringify_array","PtgBinOp","PtgAdd","PtgConcat","PtgDiv","PtgEq","PtgGe","PtgGt","PtgLe","PtgLt","PtgMul","PtgNe","PtgPower","PtgSub","get_ixti","supbooks","sname","formula_quote_sheet_name","XTI","SID","get_ixti_raw","stringify_formula","stack","nameidx","last_sp","sp","fflen","argc","args","lbl","names","XLSXFutureFunctions","externbook","bookidx","lp","rp","sharedf","parsedf","fnd","arrayf","_left","parse_SharedParsedFormula","parse_Formula","parse_FormulaValue","cbf","parse_XLSCellParsedFormula","shared","parse_XLSBParsedFormula","parse_XLSBArrayParsedFormula","parse_XLSBCellParsedFormula","parse_XLSBNameParsedFormula","parse_XLSBSharedParsedFormula","ods_to_csf_formula","ods_to_csf_3D","_ssfopts","WS","browser_has_Map","Map","get_sst_id","has","revarr","get","col_obj_w","default_margins","margins","defs","footer","get_cell_style","exec","numFmt","addStyle","revssf","ssf","applyNumberFormat","safe_format","fmtid","fillid","raw_rgb","check_ws","mergecregex","sheetdataregex","hlinkregex","dimregex","colregex","afregex","marginregex","sheetprregex","svsregex","parse_ws_xml_sheetpr","sheetPr","codeName","CodeName","sviewregex","write_ws_xml_cell","oldt","oldv","Strings","revStrings","cellregex","rowregex","isregex","refregex","match_v","match_f","parse_ws_xml_data","sdata","sstr","ftag","cells","cref","tagr","tagc","do_format","rowobj","rowrite","marr","marrlen","xlen","ht","outlineLevel","cellFormula","si","_tag","_r","WS_XML_ROOT","write_ws_xml","rdata","vbaraw","cname","Workbook","sview","workbookViewId","Views","rightToLeft","RTL","write_ws_xml_sheetviews","sheetFormat","defaultRowHeight","baseColWidth","outlineLevelRow","write_ws_xml_cols","params","height","_cell","customHeight","write_ws_xml_data","write_ws_xml_protection","Names","Sheet","Ref","write_ws_xml_autofilter","merges","write_ws_xml_merges","margin","relc","location","tooltip","ignoreEC","numberStoredAsText","sqref","write_row_header","ncolspan","lcs","caddr","first","write_BrtRowHdr","parse_BrtWsDim","write_BrtWsDim","parse_BrtMergeCell","write_BrtMergeCell","BrtMarginKeys","write_ws_bin_cell","ncell","write_BrtCellIsst","write_BrtCellSt","d100","write_RkNumber","write_BrtCellRk","write_BrtCellReal","write_BrtCellBool","write_BrtCellBlank","write_ws_bin","write_BrtWsProp","write_BrtBeginWsView","write_WSVIEWS2","write_BrtColInfo","write_COLINFOS","cap","write_CELLTABLE","write_BrtSheetProtection","write_SHEETPROTECT","write_AUTOFILTER","write_BrtBeginMergeCells","write_MERGECELLS","locidx","write_BrtHLink","write_HLINKS","write_BrtMargins","write_BrtCellIgnoreEC","write_IGNOREECS","write_LEGACYDRAWING","CS","WBPropsDef","WBViewDef","SheetDef","CalcPrDef","push_defaults_array","push_defaults","parse_wb_defaults","WBProps","CalcPr","WBView","badchars","check_ws_name","_good","wbnsregex","WB_XML_ROOT","write_wb_xml","write_names","workbookPr","sheetId","Hidden","Comment","localSheetId","write_BrtBundleSh","iTabID","strRelID","write_wb_bin","write_BrtFileVersion","filterPrivacy","write_BrtWbProp","vistab","write_BrtBookView","write_BOOKVIEWS","write_BUNDLESHS","parse_ws","ai","af","seencol","R_n","aii","_d","relId","Rel","rfx","tmpref","parse_ws_bin","data1","data2","mtch","ridx","parse_ws_xml_dim","svs","parse_ws_xml_sheetviews","columns","coli","colm","colM","parse_ws_xml_cols","afilter","parse_ws_xml_autofilter","_merge","hlink","rng","parse_ws_xml_hlinks","parse_ws_xml_margins","parse_ws_xml","parse_cmnt","authors","parse_comments_bin","commentList","authtag","cmnttag","cm","authorId","guid","textMatch","parse_comments_xml","write_wb","write_ws","write_sst","write_cmnt","attregexg2","attregex2","xlml_parsexmltag","words","xlml_parsexmltagobj","xlml_set_custprop","Custprops","oval","process_style_xlml","stag","Interior","I","Pattern","ID","parse_xlml_data","csty","nf","sid","StyleID","interiors","Parent","UTC","safe_format_xlml","Formula","ArrayRange","xlml_clean_comment","xlml_normalize","xlmlregex","parse_xlml_xml","opening","ishtml","HTML_","tmp","sheetnames","cursheet","dtag","didx","fidx","pidx","cstys","wsprops","lastIndex","HRef","HRefScreenTip","MergeAcross","MergeDown","cma","cmd","AutoFitHeight","Height","Format","ssfidx","Width","_col","Span","_NamedRange","_DefinedName","RefersTo","AutoFilter","Range","parse_fods","seen","Margin","pagemargins","Top","Left","Right","Bottom","bookSheets","bookProps","parse_xlml","fix_read_opts","write_name_xlml","write_ws_xlml_cell","mi","write_ws_xlml_row","write_ws_xlml","write_ws_xlml_names","write_ws_xlml_table","objects","scenarios","selectLockedCells","selectUnlockedCells","write_ws_xlml_wsopts","write_xlml","xlml_write_docprops","BLACKLIST","xlml_write_custprops","write_props_xlml","write_sty_xlml","write_names_xlml","slurp","insitu","XLSRecordEnum","ll","safe_format_xf","make_cell","PSCLSID","parse_xlscfb","CompObj","WorkbookP","AnsiUserType","AnsiClipboardFormat","parse_ClipboardFormatOrAnsiString","Reserved1","UnicodeClipboardFormat","parse_ClipboardFormatOrUnicodeString","Reserved2","parse_compobj","lastcell","cmnt","rngC","rngR","temp_val","country","Directory","last_formula","cur_sheet","Preamble","last_cell","cell_valid","XFs","palette","get_rgb","addcell","file_depth","xfd","icvFore","icvBack","process_cell_style","afi","rrtabid","lastuser","winlocked","wtf","last_lbl","last_Rn","BIFF2Fmt","BIFF2FmtTable","FilterDatabases","seen_codepage","RecordType","Date1904","WriteProtect","CalcRefMode","FullCalc","fDialog","ExternCount","tmpri","fakebs8","rknum","rkrec","_fr","_fc","_fe","_arraystart","isst","_j","_ixfe","b4idx","b2idx","cmo","lastobj","TxO","ImData","noteobj","ext","xfe","Encryption","Metadata","Country","parse_workbook","bookVBA","newcfb","newpath","make_vba_xls","DSI","DocSummary","SI","Summary","HeadingPairs","TitlesOfParts","parse_xls_props","bookFiles","ArchID","Ptg","fItalic","fStrikeout","fOutline","fShadow","fCondense","fExtend","parse_FontFlags","bCharSet","xColorType","bR","bG","bB","parse_BrtColor","ixfeParent","ifmt","defaultThemeVersion","strName","autoCompressPictures","backupFile","checkCompatibility","hidePivotFieldList","promptedSolutions","publishItems","refreshAllConnections","saveExternalLinkValues","showBorderUnselectedTables","showInkAnnotation","showObjects","showPivotChartFilter","updateLinks","fAlwaysCalc","display","idObj","stAuthor","parse_NoteSh","Info","Data","EncryptionVersionInfo","EncryptedVerifier","EncryptedVerifierHash","parse_RC4Header","EncryptionHeader","EncryptionVerifier","parse_RC4CryptoHeader","parse_FilePassHeader","XorArrayIndex","XorArray","verificationBytes","verifier","Value","crypto_DecryptData_Method1","parse_XORObfuscation","dyHeight","fl","Pos","Dim","CurTab","FirstTab","Selected","TabRatio","UserName","fts","parse_BIFF5Obj","parse_FtArray","ccv","rw","rkrecs","lastcol","ixfes","fStyle","alc","fWrap","alcV","fJustLast","trot","cIndent","fShrinkToFit","iReadOrder","fAtrNum","fAtrFnt","fAtrAlc","fAtrBdr","fAtrPat","fAtrProt","dgLeft","dgRight","dgTop","dgBottom","icvLeft","icvRight","grbitDiag","icvTop","icvBottom","icvDiag","dgDiag","fsxButton","parse_CellStyleXF","cmcs","ucnt","extsst","dsst","ctab","virtPath","rgst","texts","accel","parse_ControlInfo","cchText","sVer","displayName","targetFrameName","moniker","oleMoniker","fileTime","Loc","parse_URLMoniker","ansiPath","parse_FileMoniker","parse_HyperlinkMoniker","parse_Hyperlink","xnum","cUse","wzTooltip","cxfs","cexts","cchComment","themeXML","parse_frtHeader","def","area","env","lcb","XLSRE","write_biff_rec","write_BIFF2Cell","write_ws_biff2_cell","write_BIFF2NUM","write_BIFF2BERR","write_BIFF2LABEL","write_ws_biff8_cell","write_Number","write_Bes","write_BoolErr","b8","write_Label","write_ws_biff8","_WB","_sheet","MAX_ROWS","guts","write_Guts","write_Dimensions","write_Window2","write_MergeCells","HL","write_ws_biff8_hlinks","write_FEAT","write_biff8_global","_sheets","_wb","writezeroes","write_WriteAccess","write_RRTabId","write_Window1","safe1904","write_Font","write_FONTS_biff8","write_FMTS_biff8","write_CELLXFS_biff8","write_Country","blen","write_biff_buf","write_biff8_buf","write_ws_biff2","write_biff2_buf","html_to_sheet","mtch2","re","split_regex","hd","colspan","rowspan","_t","make_html_row","editable","make_html_preamble","_BEGIN","_END","_row","BEGIN","END","_preamble","parse_dom_table","getElementsByTagName","midx","is_dom_element_hidden","elts","children","innerHTML","getAttribute","element","get_computed_style","ownerDocument","defaultView","getComputedStyle","get_get_computed_style_function","getPropertyValue","number_formats","parse_content_xml","day","month","year","hours","minutes","seconds","era","quarter","sheetag","rowtag","fixed","NFtag","ctag","textp","textpidx","textR","row_ol","number_format_map","mrange","rowpeat","colpeat","atag","_Ref","creator","creatoridx","isstub","intable","rptR","rpt","nrange","ptp","parse_ods","ods","FEtag","parse_manifest","write_styles_ods","write_content_ods","null_cell_xml","_Fref","text_p","_tgt","fods","write_automatic_styles_ods","write_ods","manifest","rdf","write_rdf","write_manifest","write_obj_str","write_sheet_index","write_htm_str","write_csv_str","sheet_to_csv","write_slk_str","write_dif_str","write_prn_str","write_rtf_str","write_txt_str","sheet_to_txt","write_dbf_buf","write_eth_str","fix_opts_func","fix_write_opts","safe_parse_sheet","relsPath","sheetRels","stype","parse_cs_bin","parse_cs_xml","parse_cs","dfile","drelsp","chartp","parse_drawing","crelsp","csheet","nc","cache","parse_numCache","parse_chart","parse_ds","strip_front_slash","binname","zipentries","links","coreprops","extprops","custprops","calcchains","vba","drawings","TODO","ctext","Extension","ContentType","PartName","calcchain","parse_ct","parse_sst_bin","parse_sst_xml","parse_sst","parse_theme","parse_sty_bin","parse_sty","link","parse_xlink_bin","parse_xlink","parse_wb_bin","dname","dnstart","parse_wb_xml","parse_wb","propdata","parse_ext_props","toks","warn","parse_cust_props","deps","bookDeps","parse_cc_bin","parse_cc_xml","wbsheets","wbext","wbrelsi","wbrelsfile","wbrels","safe_parse_wbrels","nmode","dirComments","canonicalpath","sheetNames","parse_comments","Deps","Styles","bin","parse_xlsxcfb","U","W","parse_DataSpaceVersionInfo","dsm","parse_DataSpaceMap","seds","parse_DataSpaceDefinition","parse_TransformInfoHeader","ename","cmode","parse_Primary","einfo","parse_EncryptionInfo","decrypt_agile","decrypt_std76","foo","vbafmt","write_core_props","_sn","_i","write_ext_props","write_vt","write_cust_props","wsrels","need_vml","rId1","write_sty","f1","f2","f3","write_ct","read_plaintext","read_prn","readSync","infile","read_binary","bstrify","ab","vu","read_cfb","OLD_WTF","read_wb_ID","read_zip","read_utf16","read_plaintext_raw","write_cfb_ctr","write_string_type","bom","write_binary_type","writeSync","N","cn","check_wb","write_stxt_type","wbpath","Keys","DSEntries","SEntries","CEntries","CEntries2","write_xls_props","fill_vba_xls","write_xlscfb","write_cfb_type","StyleBuilder","oopts","encrypt_agile","write_zip_type","resolve_book_type","make_json_row","isempty","defineProperty","enumerable","__rowNum__","outi","counter","CC","blankrows","qreg","make_csv_row","FS","txt","endregex","skipHidden","strip","sheet_to_formulae","cmds","sheet_add_json","js","JS","Readable","get_formulae","make_csv","make_json","make_formulae","table_to_sheet","table_to_book","sheet_to_html","sheet_to_dif","sheet_to_slk","sheet_to_eth","sheet_to_row_object_array","get_default","ws_get_cell_stub","book_append_sheet","book_set_sheet_visibility","sh","vis","wb_sheet_idx","cell_set_number_format","cell_set_hyperlink","cell_set_internal_link","cell_add_comment","sheet_set_array_formula","rngstr","to_json","objectMode","_read","to_html","to_csv","BOM","XmlNode","tagName","attributes","_attributes","_children","_prefix","prefix","QUOTE","ESCAPED_QUOTE","escapeAttributeValue","att_value","customNumFmtId","40","45","46","47","48","49","56","fmt_table","_hashIndex","_listIndex","initialize","$fonts","$fills","$borders","$numFmts","$cellStyleXfs","$xf","$cellXfs","$cellStyles","$dxfs","$tableStyles","$styles","defaultStyle","defaultCellStyle","gray125Style","addStyles","hashKey","_addXf","_duckTypeStyle","patternFill","_getStyleCSS","css","_addFont","_addFill","_addBorder","_addNumFmt","$alignment","readingOrder","$font","numFmtIdx","$numFmt","$patternFill","$fgColor","$bgColor","$fill","_getSubBorder","direction","spec","$direction","$color","$border","readFile","writeFileAsync","_cb","Function","make_xlsx_lib","_babelPolyfill","writable","configurable","padStart","padEnd","blobSupported","blobSupportsArrayBufferView","blobBuilderSupported","mapArrayBufferViews","ary","byteOffset","BlobBuilderConstructor","bb","part","BlobConstructor","it","cof","UNSCOPABLES","ArrayProto","at","unicode","Constructor","forbiddenField","isObject","toObject","toAbsoluteIndex","toLength","copyWithin","inc","aLen","forOf","iter","ITERATOR","toIObject","IS_INCLUDES","$this","el","fromIndex","ctx","IObject","asc","$create","IS_MAP","IS_FILTER","IS_SOME","IS_EVERY","IS_FIND_INDEX","NO_HOLES","create","callbackfn","aFunction","isRight","SPECIES","original","constructor","speciesConstructor","invoke","arraySlice","factories","construct","fn","partArgs","bound","TAG","ARG","tryGet","callee","dP","redefineAll","anInstance","$iterDefine","setSpecies","DESCRIPTORS","fastKey","validate","SIZE","getEntry","getConstructor","wrapper","NAME","ADDER","iterable","_l","clear","setStrong","iterated","kind","_k","classof","getWeak","anObject","createArrayMethod","$has","arrayFind","arrayFindIndex","uncaughtFrozenStore","UncaughtFrozenStore","findUncaughtFrozen","store","ufstore","$export","redefine","fails","$iterDetect","setToStringTag","inheritIfRequired","methods","common","IS_WEAK","Base","proto","fixMethod","KEY","instance","HASNT_CHAINING","THROWS_ON_PRIMITIVES","ACCEPT_ITERABLES","BUGGY_ZERO","$instance","NEED","core","__e","$defineProperty","createDesc","$toISOString","lz","RangeError","getUTCFullYear","getUTCMilliseconds","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","toPrimitive","NUMBER","hint","is","getKeys","gOPS","pIE","getSymbols","symbols","isEnum","hide","own","exp","IS_FORCED","IS_GLOBAL","IS_STATIC","IS_PROTO","IS_BIND","expProto","MATCH","defined","wks","regexpExec","REPLACE_SUPPORTS_NAMED_GROUPS","groups","SPLIT_WORKS_WITH_OVERWRITTEN_EXEC","originalExec","SYMBOL","DELEGATES_TO_SYMBOL","DELEGATES_TO_EXEC","execCalled","nativeRegExpMethod","fns","nativeMethod","arg2","forceStringMethod","strfn","rxfn","ignoreCase","multiline","sticky","IS_CONCAT_SPREADABLE","flattenIntoArray","sourceLen","mapper","thisArg","spreadable","targetIndex","sourceIndex","mapFn","isArrayIter","getIterFn","BREAK","RETURN","iterator","iterFn","__g","documentElement","setPrototypeOf","un","propertyIsEnumerable","Iterators","descriptor","IteratorPrototype","LIBRARY","$iterCreate","getPrototypeOf","BUGGY","KEYS","VALUES","returnThis","DEFAULT","IS_SET","FORCED","getMethod","DEF_VALUES","VALUES_BUG","$native","$default","$entries","$anyNative","values","SAFE_CLOSING","riter","skipClosing","$expm1","expm1","EPSILON","EPSILON32","MAX32","MIN32","fround","$abs","$sign","log1p","scale","inLow","inHigh","outLow","outHigh","META","setDesc","isExtensible","FREEZE","preventExtensions","setMeta","onFreeze","getOrCreateMetadataMap","targetKey","targetMetadata","keyMetadata","MetadataKey","metadataMap","MetadataValue","_","macrotask","Observer","MutationObserver","WebKitMutationObserver","Promise","isNode","notify","domain","exit","enter","nextTick","standalone","resolve","promise","then","toggle","createTextNode","observe","characterData","task","PromiseCapability","reject","$$resolve","$$reject","$assign","Symbol","dPs","enumBugKeys","IE_PROTO","Empty","createDict","iframeDocument","iframe","contentWindow","lt","Properties","IE8_DOM_DEFINE","Attributes","defineProperties","random","__defineSetter__","gOPD","getOwnPropertyDescriptor","gOPN","windowNames","getOwnPropertyNames","getWindowNames","$keys","hiddenKeys","getOwnPropertySymbols","ObjectProto","arrayIndexOf","isEntries","Reflect","ownKeys","$parseFloat","$trim","$parseInt","radix","newPromiseCapability","promiseCapability","bitmap","SRC","$toString","TO_STRING","TPL","isFunction","builtinExec","re1","re2","regexpFlags","nativeExec","nativeReplace","patchedExec","UPDATES_LAST_INDEX_WRONG","NPCG_INCLUDED","reCopy","regExp","replacer","COLLECTION","mapping","nextItem","of","buggy","__proto__","stat","uid","SHARED","copyright","toInteger","searchString","createHTML","attribute","p1","repeat","fillString","stringLength","fillStr","intMaxLength","fillLen","stringFiller","spaces","space","ltrim","rtrim","exporter","ALIAS","FORCE","defer","channel","port","cel","setTask","setImmediate","clearTask","clearImmediate","MessageChannel","Dispatch","queue","listener","event","port2","port1","onmessage","postMessage","addEventListener","importScripts","number","valueOf","$typed","$buffer","propertyDesc","toIndex","createArrayIncludes","ArrayIterators","arrayFill","arrayCopyWithin","$DP","$GOPD","ARRAY_BUFFER","SHARED_BUFFER","BYTES_PER_ELEMENT","$ArrayBuffer","$DataView","DataView","arrayForEach","arrayFilter","arraySome","arrayEvery","arrayIncludes","arrayValues","arrayKeys","arrayEntries","arrayLastIndexOf","arrayReduce","reduce","arrayReduceRight","reduceRight","arrayJoin","arraySort","arrayToString","arrayToLocaleString","toLocaleString","TYPED_CONSTRUCTOR","DEF_CONSTRUCTOR","ALL_CONSTRUCTORS","CONSTR","TYPED_ARRAY","TYPED","VIEW","WRONG_LENGTH","$map","allocate","LITTLE_ENDIAN","FORCED_SET","toOffset","BYTES","speciesFromList","list","fromList","addGetter","internal","$from","mapfn","$of","TO_LOCALE_BUG","$toLocaleString","every","predicate","findIndex","searchElement","includes","separator","reverse","middle","some","comparefn","begin","$begin","$slice","$set","arrayLike","$iterators","isTAIndex","$getDesc","$setDesc","$TypedArrayPrototype$","CLAMPED","GETTER","SETTER","TypedArray","TAC","ABV","TypedArrayPrototype","addElement","getter","setter","$offset","$length","klass","$len","$nativeIterator","CORRECT_ITER_NAME","$iterator","DATA_VIEW","WRONG_INDEX","BaseBuffer","BUFFER","BYTE_LENGTH","BYTE_OFFSET","$BUFFER","$LENGTH","$OFFSET","packIEEE754","mLen","nBytes","eLen","eMax","eBias","unpackIEEE754","nBits","unpackI32","packI8","packI16","packI32","packF64","packF32","isLittleEndian","intIndex","_b","pack","conversion","ArrayBufferProto","$setInt8","setInt8","getInt8","setUint8","bufferLength","getUint8","getInt16","getUint16","getInt32","getUint32","getFloat32","getFloat64","setInt16","setUint16","setInt32","setUint32","setFloat32","setFloat64","Typed","TypedArrayConstructors","userAgent","wksExt","$Symbol","USE_SYMBOL","$re","escape","$every","$filter","$find","forced","$forEach","STRICT","createProperty","$indexOf","NEGATIVE_ZERO","addToUnscopables","Arguments","$reduce","upTo","cloned","$some","$sort","toJSON","pv","TO_PRIMITIVE","DateProto","INVALID_DATE","HAS_INSTANCE","FunctionProto","FProto","nameRE","strong","MAP","sqrt","$acosh","acosh","MAX_VALUE","$asinh","asinh","$atanh","atanh","cbrt","clz32","LOG2E","cosh","hypot","value1","value2","div","sum","larg","$imul","imul","UINT16","xn","yn","xl","yl","log10","log2","sinh","E","tanh","trunc","$Number","BROKEN_COF","TRIM","toNumber","argument","third","maxCode","digits","_isFinite","isInteger","isSafeInteger","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","aNumberValue","$toFixed","ERROR","ZERO","multiply","divide","numToString","acc","fractionDigits","x2","$fails","$toPrecision","precision","$freeze","$getOwnPropertyDescriptor","$getPrototypeOf","$isExtensible","$isFrozen","$isSealed","$preventExtensions","$seal","Internal","newGenericPromiseCapability","OwnPromiseCapability","Wrapper","microtask","newPromiseCapabilityModule","perform","promiseResolve","PROMISE","v8","$Promise","empty","USE_NATIVE","FakePromise","PromiseRejectionEvent","isThenable","isReject","_n","chain","_c","_v","ok","reaction","exited","handler","_h","onHandleUnhandled","onUnhandled","unhandled","isUnhandled","emit","onunhandledrejection","reason","_a","onrejectionhandled","$reject","_w","$resolve","executor","onFulfilled","onRejected","capability","all","remaining","$index","alreadyCalled","race","rApply","fApply","thisArgument","argumentsList","rConstruct","NEW_TARGET_BUG","ARGS_BUG","newTarget","$args","propertyKey","deleteProperty","Enumerate","enumerate","getProto","receiver","setProto","existingDescriptor","ownDesc","$flags","$RegExp","CORRECT_NEW","tiRE","piRE","fiU","proxy","advanceStringIndex","regExpExec","$match","maybeCallNative","rx","fullUnicode","matchStr","SUBSTITUTION_SYMBOLS","SUBSTITUTION_SYMBOLS_NO_NAMED","REPLACE","$replace","searchValue","replaceValue","functionalReplace","results","accumulatedResult","nextSourcePosition","matched","position","captures","namedCaptures","replacerArgs","replacement","getSubstitution","tailPos","ch","capture","sameValue","SEARCH","$search","previousLastIndex","callRegExpExec","$min","$push","MAX_UINT32","SUPPORTS_Y","SPLIT","$split","internalSplit","lastLength","lastLastIndex","splitLimit","separatorCopy","splitter","unicodeMatching","lim","add","$at","codePointAt","context","ENDS_WITH","$endsWith","endsWith","endPosition","$fromCodePoint","fromCodePoint","INCLUDES","point","callSite","tpl","STARTS_WITH","$startsWith","startsWith","wksDefine","enumKeys","_create","gOPNExt","$GOPS","$JSON","_stringify","HIDDEN","SymbolRegistry","AllSymbols","OPSymbols","QObject","findChild","setSymbolDesc","protoDesc","isSymbol","$defineProperties","$propertyIsEnumerable","$getOwnPropertyNames","$getOwnPropertySymbols","IS_OP","es6Symbols","wellKnownSymbols","keyFor","useSetter","useSimple","FAILS_ON_PRIMITIVES","$replacer","$isView","isView","fin","viewS","viewT","init","InternalMap","weak","NATIVE_WEAK_MAP","IS_IE11","ActiveXObject","WEAK_MAP","$WeakMap","WEAK_SET","arraySpeciesCreate","flatMap","flatten","depthArg","$includes","asap","isError","clamp","lower","upper","DEG_PER_RAD","PI","RAD_PER_DEG","degrees","radians","fscale","iaddh","x0","x1","y0","y1","$x0","$y0","imulh","$u","$v","u0","v0","u1","isubh","signbit","umulh","__defineGetter__","getOwnPropertyDescriptors","getDesc","__lookupGetter__","__lookupSetter__","$values","OBSERVABLE","cleanupSubscription","subscription","cleanup","subscriptionClosed","_o","closeSubscription","Subscription","observer","subscriber","SubscriptionObserver","unsubscribe","complete","$Observable","subscribe","observable","items","Observable","onFinally","toMetaKey","ordinaryDefineOwnMetadata","defineMetadata","metadataKey","metadataValue","deleteMetadata","Set","ordinaryOwnMetadataKeys","ordinaryMetadataKeys","oKeys","pKeys","getMetadataKeys","ordinaryHasOwnMetadata","ordinaryGetOwnMetadata","ordinaryGetMetadata","getMetadata","getOwnMetadataKeys","getOwnMetadata","ordinaryHasMetadata","hasMetadata","hasOwnMetadata","$metadata","getFlags","RegExpProto","$RegExpStringIterator","matchAll","$pad","WEBKIT_BUG","TO_STRING_TAG","ArrayValues","DOMIterables","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DOMTokenList","DataTransferItemList","FileList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList","collections","explicit","Collection","$task","MSIE","boundArgs","setInterval","XMLHttpRequest","responseType","response","onerror","send","dispatchEvent","MouseEvent","createEvent","initMouseEvent","HTMLAnchorElement","webkitURL","msSaveOrOpenBlob","autoBom","HTMLElement","safari","onloadend","readAsDataURL","Op","hasOwn","iteratorSymbol","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","runtime","regeneratorRuntime","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","NativeIteratorPrototype","Gp","GeneratorFunctionPrototype","Generator","GeneratorFunction","isGeneratorFunction","genFun","ctor","mark","awrap","__await","defineIteratorMethods","AsyncIterator","async","innerFn","outerFn","tryLocsList","Context","reset","skipTempReset","sent","_sent","delegate","tryEntries","resetTryEntry","stop","rootRecord","completion","dispatchException","exception","handle","caught","tryLoc","hasCatch","hasFinally","catchLoc","finallyLoc","abrupt","finallyEntry","afterLoc","finish","thrown","delegateYield","resultName","nextLoc","protoGenerator","generator","_invoke","doneResult","delegateResult","maybeInvokeDelegate","tryCatch","makeInvokeMethod","unwrapped","previousPromise","callInvokeWithMethodAndArg","return","info","pushTryEntry","locs","iteratorMethod","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","definition","globalThis"],"mappings":"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CpC,UAAY,WAAY,WAAY,WACpC,UAAY,WAAY,WAAY,WACpC,UAAY,WAAY,WAAY,WACpC,UAAY,WAAY,WAAY,WACpC,UAAY,WAAY,WAAY,WACpC,WAAY,WAAY,WAAY,WACpC,UAAY,WAAY,WAAY,WACpC,UAAY,WAAY,WAAY,WACpC,UAAY,WAAY,WAAY,WACpC,UAAY,WAAY,WAAY,WACpC,UAAY,WAAY,WAAY,WACpC,UAAY,WAAY,WAAY,WACpC,WAAY,SAAY,WAAY,WACpC,WAAY,UAAY,WAAY,WACpC,WAAY,UAAY,WAAY,WACpC,WAAY,UAAY,WAAY,WACpC,WAAY,UAAY,WAAY,WACpC,WAAY,UAAY,WAAY,WACpC,WAAY,UAAY,WAAY,WACpC,WAAY,UAAY,WAAY,WACpC,WAAY,UAAY,WAAY,WACpC,WAAY,WAAY,WAAY,WACpC,WAAY,UAAY,WAAY,WACpC,WAAY,UAAY,WAAY,WACpC,WAAY,UAAY,WAAY,WACpC,WAAY,UAAY,WAAY,WACpC,WAAY,UAAY,WAAY,WACpC,WAAY,UAAY,WAAY,WACpC,WAAY,WAAY,SAAY,WACpC,WAAY,WAAY,SAAY,WACpC,WAAY,WAAY,UAAY,WACpC,WAAY,WAAY,UAAY,WACpC,WAAY,WAAY,UAAY,WACpC,WAAY,WAAY,UAAY,WACpC,WAAY,WAAY,UAAY,WACpC,WAAY,WAAY,UAAY,WACpC,WAAY,WAAY,UAAY,WACpC,WAAY,WAAY,WAAY,WACpC,WAAY,WAAY,UAAY,WACpC,WAAY,WAAY,UAAY,WACpC,WAAY,WAAY,UAAY,WACpC,WAAY,WAAY,UAAY,WACpC,WAAY,WAAY,UAAY,WACpC,WAAY,WAAY,UAAY,WACpC,WAAY,WAAY,WAAY,SACpC,WAAY,WAAY,WAAY,SACpC,WAAY,WAAY,WAAY,UACpC,WAAY,WAAY,WAAY,UACpC,WAAY,WAAY,WAAY,UACpC,WAAY,WAAY,WAAY,UACpC,WAAY,WAAY,WAAY,UACpC,WAAY,WAAY,WAAY,UACpC,WAAY,WAAY,WAAY,UACpC,WAAY,WAAY,WAAY,WACpC,WAAY,WAAY,WAAY,SACpC,WAAY,WAAY,WAAY,UACpC,WAAY,WAAY,WAAY,UACpC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Q,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAAQ,EACR,IAA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KACR,EAAQ,KACR,EAAQ,MACR,EAAQ,MACR,EAAQ,KACR,EAAQ,IACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,KACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,KACR,EAAQ,MACR,EAAQ,MACR,EAAQ,KACR,EAAQ,MACR,EAAQ,KACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,KACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,KACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,IACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,KACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,KACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,KACR,EAAQ,MACR,EAAQ,KACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACR,EAAQ,MACRj/H,EAAOH,QAAU,EAAjB,O,qBC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","file":"excel.js","sourcesContent":["/*\r\n* @Author: Jeffrey Wang\r\n* @Desc:   SheetJS  XLSX.js  FileSaver\r\n* @Date:   2018-03-24 09:54:17\r\n* @Last Modified by:   Jeffrey Wang\r\n*/\r\n\r\nimport Blob from 'blob';\r\nimport FileSaver from 'file-saver';\r\nimport XLSX from './xlsx.js';\r\nimport 'babel-polyfill';\r\n\r\nfunction make_lay_excel(global) {\r\n  // default\r\n  if (!global) {\r\n    global = {};\r\n  }\r\n  global.VERSION = 'v1.6.3';\r\n  global = {\r\n    /**\r\n     * \r\n     */\r\n    objectExtend: function() {\r\n      return Object.assign.apply(this, arguments)\r\n    },\r\n    /**\r\n     * \r\n     * @param object\r\n     * @param callback\r\n     */\r\n    each: function (object, callback) {\r\n      for (var k in object) {\r\n        if (object.hasOwnProperty(k)) {\r\n          if (Array.isArray(object)) {\r\n            k = parseInt(k);\r\n          }\r\n          callback.apply(this, [k, object[k]])\r\n        }\r\n      }\r\n    },\r\n    /**\r\n     * \r\n     * @param  {[type]} data     [description]\r\n     * @param  {[type]} filename [description]\r\n     * @param  {[type]} type     [description]\r\n     * @return {[type]}          [description]\r\n     */\r\n    downloadExl: function(data, filename, type) {\r\n      type = type ? type : 'xlsx';\r\n      this.exportExcel({sheet1: data}, filename+'.'+type, type, null);\r\n    },\r\n    /**\r\n     * Excel\r\n     * @param data object\r\n     * @param  {[type]} filename [description]\r\n     * @param  {[type]} type     [description]\r\n     * @param  {[type]} opt      [description]\r\n     * @return {[type]}          [description]\r\n     */\r\n    exportExcel : function(data, filename, type, opt) {\r\n      type = type ? type : 'xlsx';\r\n      filename = filename ? filename : '.'+type;\r\n\r\n      //  XLSX \r\n      var wb = XLSX.utils.book_new();\r\n      // 1. excel\r\n      var Props = {\r\n        Title: filename,\r\n        Subject: 'Export From web browser',\r\n        Author: \"excel.wj2015.com\",\r\n        Manager: '',\r\n        Company: '',\r\n        Category: '',\r\n        Keywords: '',\r\n        Comments: '',\r\n        LastAuthor: '',\r\n        CreatedData: new Date(),\r\n      };\r\n      opt && opt.Props && (Props = this.objectExtend(Props, opt.Props));\r\n      // \r\n      wb.compression = opt ? opt.compression : true\r\n      if(wb.compression !== false) {\r\n        wb.compression = true\r\n      }\r\n      wb.Props = Props;\r\n      // \r\n      var wbExtend = {\r\n        '!merges': null\r\n        ,'!margins': null\r\n        ,'!cols': null\r\n        ,'!rows': null\r\n        ,'!protect': null\r\n        ,'!autofilter': null\r\n      };\r\n      opt && opt.extend && (wbExtend = this.objectExtend(wbExtend, opt.extend));\r\n      // \r\n      for (var key in wbExtend) {\r\n        if (!wbExtend.hasOwnProperty(key)) {\r\n          continue;\r\n        }\r\n        if (!wbExtend[key]) {\r\n          delete wbExtend[key];\r\n        }\r\n      }\r\n\r\n      //  data  sheet  sheet1\r\n      if (Array.isArray(data)) {\r\n        data = {sheet1: data};\r\n      }\r\n\r\n      for(var sheet_name in data) {\r\n        if (!data.hasOwnProperty(sheet_name)) {\r\n          continue;\r\n        }\r\n        var content = data[sheet_name];\r\n        // 2. sheet\r\n        wb.SheetNames.push(sheet_name);\r\n        // 3.  sheet\r\n        var is_aoa = false;\r\n        if (content.length && content[0] && Array.isArray(content[0])) {\r\n          is_aoa = true;\r\n        }\r\n        if (is_aoa) {\r\n          ws = XLSX.utils.aoa_to_sheet(content);\r\n        } else {\r\n          var option = {};\r\n          if (content.length) {\r\n            option.headers = content.unshift();\r\n            option.skipHeader = true;\r\n            // \r\n            var splitRes = this.splitContent(content);\r\n          }\r\n          var ws = XLSX.utils.json_to_sheet(content, option);\r\n          // \r\n          if (typeof splitRes !== 'undefined') {\r\n            this.mergeCellOpt(ws, splitRes.style);\r\n          }\r\n        }\r\n        // sheet\r\n        if (wbExtend[sheet_name]) {\r\n          this.objectExtend(ws, wbExtend[sheet_name]);\r\n        } else {\r\n          this.objectExtend(ws, wbExtend);\r\n        }\r\n        wb.Sheets[sheet_name] = ws;\r\n      };\r\n\r\n      // 4. \r\n      var wbout = XLSX.write(wb, {bookType: type, type: 'binary', cellStyles: true, compression: wb.compression});\r\n\r\n      // 5.  FileSaver \r\n      FileSaver.saveAs(new Blob([this.s2ab(wbout)], {type: \"application/octet-stream\"}), filename);\r\n    },\r\n    /**\r\n     * \r\n     * @param  {[type]} content [description]\r\n     * @return {[type]}         [description]\r\n     */\r\n    splitContent: function(content) {\r\n      var styleContent = {};\r\n      // \r\n      for (var line = 0; line < content.length; line++) {\r\n        var lineData = content[line];\r\n        var rowIndex = 0;\r\n        for (var row in lineData) {\r\n          if (!lineData.hasOwnProperty(row)) {\r\n            continue;\r\n          }\r\n          var rowData = lineData[row];\r\n          if (typeof rowData === 'object') {\r\n            // typeof null == object\r\n            if (rowData !== null) {\r\n              styleContent[this.numToTitle(rowIndex+1)+(parseInt(line)+1)] = rowData;\r\n            } else {\r\n              lineData[row] = '';\r\n            }\r\n          } else {\r\n            // JeffreyWang 2019-03-10 0 hack\r\n            if (rowData === 0) {\r\n              rowData = {\r\n                v: '0',\r\n                s: {\r\n                  alignment: {\r\n                    horizontal: 'right'\r\n                  }\r\n                }\r\n              }\r\n            }\r\n            styleContent[this.numToTitle(rowIndex+1)+(parseInt(line)+1)] = rowData;\r\n          }\r\n          rowIndex++;\r\n        }\r\n      }\r\n      return {\r\n        content: content,\r\n        style: styleContent\r\n      };\r\n    },\r\n    /**\r\n     * \r\n     * @param  {[type]} ws    [description]\r\n     * @param  {[type]} style [description]\r\n     * @return {[type]}       [description]\r\n     */\r\n    mergeCellOpt: function(ws, style) {\r\n      for (var row in style) {\r\n        if (!style.hasOwnProperty(row)) {\r\n          continue;\r\n        }\r\n        var rowOpt = style[row];\r\n        if (ws[row]) {\r\n          // \r\n          var otherOpt = ['t', 'w', 'f', 'r', 'h', 'c', 'z', 'l', 's'];\r\n          for (var i = 0; i < otherOpt.length; i++) {\r\n            ws[row][otherOpt[i]] = ws[row][otherOpt[i]];\r\n          }\r\n          this.objectExtend(ws[row], rowOpt);\r\n        }\r\n      }\r\n    },\r\n    /**\r\n     * tableJSON\r\n     * @param dom\r\n     */\r\n    tableToJson: function(dom) {\r\n      if (!dom || !dom.querySelectorAll) {\r\n        return [];\r\n      }\r\n\r\n      var that = this;\r\n      var handleLineNode = function (lineDomList) {\r\n        var res = [];\r\n        that.each(lineDomList, function (key, val) {\r\n          var line = [];\r\n          that.each(val.querySelectorAll('td,th'), function (k, v) {\r\n            line.push(v.innerText);\r\n          });\r\n          res.push(line);\r\n        })\r\n        return res;\r\n      };\r\n\r\n      var headDom = dom.querySelectorAll('thead > tr');\r\n      var bodyDom = dom.querySelectorAll('tbody > tr');\r\n      var head = handleLineNode(headDom);\r\n      var body = handleLineNode(bodyDom);\r\n\r\n      return {\r\n        head: head,\r\n        body: body\r\n      }\r\n    },\r\n    // \r\n    // \t\tfor(i=1;i<100;i++){var change = layui.excel.numToTitle(i);console.log(i, change, layui.excel.titleToNum(change));}\r\n    // numsToTitle\r\n    numsTitleCache: {},\r\n    // titleToTitle \r\n    titleNumsCache: {},\r\n    /**\r\n     * (1) ABC...AAAB0A\r\n     * @param  num int [description]\r\n     * @return string     [description]\r\n     */\r\n    numToTitle: function(num) {\r\n      if (num <= 0) {\r\n        return '';\r\n      }\r\n      var remainder = num % 26;\r\n      var left = Math.floor(num / 26);\r\n      if (remainder === 0) {\r\n        remainder = 26;\r\n        left -= 1;\r\n      }\r\n      var ans = String.fromCharCode(64 + remainder);\r\n\r\n      if (left > 0) {\r\n        ans = this.numToTitle(left) + ans;\r\n      }\r\n      this.numsTitleCache[num] = ans;\r\n      this.titleNumsCache[ans] = num;\r\n      return ans;\r\n    },\r\n    /**\r\n     * ABAAABC 123\r\n     * @param  {[type]} title [description]\r\n     * @return {number}       [description]\r\n     */\r\n    titleToNum: function(title) {\r\n      if (this.titleNumsCache[title]) {\r\n        return this.titleNumsCache[title];\r\n      }\r\n      var len = title.length;\r\n      var total = 0;\r\n      for (var index in title) {\r\n        if (!title.hasOwnProperty(index)) {\r\n          continue;\r\n        }\r\n        var char = title[index];\r\n        var code = char.charCodeAt() - 64;\r\n        total += code * Math.pow(26, len - index - 1);\r\n      }\r\n      this.numsTitleCache[total] = title;\r\n      this.titleNumsCache[title] = total;\r\n      return total;\r\n    },\r\n    /**\r\n     * \r\n     * @param data array sheet\r\n     * @param range  A1:C12\r\n     */\r\n    getDefaultRange: function(data, range) {\r\n      //  rowIndex field \r\n      var fieldKeys = Object.keys(data[0]);\r\n      var maxCol = fieldKeys.length - 1;\r\n      var maxRow = data.length -1;\r\n      //  A1 ~ \r\n      var startPos = {c: 0, r: 0};\r\n      var endPos = {c: maxCol, r: maxRow};\r\n\r\n      if (range && typeof range === 'string') {\r\n        var rangeArr = range.split(':');\r\n        if (rangeArr[0].length) {\r\n          startPos = this.splitPosition(rangeArr[0]);\r\n        }\r\n        if (typeof rangeArr[1] !== 'undefined' && rangeArr[1] !== '') {\r\n          endPos = this.splitPosition(rangeArr[1]);\r\n        }\r\n      } else {\r\n        // pass\r\n      }\r\n      // position - \r\n      // startPos.c = startPos.c < maxCol ? startPos.c : maxCol;\r\n      // endPos.c = endPos.c < maxCol ? endPos.c : maxCol;\r\n      // startPos.r = startPos.r < maxRow ? startPos.r : maxRow;\r\n      // endPos.r = endPos.r < maxRow ? endPos.r : maxRow;\r\n\r\n      if (startPos.c > endPos.c) {\r\n        console.error('');\r\n      }\r\n      if (startPos.r > endPos.r) {\r\n        console.error('');\r\n      }\r\n      return {\r\n        startPos: startPos,\r\n        endPos: endPos,\r\n        fieldKeys: fieldKeys\r\n      }\r\n    },\r\n    /**\r\n     *  startPos endPos  filter \r\n     * @param data array sheet\r\n     * @param startPos object {c: , r: }\r\n     * @param endPos object {c: , r: }\r\n     * @param fieldKeys ['Key', 'Key']\r\n     * @param config object {s: {}, v: ''}\r\n     * @param filter callable  cell(cell)newCell(cell),row(),config(), currentRow(), currentCol(-),currentColKey(-)\r\n     */\r\n    setCellStyle: function (data, startPos, endPos, fieldKeys, config, filter) {\r\n      // \r\n      for (var currentRow = startPos.r; currentRow <= endPos.r; currentRow++) {\r\n        for (var currentCol = startPos.c; currentCol <= endPos.c; currentCol++) {\r\n          // \r\n          var row = data[currentRow];\r\n          if (!row) {\r\n            row = {};\r\n            for (var key = 0; key < fieldKeys.length; key++) {\r\n              row[fieldKeys[key]] = '';\r\n            }\r\n            data[currentRow] = row;\r\n          }\r\n          var cell = row[fieldKeys[currentCol]];\r\n          var newCell = null;\r\n          if (cell === null || cell === undefined) {\r\n            cell = '';\r\n          }\r\n\r\n          // config\r\n          if (typeof cell === 'object') {\r\n            newCell = this.objectExtend(true, {}, cell, config);\r\n          } else {\r\n            newCell = this.objectExtend(true, {}, {v: cell}, config);\r\n          }\r\n\r\n          if (\r\n            typeof filter === 'function'\r\n          ) {\r\n            newCell = filter(cell, newCell, row, config, currentRow, currentCol, fieldKeys[currentCol]);\r\n          } else {\r\n          }\r\n          // \r\n          data[currentRow][fieldKeys[currentCol]] = newCell;\r\n        }\r\n      }\r\n    },\r\n    /**\r\n     * \r\n     * @param data [sheet]\r\n     * @param range [ A1:C12]\r\n     * @param config [border left/right/top/bottom{top: {xxx}, bottom: {}, left: {}, right: {}}]\r\n     */\r\n    setRoundBorder: function(data, range, config) {\r\n      if (typeof data !== 'object' || !data.length || !data[0] || !Object.keys(data[0]).length) {\r\n        return [];\r\n      }\r\n\r\n      var rangeObj = this.getDefaultRange(data, range);\r\n      var startPos = rangeObj.startPos;\r\n      var endPos = rangeObj.endPos;\r\n      var fieldKeys = rangeObj.fieldKeys;\r\n\r\n      //  border  config.top\r\n      this.setCellStyle(data, startPos, {\r\n        c: endPos.c,\r\n        r: startPos.r\r\n      }, fieldKeys, {\r\n        s: {\r\n          border: {\r\n            top: config.top,\r\n            diagonal: config.top.diagonal,\r\n            diagonalUp: config.top.diagonalUp,\r\n            diagonalDown: config.top.diagonalDown\r\n          }\r\n        }\r\n      })\r\n      //  border  config.right\r\n      this.setCellStyle(data, {\r\n        c: endPos.c,\r\n        r: startPos.r\r\n      }, endPos, fieldKeys, {\r\n        s: {\r\n          border: {\r\n            right: config.right,\r\n            diagonal: config.right.diagonal,\r\n            diagonalUp: config.right.diagonalUp,\r\n            diagonalDown: config.right.diagonalDown\r\n          }\r\n        }\r\n      })\r\n      //  border  config.bottom\r\n      this.setCellStyle(data, {\r\n        c: startPos.c,\r\n        r: endPos.r\r\n      }, endPos, fieldKeys, {\r\n        s: {\r\n          border: {\r\n            bottom: config.bottom,\r\n            diagonal: config.bottom.diagonal,\r\n            diagonalUp: config.bottom.diagonalUp,\r\n            diagonalDown: config.bottom.diagonalDown\r\n          }\r\n        }\r\n      })\r\n      //  border  config.left\r\n      this.setCellStyle(data, startPos, {\r\n        c: startPos.c,\r\n        r: endPos.r\r\n      }, fieldKeys, {\r\n        s: {\r\n          border: {\r\n            left: config.left,\r\n            diagonal: config.left.diagonal,\r\n            diagonalUp: config.left.diagonalUp,\r\n            diagonalDown: config.left.diagonalDown\r\n          }\r\n        }\r\n      })\r\n    },\r\n    /**\r\n     * \r\n     * @param  {array} data     [sheet]\r\n     * @param  {string} range\t\t [ A1:C12 A1]\r\n     * @param  {object} config   []\r\n     * @param  {function} filter   []\r\n     * @return {array}          [ sheet ]\r\n     */\r\n    setExportCellStyle: function(data, range, config, filter) {\r\n      if (typeof data !== 'object' || !data.length || !data[0] || !Object.keys(data[0]).length) {\r\n        return [];\r\n      }\r\n\r\n      var rangeObj = this.getDefaultRange(data, range);\r\n      var startPos = rangeObj.startPos;\r\n      var endPos = rangeObj.endPos;\r\n      var fieldKeys = rangeObj.fieldKeys;\r\n\r\n      this.setCellStyle(data, startPos, endPos, fieldKeys, config, filter);\r\n      return data;\r\n    },\r\n    /**\r\n     *   [ [' A1', ' D2'], [' B2', ' E3'] ]\r\n     * @param  {[type]} origin [description]\r\n     * @return {[type]}        [description]\r\n     */\r\n    makeMergeConfig: function(origin) {\r\n      var merge = [];\r\n      for (var index = 0; index < origin.length; index++) {\r\n        merge.push({\r\n          s: this.splitPosition(origin[index][0]),\r\n          e: this.splitPosition(origin[index][1])\r\n        });\r\n      }\r\n      return merge;\r\n    },\r\n    /**\r\n     * \r\n     * @param  {$ObjMap} data    [ABC]\r\n     * @param  {number} defaultNum [description]\r\n     * @return {$ObjMap}         [description]\r\n     */\r\n    makeColConfig: function(data, defaultNum) {\r\n      defaultNum = defaultNum > 0 ? defaultNum : 50;\r\n      //  ABC  index\r\n      var change = [];\r\n      var startIndex = 0;\r\n      for (var index in data) {\r\n        if (!data.hasOwnProperty(index)) {\r\n          continue;\r\n        }\r\n        var item = data[index];\r\n        if (index.match && index.match(/[A-Z]*/)) {\r\n          var currentIndex = this.titleToNum(index) - 1;\r\n          // \r\n          while (startIndex < currentIndex) {\r\n            change.push({wpx: defaultNum});\r\n            startIndex++;\r\n          }\r\n          startIndex = currentIndex+1;\r\n          change.push({wpx: item > 0 ? item : defaultNum});\r\n        }\r\n      };\r\n      return change;\r\n    },\r\n    /**\r\n     * \r\n     * @param  {[type]} data    [description]\r\n     * @param  {[type]} defaultNum [description]\r\n     * @return {[type]}         [description]\r\n     */\r\n    makeRowConfig: function(data, defaultNum) {\r\n      defaultNum = defaultNum > 0 ? defaultNum : 10;\r\n      //  ABC  index\r\n      var change = [];\r\n      var startIndex = 0;\r\n      for (var index in data) {\r\n        if (!data.hasOwnProperty(index)) {\r\n          continue;\r\n        }\r\n        var item = data[index];\r\n        if (index.match && index.match(/[0-9]*/)) {\r\n          var currentIndex = parseInt(index) - 1;\r\n          // \r\n          while (startIndex < currentIndex) {\r\n            change.push({hpx: defaultNum});\r\n            startIndex++;\r\n          }\r\n          startIndex = currentIndex+1;\r\n          change.push({hpx: item > 0 ? item : defaultNum});\r\n        }\r\n      };\r\n      return change;\r\n    },\r\n    /**\r\n     * A1 {c: 0, r: 0} \r\n     * @param  {string} pos [description]\r\n     * @return {{r: number, c: number}}     [description]\r\n     */\r\n    splitPosition: function(pos) {\r\n      var res = pos.match('^([A-Z]+)([0-9]+)$');\r\n      if (!res) {\r\n        return {c: 0, r: 0};\r\n      }\r\n      // \r\n      return {\r\n        c: this.titleToNum(res[1]) - 1,\r\n        r: parseInt(res[2]) - 1\r\n      }\r\n    },\r\n    /**\r\n     * 8\r\n     * @param  {[type]} s [description]\r\n     * @return {[type]}   [description]\r\n     */\r\n    s2ab: function(s) {\r\n      var buf = new ArrayBuffer(s.length);\r\n      var view = new Uint8Array(buf);\r\n      for (var i = 0; i < s.length; i++) {\r\n        view[i] = s.charCodeAt(i) & 0xFF;\r\n      }\r\n      return buf;\r\n    },\r\n    /**\r\n     * aoa\r\n     * @return {[type]} [description]\r\n     */\r\n    filterDataToAoaData: function(filterData){\r\n      var aoaData = [];\r\n      this.each(filterData, function(index, item) {\r\n        var itemData = [];\r\n        for (var i in item) {\r\n          if (!item.hasOwnProperty(i)) {\r\n            continue;\r\n          }\r\n          itemData.push(item[i]);\r\n        }\r\n        aoaData.push(itemData);\r\n      });\r\n      return aoaData;\r\n    },\r\n    /**\r\n     * \r\n     * @param  {[type]} data   []\r\n     * @param  {[type]} fields []\r\n     * @return {[type]}        [description]\r\n     */\r\n    filterExportData: function(data, fields) {\r\n      // PS: data  fields  { \"id\": 'test_id', 'test_id': 'new_id' }\r\n      var exportData = [];\r\n      var true_fields = [];\r\n      // filed \r\n      if (Array.isArray(fields)) {\r\n        for (var i = 0; i< fields.length; i++) {\r\n          true_fields[fields[i]] = fields[i];\r\n        }\r\n      } else {\r\n        true_fields = fields;\r\n      }\r\n      for (var i = 0; i < data.length; i++) {\r\n        var item = data[i];\r\n        exportData[i] = {};\r\n        for (var key in true_fields) {\r\n          if (!true_fields.hasOwnProperty(key)) {\r\n            continue;\r\n          }\r\n          var new_field_name = key;\r\n          var old_field_name = true_fields[key];\r\n          // \r\n          if (typeof old_field_name === 'function' && old_field_name.apply) {\r\n            exportData[i][new_field_name] = old_field_name.apply(window, [item[new_field_name], item, data, i, new_field_name]);\r\n          } else {\r\n            if (typeof item[old_field_name] !== 'undefined') {\r\n              exportData[i][new_field_name] = item[old_field_name];\r\n            } else {\r\n              exportData[i][new_field_name] = '';\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return exportData;\r\n    },\r\n    /**\r\n     *  filterExportData\r\n     * @param  {[type]} data   [description]\r\n     * @param  {[type]} fields [description]\r\n     * @return {[type]}        [description]\r\n     */\r\n    filterImportData: function(data, fields) {\r\n      var that = this;\r\n      this.each(data, function(fileindex, xlsx) {\r\n        this.each(xlsx, function(sheetname, content) {\r\n          xlsx[sheetname] = that.filterExportData(content, fields);\r\n        });\r\n      });\r\n      return data;\r\n    },\r\n    /**\r\n     * Excel\r\n     * @param  {[type]}   files    [description]\r\n     * @param  {[type]}   opt      [description]\r\n     * @param  {Function} callback [description]\r\n     * @return {[type]}            [description]\r\n     */\r\n    importExcel: function(files, opt, callback) {\r\n      var option = {\r\n        header: 'A',\r\n        range: null,\r\n        fields: null,\r\n        checkMime: true,\r\n      };\r\n      this.objectExtend(option, opt);\r\n      var that = this;\r\n\r\n      if (files.length < 1) {\r\n        throw {code: 999, 'message': ''};\r\n      }\r\n      var supportReadMime = [\r\n        'application/vnd.ms-excel',\r\n        'application/msexcel',\r\n        'application/x-msexcel',\r\n        'application/x-ms-excel',\r\n        'application/x-excel',\r\n        'application/x-dos_ms_excel',\r\n        'application/xls',\r\n        'application/x-xls',\r\n        'application/vnd-xls',\r\n        'application/csv',\r\n        'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n        'application/wps-office.xlsx',\r\n        ''\r\n      ];\r\n      if (option.checkMime) {\r\n        this.each(files, function(index, item) {\r\n          if (supportReadMime.indexOf(item.type) === -1) {\r\n            throw {code: 999, message: item.name+''+item.type+''};\r\n          }\r\n        });\r\n      }\r\n      delete option.checkMime;\r\n\r\n      // \r\n      var data = {};\r\n      var book = {};\r\n      this.each(files, function(index, item) {\r\n        var reader = new FileReader();\r\n        if (!reader) {\r\n          throw {code: 999, message: 'FileReader'};\r\n        }\r\n        // excel\r\n        reader.onload = function(ev) {\r\n          var wb = XLSX.read(ev.target.result, {\r\n            type: 'binary'\r\n          });\r\n          var excelData = {};\r\n          that.each(wb.Sheets, function(sheet, sheetObj) {\r\n            // \r\n            if (wb.Sheets.hasOwnProperty(sheet)) {\r\n              var opt = {\r\n                header: option.header,\r\n                defval: ''\r\n              };\r\n              if (option.range) {\r\n                opt.range = option.range;\r\n              }\r\n              excelData[sheet] = XLSX.utils.sheet_to_json(sheetObj, opt);\r\n              // \r\n              if (option.fields) {\r\n                excelData[sheet] = that.filterExportData(excelData[sheet], option.fields);\r\n              }\r\n            }\r\n          });\r\n          data[index] = excelData;\r\n          book[index] = wb;\r\n          // \r\n          if (index === files.length - 1) {\r\n            callback && callback.apply && callback.apply(window, [data, book]);\r\n          }\r\n        };\r\n        reader.readAsBinaryString(item);\r\n      });\r\n    },\r\n    /**\r\n     * EXCELDate\r\n     * @param code double excel\r\n     */\r\n    dateCodeToDate: function(code)\r\n    {\r\n      var obj = XLSX.SSF.parse_date_code(code);\r\n      return (new Date(obj.y + '-' + obj.m + '-' + obj.d + ' ' + obj.H + ':' + obj.M + ':' + obj.S));\r\n    },\r\n    /**\r\n     * \r\n     * @param str\r\n     * @param maxLength\r\n     * @param padString\r\n     * @returns {*}\r\n     */\r\n    strPad: function(str, maxLength, padString) {\r\n      str = str + ''\r\n      if (typeof maxLength === 'undefined') {\r\n        maxLength = 2\r\n      }\r\n      if (typeof padString === 'undefined') {\r\n        padString = '0'\r\n      }\r\n\r\n      if (padString.length <= 0) {\r\n        console.error('strPad error');\r\n        return str;\r\n      }\r\n\r\n      if (str.length < maxLength) {\r\n        var repeatCount = Math.floor((maxLength - str.length) / padString.length);\r\n        var exceptStr = '';\r\n        if (repeatCount * padString.length < maxLength - 1) {\r\n          exceptStr = padString.substr(0, maxLength - 1 - repeatCount * padString.length)\r\n        }\r\n        return padString * repeatCount + exceptStr  + str\r\n      } else {\r\n        return str\r\n      }\r\n    },\r\n    /**\r\n     * \r\n     * @param date Date \r\n     * @param format String  YYYY-MM-DD HH:ii:ss\r\n     */\r\n    dateFormat: function(date, format)\r\n    {\r\n      if (!(date instanceof Date)) {\r\n        console.error(date+'');\r\n      }\r\n      if (typeof format === 'undefined') {\r\n        format = 'YYYY-MM-DD HH:ii:ss';\r\n      }\r\n      //  format \r\n      var YYYY = date.getFullYear();\r\n      var YY = (YYYY + '').substr(2, 2)\r\n      var M = date.getMonth() + 1;\r\n      var MM = this.strPad(M, 2, '0');\r\n      var D = date.getDate();\r\n      var DD = this.strPad(D, 2, '0');\r\n      var H = date.getHours();\r\n      var HH = this.strPad(H, 2, '0');\r\n      var i = date.getMinutes();\r\n      var ii = this.strPad(i, 2, '0');\r\n      var s = date.getSeconds();\r\n      var ss = this.strPad(s, 2, '0');\r\n\r\n      var config = {\r\n        'YYYY': YYYY,\r\n        'YY': YY,\r\n        'MM': MM,\r\n        'M': M,\r\n        'DD': DD,\r\n        'D': D,\r\n        'HH': HH,\r\n        'H': H,\r\n        'ii': ii,\r\n        'i': i,\r\n        'ss': ss,\r\n        's': s\r\n      };\r\n\r\n      for (var key in config) {\r\n        if (!config.hasOwnProperty(key)) {\r\n          continue;\r\n        }\r\n\r\n        var reg = RegExp(key, 'g');\r\n\r\n        format = format.replace(reg, config[key]);\r\n      }\r\n\r\n      return format;\r\n    },\r\n    /**\r\n     * excelCODE\r\n     * @param code\r\n     * @param format\r\n     * @returns {*|void|string}\r\n     */\r\n    dateCodeFormat: function (code, format) {\r\n      return this.dateFormat(this.dateCodeToDate(code), format)\r\n    }\r\n  }\r\n  return global;\r\n}\r\n\r\nif (typeof layui !== 'undefined') {\r\n  layui.define([], function(exports){\r\n    exports('excel', make_lay_excel());\r\n  });\r\n}\r\n\r\ndebugger;\r\nif(typeof exports !== 'undefined') {make_lay_excel(exports);}\r\nelse if(typeof module !== 'undefined' && module.exports) make_lay_excel(module.exports);\r\nelse if(typeof define === 'function' && define.amd) define('lay-excel', function() { return make_lay_excel(); });\r\n\r\n\r\nwindow.LAY_EXCEL = make_lay_excel();\r\n\r\nexport default make_lay_excel();\r\n","/*\r\n\r\nJSZip - A Javascript class for generating and reading zip files\r\n<http://stuartk.com/jszip>\r\n\r\n(c) 2009-2014 Stuart Knightley <stuart [at] stuartk.com>\r\nDual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.\r\n\r\nJSZip uses the library pako released under the MIT license :\r\nhttps://github.com/nodeca/pako/blob/master/LICENSE\r\n\r\nNote: since JSZip 3 removed critical functionality, this version assigns to the\r\n`JSZipSync` variable.  Another JSZip version can be loaded in parallel.\r\n*/\r\n(function(e){\r\n  if(\"object\"==typeof exports&&\"undefined\"!=typeof module&&\"undefined\"==typeof DO_NOT_EXPORT_JSZIP)module.exports=e();\r\n  else if(\"function\"==typeof define&&define.amd&&\"undefined\"==typeof DO_NOT_EXPORT_JSZIP){JSZipSync=e();define([],e);}\r\n  else{\r\n    var f;\r\n    \"undefined\"!=typeof window?f=window:\r\n      \"undefined\"!=typeof global?f=global:\r\n        \"undefined\"!=typeof $ && $.global?f=$.global:\r\n          \"undefined\"!=typeof self&&(f=self),f.JSZipSync=e()\r\n  }\r\n}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\r\n    'use strict';\r\n// private property\r\n    var _keyStr = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\r\n\r\n\r\n// public method for encoding\r\n    exports.encode = function(input, utf8) {\r\n      var output = \"\";\r\n      var chr1, chr2, chr3, enc1, enc2, enc3, enc4;\r\n      var i = 0;\r\n\r\n      while (i < input.length) {\r\n\r\n        chr1 = input.charCodeAt(i++);\r\n        chr2 = input.charCodeAt(i++);\r\n        chr3 = input.charCodeAt(i++);\r\n\r\n        enc1 = chr1 >> 2;\r\n        enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\r\n        enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\r\n        enc4 = chr3 & 63;\r\n\r\n        if (isNaN(chr2)) {\r\n          enc3 = enc4 = 64;\r\n        }\r\n        else if (isNaN(chr3)) {\r\n          enc4 = 64;\r\n        }\r\n\r\n        output = output + _keyStr.charAt(enc1) + _keyStr.charAt(enc2) + _keyStr.charAt(enc3) + _keyStr.charAt(enc4);\r\n\r\n      }\r\n\r\n      return output;\r\n    };\r\n\r\n// public method for decoding\r\n    exports.decode = function(input, utf8) {\r\n      var output = \"\";\r\n      var chr1, chr2, chr3;\r\n      var enc1, enc2, enc3, enc4;\r\n      var i = 0;\r\n\r\n      input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\r\n\r\n      while (i < input.length) {\r\n\r\n        enc1 = _keyStr.indexOf(input.charAt(i++));\r\n        enc2 = _keyStr.indexOf(input.charAt(i++));\r\n        enc3 = _keyStr.indexOf(input.charAt(i++));\r\n        enc4 = _keyStr.indexOf(input.charAt(i++));\r\n\r\n        chr1 = (enc1 << 2) | (enc2 >> 4);\r\n        chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\r\n        chr3 = ((enc3 & 3) << 6) | enc4;\r\n\r\n        output = output + String.fromCharCode(chr1);\r\n\r\n        if (enc3 != 64) {\r\n          output = output + String.fromCharCode(chr2);\r\n        }\r\n        if (enc4 != 64) {\r\n          output = output + String.fromCharCode(chr3);\r\n        }\r\n\r\n      }\r\n\r\n      return output;\r\n\r\n    };\r\n\r\n  },{}],2:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    function CompressedObject() {\r\n      this.compressedSize = 0;\r\n      this.uncompressedSize = 0;\r\n      this.crc32 = 0;\r\n      this.compressionMethod = null;\r\n      this.compressedContent = null;\r\n    }\r\n\r\n    CompressedObject.prototype = {\r\n      /**\r\n       * Return the decompressed content in an unspecified format.\r\n       * The format will depend on the decompressor.\r\n       * @return {Object} the decompressed content.\r\n       */\r\n      getContent: function() {\r\n        return null; // see implementation\r\n      },\r\n      /**\r\n       * Return the compressed content in an unspecified format.\r\n       * The format will depend on the compressed conten source.\r\n       * @return {Object} the compressed content.\r\n       */\r\n      getCompressedContent: function() {\r\n        return null; // see implementation\r\n      }\r\n    };\r\n    module.exports = CompressedObject;\r\n\r\n  },{}],3:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    exports.STORE = {\r\n      magic: \"\\x00\\x00\",\r\n      compress: function(content) {\r\n        return content; // no compression\r\n      },\r\n      uncompress: function(content) {\r\n        return content; // no compression\r\n      },\r\n      compressInputType: null,\r\n      uncompressInputType: null\r\n    };\r\n    exports.DEFLATE = _dereq_('./flate');\r\n\r\n  },{\"./flate\":8}],4:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n    var utils = _dereq_('./utils');\r\n\r\n    var table = [\r\n      0x00000000, 0x77073096, 0xEE0E612C, 0x990951BA,\r\n      0x076DC419, 0x706AF48F, 0xE963A535, 0x9E6495A3,\r\n      0x0EDB8832, 0x79DCB8A4, 0xE0D5E91E, 0x97D2D988,\r\n      0x09B64C2B, 0x7EB17CBD, 0xE7B82D07, 0x90BF1D91,\r\n      0x1DB71064, 0x6AB020F2, 0xF3B97148, 0x84BE41DE,\r\n      0x1ADAD47D, 0x6DDDE4EB, 0xF4D4B551, 0x83D385C7,\r\n      0x136C9856, 0x646BA8C0, 0xFD62F97A, 0x8A65C9EC,\r\n      0x14015C4F, 0x63066CD9, 0xFA0F3D63, 0x8D080DF5,\r\n      0x3B6E20C8, 0x4C69105E, 0xD56041E4, 0xA2677172,\r\n      0x3C03E4D1, 0x4B04D447, 0xD20D85FD, 0xA50AB56B,\r\n      0x35B5A8FA, 0x42B2986C, 0xDBBBC9D6, 0xACBCF940,\r\n      0x32D86CE3, 0x45DF5C75, 0xDCD60DCF, 0xABD13D59,\r\n      0x26D930AC, 0x51DE003A, 0xC8D75180, 0xBFD06116,\r\n      0x21B4F4B5, 0x56B3C423, 0xCFBA9599, 0xB8BDA50F,\r\n      0x2802B89E, 0x5F058808, 0xC60CD9B2, 0xB10BE924,\r\n      0x2F6F7C87, 0x58684C11, 0xC1611DAB, 0xB6662D3D,\r\n      0x76DC4190, 0x01DB7106, 0x98D220BC, 0xEFD5102A,\r\n      0x71B18589, 0x06B6B51F, 0x9FBFE4A5, 0xE8B8D433,\r\n      0x7807C9A2, 0x0F00F934, 0x9609A88E, 0xE10E9818,\r\n      0x7F6A0DBB, 0x086D3D2D, 0x91646C97, 0xE6635C01,\r\n      0x6B6B51F4, 0x1C6C6162, 0x856530D8, 0xF262004E,\r\n      0x6C0695ED, 0x1B01A57B, 0x8208F4C1, 0xF50FC457,\r\n      0x65B0D9C6, 0x12B7E950, 0x8BBEB8EA, 0xFCB9887C,\r\n      0x62DD1DDF, 0x15DA2D49, 0x8CD37CF3, 0xFBD44C65,\r\n      0x4DB26158, 0x3AB551CE, 0xA3BC0074, 0xD4BB30E2,\r\n      0x4ADFA541, 0x3DD895D7, 0xA4D1C46D, 0xD3D6F4FB,\r\n      0x4369E96A, 0x346ED9FC, 0xAD678846, 0xDA60B8D0,\r\n      0x44042D73, 0x33031DE5, 0xAA0A4C5F, 0xDD0D7CC9,\r\n      0x5005713C, 0x270241AA, 0xBE0B1010, 0xC90C2086,\r\n      0x5768B525, 0x206F85B3, 0xB966D409, 0xCE61E49F,\r\n      0x5EDEF90E, 0x29D9C998, 0xB0D09822, 0xC7D7A8B4,\r\n      0x59B33D17, 0x2EB40D81, 0xB7BD5C3B, 0xC0BA6CAD,\r\n      0xEDB88320, 0x9ABFB3B6, 0x03B6E20C, 0x74B1D29A,\r\n      0xEAD54739, 0x9DD277AF, 0x04DB2615, 0x73DC1683,\r\n      0xE3630B12, 0x94643B84, 0x0D6D6A3E, 0x7A6A5AA8,\r\n      0xE40ECF0B, 0x9309FF9D, 0x0A00AE27, 0x7D079EB1,\r\n      0xF00F9344, 0x8708A3D2, 0x1E01F268, 0x6906C2FE,\r\n      0xF762575D, 0x806567CB, 0x196C3671, 0x6E6B06E7,\r\n      0xFED41B76, 0x89D32BE0, 0x10DA7A5A, 0x67DD4ACC,\r\n      0xF9B9DF6F, 0x8EBEEFF9, 0x17B7BE43, 0x60B08ED5,\r\n      0xD6D6A3E8, 0xA1D1937E, 0x38D8C2C4, 0x4FDFF252,\r\n      0xD1BB67F1, 0xA6BC5767, 0x3FB506DD, 0x48B2364B,\r\n      0xD80D2BDA, 0xAF0A1B4C, 0x36034AF6, 0x41047A60,\r\n      0xDF60EFC3, 0xA867DF55, 0x316E8EEF, 0x4669BE79,\r\n      0xCB61B38C, 0xBC66831A, 0x256FD2A0, 0x5268E236,\r\n      0xCC0C7795, 0xBB0B4703, 0x220216B9, 0x5505262F,\r\n      0xC5BA3BBE, 0xB2BD0B28, 0x2BB45A92, 0x5CB36A04,\r\n      0xC2D7FFA7, 0xB5D0CF31, 0x2CD99E8B, 0x5BDEAE1D,\r\n      0x9B64C2B0, 0xEC63F226, 0x756AA39C, 0x026D930A,\r\n      0x9C0906A9, 0xEB0E363F, 0x72076785, 0x05005713,\r\n      0x95BF4A82, 0xE2B87A14, 0x7BB12BAE, 0x0CB61B38,\r\n      0x92D28E9B, 0xE5D5BE0D, 0x7CDCEFB7, 0x0BDBDF21,\r\n      0x86D3D2D4, 0xF1D4E242, 0x68DDB3F8, 0x1FDA836E,\r\n      0x81BE16CD, 0xF6B9265B, 0x6FB077E1, 0x18B74777,\r\n      0x88085AE6, 0xFF0F6A70, 0x66063BCA, 0x11010B5C,\r\n      0x8F659EFF, 0xF862AE69, 0x616BFFD3, 0x166CCF45,\r\n      0xA00AE278, 0xD70DD2EE, 0x4E048354, 0x3903B3C2,\r\n      0xA7672661, 0xD06016F7, 0x4969474D, 0x3E6E77DB,\r\n      0xAED16A4A, 0xD9D65ADC, 0x40DF0B66, 0x37D83BF0,\r\n      0xA9BCAE53, 0xDEBB9EC5, 0x47B2CF7F, 0x30B5FFE9,\r\n      0xBDBDF21C, 0xCABAC28A, 0x53B39330, 0x24B4A3A6,\r\n      0xBAD03605, 0xCDD70693, 0x54DE5729, 0x23D967BF,\r\n      0xB3667A2E, 0xC4614AB8, 0x5D681B02, 0x2A6F2B94,\r\n      0xB40BBE37, 0xC30C8EA1, 0x5A05DF1B, 0x2D02EF8D\r\n    ];\r\n\r\n    /**\r\n     *\r\n     *  Javascript crc32\r\n     *  http://www.webtoolkit.info/\r\n     *\r\n     */\r\n    module.exports = function crc32(input, crc) {\r\n      if (typeof input === \"undefined\" || !input.length) {\r\n        return 0;\r\n      }\r\n\r\n      var isArray = utils.getTypeOf(input) !== \"string\";\r\n\r\n      if (typeof(crc) == \"undefined\") {\r\n        crc = 0;\r\n      }\r\n      var x = 0;\r\n      var y = 0;\r\n      var b = 0;\r\n\r\n      crc = crc ^ (-1);\r\n      for (var i = 0, iTop = input.length; i < iTop; i++) {\r\n        b = isArray ? input[i] : input.charCodeAt(i);\r\n        y = (crc ^ b) & 0xFF;\r\n        x = table[y];\r\n        crc = (crc >>> 8) ^ x;\r\n      }\r\n\r\n      return crc ^ (-1);\r\n    };\r\n// vim: set shiftwidth=4 softtabstop=4:\r\n\r\n  },{\"./utils\":21}],5:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    var utils = _dereq_('./utils');\r\n\r\n    function DataReader(data) {\r\n      this.data = null; // type : see implementation\r\n      this.length = 0;\r\n      this.index = 0;\r\n    }\r\n    DataReader.prototype = {\r\n      /**\r\n       * Check that the offset will not go too far.\r\n       * @param {string} offset the additional offset to check.\r\n       * @throws {Error} an Error if the offset is out of bounds.\r\n       */\r\n      checkOffset: function(offset) {\r\n        this.checkIndex(this.index + offset);\r\n      },\r\n      /**\r\n       * Check that the specifed index will not be too far.\r\n       * @param {string} newIndex the index to check.\r\n       * @throws {Error} an Error if the index is out of bounds.\r\n       */\r\n      checkIndex: function(newIndex) {\r\n        if (this.length < newIndex || newIndex < 0) {\r\n          throw new Error(\"End of data reached (data length = \" + this.length + \", asked index = \" + (newIndex) + \"). Corrupted zip ?\");\r\n        }\r\n      },\r\n      /**\r\n       * Change the index.\r\n       * @param {number} newIndex The new index.\r\n       * @throws {Error} if the new index is out of the data.\r\n       */\r\n      setIndex: function(newIndex) {\r\n        this.checkIndex(newIndex);\r\n        this.index = newIndex;\r\n      },\r\n      /**\r\n       * Skip the next n bytes.\r\n       * @param {number} n the number of bytes to skip.\r\n       * @throws {Error} if the new index is out of the data.\r\n       */\r\n      skip: function(n) {\r\n        this.setIndex(this.index + n);\r\n      },\r\n      /**\r\n       * Get the byte at the specified index.\r\n       * @param {number} i the index to use.\r\n       * @return {number} a byte.\r\n       */\r\n      byteAt: function(i) {\r\n        // see implementations\r\n      },\r\n      /**\r\n       * Get the next number with a given byte size.\r\n       * @param {number} size the number of bytes to read.\r\n       * @return {number} the corresponding number.\r\n       */\r\n      readInt: function(size) {\r\n        var result = 0,\r\n          i;\r\n        this.checkOffset(size);\r\n        for (i = this.index + size - 1; i >= this.index; i--) {\r\n          result = (result << 8) + this.byteAt(i);\r\n        }\r\n        this.index += size;\r\n        return result;\r\n      },\r\n      /**\r\n       * Get the next string with a given byte size.\r\n       * @param {number} size the number of bytes to read.\r\n       * @return {string} the corresponding string.\r\n       */\r\n      readString: function(size) {\r\n        return utils.transformTo(\"string\", this.readData(size));\r\n      },\r\n      /**\r\n       * Get raw data without conversion, <size> bytes.\r\n       * @param {number} size the number of bytes to read.\r\n       * @return {Object} the raw data, implementation specific.\r\n       */\r\n      readData: function(size) {\r\n        // see implementations\r\n      },\r\n      /**\r\n       * Find the last occurence of a zip signature (4 bytes).\r\n       * @param {string} sig the signature to find.\r\n       * @return {number} the index of the last occurence, -1 if not found.\r\n       */\r\n      lastIndexOfSignature: function(sig) {\r\n        // see implementations\r\n      },\r\n      /**\r\n       * Get the next date.\r\n       * @return {Date} the date.\r\n       */\r\n      readDate: function() {\r\n        var dostime = this.readInt(4);\r\n        return new Date(\r\n          ((dostime >> 25) & 0x7f) + 1980, // year\r\n          ((dostime >> 21) & 0x0f) - 1, // month\r\n          (dostime >> 16) & 0x1f, // day\r\n          (dostime >> 11) & 0x1f, // hour\r\n          (dostime >> 5) & 0x3f, // minute\r\n          (dostime & 0x1f) << 1); // second\r\n      }\r\n    };\r\n    module.exports = DataReader;\r\n\r\n  },{\"./utils\":21}],6:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    exports.base64 = false;\r\n    exports.binary = false;\r\n    exports.dir = false;\r\n    exports.createFolders = false;\r\n    exports.date = null;\r\n    exports.compression = null;\r\n    exports.comment = null;\r\n\r\n  },{}],7:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    var utils = _dereq_('./utils');\r\n\r\n    /**\r\n     * @deprecated\r\n     * This function will be removed in a future version without replacement.\r\n     */\r\n    exports.string2binary = function(str) {\r\n      return utils.string2binary(str);\r\n    };\r\n\r\n    /**\r\n     * @deprecated\r\n     * This function will be removed in a future version without replacement.\r\n     */\r\n    exports.string2Uint8Array = function(str) {\r\n      return utils.transformTo(\"uint8array\", str);\r\n    };\r\n\r\n    /**\r\n     * @deprecated\r\n     * This function will be removed in a future version without replacement.\r\n     */\r\n    exports.uint8Array2String = function(array) {\r\n      return utils.transformTo(\"string\", array);\r\n    };\r\n\r\n    /**\r\n     * @deprecated\r\n     * This function will be removed in a future version without replacement.\r\n     */\r\n    exports.string2Blob = function(str) {\r\n      var buffer = utils.transformTo(\"arraybuffer\", str);\r\n      return utils.arrayBuffer2Blob(buffer);\r\n    };\r\n\r\n    /**\r\n     * @deprecated\r\n     * This function will be removed in a future version without replacement.\r\n     */\r\n    exports.arrayBuffer2Blob = function(buffer) {\r\n      return utils.arrayBuffer2Blob(buffer);\r\n    };\r\n\r\n    /**\r\n     * @deprecated\r\n     * This function will be removed in a future version without replacement.\r\n     */\r\n    exports.transformTo = function(outputType, input) {\r\n      return utils.transformTo(outputType, input);\r\n    };\r\n\r\n    /**\r\n     * @deprecated\r\n     * This function will be removed in a future version without replacement.\r\n     */\r\n    exports.getTypeOf = function(input) {\r\n      return utils.getTypeOf(input);\r\n    };\r\n\r\n    /**\r\n     * @deprecated\r\n     * This function will be removed in a future version without replacement.\r\n     */\r\n    exports.checkSupport = function(type) {\r\n      return utils.checkSupport(type);\r\n    };\r\n\r\n    /**\r\n     * @deprecated\r\n     * This value will be removed in a future version without replacement.\r\n     */\r\n    exports.MAX_VALUE_16BITS = utils.MAX_VALUE_16BITS;\r\n\r\n    /**\r\n     * @deprecated\r\n     * This value will be removed in a future version without replacement.\r\n     */\r\n    exports.MAX_VALUE_32BITS = utils.MAX_VALUE_32BITS;\r\n\r\n\r\n    /**\r\n     * @deprecated\r\n     * This function will be removed in a future version without replacement.\r\n     */\r\n    exports.pretty = function(str) {\r\n      return utils.pretty(str);\r\n    };\r\n\r\n    /**\r\n     * @deprecated\r\n     * This function will be removed in a future version without replacement.\r\n     */\r\n    exports.findCompression = function(compressionMethod) {\r\n      return utils.findCompression(compressionMethod);\r\n    };\r\n\r\n    /**\r\n     * @deprecated\r\n     * This function will be removed in a future version without replacement.\r\n     */\r\n    exports.isRegExp = function (object) {\r\n      return utils.isRegExp(object);\r\n    };\r\n\r\n\r\n  },{\"./utils\":21}],8:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    var USE_TYPEDARRAY = (typeof Uint8Array !== 'undefined') && (typeof Uint16Array !== 'undefined') && (typeof Uint32Array !== 'undefined');\r\n\r\n    var pako = _dereq_(\"pako\");\r\n    exports.uncompressInputType = USE_TYPEDARRAY ? \"uint8array\" : \"array\";\r\n    exports.compressInputType = USE_TYPEDARRAY ? \"uint8array\" : \"array\";\r\n\r\n    exports.magic = \"\\x08\\x00\";\r\n    exports.compress = function(input) {\r\n      return pako.deflateRaw(input);\r\n    };\r\n    exports.uncompress =  function(input) {\r\n      return pako.inflateRaw(input);\r\n    };\r\n\r\n  },{\"pako\":24}],9:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n    var base64 = _dereq_('./base64');\r\n\r\n    /**\r\n     Usage:\r\n     zip = new JSZip();\r\n     zip.file(\"hello.txt\", \"Hello, World!\").file(\"tempfile\", \"nothing\");\r\n     zip.folder(\"images\").file(\"smile.gif\", base64Data, {base64: true});\r\n     zip.file(\"Xmas.txt\", \"Ho ho ho !\", {date : new Date(\"December 25, 2007 00:00:01\")});\r\n     zip.remove(\"tempfile\");\r\n\r\n     base64zip = zip.generate();\r\n\r\n     **/\r\n\r\n    /**\r\n     * Representation a of zip file in js\r\n     * @constructor\r\n     * @param {String=|ArrayBuffer=|Uint8Array=} data the data to load, if any (optional).\r\n     * @param {Object=} options the options for creating this objects (optional).\r\n     */\r\n    function JSZipSync(data, options) {\r\n      // if this constructor is used without `new`, it adds `new` before itself:\r\n      if(!(this instanceof JSZipSync)) return new JSZipSync(data, options);\r\n\r\n      // object containing the files :\r\n      // {\r\n      //   \"folder/\" : {...},\r\n      //   \"folder/data.txt\" : {...}\r\n      // }\r\n      this.files = {};\r\n\r\n      this.comment = null;\r\n\r\n      // Where we are in the hierarchy\r\n      this.root = \"\";\r\n      if (data) {\r\n        this.load(data, options);\r\n      }\r\n      this.clone = function() {\r\n        var newObj = new JSZipSync();\r\n        for (var i in this) {\r\n          if (typeof this[i] !== \"function\") {\r\n            newObj[i] = this[i];\r\n          }\r\n        }\r\n        return newObj;\r\n      };\r\n    }\r\n    JSZipSync.prototype = _dereq_('./object');\r\n    JSZipSync.prototype.load = _dereq_('./load');\r\n    JSZipSync.support = _dereq_('./support');\r\n    JSZipSync.defaults = _dereq_('./defaults');\r\n\r\n    /**\r\n     * @deprecated\r\n     * This namespace will be removed in a future version without replacement.\r\n     */\r\n    JSZipSync.utils = _dereq_('./deprecatedPublicUtils');\r\n\r\n    JSZipSync.base64 = {\r\n      /**\r\n       * @deprecated\r\n       * This method will be removed in a future version without replacement.\r\n       */\r\n      encode : function(input) {\r\n        return base64.encode(input);\r\n      },\r\n      /**\r\n       * @deprecated\r\n       * This method will be removed in a future version without replacement.\r\n       */\r\n      decode : function(input) {\r\n        return base64.decode(input);\r\n      }\r\n    };\r\n    JSZipSync.compressions = _dereq_('./compressions');\r\n    module.exports = JSZipSync;\r\n\r\n  },{\"./base64\":1,\"./compressions\":3,\"./defaults\":6,\"./deprecatedPublicUtils\":7,\"./load\":10,\"./object\":13,\"./support\":17}],10:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    var base64 = _dereq_('./base64');\r\n    var ZipEntries = _dereq_('./zipEntries');\r\n    module.exports = function(data, options) {\r\n      var files, zipEntries, i, input;\r\n      options = options || {};\r\n      if (options.base64) {\r\n        data = base64.decode(data);\r\n      }\r\n\r\n      zipEntries = new ZipEntries(data, options);\r\n      files = zipEntries.files;\r\n      for (i = 0; i < files.length; i++) {\r\n        input = files[i];\r\n        this.file(input.fileName, input.decompressed, {\r\n          binary: true,\r\n          optimizedBinaryString: true,\r\n          date: input.date,\r\n          dir: input.dir,\r\n          comment : input.fileComment.length ? input.fileComment : null,\r\n          createFolders: options.createFolders\r\n        });\r\n      }\r\n      if (zipEntries.zipComment.length) {\r\n        this.comment = zipEntries.zipComment;\r\n      }\r\n\r\n      return this;\r\n    };\r\n\r\n  },{\"./base64\":1,\"./zipEntries\":22}],11:[function(_dereq_,module,exports){\r\n    (function (Buffer){\r\n      'use strict';\r\n      var Buffer_from = /*::(*/function(){}/*:: :any)*/;\r\n      if(typeof Buffer !== 'undefined') {\r\n        var nbfs = !Buffer.from;\r\n        if(!nbfs) try { Buffer.from(\"foo\", \"utf8\"); } catch(e) { nbfs = true; }\r\n        Buffer_from = nbfs ? function(buf, enc) { return (enc) ? new Buffer(buf, enc) : new Buffer(buf); } : Buffer.from.bind(Buffer);\r\n        // $FlowIgnore\r\n        if(!Buffer.alloc) Buffer.alloc = function(n) { return new Buffer(n); };\r\n      }\r\n      module.exports = function(data, encoding){\r\n        return typeof data == 'number' ? Buffer.alloc(data) : Buffer_from(data, encoding);\r\n      };\r\n      module.exports.test = function(b){\r\n        return Buffer.isBuffer(b);\r\n      };\r\n    }).call(this,(typeof Buffer !== \"undefined\" ? Buffer : undefined))\r\n  },{}],12:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    var Uint8ArrayReader = _dereq_('./uint8ArrayReader');\r\n\r\n    function NodeBufferReader(data) {\r\n      this.data = data;\r\n      this.length = this.data.length;\r\n      this.index = 0;\r\n    }\r\n    NodeBufferReader.prototype = new Uint8ArrayReader();\r\n\r\n    /**\r\n     * @see DataReader.readData\r\n     */\r\n    NodeBufferReader.prototype.readData = function(size) {\r\n      this.checkOffset(size);\r\n      var result = this.data.slice(this.index, this.index + size);\r\n      this.index += size;\r\n      return result;\r\n    };\r\n    module.exports = NodeBufferReader;\r\n\r\n  },{\"./uint8ArrayReader\":18}],13:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    var support = _dereq_('./support');\r\n    var utils = _dereq_('./utils');\r\n    var crc32 = _dereq_('./crc32');\r\n    var signature = _dereq_('./signature');\r\n    var defaults = _dereq_('./defaults');\r\n    var base64 = _dereq_('./base64');\r\n    var compressions = _dereq_('./compressions');\r\n    var CompressedObject = _dereq_('./compressedObject');\r\n    var nodeBuffer = _dereq_('./nodeBuffer');\r\n    var utf8 = _dereq_('./utf8');\r\n    var StringWriter = _dereq_('./stringWriter');\r\n    var Uint8ArrayWriter = _dereq_('./uint8ArrayWriter');\r\n\r\n    /**\r\n     * Returns the raw data of a ZipObject, decompress the content if necessary.\r\n     * @param {ZipObject} file the file to use.\r\n     * @return {String|ArrayBuffer|Uint8Array|Buffer} the data.\r\n     */\r\n    var getRawData = function(file) {\r\n      if (file._data instanceof CompressedObject) {\r\n        file._data = file._data.getContent();\r\n        file.options.binary = true;\r\n        file.options.base64 = false;\r\n\r\n        if (utils.getTypeOf(file._data) === \"uint8array\") {\r\n          var copy = file._data;\r\n          // when reading an arraybuffer, the CompressedObject mechanism will keep it and subarray() a Uint8Array.\r\n          // if we request a file in the same format, we might get the same Uint8Array or its ArrayBuffer (the original zip file).\r\n          file._data = new Uint8Array(copy.length);\r\n          // with an empty Uint8Array, Opera fails with a \"Offset larger than array size\"\r\n          if (copy.length !== 0) {\r\n            file._data.set(copy, 0);\r\n          }\r\n        }\r\n      }\r\n      return file._data;\r\n    };\r\n\r\n    /**\r\n     * Returns the data of a ZipObject in a binary form. If the content is an unicode string, encode it.\r\n     * @param {ZipObject} file the file to use.\r\n     * @return {String|ArrayBuffer|Uint8Array|Buffer} the data.\r\n     */\r\n    var getBinaryData = function(file) {\r\n      var result = getRawData(file),\r\n        type = utils.getTypeOf(result);\r\n      if (type === \"string\") {\r\n        if (!file.options.binary) {\r\n          // unicode text !\r\n          // unicode string => binary string is a painful process, check if we can avoid it.\r\n          if (support.nodebuffer) {\r\n            return nodeBuffer(result, \"utf-8\");\r\n          }\r\n        }\r\n        return file.asBinary();\r\n      }\r\n      return result;\r\n    };\r\n\r\n    /**\r\n     * Transform this._data into a string.\r\n     * @param {function} filter a function String -> String, applied if not null on the result.\r\n     * @return {String} the string representing this._data.\r\n     */\r\n    var dataToString = function(asUTF8) {\r\n      var result = getRawData(this);\r\n      if (result === null || typeof result === \"undefined\") {\r\n        return \"\";\r\n      }\r\n      // if the data is a base64 string, we decode it before checking the encoding !\r\n      if (this.options.base64) {\r\n        result = base64.decode(result);\r\n      }\r\n      if (asUTF8 && this.options.binary) {\r\n        // JSZip.prototype.utf8decode supports arrays as input\r\n        // skip to array => string step, utf8decode will do it.\r\n        result = out.utf8decode(result);\r\n      }\r\n      else {\r\n        // no utf8 transformation, do the array => string step.\r\n        result = utils.transformTo(\"string\", result);\r\n      }\r\n\r\n      if (!asUTF8 && !this.options.binary) {\r\n        result = utils.transformTo(\"string\", out.utf8encode(result));\r\n      }\r\n      return result;\r\n    };\r\n    /**\r\n     * A simple object representing a file in the zip file.\r\n     * @constructor\r\n     * @param {string} name the name of the file\r\n     * @param {String|ArrayBuffer|Uint8Array|Buffer} data the data\r\n     * @param {Object} options the options of the file\r\n     */\r\n    var ZipObject = function(name, data, options) {\r\n      this.name = name;\r\n      this.dir = options.dir;\r\n      this.date = options.date;\r\n      this.comment = options.comment;\r\n\r\n      this._data = data;\r\n      this.options = options;\r\n\r\n      /*\r\n     * This object contains initial values for dir and date.\r\n     * With them, we can check if the user changed the deprecated metadata in\r\n     * `ZipObject#options` or not.\r\n     */\r\n      this._initialMetadata = {\r\n        dir : options.dir,\r\n        date : options.date\r\n      };\r\n    };\r\n\r\n    ZipObject.prototype = {\r\n      /**\r\n       * Return the content as UTF8 string.\r\n       * @return {string} the UTF8 string.\r\n       */\r\n      asText: function() {\r\n        return dataToString.call(this, true);\r\n      },\r\n      /**\r\n       * Returns the binary content.\r\n       * @return {string} the content as binary.\r\n       */\r\n      asBinary: function() {\r\n        return dataToString.call(this, false);\r\n      },\r\n      /**\r\n       * Returns the content as a nodejs Buffer.\r\n       * @return {Buffer} the content as a Buffer.\r\n       */\r\n      asNodeBuffer: function() {\r\n        var result = getBinaryData(this);\r\n        return utils.transformTo(\"nodebuffer\", result);\r\n      },\r\n      /**\r\n       * Returns the content as an Uint8Array.\r\n       * @return {Uint8Array} the content as an Uint8Array.\r\n       */\r\n      asUint8Array: function() {\r\n        var result = getBinaryData(this);\r\n        return utils.transformTo(\"uint8array\", result);\r\n      },\r\n      /**\r\n       * Returns the content as an ArrayBuffer.\r\n       * @return {ArrayBuffer} the content as an ArrayBufer.\r\n       */\r\n      asArrayBuffer: function() {\r\n        return this.asUint8Array().buffer;\r\n      }\r\n    };\r\n\r\n    /**\r\n     * Transform an integer into a string in hexadecimal.\r\n     * @private\r\n     * @param {number} dec the number to convert.\r\n     * @param {number} bytes the number of bytes to generate.\r\n     * @returns {string} the result.\r\n     */\r\n    var decToHex = function(dec, bytes) {\r\n      var hex = \"\",\r\n        i;\r\n      for (i = 0; i < bytes; i++) {\r\n        hex += String.fromCharCode(dec & 0xff);\r\n        dec = dec >>> 8;\r\n      }\r\n      return hex;\r\n    };\r\n\r\n    /**\r\n     * Merge the objects passed as parameters into a new one.\r\n     * @private\r\n     * @param {...Object} var_args All objects to merge.\r\n     * @return {Object} a new object with the data of the others.\r\n     */\r\n    var extend = function() {\r\n      var result = {}, i, attr;\r\n      for (i = 0; i < arguments.length; i++) { // arguments is not enumerable in some browsers\r\n        for (attr in arguments[i]) {\r\n          if (arguments[i].hasOwnProperty(attr) && typeof result[attr] === \"undefined\") {\r\n            result[attr] = arguments[i][attr];\r\n          }\r\n        }\r\n      }\r\n      return result;\r\n    };\r\n\r\n    /**\r\n     * Transforms the (incomplete) options from the user into the complete\r\n     * set of options to create a file.\r\n     * @private\r\n     * @param {Object} o the options from the user.\r\n     * @return {Object} the complete set of options.\r\n     */\r\n    var prepareFileAttrs = function(o) {\r\n      o = o || {};\r\n      if (o.base64 === true && (o.binary === null || o.binary === undefined)) {\r\n        o.binary = true;\r\n      }\r\n      o = extend(o, defaults);\r\n      o.date = o.date || new Date();\r\n      if (o.compression !== null) o.compression = o.compression.toUpperCase();\r\n\r\n      return o;\r\n    };\r\n\r\n    /**\r\n     * Add a file in the current folder.\r\n     * @private\r\n     * @param {string} name the name of the file\r\n     * @param {String|ArrayBuffer|Uint8Array|Buffer} data the data of the file\r\n     * @param {Object} o the options of the file\r\n     * @return {Object} the new file.\r\n     */\r\n    var fileAdd = function(name, data, o) {\r\n      // be sure sub folders exist\r\n      var dataType = utils.getTypeOf(data),\r\n        parent;\r\n\r\n      o = prepareFileAttrs(o);\r\n\r\n      if (o.createFolders && (parent = parentFolder(name))) {\r\n        folderAdd.call(this, parent, true);\r\n      }\r\n\r\n      if (o.dir || data === null || typeof data === \"undefined\") {\r\n        o.base64 = false;\r\n        o.binary = false;\r\n        data = null;\r\n      }\r\n      else if (dataType === \"string\") {\r\n        if (o.binary && !o.base64) {\r\n          // optimizedBinaryString == true means that the file has already been filtered with a 0xFF mask\r\n          if (o.optimizedBinaryString !== true) {\r\n            // this is a string, not in a base64 format.\r\n            // Be sure that this is a correct \"binary string\"\r\n            data = utils.string2binary(data);\r\n          }\r\n        }\r\n      }\r\n      else { // arraybuffer, uint8array, ...\r\n        o.base64 = false;\r\n        o.binary = true;\r\n\r\n        if (!dataType && !(data instanceof CompressedObject)) {\r\n          throw new Error(\"The data of '\" + name + \"' is in an unsupported format !\");\r\n        }\r\n\r\n        // special case : it's way easier to work with Uint8Array than with ArrayBuffer\r\n        if (dataType === \"arraybuffer\") {\r\n          data = utils.transformTo(\"uint8array\", data);\r\n        }\r\n      }\r\n\r\n      var object = new ZipObject(name, data, o);\r\n      this.files[name] = object;\r\n      return object;\r\n    };\r\n\r\n    /**\r\n     * Find the parent folder of the path.\r\n     * @private\r\n     * @param {string} path the path to use\r\n     * @return {string} the parent folder, or \"\"\r\n     */\r\n    var parentFolder = function (path) {\r\n      if (path.slice(-1) == '/') {\r\n        path = path.substring(0, path.length - 1);\r\n      }\r\n      var lastSlash = path.lastIndexOf('/');\r\n      return (lastSlash > 0) ? path.substring(0, lastSlash) : \"\";\r\n    };\r\n\r\n    /**\r\n     * Add a (sub) folder in the current folder.\r\n     * @private\r\n     * @param {string} name the folder's name\r\n     * @param {boolean=} [createFolders] If true, automatically create sub\r\n     *  folders. Defaults to false.\r\n     * @return {Object} the new folder.\r\n     */\r\n    var folderAdd = function(name, createFolders) {\r\n      // Check the name ends with a /\r\n      if (name.slice(-1) != \"/\") {\r\n        name += \"/\"; // IE doesn't like substr(-1)\r\n      }\r\n\r\n      createFolders = (typeof createFolders !== 'undefined') ? createFolders : false;\r\n\r\n      // Does this folder already exist?\r\n      if (!this.files[name]) {\r\n        fileAdd.call(this, name, null, {\r\n          dir: true,\r\n          createFolders: createFolders\r\n        });\r\n      }\r\n      return this.files[name];\r\n    };\r\n\r\n    /**\r\n     * Generate a JSZip.CompressedObject for a given zipOject.\r\n     * @param {ZipObject} file the object to read.\r\n     * @param {JSZip.compression} compression the compression to use.\r\n     * @return {JSZip.CompressedObject} the compressed result.\r\n     */\r\n    var generateCompressedObjectFrom = function(file, compression) {\r\n      var result = new CompressedObject(),\r\n        content;\r\n\r\n      // the data has not been decompressed, we might reuse things !\r\n      if (file._data instanceof CompressedObject) {\r\n        result.uncompressedSize = file._data.uncompressedSize;\r\n        result.crc32 = file._data.crc32;\r\n\r\n        if (result.uncompressedSize === 0 || file.dir) {\r\n          compression = compressions['STORE'];\r\n          result.compressedContent = \"\";\r\n          result.crc32 = 0;\r\n        }\r\n        else if (file._data.compressionMethod === compression.magic) {\r\n          result.compressedContent = file._data.getCompressedContent();\r\n        }\r\n        else {\r\n          content = file._data.getContent();\r\n          // need to decompress / recompress\r\n          result.compressedContent = compression.compress(utils.transformTo(compression.compressInputType, content));\r\n        }\r\n      }\r\n      else {\r\n        // have uncompressed data\r\n        content = getBinaryData(file);\r\n        if (!content || content.length === 0 || file.dir) {\r\n          compression = compressions['STORE'];\r\n          content = \"\";\r\n        }\r\n        result.uncompressedSize = content.length;\r\n        result.crc32 = crc32(content);\r\n        result.compressedContent = compression.compress(utils.transformTo(compression.compressInputType, content));\r\n      }\r\n\r\n      result.compressedSize = result.compressedContent.length;\r\n      result.compressionMethod = compression.magic;\r\n\r\n      return result;\r\n    };\r\n\r\n    /**\r\n     * Generate the various parts used in the construction of the final zip file.\r\n     * @param {string} name the file name.\r\n     * @param {ZipObject} file the file content.\r\n     * @param {JSZip.CompressedObject} compressedObject the compressed object.\r\n     * @param {number} offset the current offset from the start of the zip file.\r\n     * @return {object} the zip parts.\r\n     */\r\n    var generateZipParts = function(name, file, compressedObject, offset) {\r\n      var data = compressedObject.compressedContent,\r\n        utfEncodedFileName = utils.transformTo(\"string\", utf8.utf8encode(file.name)),\r\n        comment = file.comment || \"\",\r\n        utfEncodedComment = utils.transformTo(\"string\", utf8.utf8encode(comment)),\r\n        useUTF8ForFileName = utfEncodedFileName.length !== file.name.length,\r\n        useUTF8ForComment = utfEncodedComment.length !== comment.length,\r\n        o = file.options,\r\n        dosTime,\r\n        dosDate,\r\n        extraFields = \"\",\r\n        unicodePathExtraField = \"\",\r\n        unicodeCommentExtraField = \"\",\r\n        dir, date;\r\n\r\n\r\n      // handle the deprecated options.dir\r\n      if (file._initialMetadata.dir !== file.dir) {\r\n        dir = file.dir;\r\n      } else {\r\n        dir = o.dir;\r\n      }\r\n\r\n      // handle the deprecated options.date\r\n      if(file._initialMetadata.date !== file.date) {\r\n        date = file.date;\r\n      } else {\r\n        date = o.date;\r\n      }\r\n\r\n\r\n      dosTime = date.getHours();\r\n      dosTime = dosTime << 6;\r\n      dosTime = dosTime | date.getMinutes();\r\n      dosTime = dosTime << 5;\r\n      dosTime = dosTime | date.getSeconds() / 2;\r\n\r\n      dosDate = date.getFullYear() - 1980;\r\n      dosDate = dosDate << 4;\r\n      dosDate = dosDate | (date.getMonth() + 1);\r\n      dosDate = dosDate << 5;\r\n      dosDate = dosDate | date.getDate();\r\n\r\n      if (useUTF8ForFileName) {\r\n        // set the unicode path extra field. unzip needs at least one extra\r\n        // field to correctly handle unicode path, so using the path is as good\r\n        // as any other information. This could improve the situation with\r\n        // other archive managers too.\r\n        // This field is usually used without the utf8 flag, with a non\r\n        // unicode path in the header (winrar, winzip). This helps (a bit)\r\n        // with the messy Windows' default compressed folders feature but\r\n        // breaks on p7zip which doesn't seek the unicode path extra field.\r\n        // So for now, UTF-8 everywhere !\r\n        unicodePathExtraField =\r\n          // Version\r\n          decToHex(1, 1) +\r\n          // NameCRC32\r\n          decToHex(crc32(utfEncodedFileName), 4) +\r\n          // UnicodeName\r\n          utfEncodedFileName;\r\n\r\n        extraFields +=\r\n          // Info-ZIP Unicode Path Extra Field\r\n          \"\\x75\\x70\" +\r\n          // size\r\n          decToHex(unicodePathExtraField.length, 2) +\r\n          // content\r\n          unicodePathExtraField;\r\n      }\r\n\r\n      if(useUTF8ForComment) {\r\n\r\n        unicodeCommentExtraField =\r\n          // Version\r\n          decToHex(1, 1) +\r\n          // CommentCRC32\r\n          decToHex(this.crc32(utfEncodedComment), 4) +\r\n          // UnicodeName\r\n          utfEncodedComment;\r\n\r\n        extraFields +=\r\n          // Info-ZIP Unicode Path Extra Field\r\n          \"\\x75\\x63\" +\r\n          // size\r\n          decToHex(unicodeCommentExtraField.length, 2) +\r\n          // content\r\n          unicodeCommentExtraField;\r\n      }\r\n\r\n      var header = \"\";\r\n\r\n      // version needed to extract\r\n      header += \"\\x0A\\x00\";\r\n      // general purpose bit flag\r\n      // set bit 11 if utf8\r\n      header += (useUTF8ForFileName || useUTF8ForComment) ? \"\\x00\\x08\" : \"\\x00\\x00\";\r\n      // compression method\r\n      header += compressedObject.compressionMethod;\r\n      // last mod file time\r\n      header += decToHex(dosTime, 2);\r\n      // last mod file date\r\n      header += decToHex(dosDate, 2);\r\n      // crc-32\r\n      header += decToHex(compressedObject.crc32, 4);\r\n      // compressed size\r\n      header += decToHex(compressedObject.compressedSize, 4);\r\n      // uncompressed size\r\n      header += decToHex(compressedObject.uncompressedSize, 4);\r\n      // file name length\r\n      header += decToHex(utfEncodedFileName.length, 2);\r\n      // extra field length\r\n      header += decToHex(extraFields.length, 2);\r\n\r\n\r\n      var fileRecord = signature.LOCAL_FILE_HEADER + header + utfEncodedFileName + extraFields;\r\n\r\n      var dirRecord = signature.CENTRAL_FILE_HEADER +\r\n        // version made by (00: DOS)\r\n        \"\\x14\\x00\" +\r\n        // file header (common to file and central directory)\r\n        header +\r\n        // file comment length\r\n        decToHex(utfEncodedComment.length, 2) +\r\n        // disk number start\r\n        \"\\x00\\x00\" +\r\n        // internal file attributes TODO\r\n        \"\\x00\\x00\" +\r\n        // external file attributes\r\n        (dir === true ? \"\\x10\\x00\\x00\\x00\" : \"\\x00\\x00\\x00\\x00\") +\r\n        // relative offset of local header\r\n        decToHex(offset, 4) +\r\n        // file name\r\n        utfEncodedFileName +\r\n        // extra field\r\n        extraFields +\r\n        // file comment\r\n        utfEncodedComment;\r\n\r\n      return {\r\n        fileRecord: fileRecord,\r\n        dirRecord: dirRecord,\r\n        compressedObject: compressedObject\r\n      };\r\n    };\r\n\r\n\r\n// return the actual prototype of JSZip\r\n    var out = {\r\n      /**\r\n       * Read an existing zip and merge the data in the current JSZip object.\r\n       * The implementation is in jszip-load.js, don't forget to include it.\r\n       * @param {String|ArrayBuffer|Uint8Array|Buffer} stream  The stream to load\r\n       * @param {Object} options Options for loading the stream.\r\n       *  options.base64 : is the stream in base64 ? default : false\r\n       * @return {JSZip} the current JSZip object\r\n       */\r\n      load: function(stream, options) {\r\n        throw new Error(\"Load method is not defined. Is the file jszip-load.js included ?\");\r\n      },\r\n\r\n      /**\r\n       * Filter nested files/folders with the specified function.\r\n       * @param {Function} search the predicate to use :\r\n       * function (relativePath, file) {...}\r\n       * It takes 2 arguments : the relative path and the file.\r\n       * @return {Array} An array of matching elements.\r\n       */\r\n      filter: function(search) {\r\n        var result = [],\r\n          filename, relativePath, file, fileClone;\r\n        for (filename in this.files) {\r\n          if (!this.files.hasOwnProperty(filename)) {\r\n            continue;\r\n          }\r\n          file = this.files[filename];\r\n          // return a new object, don't let the user mess with our internal objects :)\r\n          fileClone = new ZipObject(file.name, file._data, extend(file.options));\r\n          relativePath = filename.slice(this.root.length, filename.length);\r\n          if (filename.slice(0, this.root.length) === this.root && // the file is in the current root\r\n            search(relativePath, fileClone)) { // and the file matches the function\r\n            result.push(fileClone);\r\n          }\r\n        }\r\n        return result;\r\n      },\r\n\r\n      /**\r\n       * Add a file to the zip file, or search a file.\r\n       * @param   {string|RegExp} name The name of the file to add (if data is defined),\r\n       * the name of the file to find (if no data) or a regex to match files.\r\n       * @param   {String|ArrayBuffer|Uint8Array|Buffer} data  The file data, either raw or base64 encoded\r\n       * @param   {Object} o     File options\r\n       * @return  {JSZip|Object|Array} this JSZip object (when adding a file),\r\n       * a file (when searching by string) or an array of files (when searching by regex).\r\n       */\r\n      file: function(name, data, o) {\r\n        if (arguments.length === 1) {\r\n          if (utils.isRegExp(name)) {\r\n            var regexp = name;\r\n            return this.filter(function(relativePath, file) {\r\n              return !file.dir && regexp.test(relativePath);\r\n            });\r\n          }\r\n          else { // text\r\n            return this.filter(function(relativePath, file) {\r\n              return !file.dir && relativePath === name;\r\n            })[0] || null;\r\n          }\r\n        }\r\n        else { // more than one argument : we have data !\r\n          name = this.root + name;\r\n          fileAdd.call(this, name, data, o);\r\n        }\r\n        return this;\r\n      },\r\n\r\n      /**\r\n       * Add a directory to the zip file, or search.\r\n       * @param   {String|RegExp} arg The name of the directory to add, or a regex to search folders.\r\n       * @return  {JSZip} an object with the new directory as the root, or an array containing matching folders.\r\n       */\r\n      folder: function(arg) {\r\n        if (!arg) {\r\n          return this;\r\n        }\r\n\r\n        if (utils.isRegExp(arg)) {\r\n          return this.filter(function(relativePath, file) {\r\n            return file.dir && arg.test(relativePath);\r\n          });\r\n        }\r\n\r\n        // else, name is a new folder\r\n        var name = this.root + arg;\r\n        var newFolder = folderAdd.call(this, name);\r\n\r\n        // Allow chaining by returning a new object with this folder as the root\r\n        var ret = this.clone();\r\n        ret.root = newFolder.name;\r\n        return ret;\r\n      },\r\n\r\n      /**\r\n       * Delete a file, or a directory and all sub-files, from the zip\r\n       * @param {string} name the name of the file to delete\r\n       * @return {JSZip} this JSZip object\r\n       */\r\n      remove: function(name) {\r\n        name = this.root + name;\r\n        var file = this.files[name];\r\n        if (!file) {\r\n          // Look for any folders\r\n          if (name.slice(-1) != \"/\") {\r\n            name += \"/\";\r\n          }\r\n          file = this.files[name];\r\n        }\r\n\r\n        if (file && !file.dir) {\r\n          // file\r\n          delete this.files[name];\r\n        } else {\r\n          // maybe a folder, delete recursively\r\n          var kids = this.filter(function(relativePath, file) {\r\n            return file.name.slice(0, name.length) === name;\r\n          });\r\n          for (var i = 0; i < kids.length; i++) {\r\n            delete this.files[kids[i].name];\r\n          }\r\n        }\r\n\r\n        return this;\r\n      },\r\n\r\n      /**\r\n       * Generate the complete zip file\r\n       * @param {Object} options the options to generate the zip file :\r\n       * - base64, (deprecated, use type instead) true to generate base64.\r\n       * - compression, \"STORE\" by default.\r\n       * - type, \"base64\" by default. Values are : string, base64, uint8array, arraybuffer, blob.\r\n       * @return {String|Uint8Array|ArrayBuffer|Buffer|Blob} the zip file\r\n       */\r\n      generate: function(options) {\r\n        options = extend(options || {}, {\r\n          base64: true,\r\n          compression: \"STORE\",\r\n          type: \"base64\",\r\n          comment: null\r\n        });\r\n\r\n        utils.checkSupport(options.type);\r\n\r\n        var zipData = [],\r\n          localDirLength = 0,\r\n          centralDirLength = 0,\r\n          writer, i,\r\n          utfEncodedComment = utils.transformTo(\"string\", this.utf8encode(options.comment || this.comment || \"\"));\r\n\r\n        // first, generate all the zip parts.\r\n        for (var name in this.files) {\r\n          if (!this.files.hasOwnProperty(name)) {\r\n            continue;\r\n          }\r\n          var file = this.files[name];\r\n\r\n          var compressionName = file.options.compression || options.compression.toUpperCase();\r\n          var compression = compressions[compressionName];\r\n          if (!compression) {\r\n            throw new Error(compressionName + \" is not a valid compression method !\");\r\n          }\r\n\r\n          var compressedObject = generateCompressedObjectFrom.call(this, file, compression);\r\n\r\n          var zipPart = generateZipParts.call(this, name, file, compressedObject, localDirLength);\r\n          localDirLength += zipPart.fileRecord.length + compressedObject.compressedSize;\r\n          centralDirLength += zipPart.dirRecord.length;\r\n          zipData.push(zipPart);\r\n        }\r\n\r\n        var dirEnd = \"\";\r\n\r\n        // end of central dir signature\r\n        dirEnd = signature.CENTRAL_DIRECTORY_END +\r\n          // number of this disk\r\n          \"\\x00\\x00\" +\r\n          // number of the disk with the start of the central directory\r\n          \"\\x00\\x00\" +\r\n          // total number of entries in the central directory on this disk\r\n          decToHex(zipData.length, 2) +\r\n          // total number of entries in the central directory\r\n          decToHex(zipData.length, 2) +\r\n          // size of the central directory   4 bytes\r\n          decToHex(centralDirLength, 4) +\r\n          // offset of start of central directory with respect to the starting disk number\r\n          decToHex(localDirLength, 4) +\r\n          // .ZIP file comment length\r\n          decToHex(utfEncodedComment.length, 2) +\r\n          // .ZIP file comment\r\n          utfEncodedComment;\r\n\r\n\r\n        // we have all the parts (and the total length)\r\n        // time to create a writer !\r\n        var typeName = options.type.toLowerCase();\r\n        if(typeName===\"uint8array\"||typeName===\"arraybuffer\"||typeName===\"blob\"||typeName===\"nodebuffer\") {\r\n          writer = new Uint8ArrayWriter(localDirLength + centralDirLength + dirEnd.length);\r\n        }else{\r\n          writer = new StringWriter(localDirLength + centralDirLength + dirEnd.length);\r\n        }\r\n\r\n        for (i = 0; i < zipData.length; i++) {\r\n          writer.append(zipData[i].fileRecord);\r\n          writer.append(zipData[i].compressedObject.compressedContent);\r\n        }\r\n        for (i = 0; i < zipData.length; i++) {\r\n          writer.append(zipData[i].dirRecord);\r\n        }\r\n\r\n        writer.append(dirEnd);\r\n\r\n        var zip = writer.finalize();\r\n\r\n\r\n\r\n        switch(options.type.toLowerCase()) {\r\n          // case \"zip is an Uint8Array\"\r\n          case \"uint8array\" :\r\n          case \"arraybuffer\" :\r\n          case \"nodebuffer\" :\r\n            return utils.transformTo(options.type.toLowerCase(), zip);\r\n          case \"blob\" :\r\n            return utils.arrayBuffer2Blob(utils.transformTo(\"arraybuffer\", zip));\r\n          // case \"zip is a string\"\r\n          case \"base64\" :\r\n            return (options.base64) ? base64.encode(zip) : zip;\r\n          default : // case \"string\" :\r\n            return zip;\r\n        }\r\n\r\n      },\r\n\r\n      /**\r\n       * @deprecated\r\n       * This method will be removed in a future version without replacement.\r\n       */\r\n      crc32: function (input, crc) {\r\n        return crc32(input, crc);\r\n      },\r\n\r\n      /**\r\n       * @deprecated\r\n       * This method will be removed in a future version without replacement.\r\n       */\r\n      utf8encode: function (string) {\r\n        return utils.transformTo(\"string\", utf8.utf8encode(string));\r\n      },\r\n\r\n      /**\r\n       * @deprecated\r\n       * This method will be removed in a future version without replacement.\r\n       */\r\n      utf8decode: function (input) {\r\n        return utf8.utf8decode(input);\r\n      }\r\n    };\r\n    module.exports = out;\r\n\r\n  },{\"./base64\":1,\"./compressedObject\":2,\"./compressions\":3,\"./crc32\":4,\"./defaults\":6,\"./nodeBuffer\":11,\"./signature\":14,\"./stringWriter\":16,\"./support\":17,\"./uint8ArrayWriter\":19,\"./utf8\":20,\"./utils\":21}],14:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    exports.LOCAL_FILE_HEADER = \"PK\\x03\\x04\";\r\n    exports.CENTRAL_FILE_HEADER = \"PK\\x01\\x02\";\r\n    exports.CENTRAL_DIRECTORY_END = \"PK\\x05\\x06\";\r\n    exports.ZIP64_CENTRAL_DIRECTORY_LOCATOR = \"PK\\x06\\x07\";\r\n    exports.ZIP64_CENTRAL_DIRECTORY_END = \"PK\\x06\\x06\";\r\n    exports.DATA_DESCRIPTOR = \"PK\\x07\\x08\";\r\n\r\n  },{}],15:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    var DataReader = _dereq_('./dataReader');\r\n    var utils = _dereq_('./utils');\r\n\r\n    function StringReader(data, optimizedBinaryString) {\r\n      this.data = data;\r\n      if (!optimizedBinaryString) {\r\n        this.data = utils.string2binary(this.data);\r\n      }\r\n      this.length = this.data.length;\r\n      this.index = 0;\r\n    }\r\n    StringReader.prototype = new DataReader();\r\n    /**\r\n     * @see DataReader.byteAt\r\n     */\r\n    StringReader.prototype.byteAt = function(i) {\r\n      return this.data.charCodeAt(i);\r\n    };\r\n    /**\r\n     * @see DataReader.lastIndexOfSignature\r\n     */\r\n    StringReader.prototype.lastIndexOfSignature = function(sig) {\r\n      return this.data.lastIndexOf(sig);\r\n    };\r\n    /**\r\n     * @see DataReader.readData\r\n     */\r\n    StringReader.prototype.readData = function(size) {\r\n      this.checkOffset(size);\r\n      // this will work because the constructor applied the \"& 0xff\" mask.\r\n      var result = this.data.slice(this.index, this.index + size);\r\n      this.index += size;\r\n      return result;\r\n    };\r\n    module.exports = StringReader;\r\n\r\n  },{\"./dataReader\":5,\"./utils\":21}],16:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n    var utils = _dereq_('./utils');\r\n\r\n    /**\r\n     * An object to write any content to a string.\r\n     * @constructor\r\n     */\r\n    var StringWriter = function() {\r\n      this.data = [];\r\n    };\r\n    StringWriter.prototype = {\r\n      /**\r\n       * Append any content to the current string.\r\n       * @param {Object} input the content to add.\r\n       */\r\n      append: function(input) {\r\n        input = utils.transformTo(\"string\", input);\r\n        this.data.push(input);\r\n      },\r\n      /**\r\n       * Finalize the construction an return the result.\r\n       * @return {string} the generated string.\r\n       */\r\n      finalize: function() {\r\n        return this.data.join(\"\");\r\n      }\r\n    };\r\n\r\n    module.exports = StringWriter;\r\n\r\n  },{\"./utils\":21}],17:[function(_dereq_,module,exports){\r\n    (function (Buffer){\r\n      'use strict';\r\n      exports.base64 = true;\r\n      exports.array = true;\r\n      exports.string = true;\r\n      exports.arraybuffer = typeof ArrayBuffer !== \"undefined\" && typeof Uint8Array !== \"undefined\";\r\n// contains true if JSZip can read/generate nodejs Buffer, false otherwise.\r\n// Browserify will provide a Buffer implementation for browsers, which is\r\n// an augmented Uint8Array (i.e., can be used as either Buffer or U8).\r\n      exports.nodebuffer = typeof Buffer !== \"undefined\";\r\n// contains true if JSZip can read/generate Uint8Array, false otherwise.\r\n      exports.uint8array = typeof Uint8Array !== \"undefined\";\r\n\r\n      if (typeof ArrayBuffer === \"undefined\") {\r\n        exports.blob = false;\r\n      }\r\n      else {\r\n        var buffer = new ArrayBuffer(0);\r\n        try {\r\n          exports.blob = new Blob([buffer], {\r\n            type: \"application/zip\"\r\n          }).size === 0;\r\n        }\r\n        catch (e) {\r\n          try {\r\n            var Builder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\r\n            var builder = new Builder();\r\n            builder.append(buffer);\r\n            exports.blob = builder.getBlob('application/zip').size === 0;\r\n          }\r\n          catch (e) {\r\n            exports.blob = false;\r\n          }\r\n        }\r\n      }\r\n\r\n    }).call(this,(typeof Buffer !== \"undefined\" ? Buffer : undefined))\r\n  },{}],18:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    var DataReader = _dereq_('./dataReader');\r\n\r\n    function Uint8ArrayReader(data) {\r\n      if (data) {\r\n        this.data = data;\r\n        this.length = this.data.length;\r\n        this.index = 0;\r\n      }\r\n    }\r\n    Uint8ArrayReader.prototype = new DataReader();\r\n    /**\r\n     * @see DataReader.byteAt\r\n     */\r\n    Uint8ArrayReader.prototype.byteAt = function(i) {\r\n      return this.data[i];\r\n    };\r\n    /**\r\n     * @see DataReader.lastIndexOfSignature\r\n     */\r\n    Uint8ArrayReader.prototype.lastIndexOfSignature = function(sig) {\r\n      var sig0 = sig.charCodeAt(0),\r\n        sig1 = sig.charCodeAt(1),\r\n        sig2 = sig.charCodeAt(2),\r\n        sig3 = sig.charCodeAt(3);\r\n      for (var i = this.length - 4; i >= 0; --i) {\r\n        if (this.data[i] === sig0 && this.data[i + 1] === sig1 && this.data[i + 2] === sig2 && this.data[i + 3] === sig3) {\r\n          return i;\r\n        }\r\n      }\r\n\r\n      return -1;\r\n    };\r\n    /**\r\n     * @see DataReader.readData\r\n     */\r\n    Uint8ArrayReader.prototype.readData = function(size) {\r\n      this.checkOffset(size);\r\n      if(size === 0) {\r\n        // in IE10, when using subarray(idx, idx), we get the array [0x00] instead of [].\r\n        return new Uint8Array(0);\r\n      }\r\n      var result = this.data.subarray(this.index, this.index + size);\r\n      this.index += size;\r\n      return result;\r\n    };\r\n    module.exports = Uint8ArrayReader;\r\n\r\n  },{\"./dataReader\":5}],19:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n    var utils = _dereq_('./utils');\r\n\r\n    /**\r\n     * An object to write any content to an Uint8Array.\r\n     * @constructor\r\n     * @param {number} length The length of the array.\r\n     */\r\n    var Uint8ArrayWriter = function(length) {\r\n      this.data = new Uint8Array(length);\r\n      this.index = 0;\r\n    };\r\n    Uint8ArrayWriter.prototype = {\r\n      /**\r\n       * Append any content to the current array.\r\n       * @param {Object} input the content to add.\r\n       */\r\n      append: function(input) {\r\n        if (input.length !== 0) {\r\n          // with an empty Uint8Array, Opera fails with a \"Offset larger than array size\"\r\n          input = utils.transformTo(\"uint8array\", input);\r\n          this.data.set(input, this.index);\r\n          this.index += input.length;\r\n        }\r\n      },\r\n      /**\r\n       * Finalize the construction an return the result.\r\n       * @return {Uint8Array} the generated array.\r\n       */\r\n      finalize: function() {\r\n        return this.data;\r\n      }\r\n    };\r\n\r\n    module.exports = Uint8ArrayWriter;\r\n\r\n  },{\"./utils\":21}],20:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n    var utils = _dereq_('./utils');\r\n    var support = _dereq_('./support');\r\n    var nodeBuffer = _dereq_('./nodeBuffer');\r\n\r\n    /**\r\n     * The following functions come from pako, from pako/lib/utils/strings\r\n     * released under the MIT license, see pako https://github.com/nodeca/pako/\r\n     */\r\n\r\n// Table with utf8 lengths (calculated by first byte of sequence)\r\n// Note, that 5 & 6-byte values and some 4-byte values can not be represented in JS,\r\n// because max possible codepoint is 0x10ffff\r\n    var _utf8len = new Array(256);\r\n    for (var i=0; i<256; i++) {\r\n      _utf8len[i] = (i >= 252 ? 6 : i >= 248 ? 5 : i >= 240 ? 4 : i >= 224 ? 3 : i >= 192 ? 2 : 1);\r\n    }\r\n    _utf8len[254]=_utf8len[254]=1; // Invalid sequence start\r\n\r\n// convert string to array (typed, when possible)\r\n    var string2buf = function (str) {\r\n      var buf, c, c2, m_pos, i, str_len = str.length, buf_len = 0;\r\n\r\n      // count binary size\r\n      for (m_pos = 0; m_pos < str_len; m_pos++) {\r\n        c = str.charCodeAt(m_pos);\r\n        if (((c & 0xfc00) === 0xd800) && (m_pos+1 < str_len)) {\r\n          c2 = str.charCodeAt(m_pos+1);\r\n          if ((c2 & 0xfc00) === 0xdc00) {\r\n            c = 0x10000 + ((c - 0xd800) << 10) + (c2 - 0xdc00);\r\n            m_pos++;\r\n          }\r\n        }\r\n        buf_len += (c < 0x80) ? 1 : ((c < 0x800) ? 2 : ((c < 0x10000) ? 3 : 4));\r\n      }\r\n\r\n      // allocate buffer\r\n      if (support.uint8array) {\r\n        buf = new Uint8Array(buf_len);\r\n      } else {\r\n        buf = new Array(buf_len);\r\n      }\r\n\r\n      // convert\r\n      for (i=0, m_pos = 0; i < buf_len; m_pos++) {\r\n        c = str.charCodeAt(m_pos);\r\n        if ((c & 0xfc00) === 0xd800 && (m_pos+1 < str_len)) {\r\n          c2 = str.charCodeAt(m_pos+1);\r\n          if ((c2 & 0xfc00) === 0xdc00) {\r\n            c = 0x10000 + ((c - 0xd800) << 10) + (c2 - 0xdc00);\r\n            m_pos++;\r\n          }\r\n        }\r\n        if (c < 0x80) {\r\n          /* one byte */\r\n          buf[i++] = c;\r\n        } else if (c < 0x800) {\r\n          /* two bytes */\r\n          buf[i++] = 0xC0 | (c >>> 6);\r\n          buf[i++] = 0x80 | (c & 0x3f);\r\n        } else if (c < 0x10000) {\r\n          /* three bytes */\r\n          buf[i++] = 0xE0 | (c >>> 12);\r\n          buf[i++] = 0x80 | ((c >>> 6) & 0x3f);\r\n          buf[i++] = 0x80 | (c & 0x3f);\r\n        } else {\r\n          /* four bytes */\r\n          buf[i++] = 0xf0 | (c >>> 18);\r\n          buf[i++] = 0x80 | ((c >>> 12) & 0x3f);\r\n          buf[i++] = 0x80 | ((c >>> 6) & 0x3f);\r\n          buf[i++] = 0x80 | (c & 0x3f);\r\n        }\r\n      }\r\n\r\n      return buf;\r\n    };\r\n\r\n// Calculate max possible position in utf8 buffer,\r\n// that will not break sequence. If that's not possible\r\n// - (very small limits) return max size as is.\r\n//\r\n// buf[] - utf8 bytes array\r\n// max   - length limit (mandatory);\r\n    var utf8border = function(buf, max) {\r\n      var pos;\r\n\r\n      max = max || buf.length;\r\n      if (max > buf.length) { max = buf.length; }\r\n\r\n      // go back from last position, until start of sequence found\r\n      pos = max-1;\r\n      while (pos >= 0 && (buf[pos] & 0xC0) === 0x80) { pos--; }\r\n\r\n      // Fuckup - very small and broken sequence,\r\n      // return max, because we should return something anyway.\r\n      if (pos < 0) { return max; }\r\n\r\n      // If we came to start of buffer - that means vuffer is too small,\r\n      // return max too.\r\n      if (pos === 0) { return max; }\r\n\r\n      return (pos + _utf8len[buf[pos]] > max) ? pos : max;\r\n    };\r\n\r\n// convert array to string\r\n    var buf2string = function (buf) {\r\n      var str, i, out, c, c_len;\r\n      var len = buf.length;\r\n\r\n      // Reserve max possible length (2 words per char)\r\n      // NB: by unknown reasons, Array is significantly faster for\r\n      //     String.fromCharCode.apply than Uint16Array.\r\n      var utf16buf = new Array(len*2);\r\n\r\n      for (out=0, i=0; i<len;) {\r\n        c = buf[i++];\r\n        // quick process ascii\r\n        if (c < 0x80) { utf16buf[out++] = c; continue; }\r\n\r\n        c_len = _utf8len[c];\r\n        // skip 5 & 6 byte codes\r\n        if (c_len > 4) { utf16buf[out++] = 0xfffd; i += c_len-1; continue; }\r\n\r\n        // apply mask on first byte\r\n        c &= c_len === 2 ? 0x1f : c_len === 3 ? 0x0f : 0x07;\r\n        // join the rest\r\n        while (c_len > 1 && i < len) {\r\n          c = (c << 6) | (buf[i++] & 0x3f);\r\n          c_len--;\r\n        }\r\n\r\n        // terminated by end of string?\r\n        if (c_len > 1) { utf16buf[out++] = 0xfffd; continue; }\r\n\r\n        if (c < 0x10000) {\r\n          utf16buf[out++] = c;\r\n        } else {\r\n          c -= 0x10000;\r\n          utf16buf[out++] = 0xd800 | ((c >> 10) & 0x3ff);\r\n          utf16buf[out++] = 0xdc00 | (c & 0x3ff);\r\n        }\r\n      }\r\n\r\n      // shrinkBuf(utf16buf, out)\r\n      if (utf16buf.length !== out) {\r\n        if(utf16buf.subarray) {\r\n          utf16buf = utf16buf.subarray(0, out);\r\n        } else {\r\n          utf16buf.length = out;\r\n        }\r\n      }\r\n\r\n      // return String.fromCharCode.apply(null, utf16buf);\r\n      return utils.applyFromCharCode(utf16buf);\r\n    };\r\n\r\n\r\n// That's all for the pako functions.\r\n\r\n\r\n    /**\r\n     * Transform a javascript string into an array (typed if possible) of bytes,\r\n     * UTF-8 encoded.\r\n     * @param {String} str the string to encode\r\n     * @return {Array|Uint8Array|Buffer} the UTF-8 encoded string.\r\n     */\r\n    exports.utf8encode = function utf8encode(str) {\r\n      if (support.nodebuffer) {\r\n        return nodeBuffer(str, \"utf-8\");\r\n      }\r\n\r\n      return string2buf(str);\r\n    };\r\n\r\n\r\n    /**\r\n     * Transform a bytes array (or a representation) representing an UTF-8 encoded\r\n     * string into a javascript string.\r\n     * @param {Array|Uint8Array|Buffer} buf the data de decode\r\n     * @return {String} the decoded string.\r\n     */\r\n    exports.utf8decode = function utf8decode(buf) {\r\n      if (support.nodebuffer) {\r\n        return utils.transformTo(\"nodebuffer\", buf).toString(\"utf-8\");\r\n      }\r\n\r\n      buf = utils.transformTo(support.uint8array ? \"uint8array\" : \"array\", buf);\r\n\r\n      // return buf2string(buf);\r\n      // Chrome prefers to work with \"small\" chunks of data\r\n      // for the method buf2string.\r\n      // Firefox and Chrome has their own shortcut, IE doesn't seem to really care.\r\n      var result = [], k = 0, len = buf.length, chunk = 65536;\r\n      while (k < len) {\r\n        var nextBoundary = utf8border(buf, Math.min(k + chunk, len));\r\n        if (support.uint8array) {\r\n          result.push(buf2string(buf.subarray(k, nextBoundary)));\r\n        } else {\r\n          result.push(buf2string(buf.slice(k, nextBoundary)));\r\n        }\r\n        k = nextBoundary;\r\n      }\r\n      return result.join(\"\");\r\n\r\n    };\r\n// vim: set shiftwidth=4 softtabstop=4:\r\n\r\n  },{\"./nodeBuffer\":11,\"./support\":17,\"./utils\":21}],21:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    var support = _dereq_('./support');\r\n    var compressions = _dereq_('./compressions');\r\n    var nodeBuffer = _dereq_('./nodeBuffer');\r\n    /**\r\n     * Convert a string to a \"binary string\" : a string containing only char codes between 0 and 255.\r\n     * @param {string} str the string to transform.\r\n     * @return {String} the binary string.\r\n     */\r\n    exports.string2binary = function(str) {\r\n      var result = \"\";\r\n      for (var i = 0; i < str.length; i++) {\r\n        result += String.fromCharCode(str.charCodeAt(i) & 0xff);\r\n      }\r\n      return result;\r\n    };\r\n    exports.arrayBuffer2Blob = function(buffer) {\r\n      exports.checkSupport(\"blob\");\r\n\r\n      try {\r\n        // Blob constructor\r\n        return new Blob([buffer], {\r\n          type: \"application/zip\"\r\n        });\r\n      }\r\n      catch (e) {\r\n\r\n        try {\r\n          // deprecated, browser only, old way\r\n          var Builder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\r\n          var builder = new Builder();\r\n          builder.append(buffer);\r\n          return builder.getBlob('application/zip');\r\n        }\r\n        catch (e) {\r\n\r\n          // well, fuck ?!\r\n          throw new Error(\"Bug : can't construct the Blob.\");\r\n        }\r\n      }\r\n\r\n\r\n    };\r\n    /**\r\n     * The identity function.\r\n     * @param {Object} input the input.\r\n     * @return {Object} the same input.\r\n     */\r\n    function identity(input) {\r\n      return input;\r\n    }\r\n\r\n    /**\r\n     * Fill in an array with a string.\r\n     * @param {String} str the string to use.\r\n     * @param {Array|ArrayBuffer|Uint8Array|Buffer} array the array to fill in (will be mutated).\r\n     * @return {Array|ArrayBuffer|Uint8Array|Buffer} the updated array.\r\n     */\r\n    function stringToArrayLike(str, array) {\r\n      for (var i = 0; i < str.length; ++i) {\r\n        array[i] = str.charCodeAt(i) & 0xFF;\r\n      }\r\n      return array;\r\n    }\r\n\r\n    /**\r\n     * Transform an array-like object to a string.\r\n     * @param {Array|ArrayBuffer|Uint8Array|Buffer} array the array to transform.\r\n     * @return {String} the result.\r\n     */\r\n    function arrayLikeToString(array) {\r\n      // Performances notes :\r\n      // --------------------\r\n      // String.fromCharCode.apply(null, array) is the fastest, see\r\n      // see http://jsperf.com/converting-a-uint8array-to-a-string/2\r\n      // but the stack is limited (and we can get huge arrays !).\r\n      //\r\n      // result += String.fromCharCode(array[i]); generate too many strings !\r\n      //\r\n      // This code is inspired by http://jsperf.com/arraybuffer-to-string-apply-performance/2\r\n      var chunk = 65536;\r\n      var result = [],\r\n        len = array.length,\r\n        type = exports.getTypeOf(array),\r\n        k = 0,\r\n        canUseApply = true;\r\n      try {\r\n        switch(type) {\r\n          case \"uint8array\":\r\n            String.fromCharCode.apply(null, new Uint8Array(0));\r\n            break;\r\n          case \"nodebuffer\":\r\n            String.fromCharCode.apply(null, nodeBuffer(0));\r\n            break;\r\n        }\r\n      } catch(e) {\r\n        canUseApply = false;\r\n      }\r\n\r\n      // no apply : slow and painful algorithm\r\n      // default browser on android 4.*\r\n      if (!canUseApply) {\r\n        var resultStr = \"\";\r\n        for(var i = 0; i < array.length;i++) {\r\n          resultStr += String.fromCharCode(array[i]);\r\n        }\r\n        return resultStr;\r\n      }\r\n      while (k < len && chunk > 1) {\r\n        try {\r\n          if (type === \"array\" || type === \"nodebuffer\") {\r\n            result.push(String.fromCharCode.apply(null, array.slice(k, Math.min(k + chunk, len))));\r\n          }\r\n          else {\r\n            result.push(String.fromCharCode.apply(null, array.subarray(k, Math.min(k + chunk, len))));\r\n          }\r\n          k += chunk;\r\n        }\r\n        catch (e) {\r\n          chunk = Math.floor(chunk / 2);\r\n        }\r\n      }\r\n      return result.join(\"\");\r\n    }\r\n\r\n    exports.applyFromCharCode = arrayLikeToString;\r\n\r\n\r\n    /**\r\n     * Copy the data from an array-like to an other array-like.\r\n     * @param {Array|ArrayBuffer|Uint8Array|Buffer} arrayFrom the origin array.\r\n     * @param {Array|ArrayBuffer|Uint8Array|Buffer} arrayTo the destination array which will be mutated.\r\n     * @return {Array|ArrayBuffer|Uint8Array|Buffer} the updated destination array.\r\n     */\r\n    function arrayLikeToArrayLike(arrayFrom, arrayTo) {\r\n      for (var i = 0; i < arrayFrom.length; i++) {\r\n        arrayTo[i] = arrayFrom[i];\r\n      }\r\n      return arrayTo;\r\n    }\r\n\r\n// a matrix containing functions to transform everything into everything.\r\n    var transform = {};\r\n\r\n// string to ?\r\n    transform[\"string\"] = {\r\n      \"string\": identity,\r\n      \"array\": function(input) {\r\n        return stringToArrayLike(input, new Array(input.length));\r\n      },\r\n      \"arraybuffer\": function(input) {\r\n        return transform[\"string\"][\"uint8array\"](input).buffer;\r\n      },\r\n      \"uint8array\": function(input) {\r\n        return stringToArrayLike(input, new Uint8Array(input.length));\r\n      },\r\n      \"nodebuffer\": function(input) {\r\n        return stringToArrayLike(input, nodeBuffer(input.length));\r\n      }\r\n    };\r\n\r\n// array to ?\r\n    transform[\"array\"] = {\r\n      \"string\": arrayLikeToString,\r\n      \"array\": identity,\r\n      \"arraybuffer\": function(input) {\r\n        return (new Uint8Array(input)).buffer;\r\n      },\r\n      \"uint8array\": function(input) {\r\n        return new Uint8Array(input);\r\n      },\r\n      \"nodebuffer\": function(input) {\r\n        return nodeBuffer(input);\r\n      }\r\n    };\r\n\r\n// arraybuffer to ?\r\n    transform[\"arraybuffer\"] = {\r\n      \"string\": function(input) {\r\n        return arrayLikeToString(new Uint8Array(input));\r\n      },\r\n      \"array\": function(input) {\r\n        return arrayLikeToArrayLike(new Uint8Array(input), new Array(input.byteLength));\r\n      },\r\n      \"arraybuffer\": identity,\r\n      \"uint8array\": function(input) {\r\n        return new Uint8Array(input);\r\n      },\r\n      \"nodebuffer\": function(input) {\r\n        return nodeBuffer(new Uint8Array(input));\r\n      }\r\n    };\r\n\r\n// uint8array to ?\r\n    transform[\"uint8array\"] = {\r\n      \"string\": arrayLikeToString,\r\n      \"array\": function(input) {\r\n        return arrayLikeToArrayLike(input, new Array(input.length));\r\n      },\r\n      \"arraybuffer\": function(input) {\r\n        return input.buffer;\r\n      },\r\n      \"uint8array\": identity,\r\n      \"nodebuffer\": function(input) {\r\n        return nodeBuffer(input);\r\n      }\r\n    };\r\n\r\n// nodebuffer to ?\r\n    transform[\"nodebuffer\"] = {\r\n      \"string\": arrayLikeToString,\r\n      \"array\": function(input) {\r\n        return arrayLikeToArrayLike(input, new Array(input.length));\r\n      },\r\n      \"arraybuffer\": function(input) {\r\n        return transform[\"nodebuffer\"][\"uint8array\"](input).buffer;\r\n      },\r\n      \"uint8array\": function(input) {\r\n        return arrayLikeToArrayLike(input, new Uint8Array(input.length));\r\n      },\r\n      \"nodebuffer\": identity\r\n    };\r\n\r\n    /**\r\n     * Transform an input into any type.\r\n     * The supported output type are : string, array, uint8array, arraybuffer, nodebuffer.\r\n     * If no output type is specified, the unmodified input will be returned.\r\n     * @param {String} outputType the output type.\r\n     * @param {String|Array|ArrayBuffer|Uint8Array|Buffer} input the input to convert.\r\n     * @throws {Error} an Error if the browser doesn't support the requested output type.\r\n     */\r\n    exports.transformTo = function(outputType, input) {\r\n      if (!input) {\r\n        // undefined, null, etc\r\n        // an empty string won't harm.\r\n        input = \"\";\r\n      }\r\n      if (!outputType) {\r\n        return input;\r\n      }\r\n      exports.checkSupport(outputType);\r\n      var inputType = exports.getTypeOf(input);\r\n      var result = transform[inputType][outputType](input);\r\n      return result;\r\n    };\r\n\r\n    /**\r\n     * Return the type of the input.\r\n     * The type will be in a format valid for JSZip.utils.transformTo : string, array, uint8array, arraybuffer.\r\n     * @param {Object} input the input to identify.\r\n     * @return {String} the (lowercase) type of the input.\r\n     */\r\n    exports.getTypeOf = function(input) {\r\n      if (typeof input === \"string\") {\r\n        return \"string\";\r\n      }\r\n      if (Object.prototype.toString.call(input) === \"[object Array]\") {\r\n        return \"array\";\r\n      }\r\n      if (support.nodebuffer && nodeBuffer.test(input)) {\r\n        return \"nodebuffer\";\r\n      }\r\n      if (support.uint8array && input instanceof Uint8Array) {\r\n        return \"uint8array\";\r\n      }\r\n      if (support.arraybuffer && input instanceof ArrayBuffer) {\r\n        return \"arraybuffer\";\r\n      }\r\n    };\r\n\r\n    /**\r\n     * Throw an exception if the type is not supported.\r\n     * @param {String} type the type to check.\r\n     * @throws {Error} an Error if the browser doesn't support the requested type.\r\n     */\r\n    exports.checkSupport = function(type) {\r\n      var supported = support[type.toLowerCase()];\r\n      if (!supported) {\r\n        throw new Error(type + \" is not supported by this browser\");\r\n      }\r\n    };\r\n    exports.MAX_VALUE_16BITS = 65535;\r\n    exports.MAX_VALUE_32BITS = -1; // well, \"\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF\\xFF\" is parsed as -1\r\n\r\n    /**\r\n     * Prettify a string read as binary.\r\n     * @param {string} str the string to prettify.\r\n     * @return {string} a pretty string.\r\n     */\r\n    exports.pretty = function(str) {\r\n      var res = '',\r\n        code, i;\r\n      for (i = 0; i < (str || \"\").length; i++) {\r\n        code = str.charCodeAt(i);\r\n        res += '\\\\x' + (code < 16 ? \"0\" : \"\") + code.toString(16).toUpperCase();\r\n      }\r\n      return res;\r\n    };\r\n\r\n    /**\r\n     * Find a compression registered in JSZip.\r\n     * @param {string} compressionMethod the method magic to find.\r\n     * @return {Object|null} the JSZip compression object, null if none found.\r\n     */\r\n    exports.findCompression = function(compressionMethod) {\r\n      for (var method in compressions) {\r\n        if (!compressions.hasOwnProperty(method)) {\r\n          continue;\r\n        }\r\n        if (compressions[method].magic === compressionMethod) {\r\n          return compressions[method];\r\n        }\r\n      }\r\n      return null;\r\n    };\r\n    /**\r\n     * Cross-window, cross-Node-context regular expression detection\r\n     * @param  {Object}  object Anything\r\n     * @return {Boolean}        true if the object is a regular expression,\r\n     * false otherwise\r\n     */\r\n    exports.isRegExp = function (object) {\r\n      return Object.prototype.toString.call(object) === \"[object RegExp]\";\r\n    };\r\n\r\n\r\n  },{\"./compressions\":3,\"./nodeBuffer\":11,\"./support\":17}],22:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    var StringReader = _dereq_('./stringReader');\r\n    var NodeBufferReader = _dereq_('./nodeBufferReader');\r\n    var Uint8ArrayReader = _dereq_('./uint8ArrayReader');\r\n    var utils = _dereq_('./utils');\r\n    var sig = _dereq_('./signature');\r\n    var ZipEntry = _dereq_('./zipEntry');\r\n    var support = _dereq_('./support');\r\n    var jszipProto = _dereq_('./object');\r\n//  class ZipEntries {{{\r\n    /**\r\n     * All the entries in the zip file.\r\n     * @constructor\r\n     * @param {String|ArrayBuffer|Uint8Array} data the binary stream to load.\r\n     * @param {Object} loadOptions Options for loading the stream.\r\n     */\r\n    function ZipEntries(data, loadOptions) {\r\n      this.files = [];\r\n      this.loadOptions = loadOptions;\r\n      if (data) {\r\n        this.load(data);\r\n      }\r\n    }\r\n    ZipEntries.prototype = {\r\n      /**\r\n       * Check that the reader is on the speficied signature.\r\n       * @param {string} expectedSignature the expected signature.\r\n       * @throws {Error} if it is an other signature.\r\n       */\r\n      checkSignature: function(expectedSignature) {\r\n        var signature = this.reader.readString(4);\r\n        if (signature !== expectedSignature) {\r\n          throw new Error(\"Corrupted zip or bug : unexpected signature \" + \"(\" + utils.pretty(signature) + \", expected \" + utils.pretty(expectedSignature) + \")\");\r\n        }\r\n      },\r\n      /**\r\n       * Read the end of the central directory.\r\n       */\r\n      readBlockEndOfCentral: function() {\r\n        this.diskNumber = this.reader.readInt(2);\r\n        this.diskWithCentralDirStart = this.reader.readInt(2);\r\n        this.centralDirRecordsOnThisDisk = this.reader.readInt(2);\r\n        this.centralDirRecords = this.reader.readInt(2);\r\n        this.centralDirSize = this.reader.readInt(4);\r\n        this.centralDirOffset = this.reader.readInt(4);\r\n\r\n        this.zipCommentLength = this.reader.readInt(2);\r\n        // warning : the encoding depends of the system locale\r\n        // On a linux machine with LANG=en_US.utf8, this field is utf8 encoded.\r\n        // On a windows machine, this field is encoded with the localized windows code page.\r\n        this.zipComment = this.reader.readString(this.zipCommentLength);\r\n        // To get consistent behavior with the generation part, we will assume that\r\n        // this is utf8 encoded.\r\n        this.zipComment = jszipProto.utf8decode(this.zipComment);\r\n      },\r\n      /**\r\n       * Read the end of the Zip 64 central directory.\r\n       * Not merged with the method readEndOfCentral :\r\n       * The end of central can coexist with its Zip64 brother,\r\n       * I don't want to read the wrong number of bytes !\r\n       */\r\n      readBlockZip64EndOfCentral: function() {\r\n        this.zip64EndOfCentralSize = this.reader.readInt(8);\r\n        this.versionMadeBy = this.reader.readString(2);\r\n        this.versionNeeded = this.reader.readInt(2);\r\n        this.diskNumber = this.reader.readInt(4);\r\n        this.diskWithCentralDirStart = this.reader.readInt(4);\r\n        this.centralDirRecordsOnThisDisk = this.reader.readInt(8);\r\n        this.centralDirRecords = this.reader.readInt(8);\r\n        this.centralDirSize = this.reader.readInt(8);\r\n        this.centralDirOffset = this.reader.readInt(8);\r\n\r\n        this.zip64ExtensibleData = {};\r\n        var extraDataSize = this.zip64EndOfCentralSize - 44,\r\n          index = 0,\r\n          extraFieldId,\r\n          extraFieldLength,\r\n          extraFieldValue;\r\n        while (index < extraDataSize) {\r\n          extraFieldId = this.reader.readInt(2);\r\n          extraFieldLength = this.reader.readInt(4);\r\n          extraFieldValue = this.reader.readString(extraFieldLength);\r\n          this.zip64ExtensibleData[extraFieldId] = {\r\n            id: extraFieldId,\r\n            length: extraFieldLength,\r\n            value: extraFieldValue\r\n          };\r\n        }\r\n      },\r\n      /**\r\n       * Read the end of the Zip 64 central directory locator.\r\n       */\r\n      readBlockZip64EndOfCentralLocator: function() {\r\n        this.diskWithZip64CentralDirStart = this.reader.readInt(4);\r\n        this.relativeOffsetEndOfZip64CentralDir = this.reader.readInt(8);\r\n        this.disksCount = this.reader.readInt(4);\r\n        if (this.disksCount > 1) {\r\n          throw new Error(\"Multi-volumes zip are not supported\");\r\n        }\r\n      },\r\n      /**\r\n       * Read the local files, based on the offset read in the central part.\r\n       */\r\n      readLocalFiles: function() {\r\n        var i, file;\r\n        for (i = 0; i < this.files.length; i++) {\r\n          file = this.files[i];\r\n          this.reader.setIndex(file.localHeaderOffset);\r\n          this.checkSignature(sig.LOCAL_FILE_HEADER);\r\n          file.readLocalPart(this.reader);\r\n          file.handleUTF8();\r\n        }\r\n      },\r\n      /**\r\n       * Read the central directory.\r\n       */\r\n      readCentralDir: function() {\r\n        var file;\r\n\r\n        this.reader.setIndex(this.centralDirOffset);\r\n        while (this.reader.readString(4) === sig.CENTRAL_FILE_HEADER) {\r\n          file = new ZipEntry({\r\n            zip64: this.zip64\r\n          }, this.loadOptions);\r\n          file.readCentralPart(this.reader);\r\n          this.files.push(file);\r\n        }\r\n      },\r\n      /**\r\n       * Read the end of central directory.\r\n       */\r\n      readEndOfCentral: function() {\r\n        var offset = this.reader.lastIndexOfSignature(sig.CENTRAL_DIRECTORY_END);\r\n        if (offset === -1) {\r\n          throw new Error(\"Corrupted zip : can't find end of central directory\");\r\n        }\r\n        this.reader.setIndex(offset);\r\n        this.checkSignature(sig.CENTRAL_DIRECTORY_END);\r\n        this.readBlockEndOfCentral();\r\n\r\n\r\n        /* extract from the zip spec :\r\n            4)  If one of the fields in the end of central directory\r\n                record is too small to hold required data, the field\r\n                should be set to -1 (0xFFFF or 0xFFFFFFFF) and the\r\n                ZIP64 format record should be created.\r\n            5)  The end of central directory record and the\r\n                Zip64 end of central directory locator record must\r\n                reside on the same disk when splitting or spanning\r\n                an archive.\r\n         */\r\n        if (this.diskNumber === utils.MAX_VALUE_16BITS || this.diskWithCentralDirStart === utils.MAX_VALUE_16BITS || this.centralDirRecordsOnThisDisk === utils.MAX_VALUE_16BITS || this.centralDirRecords === utils.MAX_VALUE_16BITS || this.centralDirSize === utils.MAX_VALUE_32BITS || this.centralDirOffset === utils.MAX_VALUE_32BITS) {\r\n          this.zip64 = true;\r\n\r\n          /*\r\n            Warning : the zip64 extension is supported, but ONLY if the 64bits integer read from\r\n            the zip file can fit into a 32bits integer. This cannot be solved : Javascript represents\r\n            all numbers as 64-bit double precision IEEE 754 floating point numbers.\r\n            So, we have 53bits for integers and bitwise operations treat everything as 32bits.\r\n            see https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Bitwise_Operators\r\n            and http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-262.pdf section 8.5\r\n            */\r\n\r\n          // should look for a zip64 EOCD locator\r\n          offset = this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR);\r\n          if (offset === -1) {\r\n            throw new Error(\"Corrupted zip : can't find the ZIP64 end of central directory locator\");\r\n          }\r\n          this.reader.setIndex(offset);\r\n          this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR);\r\n          this.readBlockZip64EndOfCentralLocator();\r\n\r\n          // now the zip64 EOCD record\r\n          this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);\r\n          this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_END);\r\n          this.readBlockZip64EndOfCentral();\r\n        }\r\n      },\r\n      prepareReader: function(data) {\r\n        var type = utils.getTypeOf(data);\r\n        if (type === \"string\" && !support.uint8array) {\r\n          this.reader = new StringReader(data, this.loadOptions.optimizedBinaryString);\r\n        }\r\n        else if (type === \"nodebuffer\") {\r\n          this.reader = new NodeBufferReader(data);\r\n        }\r\n        else {\r\n          this.reader = new Uint8ArrayReader(utils.transformTo(\"uint8array\", data));\r\n        }\r\n      },\r\n      /**\r\n       * Read a zip file and create ZipEntries.\r\n       * @param {String|ArrayBuffer|Uint8Array|Buffer} data the binary string representing a zip file.\r\n       */\r\n      load: function(data) {\r\n        this.prepareReader(data);\r\n        this.readEndOfCentral();\r\n        this.readCentralDir();\r\n        this.readLocalFiles();\r\n      }\r\n    };\r\n// }}} end of ZipEntries\r\n    module.exports = ZipEntries;\r\n\r\n  },{\"./nodeBufferReader\":12,\"./object\":13,\"./signature\":14,\"./stringReader\":15,\"./support\":17,\"./uint8ArrayReader\":18,\"./utils\":21,\"./zipEntry\":23}],23:[function(_dereq_,module,exports){\r\n    'use strict';\r\n    var StringReader = _dereq_('./stringReader');\r\n    var utils = _dereq_('./utils');\r\n    var CompressedObject = _dereq_('./compressedObject');\r\n    var jszipProto = _dereq_('./object');\r\n// class ZipEntry {{{\r\n    /**\r\n     * An entry in the zip file.\r\n     * @constructor\r\n     * @param {Object} options Options of the current file.\r\n     * @param {Object} loadOptions Options for loading the stream.\r\n     */\r\n    function ZipEntry(options, loadOptions) {\r\n      this.options = options;\r\n      this.loadOptions = loadOptions;\r\n    }\r\n    ZipEntry.prototype = {\r\n      /**\r\n       * say if the file is encrypted.\r\n       * @return {boolean} true if the file is encrypted, false otherwise.\r\n       */\r\n      isEncrypted: function() {\r\n        // bit 1 is set\r\n        return (this.bitFlag & 0x0001) === 0x0001;\r\n      },\r\n      /**\r\n       * say if the file has utf-8 filename/comment.\r\n       * @return {boolean} true if the filename/comment is in utf-8, false otherwise.\r\n       */\r\n      useUTF8: function() {\r\n        // bit 11 is set\r\n        return (this.bitFlag & 0x0800) === 0x0800;\r\n      },\r\n      /**\r\n       * Prepare the function used to generate the compressed content from this ZipFile.\r\n       * @param {DataReader} reader the reader to use.\r\n       * @param {number} from the offset from where we should read the data.\r\n       * @param {number} length the length of the data to read.\r\n       * @return {Function} the callback to get the compressed content (the type depends of the DataReader class).\r\n       */\r\n      prepareCompressedContent: function(reader, from, length) {\r\n        return function() {\r\n          var previousIndex = reader.index;\r\n          reader.setIndex(from);\r\n          var compressedFileData = reader.readData(length);\r\n          reader.setIndex(previousIndex);\r\n\r\n          return compressedFileData;\r\n        };\r\n      },\r\n      /**\r\n       * Prepare the function used to generate the uncompressed content from this ZipFile.\r\n       * @param {DataReader} reader the reader to use.\r\n       * @param {number} from the offset from where we should read the data.\r\n       * @param {number} length the length of the data to read.\r\n       * @param {JSZip.compression} compression the compression used on this file.\r\n       * @param {number} uncompressedSize the uncompressed size to expect.\r\n       * @return {Function} the callback to get the uncompressed content (the type depends of the DataReader class).\r\n       */\r\n      prepareContent: function(reader, from, length, compression, uncompressedSize) {\r\n        return function() {\r\n\r\n          var compressedFileData = utils.transformTo(compression.uncompressInputType, this.getCompressedContent());\r\n          var uncompressedFileData = compression.uncompress(compressedFileData);\r\n\r\n          if (uncompressedFileData.length !== uncompressedSize) {\r\n            throw new Error(\"Bug : uncompressed data size mismatch\");\r\n          }\r\n\r\n          return uncompressedFileData;\r\n        };\r\n      },\r\n      /**\r\n       * Read the local part of a zip file and add the info in this object.\r\n       * @param {DataReader} reader the reader to use.\r\n       */\r\n      readLocalPart: function(reader) {\r\n        var compression, localExtraFieldsLength;\r\n\r\n        // we already know everything from the central dir !\r\n        // If the central dir data are false, we are doomed.\r\n        // On the bright side, the local part is scary  : zip64, data descriptors, both, etc.\r\n        // The less data we get here, the more reliable this should be.\r\n        // Let's skip the whole header and dash to the data !\r\n        reader.skip(22);\r\n        // in some zip created on windows, the filename stored in the central dir contains \\ instead of /.\r\n        // Strangely, the filename here is OK.\r\n        // I would love to treat these zip files as corrupted (see http://www.info-zip.org/FAQ.html#backslashes\r\n        // or APPNOTE#4.4.17.1, \"All slashes MUST be forward slashes '/'\") but there are a lot of bad zip generators...\r\n        // Search \"unzip mismatching \"local\" filename continuing with \"central\" filename version\" on\r\n        // the internet.\r\n        //\r\n        // I think I see the logic here : the central directory is used to display\r\n        // content and the local directory is used to extract the files. Mixing / and \\\r\n        // may be used to display \\ to windows users and use / when extracting the files.\r\n        // Unfortunately, this lead also to some issues : http://seclists.org/fulldisclosure/2009/Sep/394\r\n        this.fileNameLength = reader.readInt(2);\r\n        localExtraFieldsLength = reader.readInt(2); // can't be sure this will be the same as the central dir\r\n        this.fileName = reader.readString(this.fileNameLength);\r\n        reader.skip(localExtraFieldsLength);\r\n\r\n        if (this.compressedSize == -1 || this.uncompressedSize == -1) {\r\n          throw new Error(\"Bug or corrupted zip : didn't get enough informations from the central directory \" + \"(compressedSize == -1 || uncompressedSize == -1)\");\r\n        }\r\n\r\n        compression = utils.findCompression(this.compressionMethod);\r\n        if (compression === null) { // no compression found\r\n          throw new Error(\"Corrupted zip : compression \" + utils.pretty(this.compressionMethod) + \" unknown (inner file : \" + this.fileName + \")\");\r\n        }\r\n        this.decompressed = new CompressedObject();\r\n        this.decompressed.compressedSize = this.compressedSize;\r\n        this.decompressed.uncompressedSize = this.uncompressedSize;\r\n        this.decompressed.crc32 = this.crc32;\r\n        this.decompressed.compressionMethod = this.compressionMethod;\r\n        this.decompressed.getCompressedContent = this.prepareCompressedContent(reader, reader.index, this.compressedSize, compression);\r\n        this.decompressed.getContent = this.prepareContent(reader, reader.index, this.compressedSize, compression, this.uncompressedSize);\r\n\r\n        // we need to compute the crc32...\r\n        if (this.loadOptions.checkCRC32) {\r\n          this.decompressed = utils.transformTo(\"string\", this.decompressed.getContent());\r\n          if (jszipProto.crc32(this.decompressed) !== this.crc32) {\r\n            throw new Error(\"Corrupted zip : CRC32 mismatch\");\r\n          }\r\n        }\r\n      },\r\n\r\n      /**\r\n       * Read the central part of a zip file and add the info in this object.\r\n       * @param {DataReader} reader the reader to use.\r\n       */\r\n      readCentralPart: function(reader) {\r\n        this.versionMadeBy = reader.readString(2);\r\n        this.versionNeeded = reader.readInt(2);\r\n        this.bitFlag = reader.readInt(2);\r\n        this.compressionMethod = reader.readString(2);\r\n        this.date = reader.readDate();\r\n        this.crc32 = reader.readInt(4);\r\n        this.compressedSize = reader.readInt(4);\r\n        this.uncompressedSize = reader.readInt(4);\r\n        this.fileNameLength = reader.readInt(2);\r\n        this.extraFieldsLength = reader.readInt(2);\r\n        this.fileCommentLength = reader.readInt(2);\r\n        this.diskNumberStart = reader.readInt(2);\r\n        this.internalFileAttributes = reader.readInt(2);\r\n        this.externalFileAttributes = reader.readInt(4);\r\n        this.localHeaderOffset = reader.readInt(4);\r\n\r\n        if (this.isEncrypted()) {\r\n          throw new Error(\"Encrypted zip are not supported\");\r\n        }\r\n\r\n        this.fileName = reader.readString(this.fileNameLength);\r\n        this.readExtraFields(reader);\r\n        this.parseZIP64ExtraField(reader);\r\n        this.fileComment = reader.readString(this.fileCommentLength);\r\n\r\n        // warning, this is true only for zip with madeBy == DOS (plateform dependent feature)\r\n        this.dir = this.externalFileAttributes & 0x00000010 ? true : false;\r\n      },\r\n      /**\r\n       * Parse the ZIP64 extra field and merge the info in the current ZipEntry.\r\n       * @param {DataReader} reader the reader to use.\r\n       */\r\n      parseZIP64ExtraField: function(reader) {\r\n\r\n        if (!this.extraFields[0x0001]) {\r\n          return;\r\n        }\r\n\r\n        // should be something, preparing the extra reader\r\n        var extraReader = new StringReader(this.extraFields[0x0001].value);\r\n\r\n        // I really hope that these 64bits integer can fit in 32 bits integer, because js\r\n        // won't let us have more.\r\n        if (this.uncompressedSize === utils.MAX_VALUE_32BITS) {\r\n          this.uncompressedSize = extraReader.readInt(8);\r\n        }\r\n        if (this.compressedSize === utils.MAX_VALUE_32BITS) {\r\n          this.compressedSize = extraReader.readInt(8);\r\n        }\r\n        if (this.localHeaderOffset === utils.MAX_VALUE_32BITS) {\r\n          this.localHeaderOffset = extraReader.readInt(8);\r\n        }\r\n        if (this.diskNumberStart === utils.MAX_VALUE_32BITS) {\r\n          this.diskNumberStart = extraReader.readInt(4);\r\n        }\r\n      },\r\n      /**\r\n       * Read the central part of a zip file and add the info in this object.\r\n       * @param {DataReader} reader the reader to use.\r\n       */\r\n      readExtraFields: function(reader) {\r\n        var start = reader.index,\r\n          extraFieldId,\r\n          extraFieldLength,\r\n          extraFieldValue;\r\n\r\n        this.extraFields = this.extraFields || {};\r\n\r\n        while (reader.index < start + this.extraFieldsLength) {\r\n          extraFieldId = reader.readInt(2);\r\n          extraFieldLength = reader.readInt(2);\r\n          extraFieldValue = reader.readString(extraFieldLength);\r\n\r\n          this.extraFields[extraFieldId] = {\r\n            id: extraFieldId,\r\n            length: extraFieldLength,\r\n            value: extraFieldValue\r\n          };\r\n        }\r\n      },\r\n      /**\r\n       * Apply an UTF8 transformation if needed.\r\n       */\r\n      handleUTF8: function() {\r\n        if (this.useUTF8()) {\r\n          this.fileName = jszipProto.utf8decode(this.fileName);\r\n          this.fileComment = jszipProto.utf8decode(this.fileComment);\r\n        } else {\r\n          var upath = this.findExtraFieldUnicodePath();\r\n          if (upath !== null) {\r\n            this.fileName = upath;\r\n          }\r\n          var ucomment = this.findExtraFieldUnicodeComment();\r\n          if (ucomment !== null) {\r\n            this.fileComment = ucomment;\r\n          }\r\n        }\r\n      },\r\n\r\n      /**\r\n       * Find the unicode path declared in the extra field, if any.\r\n       * @return {String} the unicode path, null otherwise.\r\n       */\r\n      findExtraFieldUnicodePath: function() {\r\n        var upathField = this.extraFields[0x7075];\r\n        if (upathField) {\r\n          var extraReader = new StringReader(upathField.value);\r\n\r\n          // wrong version\r\n          if (extraReader.readInt(1) !== 1) {\r\n            return null;\r\n          }\r\n\r\n          // the crc of the filename changed, this field is out of date.\r\n          if (jszipProto.crc32(this.fileName) !== extraReader.readInt(4)) {\r\n            return null;\r\n          }\r\n\r\n          return jszipProto.utf8decode(extraReader.readString(upathField.length - 5));\r\n        }\r\n        return null;\r\n      },\r\n\r\n      /**\r\n       * Find the unicode comment declared in the extra field, if any.\r\n       * @return {String} the unicode comment, null otherwise.\r\n       */\r\n      findExtraFieldUnicodeComment: function() {\r\n        var ucommentField = this.extraFields[0x6375];\r\n        if (ucommentField) {\r\n          var extraReader = new StringReader(ucommentField.value);\r\n\r\n          // wrong version\r\n          if (extraReader.readInt(1) !== 1) {\r\n            return null;\r\n          }\r\n\r\n          // the crc of the comment changed, this field is out of date.\r\n          if (jszipProto.crc32(this.fileComment) !== extraReader.readInt(4)) {\r\n            return null;\r\n          }\r\n\r\n          return jszipProto.utf8decode(extraReader.readString(ucommentField.length - 5));\r\n        }\r\n        return null;\r\n      }\r\n    };\r\n    module.exports = ZipEntry;\r\n\r\n  },{\"./compressedObject\":2,\"./object\":13,\"./stringReader\":15,\"./utils\":21}],24:[function(_dereq_,module,exports){\r\n// Top level file is just a mixin of submodules & constants\r\n    'use strict';\r\n\r\n    var assign    = _dereq_('./lib/utils/common').assign;\r\n\r\n    var deflate   = _dereq_('./lib/deflate');\r\n    var inflate   = _dereq_('./lib/inflate');\r\n    var constants = _dereq_('./lib/zlib/constants');\r\n\r\n    var pako = {};\r\n\r\n    assign(pako, deflate, inflate, constants);\r\n\r\n    module.exports = pako;\r\n  },{\"./lib/deflate\":25,\"./lib/inflate\":26,\"./lib/utils/common\":27,\"./lib/zlib/constants\":30}],25:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n\r\n    var zlib_deflate = _dereq_('./zlib/deflate.js');\r\n    var utils = _dereq_('./utils/common');\r\n    var strings = _dereq_('./utils/strings');\r\n    var msg = _dereq_('./zlib/messages');\r\n    var zstream = _dereq_('./zlib/zstream');\r\n\r\n\r\n    /* Public constants ==========================================================*/\r\n    /* ===========================================================================*/\r\n\r\n    var Z_NO_FLUSH      = 0;\r\n    var Z_FINISH        = 4;\r\n\r\n    var Z_OK            = 0;\r\n    var Z_STREAM_END    = 1;\r\n\r\n    var Z_DEFAULT_COMPRESSION = -1;\r\n\r\n    var Z_DEFAULT_STRATEGY    = 0;\r\n\r\n    var Z_DEFLATED  = 8;\r\n\r\n    /* ===========================================================================*/\r\n\r\n\r\n    /**\r\n     * class Deflate\r\n     *\r\n     * Generic JS-style wrapper for zlib calls. If you don't need\r\n     * streaming behaviour - use more simple functions: [[deflate]],\r\n     * [[deflateRaw]] and [[gzip]].\r\n     **/\r\n\r\n    /* internal\r\n * Deflate.chunks -> Array\r\n *\r\n * Chunks of output data, if [[Deflate#onData]] not overriden.\r\n **/\r\n\r\n    /**\r\n     * Deflate.result -> Uint8Array|Array\r\n     *\r\n     * Compressed result, generated by default [[Deflate#onData]]\r\n     * and [[Deflate#onEnd]] handlers. Filled after you push last chunk\r\n     * (call [[Deflate#push]] with `Z_FINISH` / `true` param).\r\n     **/\r\n\r\n    /**\r\n     * Deflate.err -> Number\r\n     *\r\n     * Error code after deflate finished. 0 (Z_OK) on success.\r\n     * You will not need it in real life, because deflate errors\r\n     * are possible only on wrong options or bad `onData` / `onEnd`\r\n     * custom handlers.\r\n     **/\r\n\r\n    /**\r\n     * Deflate.msg -> String\r\n     *\r\n     * Error message, if [[Deflate.err]] != 0\r\n     **/\r\n\r\n\r\n    /**\r\n     * new Deflate(options)\r\n     * - options (Object): zlib deflate options.\r\n     *\r\n     * Creates new deflator instance with specified params. Throws exception\r\n     * on bad params. Supported options:\r\n     *\r\n     * - `level`\r\n     * - `windowBits`\r\n     * - `memLevel`\r\n     * - `strategy`\r\n     *\r\n     * [http://zlib.net/manual.html#Advanced](http://zlib.net/manual.html#Advanced)\r\n     * for more information on these.\r\n     *\r\n     * Additional options, for internal needs:\r\n     *\r\n     * - `chunkSize` - size of generated data chunks (16K by default)\r\n     * - `raw` (Boolean) - do raw deflate\r\n     * - `gzip` (Boolean) - create gzip wrapper\r\n     * - `to` (String) - if equal to 'string', then result will be \"binary string\"\r\n     *    (each char code [0..255])\r\n     * - `header` (Object) - custom header for gzip\r\n     *   - `text` (Boolean) - true if compressed data believed to be text\r\n     *   - `time` (Number) - modification time, unix timestamp\r\n     *   - `os` (Number) - operation system code\r\n     *   - `extra` (Array) - array of bytes with extra data (max 65536)\r\n     *   - `name` (String) - file name (binary string)\r\n     *   - `comment` (String) - comment (binary string)\r\n     *   - `hcrc` (Boolean) - true if header crc should be added\r\n     *\r\n     * ##### Example:\r\n     *\r\n     * ```javascript\r\n     * var pako = require('pako')\r\n     *   , chunk1 = Uint8Array([1,2,3,4,5,6,7,8,9])\r\n     *   , chunk2 = Uint8Array([10,11,12,13,14,15,16,17,18,19]);\r\n     *\r\n     * var deflate = new pako.Deflate({ level: 3});\r\n     *\r\n     * deflate.push(chunk1, false);\r\n     * deflate.push(chunk2, true);  // true -> last chunk\r\n     *\r\n     * if (deflate.err) { throw new Error(deflate.err); }\r\n     *\r\n     * console.log(deflate.result);\r\n     * ```\r\n     **/\r\n    var Deflate = function(options) {\r\n\r\n      this.options = utils.assign({\r\n        level: Z_DEFAULT_COMPRESSION,\r\n        method: Z_DEFLATED,\r\n        chunkSize: 16384,\r\n        windowBits: 15,\r\n        memLevel: 8,\r\n        strategy: Z_DEFAULT_STRATEGY,\r\n        to: ''\r\n      }, options || {});\r\n\r\n      var opt = this.options;\r\n\r\n      if (opt.raw && (opt.windowBits > 0)) {\r\n        opt.windowBits = -opt.windowBits;\r\n      }\r\n\r\n      else if (opt.gzip && (opt.windowBits > 0) && (opt.windowBits < 16)) {\r\n        opt.windowBits += 16;\r\n      }\r\n\r\n      this.err    = 0;      // error code, if happens (0 = Z_OK)\r\n      this.msg    = '';     // error message\r\n      this.ended  = false;  // used to avoid multiple onEnd() calls\r\n      this.chunks = [];     // chunks of compressed data\r\n\r\n      this.strm = new zstream();\r\n      this.strm.avail_out = 0;\r\n\r\n      var status = zlib_deflate.deflateInit2(\r\n        this.strm,\r\n        opt.level,\r\n        opt.method,\r\n        opt.windowBits,\r\n        opt.memLevel,\r\n        opt.strategy\r\n      );\r\n\r\n      if (status !== Z_OK) {\r\n        throw new Error(msg[status]);\r\n      }\r\n\r\n      if (opt.header) {\r\n        zlib_deflate.deflateSetHeader(this.strm, opt.header);\r\n      }\r\n    };\r\n\r\n    /**\r\n     * Deflate#push(data[, mode]) -> Boolean\r\n     * - data (Uint8Array|Array|String): input data. Strings will be converted to\r\n     *   utf8 byte sequence.\r\n     * - mode (Number|Boolean): 0..6 for corresponding Z_NO_FLUSH..Z_TREE modes.\r\n     *   See constants. Skipped or `false` means Z_NO_FLUSH, `true` meansh Z_FINISH.\r\n     *\r\n     * Sends input data to deflate pipe, generating [[Deflate#onData]] calls with\r\n     * new compressed chunks. Returns `true` on success. The last data block must have\r\n     * mode Z_FINISH (or `true`). That flush internal pending buffers and call\r\n     * [[Deflate#onEnd]].\r\n     *\r\n     * On fail call [[Deflate#onEnd]] with error code and return false.\r\n     *\r\n     * We strongly recommend to use `Uint8Array` on input for best speed (output\r\n     * array format is detected automatically). Also, don't skip last param and always\r\n     * use the same type in your code (boolean or number). That will improve JS speed.\r\n     *\r\n     * For regular `Array`-s make sure all elements are [0..255].\r\n     *\r\n     * ##### Example\r\n     *\r\n     * ```javascript\r\n     * push(chunk, false); // push one of data chunks\r\n     * ...\r\n     * push(chunk, true);  // push last chunk\r\n     * ```\r\n     **/\r\n    Deflate.prototype.push = function(data, mode) {\r\n      var strm = this.strm;\r\n      var chunkSize = this.options.chunkSize;\r\n      var status, _mode;\r\n\r\n      if (this.ended) { return false; }\r\n\r\n      _mode = (mode === ~~mode) ? mode : ((mode === true) ? Z_FINISH : Z_NO_FLUSH);\r\n\r\n      // Convert data if needed\r\n      if (typeof data === 'string') {\r\n        // If we need to compress text, change encoding to utf8.\r\n        strm.input = strings.string2buf(data);\r\n      } else {\r\n        strm.input = data;\r\n      }\r\n\r\n      strm.next_in = 0;\r\n      strm.avail_in = strm.input.length;\r\n\r\n      do {\r\n        if (strm.avail_out === 0) {\r\n          strm.output = new utils.Buf8(chunkSize);\r\n          strm.next_out = 0;\r\n          strm.avail_out = chunkSize;\r\n        }\r\n        status = zlib_deflate.deflate(strm, _mode);    /* no bad return value */\r\n\r\n        if (status !== Z_STREAM_END && status !== Z_OK) {\r\n          this.onEnd(status);\r\n          this.ended = true;\r\n          return false;\r\n        }\r\n        if (strm.avail_out === 0 || (strm.avail_in === 0 && _mode === Z_FINISH)) {\r\n          if (this.options.to === 'string') {\r\n            this.onData(strings.buf2binstring(utils.shrinkBuf(strm.output, strm.next_out)));\r\n          } else {\r\n            this.onData(utils.shrinkBuf(strm.output, strm.next_out));\r\n          }\r\n        }\r\n      } while ((strm.avail_in > 0 || strm.avail_out === 0) && status !== Z_STREAM_END);\r\n\r\n      // Finalize on the last chunk.\r\n      if (_mode === Z_FINISH) {\r\n        status = zlib_deflate.deflateEnd(this.strm);\r\n        this.onEnd(status);\r\n        this.ended = true;\r\n        return status === Z_OK;\r\n      }\r\n\r\n      return true;\r\n    };\r\n\r\n\r\n    /**\r\n     * Deflate#onData(chunk) -> Void\r\n     * - chunk (Uint8Array|Array|String): ouput data. Type of array depends\r\n     *   on js engine support. When string output requested, each chunk\r\n     *   will be string.\r\n     *\r\n     * By default, stores data blocks in `chunks[]` property and glue\r\n     * those in `onEnd`. Override this handler, if you need another behaviour.\r\n     **/\r\n    Deflate.prototype.onData = function(chunk) {\r\n      this.chunks.push(chunk);\r\n    };\r\n\r\n\r\n    /**\r\n     * Deflate#onEnd(status) -> Void\r\n     * - status (Number): deflate status. 0 (Z_OK) on success,\r\n     *   other if not.\r\n     *\r\n     * Called once after you tell deflate that input stream complete\r\n     * or error happenned. By default - join collected chunks,\r\n     * free memory and fill `results` / `err` properties.\r\n     **/\r\n    Deflate.prototype.onEnd = function(status) {\r\n      // On success - join\r\n      if (status === Z_OK) {\r\n        if (this.options.to === 'string') {\r\n          this.result = this.chunks.join('');\r\n        } else {\r\n          this.result = utils.flattenChunks(this.chunks);\r\n        }\r\n      }\r\n      this.chunks = [];\r\n      this.err = status;\r\n      this.msg = this.strm.msg;\r\n    };\r\n\r\n\r\n    /**\r\n     * deflate(data[, options]) -> Uint8Array|Array|String\r\n     * - data (Uint8Array|Array|String): input data to compress.\r\n     * - options (Object): zlib deflate options.\r\n     *\r\n     * Compress `data` with deflate alrorythm and `options`.\r\n     *\r\n     * Supported options are:\r\n     *\r\n     * - level\r\n     * - windowBits\r\n     * - memLevel\r\n     * - strategy\r\n     *\r\n     * [http://zlib.net/manual.html#Advanced](http://zlib.net/manual.html#Advanced)\r\n     * for more information on these.\r\n     *\r\n     * Sugar (options):\r\n     *\r\n     * - `raw` (Boolean) - say that we work with raw stream, if you don't wish to specify\r\n     *   negative windowBits implicitly.\r\n     * - `to` (String) - if equal to 'string', then result will be \"binary string\"\r\n     *    (each char code [0..255])\r\n     *\r\n     * ##### Example:\r\n     *\r\n     * ```javascript\r\n     * var pako = require('pako')\r\n     *   , data = Uint8Array([1,2,3,4,5,6,7,8,9]);\r\n     *\r\n     * console.log(pako.deflate(data));\r\n     * ```\r\n     **/\r\n    function deflate(input, options) {\r\n      var deflator = new Deflate(options);\r\n\r\n      deflator.push(input, true);\r\n\r\n      // That will never happens, if you don't cheat with options :)\r\n      if (deflator.err) { throw deflator.msg; }\r\n\r\n      return deflator.result;\r\n    }\r\n\r\n\r\n    /**\r\n     * deflateRaw(data[, options]) -> Uint8Array|Array|String\r\n     * - data (Uint8Array|Array|String): input data to compress.\r\n     * - options (Object): zlib deflate options.\r\n     *\r\n     * The same as [[deflate]], but creates raw data, without wrapper\r\n     * (header and adler32 crc).\r\n     **/\r\n    function deflateRaw(input, options) {\r\n      options = options || {};\r\n      options.raw = true;\r\n      return deflate(input, options);\r\n    }\r\n\r\n\r\n    /**\r\n     * gzip(data[, options]) -> Uint8Array|Array|String\r\n     * - data (Uint8Array|Array|String): input data to compress.\r\n     * - options (Object): zlib deflate options.\r\n     *\r\n     * The same as [[deflate]], but create gzip wrapper instead of\r\n     * deflate one.\r\n     **/\r\n    function gzip(input, options) {\r\n      options = options || {};\r\n      options.gzip = true;\r\n      return deflate(input, options);\r\n    }\r\n\r\n\r\n    exports.Deflate = Deflate;\r\n    exports.deflate = deflate;\r\n    exports.deflateRaw = deflateRaw;\r\n    exports.gzip = gzip;\r\n  },{\"./utils/common\":27,\"./utils/strings\":28,\"./zlib/deflate.js\":32,\"./zlib/messages\":37,\"./zlib/zstream\":39}],26:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n\r\n    var zlib_inflate = _dereq_('./zlib/inflate.js');\r\n    var utils = _dereq_('./utils/common');\r\n    var strings = _dereq_('./utils/strings');\r\n    var c = _dereq_('./zlib/constants');\r\n    var msg = _dereq_('./zlib/messages');\r\n    var zstream = _dereq_('./zlib/zstream');\r\n    var gzheader = _dereq_('./zlib/gzheader');\r\n\r\n\r\n    /**\r\n     * class Inflate\r\n     *\r\n     * Generic JS-style wrapper for zlib calls. If you don't need\r\n     * streaming behaviour - use more simple functions: [[inflate]]\r\n     * and [[inflateRaw]].\r\n     **/\r\n\r\n    /* internal\r\n * inflate.chunks -> Array\r\n *\r\n * Chunks of output data, if [[Inflate#onData]] not overriden.\r\n **/\r\n\r\n    /**\r\n     * Inflate.result -> Uint8Array|Array|String\r\n     *\r\n     * Uncompressed result, generated by default [[Inflate#onData]]\r\n     * and [[Inflate#onEnd]] handlers. Filled after you push last chunk\r\n     * (call [[Inflate#push]] with `Z_FINISH` / `true` param).\r\n     **/\r\n\r\n    /**\r\n     * Inflate.err -> Number\r\n     *\r\n     * Error code after inflate finished. 0 (Z_OK) on success.\r\n     * Should be checked if broken data possible.\r\n     **/\r\n\r\n    /**\r\n     * Inflate.msg -> String\r\n     *\r\n     * Error message, if [[Inflate.err]] != 0\r\n     **/\r\n\r\n\r\n    /**\r\n     * new Inflate(options)\r\n     * - options (Object): zlib inflate options.\r\n     *\r\n     * Creates new inflator instance with specified params. Throws exception\r\n     * on bad params. Supported options:\r\n     *\r\n     * - `windowBits`\r\n     *\r\n     * [http://zlib.net/manual.html#Advanced](http://zlib.net/manual.html#Advanced)\r\n     * for more information on these.\r\n     *\r\n     * Additional options, for internal needs:\r\n     *\r\n     * - `chunkSize` - size of generated data chunks (16K by default)\r\n     * - `raw` (Boolean) - do raw inflate\r\n     * - `to` (String) - if equal to 'string', then result will be converted\r\n     *   from utf8 to utf16 (javascript) string. When string output requested,\r\n     *   chunk length can differ from `chunkSize`, depending on content.\r\n     *\r\n     * By default, when no options set, autodetect deflate/gzip data format via\r\n     * wrapper header.\r\n     *\r\n     * ##### Example:\r\n     *\r\n     * ```javascript\r\n     * var pako = require('pako')\r\n     *   , chunk1 = Uint8Array([1,2,3,4,5,6,7,8,9])\r\n     *   , chunk2 = Uint8Array([10,11,12,13,14,15,16,17,18,19]);\r\n     *\r\n     * var inflate = new pako.Inflate({ level: 3});\r\n     *\r\n     * inflate.push(chunk1, false);\r\n     * inflate.push(chunk2, true);  // true -> last chunk\r\n     *\r\n     * if (inflate.err) { throw new Error(inflate.err); }\r\n     *\r\n     * console.log(inflate.result);\r\n     * ```\r\n     **/\r\n    var Inflate = function(options) {\r\n\r\n      this.options = utils.assign({\r\n        chunkSize: 16384,\r\n        windowBits: 0,\r\n        to: ''\r\n      }, options || {});\r\n\r\n      var opt = this.options;\r\n\r\n      // Force window size for `raw` data, if not set directly,\r\n      // because we have no header for autodetect.\r\n      if (opt.raw && (opt.windowBits >= 0) && (opt.windowBits < 16)) {\r\n        opt.windowBits = -opt.windowBits;\r\n        if (opt.windowBits === 0) { opt.windowBits = -15; }\r\n      }\r\n\r\n      // If `windowBits` not defined (and mode not raw) - set autodetect flag for gzip/deflate\r\n      if ((opt.windowBits >= 0) && (opt.windowBits < 16) &&\r\n        !(options && options.windowBits)) {\r\n        opt.windowBits += 32;\r\n      }\r\n\r\n      // Gzip header has no info about windows size, we can do autodetect only\r\n      // for deflate. So, if window size not set, force it to max when gzip possible\r\n      if ((opt.windowBits > 15) && (opt.windowBits < 48)) {\r\n        // bit 3 (16) -> gzipped data\r\n        // bit 4 (32) -> autodetect gzip/deflate\r\n        if ((opt.windowBits & 15) === 0) {\r\n          opt.windowBits |= 15;\r\n        }\r\n      }\r\n\r\n      this.err    = 0;      // error code, if happens (0 = Z_OK)\r\n      this.msg    = '';     // error message\r\n      this.ended  = false;  // used to avoid multiple onEnd() calls\r\n      this.chunks = [];     // chunks of compressed data\r\n\r\n      this.strm   = new zstream();\r\n      this.strm.avail_out = 0;\r\n\r\n      var status  = zlib_inflate.inflateInit2(\r\n        this.strm,\r\n        opt.windowBits\r\n      );\r\n\r\n      if (status !== c.Z_OK) {\r\n        throw new Error(msg[status]);\r\n      }\r\n\r\n      this.header = new gzheader();\r\n\r\n      zlib_inflate.inflateGetHeader(this.strm, this.header);\r\n    };\r\n\r\n    /**\r\n     * Inflate#push(data[, mode]) -> Boolean\r\n     * - data (Uint8Array|Array|String): input data\r\n     * - mode (Number|Boolean): 0..6 for corresponding Z_NO_FLUSH..Z_TREE modes.\r\n     *   See constants. Skipped or `false` means Z_NO_FLUSH, `true` meansh Z_FINISH.\r\n     *\r\n     * Sends input data to inflate pipe, generating [[Inflate#onData]] calls with\r\n     * new output chunks. Returns `true` on success. The last data block must have\r\n     * mode Z_FINISH (or `true`). That flush internal pending buffers and call\r\n     * [[Inflate#onEnd]].\r\n     *\r\n     * On fail call [[Inflate#onEnd]] with error code and return false.\r\n     *\r\n     * We strongly recommend to use `Uint8Array` on input for best speed (output\r\n     * format is detected automatically). Also, don't skip last param and always\r\n     * use the same type in your code (boolean or number). That will improve JS speed.\r\n     *\r\n     * For regular `Array`-s make sure all elements are [0..255].\r\n     *\r\n     * ##### Example\r\n     *\r\n     * ```javascript\r\n     * push(chunk, false); // push one of data chunks\r\n     * ...\r\n     * push(chunk, true);  // push last chunk\r\n     * ```\r\n     **/\r\n    Inflate.prototype.push = function(data, mode) {\r\n      var strm = this.strm;\r\n      var chunkSize = this.options.chunkSize;\r\n      var status, _mode;\r\n      var next_out_utf8, tail, utf8str;\r\n\r\n      if (this.ended) { return false; }\r\n      _mode = (mode === ~~mode) ? mode : ((mode === true) ? c.Z_FINISH : c.Z_NO_FLUSH);\r\n\r\n      // Convert data if needed\r\n      if (typeof data === 'string') {\r\n        // Only binary strings can be decompressed on practice\r\n        strm.input = strings.binstring2buf(data);\r\n      } else {\r\n        strm.input = data;\r\n      }\r\n\r\n      strm.next_in = 0;\r\n      strm.avail_in = strm.input.length;\r\n\r\n      do {\r\n        if (strm.avail_out === 0) {\r\n          strm.output = new utils.Buf8(chunkSize);\r\n          strm.next_out = 0;\r\n          strm.avail_out = chunkSize;\r\n        }\r\n\r\n        status = zlib_inflate.inflate(strm, c.Z_NO_FLUSH);    /* no bad return value */\r\n\r\n        if (status !== c.Z_STREAM_END && status !== c.Z_OK) {\r\n          this.onEnd(status);\r\n          this.ended = true;\r\n          return false;\r\n        }\r\n\r\n        if (strm.next_out) {\r\n          if (strm.avail_out === 0 || status === c.Z_STREAM_END || (strm.avail_in === 0 && _mode === c.Z_FINISH)) {\r\n\r\n            if (this.options.to === 'string') {\r\n\r\n              next_out_utf8 = strings.utf8border(strm.output, strm.next_out);\r\n\r\n              tail = strm.next_out - next_out_utf8;\r\n              utf8str = strings.buf2string(strm.output, next_out_utf8);\r\n\r\n              // move tail\r\n              strm.next_out = tail;\r\n              strm.avail_out = chunkSize - tail;\r\n              if (tail) { utils.arraySet(strm.output, strm.output, next_out_utf8, tail, 0); }\r\n\r\n              this.onData(utf8str);\r\n\r\n            } else {\r\n              this.onData(utils.shrinkBuf(strm.output, strm.next_out));\r\n            }\r\n          }\r\n        }\r\n      } while ((strm.avail_in > 0) && status !== c.Z_STREAM_END);\r\n\r\n      if (status === c.Z_STREAM_END) {\r\n        _mode = c.Z_FINISH;\r\n      }\r\n      // Finalize on the last chunk.\r\n      if (_mode === c.Z_FINISH) {\r\n        status = zlib_inflate.inflateEnd(this.strm);\r\n        this.onEnd(status);\r\n        this.ended = true;\r\n        return status === c.Z_OK;\r\n      }\r\n\r\n      return true;\r\n    };\r\n\r\n\r\n    /**\r\n     * Inflate#onData(chunk) -> Void\r\n     * - chunk (Uint8Array|Array|String): ouput data. Type of array depends\r\n     *   on js engine support. When string output requested, each chunk\r\n     *   will be string.\r\n     *\r\n     * By default, stores data blocks in `chunks[]` property and glue\r\n     * those in `onEnd`. Override this handler, if you need another behaviour.\r\n     **/\r\n    Inflate.prototype.onData = function(chunk) {\r\n      this.chunks.push(chunk);\r\n    };\r\n\r\n\r\n    /**\r\n     * Inflate#onEnd(status) -> Void\r\n     * - status (Number): inflate status. 0 (Z_OK) on success,\r\n     *   other if not.\r\n     *\r\n     * Called once after you tell inflate that input stream complete\r\n     * or error happenned. By default - join collected chunks,\r\n     * free memory and fill `results` / `err` properties.\r\n     **/\r\n    Inflate.prototype.onEnd = function(status) {\r\n      // On success - join\r\n      if (status === c.Z_OK) {\r\n        if (this.options.to === 'string') {\r\n          // Glue & convert here, until we teach pako to send\r\n          // utf8 alligned strings to onData\r\n          this.result = this.chunks.join('');\r\n        } else {\r\n          this.result = utils.flattenChunks(this.chunks);\r\n        }\r\n      }\r\n      this.chunks = [];\r\n      this.err = status;\r\n      this.msg = this.strm.msg;\r\n    };\r\n\r\n\r\n    /**\r\n     * inflate(data[, options]) -> Uint8Array|Array|String\r\n     * - data (Uint8Array|Array|String): input data to decompress.\r\n     * - options (Object): zlib inflate options.\r\n     *\r\n     * Decompress `data` with inflate/ungzip and `options`. Autodetect\r\n     * format via wrapper header by default. That's why we don't provide\r\n     * separate `ungzip` method.\r\n     *\r\n     * Supported options are:\r\n     *\r\n     * - windowBits\r\n     *\r\n     * [http://zlib.net/manual.html#Advanced](http://zlib.net/manual.html#Advanced)\r\n     * for more information.\r\n     *\r\n     * Sugar (options):\r\n     *\r\n     * - `raw` (Boolean) - say that we work with raw stream, if you don't wish to specify\r\n     *   negative windowBits implicitly.\r\n     * - `to` (String) - if equal to 'string', then result will be converted\r\n     *   from utf8 to utf16 (javascript) string. When string output requested,\r\n     *   chunk length can differ from `chunkSize`, depending on content.\r\n     *\r\n     *\r\n     * ##### Example:\r\n     *\r\n     * ```javascript\r\n     * var pako = require('pako')\r\n     *   , input = pako.deflate([1,2,3,4,5,6,7,8,9])\r\n     *   , output;\r\n     *\r\n     * try {\r\n     *   output = pako.inflate(input);\r\n     * } catch (err)\r\n     *   console.log(err);\r\n     * }\r\n     * ```\r\n     **/\r\n    function inflate(input, options) {\r\n      var inflator = new Inflate(options);\r\n\r\n      inflator.push(input, true);\r\n\r\n      // That will never happens, if you don't cheat with options :)\r\n      if (inflator.err) { throw inflator.msg; }\r\n\r\n      return inflator.result;\r\n    }\r\n\r\n\r\n    /**\r\n     * inflateRaw(data[, options]) -> Uint8Array|Array|String\r\n     * - data (Uint8Array|Array|String): input data to decompress.\r\n     * - options (Object): zlib inflate options.\r\n     *\r\n     * The same as [[inflate]], but creates raw data, without wrapper\r\n     * (header and adler32 crc).\r\n     **/\r\n    function inflateRaw(input, options) {\r\n      options = options || {};\r\n      options.raw = true;\r\n      return inflate(input, options);\r\n    }\r\n\r\n\r\n    /**\r\n     * ungzip(data[, options]) -> Uint8Array|Array|String\r\n     * - data (Uint8Array|Array|String): input data to decompress.\r\n     * - options (Object): zlib inflate options.\r\n     *\r\n     * Just shortcut to [[inflate]], because it autodetects format\r\n     * by header.content. Done for convenience.\r\n     **/\r\n\r\n\r\n    exports.Inflate = Inflate;\r\n    exports.inflate = inflate;\r\n    exports.inflateRaw = inflateRaw;\r\n    exports.ungzip  = inflate;\r\n\r\n  },{\"./utils/common\":27,\"./utils/strings\":28,\"./zlib/constants\":30,\"./zlib/gzheader\":33,\"./zlib/inflate.js\":35,\"./zlib/messages\":37,\"./zlib/zstream\":39}],27:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n\r\n    var TYPED_OK =  (typeof Uint8Array !== 'undefined') &&\r\n      (typeof Uint16Array !== 'undefined') &&\r\n      (typeof Int32Array !== 'undefined');\r\n\r\n\r\n    exports.assign = function (obj /*from1, from2, from3, ...*/) {\r\n      var sources = Array.prototype.slice.call(arguments, 1);\r\n      while (sources.length) {\r\n        var source = sources.shift();\r\n        if (!source) { continue; }\r\n\r\n        if (typeof(source) !== 'object') {\r\n          throw new TypeError(source + 'must be non-object');\r\n        }\r\n\r\n        for (var p in source) {\r\n          if (source.hasOwnProperty(p)) {\r\n            obj[p] = source[p];\r\n          }\r\n        }\r\n      }\r\n\r\n      return obj;\r\n    };\r\n\r\n\r\n// reduce buffer size, avoiding mem copy\r\n    exports.shrinkBuf = function (buf, size) {\r\n      if (buf.length === size) { return buf; }\r\n      if (buf.subarray) { return buf.subarray(0, size); }\r\n      buf.length = size;\r\n      return buf;\r\n    };\r\n\r\n\r\n    var fnTyped = {\r\n      arraySet: function (dest, src, src_offs, len, dest_offs) {\r\n        if (src.subarray && dest.subarray) {\r\n          dest.set(src.subarray(src_offs, src_offs+len), dest_offs);\r\n          return;\r\n        }\r\n        // Fallback to ordinary array\r\n        for(var i=0; i<len; i++) {\r\n          dest[dest_offs + i] = src[src_offs + i];\r\n        }\r\n      },\r\n      // Join array of chunks to single array.\r\n      flattenChunks: function(chunks) {\r\n        var i, l, len, pos, chunk, result;\r\n\r\n        // calculate data length\r\n        len = 0;\r\n        for (i=0, l=chunks.length; i<l; i++) {\r\n          len += chunks[i].length;\r\n        }\r\n\r\n        // join chunks\r\n        result = new Uint8Array(len);\r\n        pos = 0;\r\n        for (i=0, l=chunks.length; i<l; i++) {\r\n          chunk = chunks[i];\r\n          result.set(chunk, pos);\r\n          pos += chunk.length;\r\n        }\r\n\r\n        return result;\r\n      }\r\n    };\r\n\r\n    var fnUntyped = {\r\n      arraySet: function (dest, src, src_offs, len, dest_offs) {\r\n        for(var i=0; i<len; i++) {\r\n          dest[dest_offs + i] = src[src_offs + i];\r\n        }\r\n      },\r\n      // Join array of chunks to single array.\r\n      flattenChunks: function(chunks) {\r\n        return [].concat.apply([], chunks);\r\n      }\r\n    };\r\n\r\n\r\n// Enable/Disable typed arrays use, for testing\r\n//\r\n    exports.setTyped = function (on) {\r\n      if (on) {\r\n        exports.Buf8  = Uint8Array;\r\n        exports.Buf16 = Uint16Array;\r\n        exports.Buf32 = Int32Array;\r\n        exports.assign(exports, fnTyped);\r\n      } else {\r\n        exports.Buf8  = Array;\r\n        exports.Buf16 = Array;\r\n        exports.Buf32 = Array;\r\n        exports.assign(exports, fnUntyped);\r\n      }\r\n    };\r\n\r\n    exports.setTyped(TYPED_OK);\r\n  },{}],28:[function(_dereq_,module,exports){\r\n// String encode/decode helpers\r\n    'use strict';\r\n\r\n\r\n    var utils = _dereq_('./common');\r\n\r\n\r\n// Quick check if we can use fast array to bin string conversion\r\n//\r\n// - apply(Array) can fail on Android 2.2\r\n// - apply(Uint8Array) can fail on iOS 5.1 Safary\r\n//\r\n    var STR_APPLY_OK = true;\r\n    var STR_APPLY_UIA_OK = true;\r\n\r\n    try { String.fromCharCode.apply(null, [0]); } catch(__) { STR_APPLY_OK = false; }\r\n    try { String.fromCharCode.apply(null, new Uint8Array(1)); } catch(__) { STR_APPLY_UIA_OK = false; }\r\n\r\n\r\n// Table with utf8 lengths (calculated by first byte of sequence)\r\n// Note, that 5 & 6-byte values and some 4-byte values can not be represented in JS,\r\n// because max possible codepoint is 0x10ffff\r\n    var _utf8len = new utils.Buf8(256);\r\n    for (var i=0; i<256; i++) {\r\n      _utf8len[i] = (i >= 252 ? 6 : i >= 248 ? 5 : i >= 240 ? 4 : i >= 224 ? 3 : i >= 192 ? 2 : 1);\r\n    }\r\n    _utf8len[254]=_utf8len[254]=1; // Invalid sequence start\r\n\r\n\r\n// convert string to array (typed, when possible)\r\n    exports.string2buf = function (str) {\r\n      var buf, c, c2, m_pos, i, str_len = str.length, buf_len = 0;\r\n\r\n      // count binary size\r\n      for (m_pos = 0; m_pos < str_len; m_pos++) {\r\n        c = str.charCodeAt(m_pos);\r\n        if ((c & 0xfc00) === 0xd800 && (m_pos+1 < str_len)) {\r\n          c2 = str.charCodeAt(m_pos+1);\r\n          if ((c2 & 0xfc00) === 0xdc00) {\r\n            c = 0x10000 + ((c - 0xd800) << 10) + (c2 - 0xdc00);\r\n            m_pos++;\r\n          }\r\n        }\r\n        buf_len += c < 0x80 ? 1 : c < 0x800 ? 2 : c < 0x10000 ? 3 : 4;\r\n      }\r\n\r\n      // allocate buffer\r\n      buf = new utils.Buf8(buf_len);\r\n\r\n      // convert\r\n      for (i=0, m_pos = 0; i < buf_len; m_pos++) {\r\n        c = str.charCodeAt(m_pos);\r\n        if ((c & 0xfc00) === 0xd800 && (m_pos+1 < str_len)) {\r\n          c2 = str.charCodeAt(m_pos+1);\r\n          if ((c2 & 0xfc00) === 0xdc00) {\r\n            c = 0x10000 + ((c - 0xd800) << 10) + (c2 - 0xdc00);\r\n            m_pos++;\r\n          }\r\n        }\r\n        if (c < 0x80) {\r\n          /* one byte */\r\n          buf[i++] = c;\r\n        } else if (c < 0x800) {\r\n          /* two bytes */\r\n          buf[i++] = 0xC0 | (c >>> 6);\r\n          buf[i++] = 0x80 | (c & 0x3f);\r\n        } else if (c < 0x10000) {\r\n          /* three bytes */\r\n          buf[i++] = 0xE0 | (c >>> 12);\r\n          buf[i++] = 0x80 | (c >>> 6 & 0x3f);\r\n          buf[i++] = 0x80 | (c & 0x3f);\r\n        } else {\r\n          /* four bytes */\r\n          buf[i++] = 0xf0 | (c >>> 18);\r\n          buf[i++] = 0x80 | (c >>> 12 & 0x3f);\r\n          buf[i++] = 0x80 | (c >>> 6 & 0x3f);\r\n          buf[i++] = 0x80 | (c & 0x3f);\r\n        }\r\n      }\r\n\r\n      return buf;\r\n    };\r\n\r\n// Helper (used in 2 places)\r\n    function buf2binstring(buf, len) {\r\n      // use fallback for big arrays to avoid stack overflow\r\n      if (len < 65537) {\r\n        if ((buf.subarray && STR_APPLY_UIA_OK) || (!buf.subarray && STR_APPLY_OK)) {\r\n          return String.fromCharCode.apply(null, utils.shrinkBuf(buf, len));\r\n        }\r\n      }\r\n\r\n      var result = '';\r\n      for(var i=0; i < len; i++) {\r\n        result += String.fromCharCode(buf[i]);\r\n      }\r\n      return result;\r\n    }\r\n\r\n\r\n// Convert byte array to binary string\r\n    exports.buf2binstring = function(buf) {\r\n      return buf2binstring(buf, buf.length);\r\n    };\r\n\r\n\r\n// Convert binary string (typed, when possible)\r\n    exports.binstring2buf = function(str) {\r\n      var buf = new utils.Buf8(str.length);\r\n      for(var i=0, len=buf.length; i < len; i++) {\r\n        buf[i] = str.charCodeAt(i);\r\n      }\r\n      return buf;\r\n    };\r\n\r\n\r\n// convert array to string\r\n    exports.buf2string = function (buf, max) {\r\n      var i, out, c, c_len;\r\n      var len = max || buf.length;\r\n\r\n      // Reserve max possible length (2 words per char)\r\n      // NB: by unknown reasons, Array is significantly faster for\r\n      //     String.fromCharCode.apply than Uint16Array.\r\n      var utf16buf = new Array(len*2);\r\n\r\n      for (out=0, i=0; i<len;) {\r\n        c = buf[i++];\r\n        // quick process ascii\r\n        if (c < 0x80) { utf16buf[out++] = c; continue; }\r\n\r\n        c_len = _utf8len[c];\r\n        // skip 5 & 6 byte codes\r\n        if (c_len > 4) { utf16buf[out++] = 0xfffd; i += c_len-1; continue; }\r\n\r\n        // apply mask on first byte\r\n        c &= c_len === 2 ? 0x1f : c_len === 3 ? 0x0f : 0x07;\r\n        // join the rest\r\n        while (c_len > 1 && i < len) {\r\n          c = (c << 6) | (buf[i++] & 0x3f);\r\n          c_len--;\r\n        }\r\n\r\n        // terminated by end of string?\r\n        if (c_len > 1) { utf16buf[out++] = 0xfffd; continue; }\r\n\r\n        if (c < 0x10000) {\r\n          utf16buf[out++] = c;\r\n        } else {\r\n          c -= 0x10000;\r\n          utf16buf[out++] = 0xd800 | ((c >> 10) & 0x3ff);\r\n          utf16buf[out++] = 0xdc00 | (c & 0x3ff);\r\n        }\r\n      }\r\n\r\n      return buf2binstring(utf16buf, out);\r\n    };\r\n\r\n\r\n// Calculate max possible position in utf8 buffer,\r\n// that will not break sequence. If that's not possible\r\n// - (very small limits) return max size as is.\r\n//\r\n// buf[] - utf8 bytes array\r\n// max   - length limit (mandatory);\r\n    exports.utf8border = function(buf, max) {\r\n      var pos;\r\n\r\n      max = max || buf.length;\r\n      if (max > buf.length) { max = buf.length; }\r\n\r\n      // go back from last position, until start of sequence found\r\n      pos = max-1;\r\n      while (pos >= 0 && (buf[pos] & 0xC0) === 0x80) { pos--; }\r\n\r\n      // Fuckup - very small and broken sequence,\r\n      // return max, because we should return something anyway.\r\n      if (pos < 0) { return max; }\r\n\r\n      // If we came to start of buffer - that means vuffer is too small,\r\n      // return max too.\r\n      if (pos === 0) { return max; }\r\n\r\n      return (pos + _utf8len[buf[pos]] > max) ? pos : max;\r\n    };\r\n\r\n  },{\"./common\":27}],29:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n// Note: adler32 takes 12% for level 0 and 2% for level 6.\r\n// It doesn't worth to make additional optimizationa as in original.\r\n// Small size is preferable.\r\n\r\n    function adler32(adler, buf, len, pos) {\r\n      var s1 = (adler & 0xffff) |0\r\n        , s2 = ((adler >>> 16) & 0xffff) |0\r\n        , n = 0;\r\n\r\n      while (len !== 0) {\r\n        // Set limit ~ twice less than 5552, to keep\r\n        // s2 in 31-bits, because we force signed ints.\r\n        // in other case %= will fail.\r\n        n = len > 2000 ? 2000 : len;\r\n        len -= n;\r\n\r\n        do {\r\n          s1 = (s1 + buf[pos++]) |0;\r\n          s2 = (s2 + s1) |0;\r\n        } while (--n);\r\n\r\n        s1 %= 65521;\r\n        s2 %= 65521;\r\n      }\r\n\r\n      return (s1 | (s2 << 16)) |0;\r\n    }\r\n\r\n\r\n    module.exports = adler32;\r\n  },{}],30:[function(_dereq_,module,exports){\r\n    module.exports = {\r\n\r\n      /* Allowed flush values; see deflate() and inflate() below for details */\r\n      Z_NO_FLUSH:         0,\r\n      Z_PARTIAL_FLUSH:    1,\r\n      Z_SYNC_FLUSH:       2,\r\n      Z_FULL_FLUSH:       3,\r\n      Z_FINISH:           4,\r\n      Z_BLOCK:            5,\r\n      Z_TREES:            6,\r\n\r\n      /* Return codes for the compression/decompression functions. Negative values\r\n  * are errors, positive values are used for special but normal events.\r\n  */\r\n      Z_OK:               0,\r\n      Z_STREAM_END:       1,\r\n      Z_NEED_DICT:        2,\r\n      Z_ERRNO:           -1,\r\n      Z_STREAM_ERROR:    -2,\r\n      Z_DATA_ERROR:      -3,\r\n      //Z_MEM_ERROR:     -4,\r\n      Z_BUF_ERROR:       -5,\r\n      //Z_VERSION_ERROR: -6,\r\n\r\n      /* compression levels */\r\n      Z_NO_COMPRESSION:         0,\r\n      Z_BEST_SPEED:             1,\r\n      Z_BEST_COMPRESSION:       9,\r\n      Z_DEFAULT_COMPRESSION:   -1,\r\n\r\n\r\n      Z_FILTERED:               1,\r\n      Z_HUFFMAN_ONLY:           2,\r\n      Z_RLE:                    3,\r\n      Z_FIXED:                  4,\r\n      Z_DEFAULT_STRATEGY:       0,\r\n\r\n      /* Possible values of the data_type field (though see inflate()) */\r\n      Z_BINARY:                 0,\r\n      Z_TEXT:                   1,\r\n      //Z_ASCII:                1, // = Z_TEXT (deprecated)\r\n      Z_UNKNOWN:                2,\r\n\r\n      /* The deflate compression method */\r\n      Z_DEFLATED:               8\r\n      //Z_NULL:                 null // Use -1 or null inline, depending on var type\r\n    };\r\n  },{}],31:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n// Note: we can't get significant speed boost here.\r\n// So write code to minimize size - no pregenerated tables\r\n// and array tools dependencies.\r\n\r\n\r\n// Use ordinary array, since untyped makes no boost here\r\n    function makeTable() {\r\n      var c, table = [];\r\n\r\n      for(var n =0; n < 256; n++){\r\n        c = n;\r\n        for(var k =0; k < 8; k++){\r\n          c = ((c&1) ? (0xEDB88320 ^ (c >>> 1)) : (c >>> 1));\r\n        }\r\n        table[n] = c;\r\n      }\r\n\r\n      return table;\r\n    }\r\n\r\n// Create table on load. Just 255 signed longs. Not a problem.\r\n    var crcTable = makeTable();\r\n\r\n\r\n    function crc32(crc, buf, len, pos) {\r\n      var t = crcTable\r\n        , end = pos + len;\r\n\r\n      crc = crc ^ (-1);\r\n\r\n      for (var i = pos; i < end; i++ ) {\r\n        crc = (crc >>> 8) ^ t[(crc ^ buf[i]) & 0xFF];\r\n      }\r\n\r\n      return (crc ^ (-1)); // >>> 0;\r\n    }\r\n\r\n\r\n    module.exports = crc32;\r\n  },{}],32:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n    var utils   = _dereq_('../utils/common');\r\n    var trees   = _dereq_('./trees');\r\n    var adler32 = _dereq_('./adler32');\r\n    var crc32   = _dereq_('./crc32');\r\n    var msg   = _dereq_('./messages');\r\n\r\n    /* Public constants ==========================================================*/\r\n    /* ===========================================================================*/\r\n\r\n\r\n    /* Allowed flush values; see deflate() and inflate() below for details */\r\n    var Z_NO_FLUSH      = 0;\r\n    var Z_PARTIAL_FLUSH = 1;\r\n//var Z_SYNC_FLUSH    = 2;\r\n    var Z_FULL_FLUSH    = 3;\r\n    var Z_FINISH        = 4;\r\n    var Z_BLOCK         = 5;\r\n//var Z_TREES         = 6;\r\n\r\n\r\n    /* Return codes for the compression/decompression functions. Negative values\r\n * are errors, positive values are used for special but normal events.\r\n */\r\n    var Z_OK            = 0;\r\n    var Z_STREAM_END    = 1;\r\n//var Z_NEED_DICT     = 2;\r\n//var Z_ERRNO         = -1;\r\n    var Z_STREAM_ERROR  = -2;\r\n    var Z_DATA_ERROR    = -3;\r\n//var Z_MEM_ERROR     = -4;\r\n    var Z_BUF_ERROR     = -5;\r\n//var Z_VERSION_ERROR = -6;\r\n\r\n\r\n    /* compression levels */\r\n//var Z_NO_COMPRESSION      = 0;\r\n//var Z_BEST_SPEED          = 1;\r\n//var Z_BEST_COMPRESSION    = 9;\r\n    var Z_DEFAULT_COMPRESSION = -1;\r\n\r\n\r\n    var Z_FILTERED            = 1;\r\n    var Z_HUFFMAN_ONLY        = 2;\r\n    var Z_RLE                 = 3;\r\n    var Z_FIXED               = 4;\r\n    var Z_DEFAULT_STRATEGY    = 0;\r\n\r\n    /* Possible values of the data_type field (though see inflate()) */\r\n//var Z_BINARY              = 0;\r\n//var Z_TEXT                = 1;\r\n//var Z_ASCII               = 1; // = Z_TEXT\r\n    var Z_UNKNOWN             = 2;\r\n\r\n\r\n    /* The deflate compression method */\r\n    var Z_DEFLATED  = 8;\r\n\r\n    /*============================================================================*/\r\n\r\n\r\n    var MAX_MEM_LEVEL = 9;\r\n    /* Maximum value for memLevel in deflateInit2 */\r\n    var MAX_WBITS = 15;\r\n    /* 32K LZ77 window */\r\n    var DEF_MEM_LEVEL = 8;\r\n\r\n\r\n    var LENGTH_CODES  = 29;\r\n    /* number of length codes, not counting the special END_BLOCK code */\r\n    var LITERALS      = 256;\r\n    /* number of literal bytes 0..255 */\r\n    var L_CODES       = LITERALS + 1 + LENGTH_CODES;\r\n    /* number of Literal or Length codes, including the END_BLOCK code */\r\n    var D_CODES       = 30;\r\n    /* number of distance codes */\r\n    var BL_CODES      = 19;\r\n    /* number of codes used to transfer the bit lengths */\r\n    var HEAP_SIZE     = 2*L_CODES + 1;\r\n    /* maximum heap size */\r\n    var MAX_BITS  = 15;\r\n    /* All codes must not exceed MAX_BITS bits */\r\n\r\n    var MIN_MATCH = 3;\r\n    var MAX_MATCH = 258;\r\n    var MIN_LOOKAHEAD = (MAX_MATCH + MIN_MATCH + 1);\r\n\r\n    var PRESET_DICT = 0x20;\r\n\r\n    var INIT_STATE = 42;\r\n    var EXTRA_STATE = 69;\r\n    var NAME_STATE = 73;\r\n    var COMMENT_STATE = 91;\r\n    var HCRC_STATE = 103;\r\n    var BUSY_STATE = 113;\r\n    var FINISH_STATE = 666;\r\n\r\n    var BS_NEED_MORE      = 1; /* block not completed, need more input or more output */\r\n    var BS_BLOCK_DONE     = 2; /* block flush performed */\r\n    var BS_FINISH_STARTED = 3; /* finish started, need only more output at next deflate */\r\n    var BS_FINISH_DONE    = 4; /* finish done, accept no more input or output */\r\n\r\n    var OS_CODE = 0x03; // Unix :) . Don't detect, use this default.\r\n\r\n    function err(strm, errorCode) {\r\n      strm.msg = msg[errorCode];\r\n      return errorCode;\r\n    }\r\n\r\n    function rank(f) {\r\n      return ((f) << 1) - ((f) > 4 ? 9 : 0);\r\n    }\r\n\r\n    function zero(buf) { var len = buf.length; while (--len >= 0) { buf[len] = 0; } }\r\n\r\n\r\n    /* =========================================================================\r\n * Flush as much pending output as possible. All deflate() output goes\r\n * through this function so some applications may wish to modify it\r\n * to avoid allocating a large strm->output buffer and copying into it.\r\n * (See also read_buf()).\r\n */\r\n    function flush_pending(strm) {\r\n      var s = strm.state;\r\n\r\n      //_tr_flush_bits(s);\r\n      var len = s.pending;\r\n      if (len > strm.avail_out) {\r\n        len = strm.avail_out;\r\n      }\r\n      if (len === 0) { return; }\r\n\r\n      utils.arraySet(strm.output, s.pending_buf, s.pending_out, len, strm.next_out);\r\n      strm.next_out += len;\r\n      s.pending_out += len;\r\n      strm.total_out += len;\r\n      strm.avail_out -= len;\r\n      s.pending -= len;\r\n      if (s.pending === 0) {\r\n        s.pending_out = 0;\r\n      }\r\n    }\r\n\r\n\r\n    function flush_block_only (s, last) {\r\n      trees._tr_flush_block(s, (s.block_start >= 0 ? s.block_start : -1), s.strstart - s.block_start, last);\r\n      s.block_start = s.strstart;\r\n      flush_pending(s.strm);\r\n    }\r\n\r\n\r\n    function put_byte(s, b) {\r\n      s.pending_buf[s.pending++] = b;\r\n    }\r\n\r\n\r\n    /* =========================================================================\r\n * Put a short in the pending buffer. The 16-bit value is put in MSB order.\r\n * IN assertion: the stream state is correct and there is enough room in\r\n * pending_buf.\r\n */\r\n    function putShortMSB(s, b) {\r\n//  put_byte(s, (Byte)(b >> 8));\r\n//  put_byte(s, (Byte)(b & 0xff));\r\n      s.pending_buf[s.pending++] = (b >>> 8) & 0xff;\r\n      s.pending_buf[s.pending++] = b & 0xff;\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Read a new buffer from the current input stream, update the adler32\r\n * and total number of bytes read.  All deflate() input goes through\r\n * this function so some applications may wish to modify it to avoid\r\n * allocating a large strm->input buffer and copying from it.\r\n * (See also flush_pending()).\r\n */\r\n    function read_buf(strm, buf, start, size) {\r\n      var len = strm.avail_in;\r\n\r\n      if (len > size) { len = size; }\r\n      if (len === 0) { return 0; }\r\n\r\n      strm.avail_in -= len;\r\n\r\n      utils.arraySet(buf, strm.input, strm.next_in, len, start);\r\n      if (strm.state.wrap === 1) {\r\n        strm.adler = adler32(strm.adler, buf, len, start);\r\n      }\r\n\r\n      else if (strm.state.wrap === 2) {\r\n        strm.adler = crc32(strm.adler, buf, len, start);\r\n      }\r\n\r\n      strm.next_in += len;\r\n      strm.total_in += len;\r\n\r\n      return len;\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Set match_start to the longest match starting at the given string and\r\n * return its length. Matches shorter or equal to prev_length are discarded,\r\n * in which case the result is equal to prev_length and match_start is\r\n * garbage.\r\n * IN assertions: cur_match is the head of the hash chain for the current\r\n *   string (strstart) and its distance is <= MAX_DIST, and prev_length >= 1\r\n * OUT assertion: the match length is not greater than s->lookahead.\r\n */\r\n    function longest_match(s, cur_match) {\r\n      var chain_length = s.max_chain_length;      /* max hash chain length */\r\n      var scan = s.strstart; /* current string */\r\n      var match;                       /* matched string */\r\n      var len;                           /* length of current match */\r\n      var best_len = s.prev_length;              /* best match length so far */\r\n      var nice_match = s.nice_match;             /* stop if match long enough */\r\n      var limit = (s.strstart > (s.w_size - MIN_LOOKAHEAD)) ?\r\n        s.strstart - (s.w_size - MIN_LOOKAHEAD) : 0/*NIL*/;\r\n\r\n      var _win = s.window; // shortcut\r\n\r\n      var wmask = s.w_mask;\r\n      var prev  = s.prev;\r\n\r\n      /* Stop when cur_match becomes <= limit. To simplify the code,\r\n   * we prevent matches with the string of window index 0.\r\n   */\r\n\r\n      var strend = s.strstart + MAX_MATCH;\r\n      var scan_end1  = _win[scan + best_len - 1];\r\n      var scan_end   = _win[scan + best_len];\r\n\r\n      /* The code is optimized for HASH_BITS >= 8 and MAX_MATCH-2 multiple of 16.\r\n   * It is easy to get rid of this optimization if necessary.\r\n   */\r\n      // Assert(s->hash_bits >= 8 && MAX_MATCH == 258, \"Code too clever\");\r\n\r\n      /* Do not waste too much time if we already have a good match: */\r\n      if (s.prev_length >= s.good_match) {\r\n        chain_length >>= 2;\r\n      }\r\n      /* Do not look for matches beyond the end of the input. This is necessary\r\n   * to make deflate deterministic.\r\n   */\r\n      if (nice_match > s.lookahead) { nice_match = s.lookahead; }\r\n\r\n      // Assert((ulg)s->strstart <= s->window_size-MIN_LOOKAHEAD, \"need lookahead\");\r\n\r\n      do {\r\n        // Assert(cur_match < s->strstart, \"no future\");\r\n        match = cur_match;\r\n\r\n        /* Skip to next match if the match length cannot increase\r\n     * or if the match length is less than 2.  Note that the checks below\r\n     * for insufficient lookahead only occur occasionally for performance\r\n     * reasons.  Therefore uninitialized memory will be accessed, and\r\n     * conditional jumps will be made that depend on those values.\r\n     * However the length of the match is limited to the lookahead, so\r\n     * the output of deflate is not affected by the uninitialized values.\r\n     */\r\n\r\n        if (_win[match + best_len]     !== scan_end  ||\r\n          _win[match + best_len - 1] !== scan_end1 ||\r\n          _win[match]                !== _win[scan] ||\r\n          _win[++match]              !== _win[scan + 1]) {\r\n          continue;\r\n        }\r\n\r\n        /* The check at best_len-1 can be removed because it will be made\r\n     * again later. (This heuristic is not always a win.)\r\n     * It is not necessary to compare scan[2] and match[2] since they\r\n     * are always equal when the other bytes match, given that\r\n     * the hash keys are equal and that HASH_BITS >= 8.\r\n     */\r\n        scan += 2;\r\n        match++;\r\n        // Assert(*scan == *match, \"match[2]?\");\r\n\r\n        /* We check for insufficient lookahead only every 8th comparison;\r\n     * the 256th check will be made at strstart+258.\r\n     */\r\n        do {\r\n          /*jshint noempty:false*/\r\n        } while (_win[++scan] === _win[++match] && _win[++scan] === _win[++match] &&\r\n        _win[++scan] === _win[++match] && _win[++scan] === _win[++match] &&\r\n        _win[++scan] === _win[++match] && _win[++scan] === _win[++match] &&\r\n        _win[++scan] === _win[++match] && _win[++scan] === _win[++match] &&\r\n        scan < strend);\r\n\r\n        // Assert(scan <= s->window+(unsigned)(s->window_size-1), \"wild scan\");\r\n\r\n        len = MAX_MATCH - (strend - scan);\r\n        scan = strend - MAX_MATCH;\r\n\r\n        if (len > best_len) {\r\n          s.match_start = cur_match;\r\n          best_len = len;\r\n          if (len >= nice_match) {\r\n            break;\r\n          }\r\n          scan_end1  = _win[scan + best_len - 1];\r\n          scan_end   = _win[scan + best_len];\r\n        }\r\n      } while ((cur_match = prev[cur_match & wmask]) > limit && --chain_length !== 0);\r\n\r\n      if (best_len <= s.lookahead) {\r\n        return best_len;\r\n      }\r\n      return s.lookahead;\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Fill the window when the lookahead becomes insufficient.\r\n * Updates strstart and lookahead.\r\n *\r\n * IN assertion: lookahead < MIN_LOOKAHEAD\r\n * OUT assertions: strstart <= window_size-MIN_LOOKAHEAD\r\n *    At least one byte has been read, or avail_in == 0; reads are\r\n *    performed for at least two bytes (required for the zip translate_eol\r\n *    option -- not supported here).\r\n */\r\n    function fill_window(s) {\r\n      var _w_size = s.w_size;\r\n      var p, n, m, more, str;\r\n\r\n      //Assert(s->lookahead < MIN_LOOKAHEAD, \"already enough lookahead\");\r\n\r\n      do {\r\n        more = s.window_size - s.lookahead - s.strstart;\r\n\r\n        // JS ints have 32 bit, block below not needed\r\n        /* Deal with !@#$% 64K limit: */\r\n        //if (sizeof(int) <= 2) {\r\n        //    if (more == 0 && s->strstart == 0 && s->lookahead == 0) {\r\n        //        more = wsize;\r\n        //\r\n        //  } else if (more == (unsigned)(-1)) {\r\n        //        /* Very unlikely, but possible on 16 bit machine if\r\n        //         * strstart == 0 && lookahead == 1 (input done a byte at time)\r\n        //         */\r\n        //        more--;\r\n        //    }\r\n        //}\r\n\r\n\r\n        /* If the window is almost full and there is insufficient lookahead,\r\n     * move the upper half to the lower one to make room in the upper half.\r\n     */\r\n        if (s.strstart >= _w_size + (_w_size - MIN_LOOKAHEAD)) {\r\n\r\n          utils.arraySet(s.window, s.window, _w_size, _w_size, 0);\r\n          s.match_start -= _w_size;\r\n          s.strstart -= _w_size;\r\n          /* we now have strstart >= MAX_DIST */\r\n          s.block_start -= _w_size;\r\n\r\n          /* Slide the hash table (could be avoided with 32 bit values\r\n       at the expense of memory usage). We slide even when level == 0\r\n       to keep the hash table consistent if we switch back to level > 0\r\n       later. (Using level 0 permanently is not an optimal usage of\r\n       zlib, so we don't care about this pathological case.)\r\n       */\r\n\r\n          n = s.hash_size;\r\n          p = n;\r\n          do {\r\n            m = s.head[--p];\r\n            s.head[p] = (m >= _w_size ? m - _w_size : 0);\r\n          } while (--n);\r\n\r\n          n = _w_size;\r\n          p = n;\r\n          do {\r\n            m = s.prev[--p];\r\n            s.prev[p] = (m >= _w_size ? m - _w_size : 0);\r\n            /* If n is not on any hash chain, prev[n] is garbage but\r\n         * its value will never be used.\r\n         */\r\n          } while (--n);\r\n\r\n          more += _w_size;\r\n        }\r\n        if (s.strm.avail_in === 0) {\r\n          break;\r\n        }\r\n\r\n        /* If there was no sliding:\r\n     *    strstart <= WSIZE+MAX_DIST-1 && lookahead <= MIN_LOOKAHEAD - 1 &&\r\n     *    more == window_size - lookahead - strstart\r\n     * => more >= window_size - (MIN_LOOKAHEAD-1 + WSIZE + MAX_DIST-1)\r\n     * => more >= window_size - 2*WSIZE + 2\r\n     * In the BIG_MEM or MMAP case (not yet supported),\r\n     *   window_size == input_size + MIN_LOOKAHEAD  &&\r\n     *   strstart + s->lookahead <= input_size => more >= MIN_LOOKAHEAD.\r\n     * Otherwise, window_size == 2*WSIZE so more >= 2.\r\n     * If there was sliding, more >= WSIZE. So in all cases, more >= 2.\r\n     */\r\n        //Assert(more >= 2, \"more < 2\");\r\n        n = read_buf(s.strm, s.window, s.strstart + s.lookahead, more);\r\n        s.lookahead += n;\r\n\r\n        /* Initialize the hash value now that we have some input: */\r\n        if (s.lookahead + s.insert >= MIN_MATCH) {\r\n          str = s.strstart - s.insert;\r\n          s.ins_h = s.window[str];\r\n\r\n          /* UPDATE_HASH(s, s->ins_h, s->window[str + 1]); */\r\n          s.ins_h = ((s.ins_h << s.hash_shift) ^ s.window[str + 1]) & s.hash_mask;\r\n//#if MIN_MATCH != 3\r\n//        Call update_hash() MIN_MATCH-3 more times\r\n//#endif\r\n          while (s.insert) {\r\n            /* UPDATE_HASH(s, s->ins_h, s->window[str + MIN_MATCH-1]); */\r\n            s.ins_h = ((s.ins_h << s.hash_shift) ^ s.window[str + MIN_MATCH-1]) & s.hash_mask;\r\n\r\n            s.prev[str & s.w_mask] = s.head[s.ins_h];\r\n            s.head[s.ins_h] = str;\r\n            str++;\r\n            s.insert--;\r\n            if (s.lookahead + s.insert < MIN_MATCH) {\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        /* If the whole input has less than MIN_MATCH bytes, ins_h is garbage,\r\n     * but this is not important since only literal bytes will be emitted.\r\n     */\r\n\r\n      } while (s.lookahead < MIN_LOOKAHEAD && s.strm.avail_in !== 0);\r\n\r\n      /* If the WIN_INIT bytes after the end of the current data have never been\r\n   * written, then zero those bytes in order to avoid memory check reports of\r\n   * the use of uninitialized (or uninitialised as Julian writes) bytes by\r\n   * the longest match routines.  Update the high water mark for the next\r\n   * time through here.  WIN_INIT is set to MAX_MATCH since the longest match\r\n   * routines allow scanning to strstart + MAX_MATCH, ignoring lookahead.\r\n   */\r\n//  if (s.high_water < s.window_size) {\r\n//    var curr = s.strstart + s.lookahead;\r\n//    var init = 0;\r\n//\r\n//    if (s.high_water < curr) {\r\n//      /* Previous high water mark below current data -- zero WIN_INIT\r\n//       * bytes or up to end of window, whichever is less.\r\n//       */\r\n//      init = s.window_size - curr;\r\n//      if (init > WIN_INIT)\r\n//        init = WIN_INIT;\r\n//      zmemzero(s->window + curr, (unsigned)init);\r\n//      s->high_water = curr + init;\r\n//    }\r\n//    else if (s->high_water < (ulg)curr + WIN_INIT) {\r\n//      /* High water mark at or above current data, but below current data\r\n//       * plus WIN_INIT -- zero out to current data plus WIN_INIT, or up\r\n//       * to end of window, whichever is less.\r\n//       */\r\n//      init = (ulg)curr + WIN_INIT - s->high_water;\r\n//      if (init > s->window_size - s->high_water)\r\n//        init = s->window_size - s->high_water;\r\n//      zmemzero(s->window + s->high_water, (unsigned)init);\r\n//      s->high_water += init;\r\n//    }\r\n//  }\r\n//\r\n//  Assert((ulg)s->strstart <= s->window_size - MIN_LOOKAHEAD,\r\n//    \"not enough room for search\");\r\n    }\r\n\r\n    /* ===========================================================================\r\n * Copy without compression as much as possible from the input stream, return\r\n * the current block state.\r\n * This function does not insert new strings in the dictionary since\r\n * uncompressible data is probably not useful. This function is used\r\n * only for the level=0 compression option.\r\n * NOTE: this function should be optimized to avoid extra copying from\r\n * window to pending_buf.\r\n */\r\n    function deflate_stored(s, flush) {\r\n      /* Stored blocks are limited to 0xffff bytes, pending_buf is limited\r\n   * to pending_buf_size, and each stored block has a 5 byte header:\r\n   */\r\n      var max_block_size = 0xffff;\r\n\r\n      if (max_block_size > s.pending_buf_size - 5) {\r\n        max_block_size = s.pending_buf_size - 5;\r\n      }\r\n\r\n      /* Copy as much as possible from input to output: */\r\n      for (;;) {\r\n        /* Fill the window as much as possible: */\r\n        if (s.lookahead <= 1) {\r\n\r\n          //Assert(s->strstart < s->w_size+MAX_DIST(s) ||\r\n          //  s->block_start >= (long)s->w_size, \"slide too late\");\r\n//      if (!(s.strstart < s.w_size + (s.w_size - MIN_LOOKAHEAD) ||\r\n//        s.block_start >= s.w_size)) {\r\n//        throw  new Error(\"slide too late\");\r\n//      }\r\n\r\n          fill_window(s);\r\n          if (s.lookahead === 0 && flush === Z_NO_FLUSH) {\r\n            return BS_NEED_MORE;\r\n          }\r\n\r\n          if (s.lookahead === 0) {\r\n            break;\r\n          }\r\n          /* flush the current block */\r\n        }\r\n        //Assert(s->block_start >= 0L, \"block gone\");\r\n//    if (s.block_start < 0) throw new Error(\"block gone\");\r\n\r\n        s.strstart += s.lookahead;\r\n        s.lookahead = 0;\r\n\r\n        /* Emit a stored block if pending_buf will be full: */\r\n        var max_start = s.block_start + max_block_size;\r\n\r\n        if (s.strstart === 0 || s.strstart >= max_start) {\r\n          /* strstart == 0 is possible when wraparound on 16-bit machine */\r\n          s.lookahead = s.strstart - max_start;\r\n          s.strstart = max_start;\r\n          /*** FLUSH_BLOCK(s, 0); ***/\r\n          flush_block_only(s, false);\r\n          if (s.strm.avail_out === 0) {\r\n            return BS_NEED_MORE;\r\n          }\r\n          /***/\r\n\r\n\r\n        }\r\n        /* Flush if we may have to slide, otherwise block_start may become\r\n     * negative and the data will be gone:\r\n     */\r\n        if (s.strstart - s.block_start >= (s.w_size - MIN_LOOKAHEAD)) {\r\n          /*** FLUSH_BLOCK(s, 0); ***/\r\n          flush_block_only(s, false);\r\n          if (s.strm.avail_out === 0) {\r\n            return BS_NEED_MORE;\r\n          }\r\n          /***/\r\n        }\r\n      }\r\n\r\n      s.insert = 0;\r\n\r\n      if (flush === Z_FINISH) {\r\n        /*** FLUSH_BLOCK(s, 1); ***/\r\n        flush_block_only(s, true);\r\n        if (s.strm.avail_out === 0) {\r\n          return BS_FINISH_STARTED;\r\n        }\r\n        /***/\r\n        return BS_FINISH_DONE;\r\n      }\r\n\r\n      if (s.strstart > s.block_start) {\r\n        /*** FLUSH_BLOCK(s, 0); ***/\r\n        flush_block_only(s, false);\r\n        if (s.strm.avail_out === 0) {\r\n          return BS_NEED_MORE;\r\n        }\r\n        /***/\r\n      }\r\n\r\n      return BS_NEED_MORE;\r\n    }\r\n\r\n    /* ===========================================================================\r\n * Compress as much as possible from the input stream, return the current\r\n * block state.\r\n * This function does not perform lazy evaluation of matches and inserts\r\n * new strings in the dictionary only for unmatched strings or for short\r\n * matches. It is used only for the fast compression options.\r\n */\r\n    function deflate_fast(s, flush) {\r\n      var hash_head;        /* head of the hash chain */\r\n      var bflush;           /* set if current block must be flushed */\r\n\r\n      for (;;) {\r\n        /* Make sure that we always have enough lookahead, except\r\n     * at the end of the input file. We need MAX_MATCH bytes\r\n     * for the next match, plus MIN_MATCH bytes to insert the\r\n     * string following the next match.\r\n     */\r\n        if (s.lookahead < MIN_LOOKAHEAD) {\r\n          fill_window(s);\r\n          if (s.lookahead < MIN_LOOKAHEAD && flush === Z_NO_FLUSH) {\r\n            return BS_NEED_MORE;\r\n          }\r\n          if (s.lookahead === 0) {\r\n            break; /* flush the current block */\r\n          }\r\n        }\r\n\r\n        /* Insert the string window[strstart .. strstart+2] in the\r\n     * dictionary, and set hash_head to the head of the hash chain:\r\n     */\r\n        hash_head = 0/*NIL*/;\r\n        if (s.lookahead >= MIN_MATCH) {\r\n          /*** INSERT_STRING(s, s.strstart, hash_head); ***/\r\n          s.ins_h = ((s.ins_h << s.hash_shift) ^ s.window[s.strstart + MIN_MATCH - 1]) & s.hash_mask;\r\n          hash_head = s.prev[s.strstart & s.w_mask] = s.head[s.ins_h];\r\n          s.head[s.ins_h] = s.strstart;\r\n          /***/\r\n        }\r\n\r\n        /* Find the longest match, discarding those <= prev_length.\r\n     * At this point we have always match_length < MIN_MATCH\r\n     */\r\n        if (hash_head !== 0/*NIL*/ && ((s.strstart - hash_head) <= (s.w_size - MIN_LOOKAHEAD))) {\r\n          /* To simplify the code, we prevent matches with the string\r\n       * of window index 0 (in particular we have to avoid a match\r\n       * of the string with itself at the start of the input file).\r\n       */\r\n          s.match_length = longest_match(s, hash_head);\r\n          /* longest_match() sets match_start */\r\n        }\r\n        if (s.match_length >= MIN_MATCH) {\r\n          // check_match(s, s.strstart, s.match_start, s.match_length); // for debug only\r\n\r\n          /*** _tr_tally_dist(s, s.strstart - s.match_start,\r\n           s.match_length - MIN_MATCH, bflush); ***/\r\n          bflush = trees._tr_tally(s, s.strstart - s.match_start, s.match_length - MIN_MATCH);\r\n\r\n          s.lookahead -= s.match_length;\r\n\r\n          /* Insert new strings in the hash table only if the match length\r\n       * is not too large. This saves time but degrades compression.\r\n       */\r\n          if (s.match_length <= s.max_lazy_match/*max_insert_length*/ && s.lookahead >= MIN_MATCH) {\r\n            s.match_length--; /* string at strstart already in table */\r\n            do {\r\n              s.strstart++;\r\n              /*** INSERT_STRING(s, s.strstart, hash_head); ***/\r\n              s.ins_h = ((s.ins_h << s.hash_shift) ^ s.window[s.strstart + MIN_MATCH - 1]) & s.hash_mask;\r\n              hash_head = s.prev[s.strstart & s.w_mask] = s.head[s.ins_h];\r\n              s.head[s.ins_h] = s.strstart;\r\n              /***/\r\n              /* strstart never exceeds WSIZE-MAX_MATCH, so there are\r\n           * always MIN_MATCH bytes ahead.\r\n           */\r\n            } while (--s.match_length !== 0);\r\n            s.strstart++;\r\n          } else\r\n          {\r\n            s.strstart += s.match_length;\r\n            s.match_length = 0;\r\n            s.ins_h = s.window[s.strstart];\r\n            /* UPDATE_HASH(s, s.ins_h, s.window[s.strstart+1]); */\r\n            s.ins_h = ((s.ins_h << s.hash_shift) ^ s.window[s.strstart + 1]) & s.hash_mask;\r\n\r\n//#if MIN_MATCH != 3\r\n//                Call UPDATE_HASH() MIN_MATCH-3 more times\r\n//#endif\r\n            /* If lookahead < MIN_MATCH, ins_h is garbage, but it does not\r\n         * matter since it will be recomputed at next deflate call.\r\n         */\r\n          }\r\n        } else {\r\n          /* No match, output a literal byte */\r\n          //Tracevv((stderr,\"%c\", s.window[s.strstart]));\r\n          /*** _tr_tally_lit(s, s.window[s.strstart], bflush); ***/\r\n          bflush = trees._tr_tally(s, 0, s.window[s.strstart]);\r\n\r\n          s.lookahead--;\r\n          s.strstart++;\r\n        }\r\n        if (bflush) {\r\n          /*** FLUSH_BLOCK(s, 0); ***/\r\n          flush_block_only(s, false);\r\n          if (s.strm.avail_out === 0) {\r\n            return BS_NEED_MORE;\r\n          }\r\n          /***/\r\n        }\r\n      }\r\n      s.insert = ((s.strstart < (MIN_MATCH-1)) ? s.strstart : MIN_MATCH-1);\r\n      if (flush === Z_FINISH) {\r\n        /*** FLUSH_BLOCK(s, 1); ***/\r\n        flush_block_only(s, true);\r\n        if (s.strm.avail_out === 0) {\r\n          return BS_FINISH_STARTED;\r\n        }\r\n        /***/\r\n        return BS_FINISH_DONE;\r\n      }\r\n      if (s.last_lit) {\r\n        /*** FLUSH_BLOCK(s, 0); ***/\r\n        flush_block_only(s, false);\r\n        if (s.strm.avail_out === 0) {\r\n          return BS_NEED_MORE;\r\n        }\r\n        /***/\r\n      }\r\n      return BS_BLOCK_DONE;\r\n    }\r\n\r\n    /* ===========================================================================\r\n * Same as above, but achieves better compression. We use a lazy\r\n * evaluation for matches: a match is finally adopted only if there is\r\n * no better match at the next window position.\r\n */\r\n    function deflate_slow(s, flush) {\r\n      var hash_head;          /* head of hash chain */\r\n      var bflush;              /* set if current block must be flushed */\r\n\r\n      var max_insert;\r\n\r\n      /* Process the input block. */\r\n      for (;;) {\r\n        /* Make sure that we always have enough lookahead, except\r\n     * at the end of the input file. We need MAX_MATCH bytes\r\n     * for the next match, plus MIN_MATCH bytes to insert the\r\n     * string following the next match.\r\n     */\r\n        if (s.lookahead < MIN_LOOKAHEAD) {\r\n          fill_window(s);\r\n          if (s.lookahead < MIN_LOOKAHEAD && flush === Z_NO_FLUSH) {\r\n            return BS_NEED_MORE;\r\n          }\r\n          if (s.lookahead === 0) { break; } /* flush the current block */\r\n        }\r\n\r\n        /* Insert the string window[strstart .. strstart+2] in the\r\n     * dictionary, and set hash_head to the head of the hash chain:\r\n     */\r\n        hash_head = 0/*NIL*/;\r\n        if (s.lookahead >= MIN_MATCH) {\r\n          /*** INSERT_STRING(s, s.strstart, hash_head); ***/\r\n          s.ins_h = ((s.ins_h << s.hash_shift) ^ s.window[s.strstart + MIN_MATCH - 1]) & s.hash_mask;\r\n          hash_head = s.prev[s.strstart & s.w_mask] = s.head[s.ins_h];\r\n          s.head[s.ins_h] = s.strstart;\r\n          /***/\r\n        }\r\n\r\n        /* Find the longest match, discarding those <= prev_length.\r\n     */\r\n        s.prev_length = s.match_length;\r\n        s.prev_match = s.match_start;\r\n        s.match_length = MIN_MATCH-1;\r\n\r\n        if (hash_head !== 0/*NIL*/ && s.prev_length < s.max_lazy_match &&\r\n          s.strstart - hash_head <= (s.w_size-MIN_LOOKAHEAD)/*MAX_DIST(s)*/) {\r\n          /* To simplify the code, we prevent matches with the string\r\n       * of window index 0 (in particular we have to avoid a match\r\n       * of the string with itself at the start of the input file).\r\n       */\r\n          s.match_length = longest_match(s, hash_head);\r\n          /* longest_match() sets match_start */\r\n\r\n          if (s.match_length <= 5 &&\r\n            (s.strategy === Z_FILTERED || (s.match_length === MIN_MATCH && s.strstart - s.match_start > 4096/*TOO_FAR*/))) {\r\n\r\n            /* If prev_match is also MIN_MATCH, match_start is garbage\r\n         * but we will ignore the current match anyway.\r\n         */\r\n            s.match_length = MIN_MATCH-1;\r\n          }\r\n        }\r\n        /* If there was a match at the previous step and the current\r\n     * match is not better, output the previous match:\r\n     */\r\n        if (s.prev_length >= MIN_MATCH && s.match_length <= s.prev_length) {\r\n          max_insert = s.strstart + s.lookahead - MIN_MATCH;\r\n          /* Do not insert strings in hash table beyond this. */\r\n\r\n          //check_match(s, s.strstart-1, s.prev_match, s.prev_length);\r\n\r\n          /***_tr_tally_dist(s, s.strstart - 1 - s.prev_match,\r\n           s.prev_length - MIN_MATCH, bflush);***/\r\n          bflush = trees._tr_tally(s, s.strstart - 1- s.prev_match, s.prev_length - MIN_MATCH);\r\n          /* Insert in hash table all strings up to the end of the match.\r\n       * strstart-1 and strstart are already inserted. If there is not\r\n       * enough lookahead, the last two strings are not inserted in\r\n       * the hash table.\r\n       */\r\n          s.lookahead -= s.prev_length-1;\r\n          s.prev_length -= 2;\r\n          do {\r\n            if (++s.strstart <= max_insert) {\r\n              /*** INSERT_STRING(s, s.strstart, hash_head); ***/\r\n              s.ins_h = ((s.ins_h << s.hash_shift) ^ s.window[s.strstart + MIN_MATCH - 1]) & s.hash_mask;\r\n              hash_head = s.prev[s.strstart & s.w_mask] = s.head[s.ins_h];\r\n              s.head[s.ins_h] = s.strstart;\r\n              /***/\r\n            }\r\n          } while (--s.prev_length !== 0);\r\n          s.match_available = 0;\r\n          s.match_length = MIN_MATCH-1;\r\n          s.strstart++;\r\n\r\n          if (bflush) {\r\n            /*** FLUSH_BLOCK(s, 0); ***/\r\n            flush_block_only(s, false);\r\n            if (s.strm.avail_out === 0) {\r\n              return BS_NEED_MORE;\r\n            }\r\n            /***/\r\n          }\r\n\r\n        } else if (s.match_available) {\r\n          /* If there was no match at the previous position, output a\r\n       * single literal. If there was a match but the current match\r\n       * is longer, truncate the previous match to a single literal.\r\n       */\r\n          //Tracevv((stderr,\"%c\", s->window[s->strstart-1]));\r\n          /*** _tr_tally_lit(s, s.window[s.strstart-1], bflush); ***/\r\n          bflush = trees._tr_tally(s, 0, s.window[s.strstart-1]);\r\n\r\n          if (bflush) {\r\n            /*** FLUSH_BLOCK_ONLY(s, 0) ***/\r\n            flush_block_only(s, false);\r\n            /***/\r\n          }\r\n          s.strstart++;\r\n          s.lookahead--;\r\n          if (s.strm.avail_out === 0) {\r\n            return BS_NEED_MORE;\r\n          }\r\n        } else {\r\n          /* There is no previous match to compare with, wait for\r\n       * the next step to decide.\r\n       */\r\n          s.match_available = 1;\r\n          s.strstart++;\r\n          s.lookahead--;\r\n        }\r\n      }\r\n      //Assert (flush != Z_NO_FLUSH, \"no flush?\");\r\n      if (s.match_available) {\r\n        //Tracevv((stderr,\"%c\", s->window[s->strstart-1]));\r\n        /*** _tr_tally_lit(s, s.window[s.strstart-1], bflush); ***/\r\n        bflush = trees._tr_tally(s, 0, s.window[s.strstart-1]);\r\n\r\n        s.match_available = 0;\r\n      }\r\n      s.insert = s.strstart < MIN_MATCH-1 ? s.strstart : MIN_MATCH-1;\r\n      if (flush === Z_FINISH) {\r\n        /*** FLUSH_BLOCK(s, 1); ***/\r\n        flush_block_only(s, true);\r\n        if (s.strm.avail_out === 0) {\r\n          return BS_FINISH_STARTED;\r\n        }\r\n        /***/\r\n        return BS_FINISH_DONE;\r\n      }\r\n      if (s.last_lit) {\r\n        /*** FLUSH_BLOCK(s, 0); ***/\r\n        flush_block_only(s, false);\r\n        if (s.strm.avail_out === 0) {\r\n          return BS_NEED_MORE;\r\n        }\r\n        /***/\r\n      }\r\n\r\n      return BS_BLOCK_DONE;\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * For Z_RLE, simply look for runs of bytes, generate matches only of distance\r\n * one.  Do not maintain a hash table.  (It will be regenerated if this run of\r\n * deflate switches away from Z_RLE.)\r\n */\r\n    function deflate_rle(s, flush) {\r\n      var bflush;            /* set if current block must be flushed */\r\n      var prev;              /* byte at distance one to match */\r\n      var scan, strend;      /* scan goes up to strend for length of run */\r\n\r\n      var _win = s.window;\r\n\r\n      for (;;) {\r\n        /* Make sure that we always have enough lookahead, except\r\n     * at the end of the input file. We need MAX_MATCH bytes\r\n     * for the longest run, plus one for the unrolled loop.\r\n     */\r\n        if (s.lookahead <= MAX_MATCH) {\r\n          fill_window(s);\r\n          if (s.lookahead <= MAX_MATCH && flush === Z_NO_FLUSH) {\r\n            return BS_NEED_MORE;\r\n          }\r\n          if (s.lookahead === 0) { break; } /* flush the current block */\r\n        }\r\n\r\n        /* See how many times the previous byte repeats */\r\n        s.match_length = 0;\r\n        if (s.lookahead >= MIN_MATCH && s.strstart > 0) {\r\n          scan = s.strstart - 1;\r\n          prev = _win[scan];\r\n          if (prev === _win[++scan] && prev === _win[++scan] && prev === _win[++scan]) {\r\n            strend = s.strstart + MAX_MATCH;\r\n            do {\r\n              /*jshint noempty:false*/\r\n            } while (prev === _win[++scan] && prev === _win[++scan] &&\r\n            prev === _win[++scan] && prev === _win[++scan] &&\r\n            prev === _win[++scan] && prev === _win[++scan] &&\r\n            prev === _win[++scan] && prev === _win[++scan] &&\r\n            scan < strend);\r\n            s.match_length = MAX_MATCH - (strend - scan);\r\n            if (s.match_length > s.lookahead) {\r\n              s.match_length = s.lookahead;\r\n            }\r\n          }\r\n          //Assert(scan <= s->window+(uInt)(s->window_size-1), \"wild scan\");\r\n        }\r\n\r\n        /* Emit match if have run of MIN_MATCH or longer, else emit literal */\r\n        if (s.match_length >= MIN_MATCH) {\r\n          //check_match(s, s.strstart, s.strstart - 1, s.match_length);\r\n\r\n          /*** _tr_tally_dist(s, 1, s.match_length - MIN_MATCH, bflush); ***/\r\n          bflush = trees._tr_tally(s, 1, s.match_length - MIN_MATCH);\r\n\r\n          s.lookahead -= s.match_length;\r\n          s.strstart += s.match_length;\r\n          s.match_length = 0;\r\n        } else {\r\n          /* No match, output a literal byte */\r\n          //Tracevv((stderr,\"%c\", s->window[s->strstart]));\r\n          /*** _tr_tally_lit(s, s.window[s.strstart], bflush); ***/\r\n          bflush = trees._tr_tally(s, 0, s.window[s.strstart]);\r\n\r\n          s.lookahead--;\r\n          s.strstart++;\r\n        }\r\n        if (bflush) {\r\n          /*** FLUSH_BLOCK(s, 0); ***/\r\n          flush_block_only(s, false);\r\n          if (s.strm.avail_out === 0) {\r\n            return BS_NEED_MORE;\r\n          }\r\n          /***/\r\n        }\r\n      }\r\n      s.insert = 0;\r\n      if (flush === Z_FINISH) {\r\n        /*** FLUSH_BLOCK(s, 1); ***/\r\n        flush_block_only(s, true);\r\n        if (s.strm.avail_out === 0) {\r\n          return BS_FINISH_STARTED;\r\n        }\r\n        /***/\r\n        return BS_FINISH_DONE;\r\n      }\r\n      if (s.last_lit) {\r\n        /*** FLUSH_BLOCK(s, 0); ***/\r\n        flush_block_only(s, false);\r\n        if (s.strm.avail_out === 0) {\r\n          return BS_NEED_MORE;\r\n        }\r\n        /***/\r\n      }\r\n      return BS_BLOCK_DONE;\r\n    }\r\n\r\n    /* ===========================================================================\r\n * For Z_HUFFMAN_ONLY, do not look for matches.  Do not maintain a hash table.\r\n * (It will be regenerated if this run of deflate switches away from Huffman.)\r\n */\r\n    function deflate_huff(s, flush) {\r\n      var bflush;             /* set if current block must be flushed */\r\n\r\n      for (;;) {\r\n        /* Make sure that we have a literal to write. */\r\n        if (s.lookahead === 0) {\r\n          fill_window(s);\r\n          if (s.lookahead === 0) {\r\n            if (flush === Z_NO_FLUSH) {\r\n              return BS_NEED_MORE;\r\n            }\r\n            break;      /* flush the current block */\r\n          }\r\n        }\r\n\r\n        /* Output a literal byte */\r\n        s.match_length = 0;\r\n        //Tracevv((stderr,\"%c\", s->window[s->strstart]));\r\n        /*** _tr_tally_lit(s, s.window[s.strstart], bflush); ***/\r\n        bflush = trees._tr_tally(s, 0, s.window[s.strstart]);\r\n        s.lookahead--;\r\n        s.strstart++;\r\n        if (bflush) {\r\n          /*** FLUSH_BLOCK(s, 0); ***/\r\n          flush_block_only(s, false);\r\n          if (s.strm.avail_out === 0) {\r\n            return BS_NEED_MORE;\r\n          }\r\n          /***/\r\n        }\r\n      }\r\n      s.insert = 0;\r\n      if (flush === Z_FINISH) {\r\n        /*** FLUSH_BLOCK(s, 1); ***/\r\n        flush_block_only(s, true);\r\n        if (s.strm.avail_out === 0) {\r\n          return BS_FINISH_STARTED;\r\n        }\r\n        /***/\r\n        return BS_FINISH_DONE;\r\n      }\r\n      if (s.last_lit) {\r\n        /*** FLUSH_BLOCK(s, 0); ***/\r\n        flush_block_only(s, false);\r\n        if (s.strm.avail_out === 0) {\r\n          return BS_NEED_MORE;\r\n        }\r\n        /***/\r\n      }\r\n      return BS_BLOCK_DONE;\r\n    }\r\n\r\n    /* Values for max_lazy_match, good_match and max_chain_length, depending on\r\n * the desired pack level (0..9). The values given below have been tuned to\r\n * exclude worst case performance for pathological files. Better values may be\r\n * found for specific files.\r\n */\r\n    var Config = function (good_length, max_lazy, nice_length, max_chain, func) {\r\n      this.good_length = good_length;\r\n      this.max_lazy = max_lazy;\r\n      this.nice_length = nice_length;\r\n      this.max_chain = max_chain;\r\n      this.func = func;\r\n    };\r\n\r\n    var configuration_table;\r\n\r\n    configuration_table = [\r\n      /*      good lazy nice chain */\r\n      new Config(0, 0, 0, 0, deflate_stored),          /* 0 store only */\r\n      new Config(4, 4, 8, 4, deflate_fast),            /* 1 max speed, no lazy matches */\r\n      new Config(4, 5, 16, 8, deflate_fast),           /* 2 */\r\n      new Config(4, 6, 32, 32, deflate_fast),          /* 3 */\r\n\r\n      new Config(4, 4, 16, 16, deflate_slow),          /* 4 lazy matches */\r\n      new Config(8, 16, 32, 32, deflate_slow),         /* 5 */\r\n      new Config(8, 16, 128, 128, deflate_slow),       /* 6 */\r\n      new Config(8, 32, 128, 256, deflate_slow),       /* 7 */\r\n      new Config(32, 128, 258, 1024, deflate_slow),    /* 8 */\r\n      new Config(32, 258, 258, 4096, deflate_slow)     /* 9 max compression */\r\n    ];\r\n\r\n\r\n    /* ===========================================================================\r\n * Initialize the \"longest match\" routines for a new zlib stream\r\n */\r\n    function lm_init(s) {\r\n      s.window_size = 2 * s.w_size;\r\n\r\n      /*** CLEAR_HASH(s); ***/\r\n      zero(s.head); // Fill with NIL (= 0);\r\n\r\n      /* Set the default configuration parameters:\r\n   */\r\n      s.max_lazy_match = configuration_table[s.level].max_lazy;\r\n      s.good_match = configuration_table[s.level].good_length;\r\n      s.nice_match = configuration_table[s.level].nice_length;\r\n      s.max_chain_length = configuration_table[s.level].max_chain;\r\n\r\n      s.strstart = 0;\r\n      s.block_start = 0;\r\n      s.lookahead = 0;\r\n      s.insert = 0;\r\n      s.match_length = s.prev_length = MIN_MATCH - 1;\r\n      s.match_available = 0;\r\n      s.ins_h = 0;\r\n    }\r\n\r\n\r\n    function DeflateState() {\r\n      this.strm = null;            /* pointer back to this zlib stream */\r\n      this.status = 0;            /* as the name implies */\r\n      this.pending_buf = null;      /* output still pending */\r\n      this.pending_buf_size = 0;  /* size of pending_buf */\r\n      this.pending_out = 0;       /* next pending byte to output to the stream */\r\n      this.pending = 0;           /* nb of bytes in the pending buffer */\r\n      this.wrap = 0;              /* bit 0 true for zlib, bit 1 true for gzip */\r\n      this.gzhead = null;         /* gzip header information to write */\r\n      this.gzindex = 0;           /* where in extra, name, or comment */\r\n      this.method = Z_DEFLATED; /* can only be DEFLATED */\r\n      this.last_flush = -1;   /* value of flush param for previous deflate call */\r\n\r\n      this.w_size = 0;  /* LZ77 window size (32K by default) */\r\n      this.w_bits = 0;  /* log2(w_size)  (8..16) */\r\n      this.w_mask = 0;  /* w_size - 1 */\r\n\r\n      this.window = null;\r\n      /* Sliding window. Input bytes are read into the second half of the window,\r\n   * and move to the first half later to keep a dictionary of at least wSize\r\n   * bytes. With this organization, matches are limited to a distance of\r\n   * wSize-MAX_MATCH bytes, but this ensures that IO is always\r\n   * performed with a length multiple of the block size.\r\n   */\r\n\r\n      this.window_size = 0;\r\n      /* Actual size of window: 2*wSize, except when the user input buffer\r\n   * is directly used as sliding window.\r\n   */\r\n\r\n      this.prev = null;\r\n      /* Link to older string with same hash index. To limit the size of this\r\n   * array to 64K, this link is maintained only for the last 32K strings.\r\n   * An index in this array is thus a window index modulo 32K.\r\n   */\r\n\r\n      this.head = null;   /* Heads of the hash chains or NIL. */\r\n\r\n      this.ins_h = 0;       /* hash index of string to be inserted */\r\n      this.hash_size = 0;   /* number of elements in hash table */\r\n      this.hash_bits = 0;   /* log2(hash_size) */\r\n      this.hash_mask = 0;   /* hash_size-1 */\r\n\r\n      this.hash_shift = 0;\r\n      /* Number of bits by which ins_h must be shifted at each input\r\n   * step. It must be such that after MIN_MATCH steps, the oldest\r\n   * byte no longer takes part in the hash key, that is:\r\n   *   hash_shift * MIN_MATCH >= hash_bits\r\n   */\r\n\r\n      this.block_start = 0;\r\n      /* Window position at the beginning of the current output block. Gets\r\n   * negative when the window is moved backwards.\r\n   */\r\n\r\n      this.match_length = 0;      /* length of best match */\r\n      this.prev_match = 0;        /* previous match */\r\n      this.match_available = 0;   /* set if previous match exists */\r\n      this.strstart = 0;          /* start of string to insert */\r\n      this.match_start = 0;       /* start of matching string */\r\n      this.lookahead = 0;         /* number of valid bytes ahead in window */\r\n\r\n      this.prev_length = 0;\r\n      /* Length of the best match at previous step. Matches not greater than this\r\n   * are discarded. This is used in the lazy match evaluation.\r\n   */\r\n\r\n      this.max_chain_length = 0;\r\n      /* To speed up deflation, hash chains are never searched beyond this\r\n   * length.  A higher limit improves compression ratio but degrades the\r\n   * speed.\r\n   */\r\n\r\n      this.max_lazy_match = 0;\r\n      /* Attempt to find a better match only when the current match is strictly\r\n   * smaller than this value. This mechanism is used only for compression\r\n   * levels >= 4.\r\n   */\r\n      // That's alias to max_lazy_match, don't use directly\r\n      //this.max_insert_length = 0;\r\n      /* Insert new strings in the hash table only if the match length is not\r\n   * greater than this length. This saves time but degrades compression.\r\n   * max_insert_length is used only for compression levels <= 3.\r\n   */\r\n\r\n      this.level = 0;     /* compression level (1..9) */\r\n      this.strategy = 0;  /* favor or force Huffman coding*/\r\n\r\n      this.good_match = 0;\r\n      /* Use a faster search when the previous match is longer than this */\r\n\r\n      this.nice_match = 0; /* Stop searching when current match exceeds this */\r\n\r\n      /* used by trees.c: */\r\n\r\n      /* Didn't use ct_data typedef below to suppress compiler warning */\r\n\r\n      // struct ct_data_s dyn_ltree[HEAP_SIZE];   /* literal and length tree */\r\n      // struct ct_data_s dyn_dtree[2*D_CODES+1]; /* distance tree */\r\n      // struct ct_data_s bl_tree[2*BL_CODES+1];  /* Huffman tree for bit lengths */\r\n\r\n      // Use flat array of DOUBLE size, with interleaved fata,\r\n      // because JS does not support effective\r\n      this.dyn_ltree  = new utils.Buf16(HEAP_SIZE * 2);\r\n      this.dyn_dtree  = new utils.Buf16((2*D_CODES+1) * 2);\r\n      this.bl_tree    = new utils.Buf16((2*BL_CODES+1) * 2);\r\n      zero(this.dyn_ltree);\r\n      zero(this.dyn_dtree);\r\n      zero(this.bl_tree);\r\n\r\n      this.l_desc   = null;         /* desc. for literal tree */\r\n      this.d_desc   = null;         /* desc. for distance tree */\r\n      this.bl_desc  = null;         /* desc. for bit length tree */\r\n\r\n      //ush bl_count[MAX_BITS+1];\r\n      this.bl_count = new utils.Buf16(MAX_BITS+1);\r\n      /* number of codes at each bit length for an optimal tree */\r\n\r\n      //int heap[2*L_CODES+1];      /* heap used to build the Huffman trees */\r\n      this.heap = new utils.Buf16(2*L_CODES+1);  /* heap used to build the Huffman trees */\r\n      zero(this.heap);\r\n\r\n      this.heap_len = 0;               /* number of elements in the heap */\r\n      this.heap_max = 0;               /* element of largest frequency */\r\n      /* The sons of heap[n] are heap[2*n] and heap[2*n+1]. heap[0] is not used.\r\n   * The same heap array is used to build all trees.\r\n   */\r\n\r\n      this.depth = new utils.Buf16(2*L_CODES+1); //uch depth[2*L_CODES+1];\r\n      zero(this.depth);\r\n      /* Depth of each subtree used as tie breaker for trees of equal frequency\r\n   */\r\n\r\n      this.l_buf = 0;          /* buffer index for literals or lengths */\r\n\r\n      this.lit_bufsize = 0;\r\n      /* Size of match buffer for literals/lengths.  There are 4 reasons for\r\n   * limiting lit_bufsize to 64K:\r\n   *   - frequencies can be kept in 16 bit counters\r\n   *   - if compression is not successful for the first block, all input\r\n   *     data is still in the window so we can still emit a stored block even\r\n   *     when input comes from standard input.  (This can also be done for\r\n   *     all blocks if lit_bufsize is not greater than 32K.)\r\n   *   - if compression is not successful for a file smaller than 64K, we can\r\n   *     even emit a stored file instead of a stored block (saving 5 bytes).\r\n   *     This is applicable only for zip (not gzip or zlib).\r\n   *   - creating new Huffman trees less frequently may not provide fast\r\n   *     adaptation to changes in the input data statistics. (Take for\r\n   *     example a binary file with poorly compressible code followed by\r\n   *     a highly compressible string table.) Smaller buffer sizes give\r\n   *     fast adaptation but have of course the overhead of transmitting\r\n   *     trees more frequently.\r\n   *   - I can't count above 4\r\n   */\r\n\r\n      this.last_lit = 0;      /* running index in l_buf */\r\n\r\n      this.d_buf = 0;\r\n      /* Buffer index for distances. To simplify the code, d_buf and l_buf have\r\n   * the same number of elements. To use different lengths, an extra flag\r\n   * array would be necessary.\r\n   */\r\n\r\n      this.opt_len = 0;       /* bit length of current block with optimal trees */\r\n      this.static_len = 0;    /* bit length of current block with static trees */\r\n      this.matches = 0;       /* number of string matches in current block */\r\n      this.insert = 0;        /* bytes at end of window left to insert */\r\n\r\n\r\n      this.bi_buf = 0;\r\n      /* Output buffer. bits are inserted starting at the bottom (least\r\n   * significant bits).\r\n   */\r\n      this.bi_valid = 0;\r\n      /* Number of valid bits in bi_buf.  All bits above the last valid bit\r\n   * are always zero.\r\n   */\r\n\r\n      // Used for window memory init. We safely ignore it for JS. That makes\r\n      // sense only for pointers and memory check tools.\r\n      //this.high_water = 0;\r\n      /* High water mark offset in window for initialized bytes -- bytes above\r\n   * this are set to zero in order to avoid memory check warnings when\r\n   * longest match routines access bytes past the input.  This is then\r\n   * updated to the new high water mark.\r\n   */\r\n    }\r\n\r\n\r\n    function deflateResetKeep(strm) {\r\n      var s;\r\n\r\n      if (!strm || !strm.state) {\r\n        return err(strm, Z_STREAM_ERROR);\r\n      }\r\n\r\n      strm.total_in = strm.total_out = 0;\r\n      strm.data_type = Z_UNKNOWN;\r\n\r\n      s = strm.state;\r\n      s.pending = 0;\r\n      s.pending_out = 0;\r\n\r\n      if (s.wrap < 0) {\r\n        s.wrap = -s.wrap;\r\n        /* was made negative by deflate(..., Z_FINISH); */\r\n      }\r\n      s.status = (s.wrap ? INIT_STATE : BUSY_STATE);\r\n      strm.adler = (s.wrap === 2) ?\r\n        0  // crc32(0, Z_NULL, 0)\r\n        :\r\n        1; // adler32(0, Z_NULL, 0)\r\n      s.last_flush = Z_NO_FLUSH;\r\n      trees._tr_init(s);\r\n      return Z_OK;\r\n    }\r\n\r\n\r\n    function deflateReset(strm) {\r\n      var ret = deflateResetKeep(strm);\r\n      if (ret === Z_OK) {\r\n        lm_init(strm.state);\r\n      }\r\n      return ret;\r\n    }\r\n\r\n\r\n    function deflateSetHeader(strm, head) {\r\n      if (!strm || !strm.state) { return Z_STREAM_ERROR; }\r\n      if (strm.state.wrap !== 2) { return Z_STREAM_ERROR; }\r\n      strm.state.gzhead = head;\r\n      return Z_OK;\r\n    }\r\n\r\n\r\n    function deflateInit2(strm, level, method, windowBits, memLevel, strategy) {\r\n      if (!strm) { // === Z_NULL\r\n        return Z_STREAM_ERROR;\r\n      }\r\n      var wrap = 1;\r\n\r\n      if (level === Z_DEFAULT_COMPRESSION) {\r\n        level = 6;\r\n      }\r\n\r\n      if (windowBits < 0) { /* suppress zlib wrapper */\r\n        wrap = 0;\r\n        windowBits = -windowBits;\r\n      }\r\n\r\n      else if (windowBits > 15) {\r\n        wrap = 2;           /* write gzip wrapper instead */\r\n        windowBits -= 16;\r\n      }\r\n\r\n\r\n      if (memLevel < 1 || memLevel > MAX_MEM_LEVEL || method !== Z_DEFLATED ||\r\n        windowBits < 8 || windowBits > 15 || level < 0 || level > 9 ||\r\n        strategy < 0 || strategy > Z_FIXED) {\r\n        return err(strm, Z_STREAM_ERROR);\r\n      }\r\n\r\n\r\n      if (windowBits === 8) {\r\n        windowBits = 9;\r\n      }\r\n      /* until 256-byte window bug fixed */\r\n\r\n      var s = new DeflateState();\r\n\r\n      strm.state = s;\r\n      s.strm = strm;\r\n\r\n      s.wrap = wrap;\r\n      s.gzhead = null;\r\n      s.w_bits = windowBits;\r\n      s.w_size = 1 << s.w_bits;\r\n      s.w_mask = s.w_size - 1;\r\n\r\n      s.hash_bits = memLevel + 7;\r\n      s.hash_size = 1 << s.hash_bits;\r\n      s.hash_mask = s.hash_size - 1;\r\n      s.hash_shift = ~~((s.hash_bits + MIN_MATCH - 1) / MIN_MATCH);\r\n\r\n      s.window = new utils.Buf8(s.w_size * 2);\r\n      s.head = new utils.Buf16(s.hash_size);\r\n      s.prev = new utils.Buf16(s.w_size);\r\n\r\n      // Don't need mem init magic for JS.\r\n      //s.high_water = 0;  /* nothing written to s->window yet */\r\n\r\n      s.lit_bufsize = 1 << (memLevel + 6); /* 16K elements by default */\r\n\r\n      s.pending_buf_size = s.lit_bufsize * 4;\r\n      s.pending_buf = new utils.Buf8(s.pending_buf_size);\r\n\r\n      s.d_buf = s.lit_bufsize >> 1;\r\n      s.l_buf = (1 + 2) * s.lit_bufsize;\r\n\r\n      s.level = level;\r\n      s.strategy = strategy;\r\n      s.method = method;\r\n\r\n      return deflateReset(strm);\r\n    }\r\n\r\n    function deflateInit(strm, level) {\r\n      return deflateInit2(strm, level, Z_DEFLATED, MAX_WBITS, DEF_MEM_LEVEL, Z_DEFAULT_STRATEGY);\r\n    }\r\n\r\n\r\n    function deflate(strm, flush) {\r\n      var old_flush, s;\r\n      var beg, val; // for gzip header write only\r\n\r\n      if (!strm || !strm.state ||\r\n        flush > Z_BLOCK || flush < 0) {\r\n        return strm ? err(strm, Z_STREAM_ERROR) : Z_STREAM_ERROR;\r\n      }\r\n\r\n      s = strm.state;\r\n\r\n      if (!strm.output ||\r\n        (!strm.input && strm.avail_in !== 0) ||\r\n        (s.status === FINISH_STATE && flush !== Z_FINISH)) {\r\n        return err(strm, (strm.avail_out === 0) ? Z_BUF_ERROR : Z_STREAM_ERROR);\r\n      }\r\n\r\n      s.strm = strm; /* just in case */\r\n      old_flush = s.last_flush;\r\n      s.last_flush = flush;\r\n\r\n      /* Write the header */\r\n      if (s.status === INIT_STATE) {\r\n\r\n        if (s.wrap === 2) { // GZIP header\r\n          strm.adler = 0;  //crc32(0L, Z_NULL, 0);\r\n          put_byte(s, 31);\r\n          put_byte(s, 139);\r\n          put_byte(s, 8);\r\n          if (!s.gzhead) { // s->gzhead == Z_NULL\r\n            put_byte(s, 0);\r\n            put_byte(s, 0);\r\n            put_byte(s, 0);\r\n            put_byte(s, 0);\r\n            put_byte(s, 0);\r\n            put_byte(s, s.level === 9 ? 2 :\r\n              (s.strategy >= Z_HUFFMAN_ONLY || s.level < 2 ?\r\n                4 : 0));\r\n            put_byte(s, OS_CODE);\r\n            s.status = BUSY_STATE;\r\n          }\r\n          else {\r\n            put_byte(s, (s.gzhead.text ? 1 : 0) +\r\n              (s.gzhead.hcrc ? 2 : 0) +\r\n              (!s.gzhead.extra ? 0 : 4) +\r\n              (!s.gzhead.name ? 0 : 8) +\r\n              (!s.gzhead.comment ? 0 : 16)\r\n            );\r\n            put_byte(s, s.gzhead.time & 0xff);\r\n            put_byte(s, (s.gzhead.time >> 8) & 0xff);\r\n            put_byte(s, (s.gzhead.time >> 16) & 0xff);\r\n            put_byte(s, (s.gzhead.time >> 24) & 0xff);\r\n            put_byte(s, s.level === 9 ? 2 :\r\n              (s.strategy >= Z_HUFFMAN_ONLY || s.level < 2 ?\r\n                4 : 0));\r\n            put_byte(s, s.gzhead.os & 0xff);\r\n            if (s.gzhead.extra && s.gzhead.extra.length) {\r\n              put_byte(s, s.gzhead.extra.length & 0xff);\r\n              put_byte(s, (s.gzhead.extra.length >> 8) & 0xff);\r\n            }\r\n            if (s.gzhead.hcrc) {\r\n              strm.adler = crc32(strm.adler, s.pending_buf, s.pending, 0);\r\n            }\r\n            s.gzindex = 0;\r\n            s.status = EXTRA_STATE;\r\n          }\r\n        }\r\n        else // DEFLATE header\r\n        {\r\n          var header = (Z_DEFLATED + ((s.w_bits - 8) << 4)) << 8;\r\n          var level_flags = -1;\r\n\r\n          if (s.strategy >= Z_HUFFMAN_ONLY || s.level < 2) {\r\n            level_flags = 0;\r\n          } else if (s.level < 6) {\r\n            level_flags = 1;\r\n          } else if (s.level === 6) {\r\n            level_flags = 2;\r\n          } else {\r\n            level_flags = 3;\r\n          }\r\n          header |= (level_flags << 6);\r\n          if (s.strstart !== 0) { header |= PRESET_DICT; }\r\n          header += 31 - (header % 31);\r\n\r\n          s.status = BUSY_STATE;\r\n          putShortMSB(s, header);\r\n\r\n          /* Save the adler32 of the preset dictionary: */\r\n          if (s.strstart !== 0) {\r\n            putShortMSB(s, strm.adler >>> 16);\r\n            putShortMSB(s, strm.adler & 0xffff);\r\n          }\r\n          strm.adler = 1; // adler32(0L, Z_NULL, 0);\r\n        }\r\n      }\r\n\r\n//#ifdef GZIP\r\n      if (s.status === EXTRA_STATE) {\r\n        if (s.gzhead.extra/* != Z_NULL*/) {\r\n          beg = s.pending;  /* start of bytes to update crc */\r\n\r\n          while (s.gzindex < (s.gzhead.extra.length & 0xffff)) {\r\n            if (s.pending === s.pending_buf_size) {\r\n              if (s.gzhead.hcrc && s.pending > beg) {\r\n                strm.adler = crc32(strm.adler, s.pending_buf, s.pending - beg, beg);\r\n              }\r\n              flush_pending(strm);\r\n              beg = s.pending;\r\n              if (s.pending === s.pending_buf_size) {\r\n                break;\r\n              }\r\n            }\r\n            put_byte(s, s.gzhead.extra[s.gzindex] & 0xff);\r\n            s.gzindex++;\r\n          }\r\n          if (s.gzhead.hcrc && s.pending > beg) {\r\n            strm.adler = crc32(strm.adler, s.pending_buf, s.pending - beg, beg);\r\n          }\r\n          if (s.gzindex === s.gzhead.extra.length) {\r\n            s.gzindex = 0;\r\n            s.status = NAME_STATE;\r\n          }\r\n        }\r\n        else {\r\n          s.status = NAME_STATE;\r\n        }\r\n      }\r\n      if (s.status === NAME_STATE) {\r\n        if (s.gzhead.name/* != Z_NULL*/) {\r\n          beg = s.pending;  /* start of bytes to update crc */\r\n          //int val;\r\n\r\n          do {\r\n            if (s.pending === s.pending_buf_size) {\r\n              if (s.gzhead.hcrc && s.pending > beg) {\r\n                strm.adler = crc32(strm.adler, s.pending_buf, s.pending - beg, beg);\r\n              }\r\n              flush_pending(strm);\r\n              beg = s.pending;\r\n              if (s.pending === s.pending_buf_size) {\r\n                val = 1;\r\n                break;\r\n              }\r\n            }\r\n            // JS specific: little magic to add zero terminator to end of string\r\n            if (s.gzindex < s.gzhead.name.length) {\r\n              val = s.gzhead.name.charCodeAt(s.gzindex++) & 0xff;\r\n            } else {\r\n              val = 0;\r\n            }\r\n            put_byte(s, val);\r\n          } while (val !== 0);\r\n\r\n          if (s.gzhead.hcrc && s.pending > beg){\r\n            strm.adler = crc32(strm.adler, s.pending_buf, s.pending - beg, beg);\r\n          }\r\n          if (val === 0) {\r\n            s.gzindex = 0;\r\n            s.status = COMMENT_STATE;\r\n          }\r\n        }\r\n        else {\r\n          s.status = COMMENT_STATE;\r\n        }\r\n      }\r\n      if (s.status === COMMENT_STATE) {\r\n        if (s.gzhead.comment/* != Z_NULL*/) {\r\n          beg = s.pending;  /* start of bytes to update crc */\r\n          //int val;\r\n\r\n          do {\r\n            if (s.pending === s.pending_buf_size) {\r\n              if (s.gzhead.hcrc && s.pending > beg) {\r\n                strm.adler = crc32(strm.adler, s.pending_buf, s.pending - beg, beg);\r\n              }\r\n              flush_pending(strm);\r\n              beg = s.pending;\r\n              if (s.pending === s.pending_buf_size) {\r\n                val = 1;\r\n                break;\r\n              }\r\n            }\r\n            // JS specific: little magic to add zero terminator to end of string\r\n            if (s.gzindex < s.gzhead.comment.length) {\r\n              val = s.gzhead.comment.charCodeAt(s.gzindex++) & 0xff;\r\n            } else {\r\n              val = 0;\r\n            }\r\n            put_byte(s, val);\r\n          } while (val !== 0);\r\n\r\n          if (s.gzhead.hcrc && s.pending > beg) {\r\n            strm.adler = crc32(strm.adler, s.pending_buf, s.pending - beg, beg);\r\n          }\r\n          if (val === 0) {\r\n            s.status = HCRC_STATE;\r\n          }\r\n        }\r\n        else {\r\n          s.status = HCRC_STATE;\r\n        }\r\n      }\r\n      if (s.status === HCRC_STATE) {\r\n        if (s.gzhead.hcrc) {\r\n          if (s.pending + 2 > s.pending_buf_size) {\r\n            flush_pending(strm);\r\n          }\r\n          if (s.pending + 2 <= s.pending_buf_size) {\r\n            put_byte(s, strm.adler & 0xff);\r\n            put_byte(s, (strm.adler >> 8) & 0xff);\r\n            strm.adler = 0; //crc32(0L, Z_NULL, 0);\r\n            s.status = BUSY_STATE;\r\n          }\r\n        }\r\n        else {\r\n          s.status = BUSY_STATE;\r\n        }\r\n      }\r\n//#endif\r\n\r\n      /* Flush as much pending output as possible */\r\n      if (s.pending !== 0) {\r\n        flush_pending(strm);\r\n        if (strm.avail_out === 0) {\r\n          /* Since avail_out is 0, deflate will be called again with\r\n       * more output space, but possibly with both pending and\r\n       * avail_in equal to zero. There won't be anything to do,\r\n       * but this is not an error situation so make sure we\r\n       * return OK instead of BUF_ERROR at next call of deflate:\r\n       */\r\n          s.last_flush = -1;\r\n          return Z_OK;\r\n        }\r\n\r\n        /* Make sure there is something to do and avoid duplicate consecutive\r\n     * flushes. For repeated and useless calls with Z_FINISH, we keep\r\n     * returning Z_STREAM_END instead of Z_BUF_ERROR.\r\n     */\r\n      } else if (strm.avail_in === 0 && rank(flush) <= rank(old_flush) &&\r\n        flush !== Z_FINISH) {\r\n        return err(strm, Z_BUF_ERROR);\r\n      }\r\n\r\n      /* User must not provide more input after the first FINISH: */\r\n      if (s.status === FINISH_STATE && strm.avail_in !== 0) {\r\n        return err(strm, Z_BUF_ERROR);\r\n      }\r\n\r\n      /* Start a new block or continue the current one.\r\n   */\r\n      if (strm.avail_in !== 0 || s.lookahead !== 0 ||\r\n        (flush !== Z_NO_FLUSH && s.status !== FINISH_STATE)) {\r\n        var bstate = (s.strategy === Z_HUFFMAN_ONLY) ? deflate_huff(s, flush) :\r\n          (s.strategy === Z_RLE ? deflate_rle(s, flush) :\r\n            configuration_table[s.level].func(s, flush));\r\n\r\n        if (bstate === BS_FINISH_STARTED || bstate === BS_FINISH_DONE) {\r\n          s.status = FINISH_STATE;\r\n        }\r\n        if (bstate === BS_NEED_MORE || bstate === BS_FINISH_STARTED) {\r\n          if (strm.avail_out === 0) {\r\n            s.last_flush = -1;\r\n            /* avoid BUF_ERROR next call, see above */\r\n          }\r\n          return Z_OK;\r\n          /* If flush != Z_NO_FLUSH && avail_out == 0, the next call\r\n       * of deflate should use the same flush parameter to make sure\r\n       * that the flush is complete. So we don't have to output an\r\n       * empty block here, this will be done at next call. This also\r\n       * ensures that for a very small output buffer, we emit at most\r\n       * one empty block.\r\n       */\r\n        }\r\n        if (bstate === BS_BLOCK_DONE) {\r\n          if (flush === Z_PARTIAL_FLUSH) {\r\n            trees._tr_align(s);\r\n          }\r\n          else if (flush !== Z_BLOCK) { /* FULL_FLUSH or SYNC_FLUSH */\r\n\r\n            trees._tr_stored_block(s, 0, 0, false);\r\n            /* For a full flush, this empty block will be recognized\r\n         * as a special marker by inflate_sync().\r\n         */\r\n            if (flush === Z_FULL_FLUSH) {\r\n              /*** CLEAR_HASH(s); ***/             /* forget history */\r\n              zero(s.head); // Fill with NIL (= 0);\r\n\r\n              if (s.lookahead === 0) {\r\n                s.strstart = 0;\r\n                s.block_start = 0;\r\n                s.insert = 0;\r\n              }\r\n            }\r\n          }\r\n          flush_pending(strm);\r\n          if (strm.avail_out === 0) {\r\n            s.last_flush = -1; /* avoid BUF_ERROR at next call, see above */\r\n            return Z_OK;\r\n          }\r\n        }\r\n      }\r\n      //Assert(strm->avail_out > 0, \"bug2\");\r\n      //if (strm.avail_out <= 0) { throw new Error(\"bug2\");}\r\n\r\n      if (flush !== Z_FINISH) { return Z_OK; }\r\n      if (s.wrap <= 0) { return Z_STREAM_END; }\r\n\r\n      /* Write the trailer */\r\n      if (s.wrap === 2) {\r\n        put_byte(s, strm.adler & 0xff);\r\n        put_byte(s, (strm.adler >> 8) & 0xff);\r\n        put_byte(s, (strm.adler >> 16) & 0xff);\r\n        put_byte(s, (strm.adler >> 24) & 0xff);\r\n        put_byte(s, strm.total_in & 0xff);\r\n        put_byte(s, (strm.total_in >> 8) & 0xff);\r\n        put_byte(s, (strm.total_in >> 16) & 0xff);\r\n        put_byte(s, (strm.total_in >> 24) & 0xff);\r\n      }\r\n      else\r\n      {\r\n        putShortMSB(s, strm.adler >>> 16);\r\n        putShortMSB(s, strm.adler & 0xffff);\r\n      }\r\n\r\n      flush_pending(strm);\r\n      /* If avail_out is zero, the application will call deflate again\r\n   * to flush the rest.\r\n   */\r\n      if (s.wrap > 0) { s.wrap = -s.wrap; }\r\n      /* write the trailer only once! */\r\n      return s.pending !== 0 ? Z_OK : Z_STREAM_END;\r\n    }\r\n\r\n    function deflateEnd(strm) {\r\n      var status;\r\n\r\n      if (!strm/*== Z_NULL*/ || !strm.state/*== Z_NULL*/) {\r\n        return Z_STREAM_ERROR;\r\n      }\r\n\r\n      status = strm.state.status;\r\n      if (status !== INIT_STATE &&\r\n        status !== EXTRA_STATE &&\r\n        status !== NAME_STATE &&\r\n        status !== COMMENT_STATE &&\r\n        status !== HCRC_STATE &&\r\n        status !== BUSY_STATE &&\r\n        status !== FINISH_STATE\r\n      ) {\r\n        return err(strm, Z_STREAM_ERROR);\r\n      }\r\n\r\n      strm.state = null;\r\n\r\n      return status === BUSY_STATE ? err(strm, Z_DATA_ERROR) : Z_OK;\r\n    }\r\n\r\n    /* =========================================================================\r\n * Copy the source state to the destination state\r\n */\r\n//function deflateCopy(dest, source) {\r\n//\r\n//}\r\n\r\n    exports.deflateInit = deflateInit;\r\n    exports.deflateInit2 = deflateInit2;\r\n    exports.deflateReset = deflateReset;\r\n    exports.deflateResetKeep = deflateResetKeep;\r\n    exports.deflateSetHeader = deflateSetHeader;\r\n    exports.deflate = deflate;\r\n    exports.deflateEnd = deflateEnd;\r\n    exports.deflateInfo = 'pako deflate (from Nodeca project)';\r\n\r\n    /* Not implemented\r\nexports.deflateBound = deflateBound;\r\nexports.deflateCopy = deflateCopy;\r\nexports.deflateSetDictionary = deflateSetDictionary;\r\nexports.deflateParams = deflateParams;\r\nexports.deflatePending = deflatePending;\r\nexports.deflatePrime = deflatePrime;\r\nexports.deflateTune = deflateTune;\r\n*/\r\n  },{\"../utils/common\":27,\"./adler32\":29,\"./crc32\":31,\"./messages\":37,\"./trees\":38}],33:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n\r\n    function GZheader() {\r\n      /* true if compressed data believed to be text */\r\n      this.text       = 0;\r\n      /* modification time */\r\n      this.time       = 0;\r\n      /* extra flags (not used when writing a gzip file) */\r\n      this.xflags     = 0;\r\n      /* operating system */\r\n      this.os         = 0;\r\n      /* pointer to extra field or Z_NULL if none */\r\n      this.extra      = null;\r\n      /* extra field length (valid if extra != Z_NULL) */\r\n      this.extra_len  = 0; // Actually, we don't need it in JS,\r\n                           // but leave for few code modifications\r\n\r\n      //\r\n      // Setup limits is not necessary because in js we should not preallocate memory\r\n      // for inflate use constant limit in 65536 bytes\r\n      //\r\n\r\n      /* space at extra (only when reading header) */\r\n      // this.extra_max  = 0;\r\n      /* pointer to zero-terminated file name or Z_NULL */\r\n      this.name       = '';\r\n      /* space at name (only when reading header) */\r\n      // this.name_max   = 0;\r\n      /* pointer to zero-terminated comment or Z_NULL */\r\n      this.comment    = '';\r\n      /* space at comment (only when reading header) */\r\n      // this.comm_max   = 0;\r\n      /* true if there was or will be a header crc */\r\n      this.hcrc       = 0;\r\n      /* true when done reading gzip header (not used when writing a gzip file) */\r\n      this.done       = false;\r\n    }\r\n\r\n    module.exports = GZheader;\r\n  },{}],34:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n// See state defs from inflate.js\r\n    var BAD = 30;       /* got a data error -- remain here until reset */\r\n    var TYPE = 12;      /* i: waiting for type bits, including last-flag bit */\r\n\r\n    /*\r\n   Decode literal, length, and distance codes and write out the resulting\r\n   literal and match bytes until either not enough input or output is\r\n   available, an end-of-block is encountered, or a data error is encountered.\r\n   When large enough input and output buffers are supplied to inflate(), for\r\n   example, a 16K input buffer and a 64K output buffer, more than 95% of the\r\n   inflate execution time is spent in this routine.\r\n\r\n   Entry assumptions:\r\n\r\n        state.mode === LEN\r\n        strm.avail_in >= 6\r\n        strm.avail_out >= 258\r\n        start >= strm.avail_out\r\n        state.bits < 8\r\n\r\n   On return, state.mode is one of:\r\n\r\n        LEN -- ran out of enough output space or enough available input\r\n        TYPE -- reached end of block code, inflate() to interpret next block\r\n        BAD -- error in block data\r\n\r\n   Notes:\r\n\r\n    - The maximum input bits used by a length/distance pair is 15 bits for the\r\n      length code, 5 bits for the length extra, 15 bits for the distance code,\r\n      and 13 bits for the distance extra.  This totals 48 bits, or six bytes.\r\n      Therefore if strm.avail_in >= 6, then there is enough input to avoid\r\n      checking for available input while decoding.\r\n\r\n    - The maximum bytes that a single length/distance pair can output is 258\r\n      bytes, which is the maximum length that can be coded.  inflate_fast()\r\n      requires strm.avail_out >= 258 for each loop to avoid checking for\r\n      output space.\r\n */\r\n    module.exports = function inflate_fast(strm, start) {\r\n      var state;\r\n      var _in;                    /* local strm.input */\r\n      var last;                   /* have enough input while in < last */\r\n      var _out;                   /* local strm.output */\r\n      var beg;                    /* inflate()'s initial strm.output */\r\n      var end;                    /* while out < end, enough space available */\r\n//#ifdef INFLATE_STRICT\r\n      var dmax;                   /* maximum distance from zlib header */\r\n//#endif\r\n      var wsize;                  /* window size or zero if not using window */\r\n      var whave;                  /* valid bytes in the window */\r\n      var wnext;                  /* window write index */\r\n      var window;                 /* allocated sliding window, if wsize != 0 */\r\n      var hold;                   /* local strm.hold */\r\n      var bits;                   /* local strm.bits */\r\n      var lcode;                  /* local strm.lencode */\r\n      var dcode;                  /* local strm.distcode */\r\n      var lmask;                  /* mask for first level of length codes */\r\n      var dmask;                  /* mask for first level of distance codes */\r\n      var here;                   /* retrieved table entry */\r\n      var op;                     /* code bits, operation, extra bits, or */\r\n      /*  window position, window bytes to copy */\r\n      var len;                    /* match length, unused bytes */\r\n      var dist;                   /* match distance */\r\n      var from;                   /* where to copy match from */\r\n      var from_source;\r\n\r\n\r\n      var input, output; // JS specific, because we have no pointers\r\n\r\n      /* copy state to local variables */\r\n      state = strm.state;\r\n      //here = state.here;\r\n      _in = strm.next_in;\r\n      input = strm.input;\r\n      last = _in + (strm.avail_in - 5);\r\n      _out = strm.next_out;\r\n      output = strm.output;\r\n      beg = _out - (start - strm.avail_out);\r\n      end = _out + (strm.avail_out - 257);\r\n//#ifdef INFLATE_STRICT\r\n      dmax = state.dmax;\r\n//#endif\r\n      wsize = state.wsize;\r\n      whave = state.whave;\r\n      wnext = state.wnext;\r\n      window = state.window;\r\n      hold = state.hold;\r\n      bits = state.bits;\r\n      lcode = state.lencode;\r\n      dcode = state.distcode;\r\n      lmask = (1 << state.lenbits) - 1;\r\n      dmask = (1 << state.distbits) - 1;\r\n\r\n\r\n      /* decode literals and length/distances until end-of-block or not enough\r\n     input data or output space */\r\n\r\n      top:\r\n        do {\r\n          if (bits < 15) {\r\n            hold += input[_in++] << bits;\r\n            bits += 8;\r\n            hold += input[_in++] << bits;\r\n            bits += 8;\r\n          }\r\n\r\n          here = lcode[hold & lmask];\r\n\r\n          dolen:\r\n            for (;;) { // Goto emulation\r\n              op = here >>> 24/*here.bits*/;\r\n              hold >>>= op;\r\n              bits -= op;\r\n              op = (here >>> 16) & 0xff/*here.op*/;\r\n              if (op === 0) {                          /* literal */\r\n                //Tracevv((stderr, here.val >= 0x20 && here.val < 0x7f ?\r\n                //        \"inflate:         literal '%c'\\n\" :\r\n                //        \"inflate:         literal 0x%02x\\n\", here.val));\r\n                output[_out++] = here & 0xffff/*here.val*/;\r\n              }\r\n              else if (op & 16) {                     /* length base */\r\n                len = here & 0xffff/*here.val*/;\r\n                op &= 15;                           /* number of extra bits */\r\n                if (op) {\r\n                  if (bits < op) {\r\n                    hold += input[_in++] << bits;\r\n                    bits += 8;\r\n                  }\r\n                  len += hold & ((1 << op) - 1);\r\n                  hold >>>= op;\r\n                  bits -= op;\r\n                }\r\n                //Tracevv((stderr, \"inflate:         length %u\\n\", len));\r\n                if (bits < 15) {\r\n                  hold += input[_in++] << bits;\r\n                  bits += 8;\r\n                  hold += input[_in++] << bits;\r\n                  bits += 8;\r\n                }\r\n                here = dcode[hold & dmask];\r\n\r\n                dodist:\r\n                  for (;;) { // goto emulation\r\n                    op = here >>> 24/*here.bits*/;\r\n                    hold >>>= op;\r\n                    bits -= op;\r\n                    op = (here >>> 16) & 0xff/*here.op*/;\r\n\r\n                    if (op & 16) {                      /* distance base */\r\n                      dist = here & 0xffff/*here.val*/;\r\n                      op &= 15;                       /* number of extra bits */\r\n                      if (bits < op) {\r\n                        hold += input[_in++] << bits;\r\n                        bits += 8;\r\n                        if (bits < op) {\r\n                          hold += input[_in++] << bits;\r\n                          bits += 8;\r\n                        }\r\n                      }\r\n                      dist += hold & ((1 << op) - 1);\r\n//#ifdef INFLATE_STRICT\r\n                      if (dist > dmax) {\r\n                        strm.msg = 'invalid distance too far back';\r\n                        state.mode = BAD;\r\n                        break top;\r\n                      }\r\n//#endif\r\n                      hold >>>= op;\r\n                      bits -= op;\r\n                      //Tracevv((stderr, \"inflate:         distance %u\\n\", dist));\r\n                      op = _out - beg;                /* max distance in output */\r\n                      if (dist > op) {                /* see if copy from window */\r\n                        op = dist - op;               /* distance back in window */\r\n                        if (op > whave) {\r\n                          if (state.sane) {\r\n                            strm.msg = 'invalid distance too far back';\r\n                            state.mode = BAD;\r\n                            break top;\r\n                          }\r\n\r\n// (!) This block is disabled in zlib defailts,\r\n// don't enable it for binary compatibility\r\n//#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR\r\n//                if (len <= op - whave) {\r\n//                  do {\r\n//                    output[_out++] = 0;\r\n//                  } while (--len);\r\n//                  continue top;\r\n//                }\r\n//                len -= op - whave;\r\n//                do {\r\n//                  output[_out++] = 0;\r\n//                } while (--op > whave);\r\n//                if (op === 0) {\r\n//                  from = _out - dist;\r\n//                  do {\r\n//                    output[_out++] = output[from++];\r\n//                  } while (--len);\r\n//                  continue top;\r\n//                }\r\n//#endif\r\n                        }\r\n                        from = 0; // window index\r\n                        from_source = window;\r\n                        if (wnext === 0) {           /* very common case */\r\n                          from += wsize - op;\r\n                          if (op < len) {         /* some from window */\r\n                            len -= op;\r\n                            do {\r\n                              output[_out++] = window[from++];\r\n                            } while (--op);\r\n                            from = _out - dist;  /* rest from output */\r\n                            from_source = output;\r\n                          }\r\n                        }\r\n                        else if (wnext < op) {      /* wrap around window */\r\n                          from += wsize + wnext - op;\r\n                          op -= wnext;\r\n                          if (op < len) {         /* some from end of window */\r\n                            len -= op;\r\n                            do {\r\n                              output[_out++] = window[from++];\r\n                            } while (--op);\r\n                            from = 0;\r\n                            if (wnext < len) {  /* some from start of window */\r\n                              op = wnext;\r\n                              len -= op;\r\n                              do {\r\n                                output[_out++] = window[from++];\r\n                              } while (--op);\r\n                              from = _out - dist;      /* rest from output */\r\n                              from_source = output;\r\n                            }\r\n                          }\r\n                        }\r\n                        else {                      /* contiguous in window */\r\n                          from += wnext - op;\r\n                          if (op < len) {         /* some from window */\r\n                            len -= op;\r\n                            do {\r\n                              output[_out++] = window[from++];\r\n                            } while (--op);\r\n                            from = _out - dist;  /* rest from output */\r\n                            from_source = output;\r\n                          }\r\n                        }\r\n                        while (len > 2) {\r\n                          output[_out++] = from_source[from++];\r\n                          output[_out++] = from_source[from++];\r\n                          output[_out++] = from_source[from++];\r\n                          len -= 3;\r\n                        }\r\n                        if (len) {\r\n                          output[_out++] = from_source[from++];\r\n                          if (len > 1) {\r\n                            output[_out++] = from_source[from++];\r\n                          }\r\n                        }\r\n                      }\r\n                      else {\r\n                        from = _out - dist;          /* copy direct from output */\r\n                        do {                        /* minimum length is three */\r\n                          output[_out++] = output[from++];\r\n                          output[_out++] = output[from++];\r\n                          output[_out++] = output[from++];\r\n                          len -= 3;\r\n                        } while (len > 2);\r\n                        if (len) {\r\n                          output[_out++] = output[from++];\r\n                          if (len > 1) {\r\n                            output[_out++] = output[from++];\r\n                          }\r\n                        }\r\n                      }\r\n                    }\r\n                    else if ((op & 64) === 0) {          /* 2nd level distance code */\r\n                      here = dcode[(here & 0xffff)/*here.val*/ + (hold & ((1 << op) - 1))];\r\n                      continue dodist;\r\n                    }\r\n                    else {\r\n                      strm.msg = 'invalid distance code';\r\n                      state.mode = BAD;\r\n                      break top;\r\n                    }\r\n\r\n                    break; // need to emulate goto via \"continue\"\r\n                  }\r\n              }\r\n              else if ((op & 64) === 0) {              /* 2nd level length code */\r\n                here = lcode[(here & 0xffff)/*here.val*/ + (hold & ((1 << op) - 1))];\r\n                continue dolen;\r\n              }\r\n              else if (op & 32) {                     /* end-of-block */\r\n                //Tracevv((stderr, \"inflate:         end of block\\n\"));\r\n                state.mode = TYPE;\r\n                break top;\r\n              }\r\n              else {\r\n                strm.msg = 'invalid literal/length code';\r\n                state.mode = BAD;\r\n                break top;\r\n              }\r\n\r\n              break; // need to emulate goto via \"continue\"\r\n            }\r\n        } while (_in < last && _out < end);\r\n\r\n      /* return unused bytes (on entry, bits < 8, so in won't go too far back) */\r\n      len = bits >> 3;\r\n      _in -= len;\r\n      bits -= len << 3;\r\n      hold &= (1 << bits) - 1;\r\n\r\n      /* update state and return */\r\n      strm.next_in = _in;\r\n      strm.next_out = _out;\r\n      strm.avail_in = (_in < last ? 5 + (last - _in) : 5 - (_in - last));\r\n      strm.avail_out = (_out < end ? 257 + (end - _out) : 257 - (_out - end));\r\n      state.hold = hold;\r\n      state.bits = bits;\r\n      return;\r\n    };\r\n\r\n  },{}],35:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n\r\n    var utils = _dereq_('../utils/common');\r\n    var adler32 = _dereq_('./adler32');\r\n    var crc32   = _dereq_('./crc32');\r\n    var inflate_fast = _dereq_('./inffast');\r\n    var inflate_table = _dereq_('./inftrees');\r\n\r\n    var CODES = 0;\r\n    var LENS = 1;\r\n    var DISTS = 2;\r\n\r\n    /* Public constants ==========================================================*/\r\n    /* ===========================================================================*/\r\n\r\n\r\n    /* Allowed flush values; see deflate() and inflate() below for details */\r\n//var Z_NO_FLUSH      = 0;\r\n//var Z_PARTIAL_FLUSH = 1;\r\n//var Z_SYNC_FLUSH    = 2;\r\n//var Z_FULL_FLUSH    = 3;\r\n    var Z_FINISH        = 4;\r\n    var Z_BLOCK         = 5;\r\n    var Z_TREES         = 6;\r\n\r\n\r\n    /* Return codes for the compression/decompression functions. Negative values\r\n * are errors, positive values are used for special but normal events.\r\n */\r\n    var Z_OK            = 0;\r\n    var Z_STREAM_END    = 1;\r\n    var Z_NEED_DICT     = 2;\r\n//var Z_ERRNO         = -1;\r\n    var Z_STREAM_ERROR  = -2;\r\n    var Z_DATA_ERROR    = -3;\r\n    var Z_MEM_ERROR     = -4;\r\n    var Z_BUF_ERROR     = -5;\r\n//var Z_VERSION_ERROR = -6;\r\n\r\n    /* The deflate compression method */\r\n    var Z_DEFLATED  = 8;\r\n\r\n\r\n    /* STATES ====================================================================*/\r\n    /* ===========================================================================*/\r\n\r\n\r\n    var    HEAD = 1;       /* i: waiting for magic header */\r\n    var    FLAGS = 2;      /* i: waiting for method and flags (gzip) */\r\n    var    TIME = 3;       /* i: waiting for modification time (gzip) */\r\n    var    OS = 4;         /* i: waiting for extra flags and operating system (gzip) */\r\n    var    EXLEN = 5;      /* i: waiting for extra length (gzip) */\r\n    var    EXTRA = 6;      /* i: waiting for extra bytes (gzip) */\r\n    var    NAME = 7;       /* i: waiting for end of file name (gzip) */\r\n    var    COMMENT = 8;    /* i: waiting for end of comment (gzip) */\r\n    var    HCRC = 9;       /* i: waiting for header crc (gzip) */\r\n    var    DICTID = 10;    /* i: waiting for dictionary check value */\r\n    var    DICT = 11;      /* waiting for inflateSetDictionary() call */\r\n    var        TYPE = 12;      /* i: waiting for type bits, including last-flag bit */\r\n    var        TYPEDO = 13;    /* i: same, but skip check to exit inflate on new block */\r\n    var        STORED = 14;    /* i: waiting for stored size (length and complement) */\r\n    var        COPY_ = 15;     /* i/o: same as COPY below, but only first time in */\r\n    var        COPY = 16;      /* i/o: waiting for input or output to copy stored block */\r\n    var        TABLE = 17;     /* i: waiting for dynamic block table lengths */\r\n    var        LENLENS = 18;   /* i: waiting for code length code lengths */\r\n    var        CODELENS = 19;  /* i: waiting for length/lit and distance code lengths */\r\n    var            LEN_ = 20;      /* i: same as LEN below, but only first time in */\r\n    var            LEN = 21;       /* i: waiting for length/lit/eob code */\r\n    var            LENEXT = 22;    /* i: waiting for length extra bits */\r\n    var            DIST = 23;      /* i: waiting for distance code */\r\n    var            DISTEXT = 24;   /* i: waiting for distance extra bits */\r\n    var            MATCH = 25;     /* o: waiting for output space to copy string */\r\n    var            LIT = 26;       /* o: waiting for output space to write literal */\r\n    var    CHECK = 27;     /* i: waiting for 32-bit check value */\r\n    var    LENGTH = 28;    /* i: waiting for 32-bit length (gzip) */\r\n    var    DONE = 29;      /* finished check, done -- remain here until reset */\r\n    var    BAD = 30;       /* got a data error -- remain here until reset */\r\n    var    MEM = 31;       /* got an inflate() memory error -- remain here until reset */\r\n    var    SYNC = 32;      /* looking for synchronization bytes to restart inflate() */\r\n\r\n    /* ===========================================================================*/\r\n\r\n\r\n\r\n    var ENOUGH_LENS = 852;\r\n    var ENOUGH_DISTS = 592;\r\n//var ENOUGH =  (ENOUGH_LENS+ENOUGH_DISTS);\r\n\r\n    var MAX_WBITS = 15;\r\n    /* 32K LZ77 window */\r\n    var DEF_WBITS = MAX_WBITS;\r\n\r\n\r\n    function ZSWAP32(q) {\r\n      return  (((q >>> 24) & 0xff) +\r\n        ((q >>> 8) & 0xff00) +\r\n        ((q & 0xff00) << 8) +\r\n        ((q & 0xff) << 24));\r\n    }\r\n\r\n\r\n    function InflateState() {\r\n      this.mode = 0;             /* current inflate mode */\r\n      this.last = false;          /* true if processing last block */\r\n      this.wrap = 0;              /* bit 0 true for zlib, bit 1 true for gzip */\r\n      this.havedict = false;      /* true if dictionary provided */\r\n      this.flags = 0;             /* gzip header method and flags (0 if zlib) */\r\n      this.dmax = 0;              /* zlib header max distance (INFLATE_STRICT) */\r\n      this.check = 0;             /* protected copy of check value */\r\n      this.total = 0;             /* protected copy of output count */\r\n      // TODO: may be {}\r\n      this.head = null;           /* where to save gzip header information */\r\n\r\n      /* sliding window */\r\n      this.wbits = 0;             /* log base 2 of requested window size */\r\n      this.wsize = 0;             /* window size or zero if not using window */\r\n      this.whave = 0;             /* valid bytes in the window */\r\n      this.wnext = 0;             /* window write index */\r\n      this.window = null;         /* allocated sliding window, if needed */\r\n\r\n      /* bit accumulator */\r\n      this.hold = 0;              /* input bit accumulator */\r\n      this.bits = 0;              /* number of bits in \"in\" */\r\n\r\n      /* for string and stored block copying */\r\n      this.length = 0;            /* literal or length of data to copy */\r\n      this.offset = 0;            /* distance back to copy string from */\r\n\r\n      /* for table and code decoding */\r\n      this.extra = 0;             /* extra bits needed */\r\n\r\n      /* fixed and dynamic code tables */\r\n      this.lencode = null;          /* starting table for length/literal codes */\r\n      this.distcode = null;         /* starting table for distance codes */\r\n      this.lenbits = 0;           /* index bits for lencode */\r\n      this.distbits = 0;          /* index bits for distcode */\r\n\r\n      /* dynamic table building */\r\n      this.ncode = 0;             /* number of code length code lengths */\r\n      this.nlen = 0;              /* number of length code lengths */\r\n      this.ndist = 0;             /* number of distance code lengths */\r\n      this.have = 0;              /* number of code lengths in lens[] */\r\n      this.next = null;              /* next available space in codes[] */\r\n\r\n      this.lens = new utils.Buf16(320); /* temporary storage for code lengths */\r\n      this.work = new utils.Buf16(288); /* work area for code table building */\r\n\r\n      /*\r\n   because we don't have pointers in js, we use lencode and distcode directly\r\n   as buffers so we don't need codes\r\n  */\r\n      //this.codes = new utils.Buf32(ENOUGH);       /* space for code tables */\r\n      this.lendyn = null;              /* dynamic table for length/literal codes (JS specific) */\r\n      this.distdyn = null;             /* dynamic table for distance codes (JS specific) */\r\n      this.sane = 0;                   /* if false, allow invalid distance too far */\r\n      this.back = 0;                   /* bits back of last unprocessed length/lit */\r\n      this.was = 0;                    /* initial length of match */\r\n    }\r\n\r\n    function inflateResetKeep(strm) {\r\n      var state;\r\n\r\n      if (!strm || !strm.state) { return Z_STREAM_ERROR; }\r\n      state = strm.state;\r\n      strm.total_in = strm.total_out = state.total = 0;\r\n      strm.msg = ''; /*Z_NULL*/\r\n      if (state.wrap) {       /* to support ill-conceived Java test suite */\r\n        strm.adler = state.wrap & 1;\r\n      }\r\n      state.mode = HEAD;\r\n      state.last = 0;\r\n      state.havedict = 0;\r\n      state.dmax = 32768;\r\n      state.head = null/*Z_NULL*/;\r\n      state.hold = 0;\r\n      state.bits = 0;\r\n      //state.lencode = state.distcode = state.next = state.codes;\r\n      state.lencode = state.lendyn = new utils.Buf32(ENOUGH_LENS);\r\n      state.distcode = state.distdyn = new utils.Buf32(ENOUGH_DISTS);\r\n\r\n      state.sane = 1;\r\n      state.back = -1;\r\n      //Tracev((stderr, \"inflate: reset\\n\"));\r\n      return Z_OK;\r\n    }\r\n\r\n    function inflateReset(strm) {\r\n      var state;\r\n\r\n      if (!strm || !strm.state) { return Z_STREAM_ERROR; }\r\n      state = strm.state;\r\n      state.wsize = 0;\r\n      state.whave = 0;\r\n      state.wnext = 0;\r\n      return inflateResetKeep(strm);\r\n\r\n    }\r\n\r\n    function inflateReset2(strm, windowBits) {\r\n      var wrap;\r\n      var state;\r\n\r\n      /* get the state */\r\n      if (!strm || !strm.state) { return Z_STREAM_ERROR; }\r\n      state = strm.state;\r\n\r\n      /* extract wrap request from windowBits parameter */\r\n      if (windowBits < 0) {\r\n        wrap = 0;\r\n        windowBits = -windowBits;\r\n      }\r\n      else {\r\n        wrap = (windowBits >> 4) + 1;\r\n        if (windowBits < 48) {\r\n          windowBits &= 15;\r\n        }\r\n      }\r\n\r\n      /* set number of window bits, free window if different */\r\n      if (windowBits && (windowBits < 8 || windowBits > 15)) {\r\n        return Z_STREAM_ERROR;\r\n      }\r\n      if (state.window !== null && state.wbits !== windowBits) {\r\n        state.window = null;\r\n      }\r\n\r\n      /* update state and reset the rest of it */\r\n      state.wrap = wrap;\r\n      state.wbits = windowBits;\r\n      return inflateReset(strm);\r\n    }\r\n\r\n    function inflateInit2(strm, windowBits) {\r\n      var ret;\r\n      var state;\r\n\r\n      if (!strm) { return Z_STREAM_ERROR; }\r\n      //strm.msg = Z_NULL;                 /* in case we return an error */\r\n\r\n      state = new InflateState();\r\n\r\n      //if (state === Z_NULL) return Z_MEM_ERROR;\r\n      //Tracev((stderr, \"inflate: allocated\\n\"));\r\n      strm.state = state;\r\n      state.window = null/*Z_NULL*/;\r\n      ret = inflateReset2(strm, windowBits);\r\n      if (ret !== Z_OK) {\r\n        strm.state = null/*Z_NULL*/;\r\n      }\r\n      return ret;\r\n    }\r\n\r\n    function inflateInit(strm) {\r\n      return inflateInit2(strm, DEF_WBITS);\r\n    }\r\n\r\n\r\n    /*\r\n Return state with length and distance decoding tables and index sizes set to\r\n fixed code decoding.  Normally this returns fixed tables from inffixed.h.\r\n If BUILDFIXED is defined, then instead this routine builds the tables the\r\n first time it's called, and returns those tables the first time and\r\n thereafter.  This reduces the size of the code by about 2K bytes, in\r\n exchange for a little execution time.  However, BUILDFIXED should not be\r\n used for threaded applications, since the rewriting of the tables and virgin\r\n may not be thread-safe.\r\n */\r\n    var virgin = true;\r\n\r\n    var lenfix, distfix; // We have no pointers in JS, so keep tables separate\r\n\r\n    function fixedtables(state) {\r\n      /* build fixed huffman tables if first call (may not be thread safe) */\r\n      if (virgin) {\r\n        var sym;\r\n\r\n        lenfix = new utils.Buf32(512);\r\n        distfix = new utils.Buf32(32);\r\n\r\n        /* literal/length table */\r\n        sym = 0;\r\n        while (sym < 144) { state.lens[sym++] = 8; }\r\n        while (sym < 256) { state.lens[sym++] = 9; }\r\n        while (sym < 280) { state.lens[sym++] = 7; }\r\n        while (sym < 288) { state.lens[sym++] = 8; }\r\n\r\n        inflate_table(LENS,  state.lens, 0, 288, lenfix,   0, state.work, {bits: 9});\r\n\r\n        /* distance table */\r\n        sym = 0;\r\n        while (sym < 32) { state.lens[sym++] = 5; }\r\n\r\n        inflate_table(DISTS, state.lens, 0, 32,   distfix, 0, state.work, {bits: 5});\r\n\r\n        /* do this just once */\r\n        virgin = false;\r\n      }\r\n\r\n      state.lencode = lenfix;\r\n      state.lenbits = 9;\r\n      state.distcode = distfix;\r\n      state.distbits = 5;\r\n    }\r\n\r\n\r\n    /*\r\n Update the window with the last wsize (normally 32K) bytes written before\r\n returning.  If window does not exist yet, create it.  This is only called\r\n when a window is already in use, or when output has been written during this\r\n inflate call, but the end of the deflate stream has not been reached yet.\r\n It is also called to create a window for dictionary data when a dictionary\r\n is loaded.\r\n\r\n Providing output buffers larger than 32K to inflate() should provide a speed\r\n advantage, since only the last 32K of output is copied to the sliding window\r\n upon return from inflate(), and since all distances after the first 32K of\r\n output will fall in the output data, making match copies simpler and faster.\r\n The advantage may be dependent on the size of the processor's data caches.\r\n */\r\n    function updatewindow(strm, src, end, copy) {\r\n      var dist;\r\n      var state = strm.state;\r\n\r\n      /* if it hasn't been done already, allocate space for the window */\r\n      if (state.window === null) {\r\n        state.wsize = 1 << state.wbits;\r\n        state.wnext = 0;\r\n        state.whave = 0;\r\n\r\n        state.window = new utils.Buf8(state.wsize);\r\n      }\r\n\r\n      /* copy state->wsize or less output bytes into the circular window */\r\n      if (copy >= state.wsize) {\r\n        utils.arraySet(state.window,src, end - state.wsize, state.wsize, 0);\r\n        state.wnext = 0;\r\n        state.whave = state.wsize;\r\n      }\r\n      else {\r\n        dist = state.wsize - state.wnext;\r\n        if (dist > copy) {\r\n          dist = copy;\r\n        }\r\n        //zmemcpy(state->window + state->wnext, end - copy, dist);\r\n        utils.arraySet(state.window,src, end - copy, dist, state.wnext);\r\n        copy -= dist;\r\n        if (copy) {\r\n          //zmemcpy(state->window, end - copy, copy);\r\n          utils.arraySet(state.window,src, end - copy, copy, 0);\r\n          state.wnext = copy;\r\n          state.whave = state.wsize;\r\n        }\r\n        else {\r\n          state.wnext += dist;\r\n          if (state.wnext === state.wsize) { state.wnext = 0; }\r\n          if (state.whave < state.wsize) { state.whave += dist; }\r\n        }\r\n      }\r\n      return 0;\r\n    }\r\n\r\n    function inflate(strm, flush) {\r\n      var state;\r\n      var input, output;          // input/output buffers\r\n      var next;                   /* next input INDEX */\r\n      var put;                    /* next output INDEX */\r\n      var have, left;             /* available input and output */\r\n      var hold;                   /* bit buffer */\r\n      var bits;                   /* bits in bit buffer */\r\n      var _in, _out;              /* save starting available input and output */\r\n      var copy;                   /* number of stored or match bytes to copy */\r\n      var from;                   /* where to copy match bytes from */\r\n      var from_source;\r\n      var here = 0;               /* current decoding table entry */\r\n      var here_bits, here_op, here_val; // paked \"here\" denormalized (JS specific)\r\n      //var last;                   /* parent table entry */\r\n      var last_bits, last_op, last_val; // paked \"last\" denormalized (JS specific)\r\n      var len;                    /* length to copy for repeats, bits to drop */\r\n      var ret;                    /* return code */\r\n      var hbuf = new utils.Buf8(4);    /* buffer for gzip header crc calculation */\r\n      var opts;\r\n\r\n      var n; // temporary var for NEED_BITS\r\n\r\n      var order = /* permutation of code lengths */\r\n        [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];\r\n\r\n\r\n      if (!strm || !strm.state || !strm.output ||\r\n        (!strm.input && strm.avail_in !== 0)) {\r\n        return Z_STREAM_ERROR;\r\n      }\r\n\r\n      state = strm.state;\r\n      if (state.mode === TYPE) { state.mode = TYPEDO; }    /* skip check */\r\n\r\n\r\n      //--- LOAD() ---\r\n      put = strm.next_out;\r\n      output = strm.output;\r\n      left = strm.avail_out;\r\n      next = strm.next_in;\r\n      input = strm.input;\r\n      have = strm.avail_in;\r\n      hold = state.hold;\r\n      bits = state.bits;\r\n      //---\r\n\r\n      _in = have;\r\n      _out = left;\r\n      ret = Z_OK;\r\n\r\n      inf_leave: // goto emulation\r\n        for (;;) {\r\n          switch (state.mode) {\r\n            case HEAD:\r\n              if (state.wrap === 0) {\r\n                state.mode = TYPEDO;\r\n                break;\r\n              }\r\n              //=== NEEDBITS(16);\r\n              while (bits < 16) {\r\n                if (have === 0) { break inf_leave; }\r\n                have--;\r\n                hold += input[next++] << bits;\r\n                bits += 8;\r\n              }\r\n              //===//\r\n              if ((state.wrap & 2) && hold === 0x8b1f) {  /* gzip header */\r\n                state.check = 0/*crc32(0L, Z_NULL, 0)*/;\r\n                //=== CRC2(state.check, hold);\r\n                hbuf[0] = hold & 0xff;\r\n                hbuf[1] = (hold >>> 8) & 0xff;\r\n                state.check = crc32(state.check, hbuf, 2, 0);\r\n                //===//\r\n\r\n                //=== INITBITS();\r\n                hold = 0;\r\n                bits = 0;\r\n                //===//\r\n                state.mode = FLAGS;\r\n                break;\r\n              }\r\n              state.flags = 0;           /* expect zlib header */\r\n              if (state.head) {\r\n                state.head.done = false;\r\n              }\r\n              if (!(state.wrap & 1) ||   /* check if zlib header allowed */\r\n                (((hold & 0xff)/*BITS(8)*/ << 8) + (hold >> 8)) % 31) {\r\n                strm.msg = 'incorrect header check';\r\n                state.mode = BAD;\r\n                break;\r\n              }\r\n              if ((hold & 0x0f)/*BITS(4)*/ !== Z_DEFLATED) {\r\n                strm.msg = 'unknown compression method';\r\n                state.mode = BAD;\r\n                break;\r\n              }\r\n              //--- DROPBITS(4) ---//\r\n              hold >>>= 4;\r\n              bits -= 4;\r\n              //---//\r\n              len = (hold & 0x0f)/*BITS(4)*/ + 8;\r\n              if (state.wbits === 0) {\r\n                state.wbits = len;\r\n              }\r\n              else if (len > state.wbits) {\r\n                strm.msg = 'invalid window size';\r\n                state.mode = BAD;\r\n                break;\r\n              }\r\n              state.dmax = 1 << len;\r\n              //Tracev((stderr, \"inflate:   zlib header ok\\n\"));\r\n              strm.adler = state.check = 1/*adler32(0L, Z_NULL, 0)*/;\r\n              state.mode = hold & 0x200 ? DICTID : TYPE;\r\n              //=== INITBITS();\r\n              hold = 0;\r\n              bits = 0;\r\n              //===//\r\n              break;\r\n            case FLAGS:\r\n              //=== NEEDBITS(16); */\r\n              while (bits < 16) {\r\n                if (have === 0) { break inf_leave; }\r\n                have--;\r\n                hold += input[next++] << bits;\r\n                bits += 8;\r\n              }\r\n              //===//\r\n              state.flags = hold;\r\n              if ((state.flags & 0xff) !== Z_DEFLATED) {\r\n                strm.msg = 'unknown compression method';\r\n                state.mode = BAD;\r\n                break;\r\n              }\r\n              if (state.flags & 0xe000) {\r\n                strm.msg = 'unknown header flags set';\r\n                state.mode = BAD;\r\n                break;\r\n              }\r\n              if (state.head) {\r\n                state.head.text = ((hold >> 8) & 1);\r\n              }\r\n              if (state.flags & 0x0200) {\r\n                //=== CRC2(state.check, hold);\r\n                hbuf[0] = hold & 0xff;\r\n                hbuf[1] = (hold >>> 8) & 0xff;\r\n                state.check = crc32(state.check, hbuf, 2, 0);\r\n                //===//\r\n              }\r\n              //=== INITBITS();\r\n              hold = 0;\r\n              bits = 0;\r\n              //===//\r\n              state.mode = TIME;\r\n            /* falls through */\r\n            case TIME:\r\n              //=== NEEDBITS(32); */\r\n              while (bits < 32) {\r\n                if (have === 0) { break inf_leave; }\r\n                have--;\r\n                hold += input[next++] << bits;\r\n                bits += 8;\r\n              }\r\n              //===//\r\n              if (state.head) {\r\n                state.head.time = hold;\r\n              }\r\n              if (state.flags & 0x0200) {\r\n                //=== CRC4(state.check, hold)\r\n                hbuf[0] = hold & 0xff;\r\n                hbuf[1] = (hold >>> 8) & 0xff;\r\n                hbuf[2] = (hold >>> 16) & 0xff;\r\n                hbuf[3] = (hold >>> 24) & 0xff;\r\n                state.check = crc32(state.check, hbuf, 4, 0);\r\n                //===\r\n              }\r\n              //=== INITBITS();\r\n              hold = 0;\r\n              bits = 0;\r\n              //===//\r\n              state.mode = OS;\r\n            /* falls through */\r\n            case OS:\r\n              //=== NEEDBITS(16); */\r\n              while (bits < 16) {\r\n                if (have === 0) { break inf_leave; }\r\n                have--;\r\n                hold += input[next++] << bits;\r\n                bits += 8;\r\n              }\r\n              //===//\r\n              if (state.head) {\r\n                state.head.xflags = (hold & 0xff);\r\n                state.head.os = (hold >> 8);\r\n              }\r\n              if (state.flags & 0x0200) {\r\n                //=== CRC2(state.check, hold);\r\n                hbuf[0] = hold & 0xff;\r\n                hbuf[1] = (hold >>> 8) & 0xff;\r\n                state.check = crc32(state.check, hbuf, 2, 0);\r\n                //===//\r\n              }\r\n              //=== INITBITS();\r\n              hold = 0;\r\n              bits = 0;\r\n              //===//\r\n              state.mode = EXLEN;\r\n            /* falls through */\r\n            case EXLEN:\r\n              if (state.flags & 0x0400) {\r\n                //=== NEEDBITS(16); */\r\n                while (bits < 16) {\r\n                  if (have === 0) { break inf_leave; }\r\n                  have--;\r\n                  hold += input[next++] << bits;\r\n                  bits += 8;\r\n                }\r\n                //===//\r\n                state.length = hold;\r\n                if (state.head) {\r\n                  state.head.extra_len = hold;\r\n                }\r\n                if (state.flags & 0x0200) {\r\n                  //=== CRC2(state.check, hold);\r\n                  hbuf[0] = hold & 0xff;\r\n                  hbuf[1] = (hold >>> 8) & 0xff;\r\n                  state.check = crc32(state.check, hbuf, 2, 0);\r\n                  //===//\r\n                }\r\n                //=== INITBITS();\r\n                hold = 0;\r\n                bits = 0;\r\n                //===//\r\n              }\r\n              else if (state.head) {\r\n                state.head.extra = null/*Z_NULL*/;\r\n              }\r\n              state.mode = EXTRA;\r\n            /* falls through */\r\n            case EXTRA:\r\n              if (state.flags & 0x0400) {\r\n                copy = state.length;\r\n                if (copy > have) { copy = have; }\r\n                if (copy) {\r\n                  if (state.head) {\r\n                    len = state.head.extra_len - state.length;\r\n                    if (!state.head.extra) {\r\n                      // Use untyped array for more conveniend processing later\r\n                      state.head.extra = new Array(state.head.extra_len);\r\n                    }\r\n                    utils.arraySet(\r\n                      state.head.extra,\r\n                      input,\r\n                      next,\r\n                      // extra field is limited to 65536 bytes\r\n                      // - no need for additional size check\r\n                      copy,\r\n                      /*len + copy > state.head.extra_max - len ? state.head.extra_max : copy,*/\r\n                      len\r\n                    );\r\n                    //zmemcpy(state.head.extra + len, next,\r\n                    //        len + copy > state.head.extra_max ?\r\n                    //        state.head.extra_max - len : copy);\r\n                  }\r\n                  if (state.flags & 0x0200) {\r\n                    state.check = crc32(state.check, input, copy, next);\r\n                  }\r\n                  have -= copy;\r\n                  next += copy;\r\n                  state.length -= copy;\r\n                }\r\n                if (state.length) { break inf_leave; }\r\n              }\r\n              state.length = 0;\r\n              state.mode = NAME;\r\n            /* falls through */\r\n            case NAME:\r\n              if (state.flags & 0x0800) {\r\n                if (have === 0) { break inf_leave; }\r\n                copy = 0;\r\n                do {\r\n                  // TODO: 2 or 1 bytes?\r\n                  len = input[next + copy++];\r\n                  /* use constant limit because in js we should not preallocate memory */\r\n                  if (state.head && len &&\r\n                    (state.length < 65536 /*state.head.name_max*/)) {\r\n                    state.head.name += String.fromCharCode(len);\r\n                  }\r\n                } while (len && copy < have);\r\n\r\n                if (state.flags & 0x0200) {\r\n                  state.check = crc32(state.check, input, copy, next);\r\n                }\r\n                have -= copy;\r\n                next += copy;\r\n                if (len) { break inf_leave; }\r\n              }\r\n              else if (state.head) {\r\n                state.head.name = null;\r\n              }\r\n              state.length = 0;\r\n              state.mode = COMMENT;\r\n            /* falls through */\r\n            case COMMENT:\r\n              if (state.flags & 0x1000) {\r\n                if (have === 0) { break inf_leave; }\r\n                copy = 0;\r\n                do {\r\n                  len = input[next + copy++];\r\n                  /* use constant limit because in js we should not preallocate memory */\r\n                  if (state.head && len &&\r\n                    (state.length < 65536 /*state.head.comm_max*/)) {\r\n                    state.head.comment += String.fromCharCode(len);\r\n                  }\r\n                } while (len && copy < have);\r\n                if (state.flags & 0x0200) {\r\n                  state.check = crc32(state.check, input, copy, next);\r\n                }\r\n                have -= copy;\r\n                next += copy;\r\n                if (len) { break inf_leave; }\r\n              }\r\n              else if (state.head) {\r\n                state.head.comment = null;\r\n              }\r\n              state.mode = HCRC;\r\n            /* falls through */\r\n            case HCRC:\r\n              if (state.flags & 0x0200) {\r\n                //=== NEEDBITS(16); */\r\n                while (bits < 16) {\r\n                  if (have === 0) { break inf_leave; }\r\n                  have--;\r\n                  hold += input[next++] << bits;\r\n                  bits += 8;\r\n                }\r\n                //===//\r\n                if (hold !== (state.check & 0xffff)) {\r\n                  strm.msg = 'header crc mismatch';\r\n                  state.mode = BAD;\r\n                  break;\r\n                }\r\n                //=== INITBITS();\r\n                hold = 0;\r\n                bits = 0;\r\n                //===//\r\n              }\r\n              if (state.head) {\r\n                state.head.hcrc = ((state.flags >> 9) & 1);\r\n                state.head.done = true;\r\n              }\r\n              strm.adler = state.check = 0 /*crc32(0L, Z_NULL, 0)*/;\r\n              state.mode = TYPE;\r\n              break;\r\n            case DICTID:\r\n              //=== NEEDBITS(32); */\r\n              while (bits < 32) {\r\n                if (have === 0) { break inf_leave; }\r\n                have--;\r\n                hold += input[next++] << bits;\r\n                bits += 8;\r\n              }\r\n              //===//\r\n              strm.adler = state.check = ZSWAP32(hold);\r\n              //=== INITBITS();\r\n              hold = 0;\r\n              bits = 0;\r\n              //===//\r\n              state.mode = DICT;\r\n            /* falls through */\r\n            case DICT:\r\n              if (state.havedict === 0) {\r\n                //--- RESTORE() ---\r\n                strm.next_out = put;\r\n                strm.avail_out = left;\r\n                strm.next_in = next;\r\n                strm.avail_in = have;\r\n                state.hold = hold;\r\n                state.bits = bits;\r\n                //---\r\n                return Z_NEED_DICT;\r\n              }\r\n              strm.adler = state.check = 1/*adler32(0L, Z_NULL, 0)*/;\r\n              state.mode = TYPE;\r\n            /* falls through */\r\n            case TYPE:\r\n              if (flush === Z_BLOCK || flush === Z_TREES) { break inf_leave; }\r\n            /* falls through */\r\n            case TYPEDO:\r\n              if (state.last) {\r\n                //--- BYTEBITS() ---//\r\n                hold >>>= bits & 7;\r\n                bits -= bits & 7;\r\n                //---//\r\n                state.mode = CHECK;\r\n                break;\r\n              }\r\n              //=== NEEDBITS(3); */\r\n              while (bits < 3) {\r\n                if (have === 0) { break inf_leave; }\r\n                have--;\r\n                hold += input[next++] << bits;\r\n                bits += 8;\r\n              }\r\n              //===//\r\n              state.last = (hold & 0x01)/*BITS(1)*/;\r\n              //--- DROPBITS(1) ---//\r\n              hold >>>= 1;\r\n              bits -= 1;\r\n              //---//\r\n\r\n              switch ((hold & 0x03)/*BITS(2)*/) {\r\n                case 0:                             /* stored block */\r\n                  //Tracev((stderr, \"inflate:     stored block%s\\n\",\r\n                  //        state.last ? \" (last)\" : \"\"));\r\n                  state.mode = STORED;\r\n                  break;\r\n                case 1:                             /* fixed block */\r\n                  fixedtables(state);\r\n                  //Tracev((stderr, \"inflate:     fixed codes block%s\\n\",\r\n                  //        state.last ? \" (last)\" : \"\"));\r\n                  state.mode = LEN_;             /* decode codes */\r\n                  if (flush === Z_TREES) {\r\n                    //--- DROPBITS(2) ---//\r\n                    hold >>>= 2;\r\n                    bits -= 2;\r\n                    //---//\r\n                    break inf_leave;\r\n                  }\r\n                  break;\r\n                case 2:                             /* dynamic block */\r\n                  //Tracev((stderr, \"inflate:     dynamic codes block%s\\n\",\r\n                  //        state.last ? \" (last)\" : \"\"));\r\n                  state.mode = TABLE;\r\n                  break;\r\n                case 3:\r\n                  strm.msg = 'invalid block type';\r\n                  state.mode = BAD;\r\n              }\r\n              //--- DROPBITS(2) ---//\r\n              hold >>>= 2;\r\n              bits -= 2;\r\n              //---//\r\n              break;\r\n            case STORED:\r\n              //--- BYTEBITS() ---// /* go to byte boundary */\r\n              hold >>>= bits & 7;\r\n              bits -= bits & 7;\r\n              //---//\r\n              //=== NEEDBITS(32); */\r\n              while (bits < 32) {\r\n                if (have === 0) { break inf_leave; }\r\n                have--;\r\n                hold += input[next++] << bits;\r\n                bits += 8;\r\n              }\r\n              //===//\r\n              if ((hold & 0xffff) !== ((hold >>> 16) ^ 0xffff)) {\r\n                strm.msg = 'invalid stored block lengths';\r\n                state.mode = BAD;\r\n                break;\r\n              }\r\n              state.length = hold & 0xffff;\r\n              //Tracev((stderr, \"inflate:       stored length %u\\n\",\r\n              //        state.length));\r\n              //=== INITBITS();\r\n              hold = 0;\r\n              bits = 0;\r\n              //===//\r\n              state.mode = COPY_;\r\n              if (flush === Z_TREES) { break inf_leave; }\r\n            /* falls through */\r\n            case COPY_:\r\n              state.mode = COPY;\r\n            /* falls through */\r\n            case COPY:\r\n              copy = state.length;\r\n              if (copy) {\r\n                if (copy > have) { copy = have; }\r\n                if (copy > left) { copy = left; }\r\n                if (copy === 0) { break inf_leave; }\r\n                //--- zmemcpy(put, next, copy); ---\r\n                utils.arraySet(output, input, next, copy, put);\r\n                //---//\r\n                have -= copy;\r\n                next += copy;\r\n                left -= copy;\r\n                put += copy;\r\n                state.length -= copy;\r\n                break;\r\n              }\r\n              //Tracev((stderr, \"inflate:       stored end\\n\"));\r\n              state.mode = TYPE;\r\n              break;\r\n            case TABLE:\r\n              //=== NEEDBITS(14); */\r\n              while (bits < 14) {\r\n                if (have === 0) { break inf_leave; }\r\n                have--;\r\n                hold += input[next++] << bits;\r\n                bits += 8;\r\n              }\r\n              //===//\r\n              state.nlen = (hold & 0x1f)/*BITS(5)*/ + 257;\r\n              //--- DROPBITS(5) ---//\r\n              hold >>>= 5;\r\n              bits -= 5;\r\n              //---//\r\n              state.ndist = (hold & 0x1f)/*BITS(5)*/ + 1;\r\n              //--- DROPBITS(5) ---//\r\n              hold >>>= 5;\r\n              bits -= 5;\r\n              //---//\r\n              state.ncode = (hold & 0x0f)/*BITS(4)*/ + 4;\r\n              //--- DROPBITS(4) ---//\r\n              hold >>>= 4;\r\n              bits -= 4;\r\n              //---//\r\n//#ifndef PKZIP_BUG_WORKAROUND\r\n              if (state.nlen > 286 || state.ndist > 30) {\r\n                strm.msg = 'too many length or distance symbols';\r\n                state.mode = BAD;\r\n                break;\r\n              }\r\n//#endif\r\n              //Tracev((stderr, \"inflate:       table sizes ok\\n\"));\r\n              state.have = 0;\r\n              state.mode = LENLENS;\r\n            /* falls through */\r\n            case LENLENS:\r\n              while (state.have < state.ncode) {\r\n                //=== NEEDBITS(3);\r\n                while (bits < 3) {\r\n                  if (have === 0) { break inf_leave; }\r\n                  have--;\r\n                  hold += input[next++] << bits;\r\n                  bits += 8;\r\n                }\r\n                //===//\r\n                state.lens[order[state.have++]] = (hold & 0x07);//BITS(3);\r\n                //--- DROPBITS(3) ---//\r\n                hold >>>= 3;\r\n                bits -= 3;\r\n                //---//\r\n              }\r\n              while (state.have < 19) {\r\n                state.lens[order[state.have++]] = 0;\r\n              }\r\n              // We have separate tables & no pointers. 2 commented lines below not needed.\r\n              //state.next = state.codes;\r\n              //state.lencode = state.next;\r\n              // Switch to use dynamic table\r\n              state.lencode = state.lendyn;\r\n              state.lenbits = 7;\r\n\r\n              opts = {bits: state.lenbits};\r\n              ret = inflate_table(CODES, state.lens, 0, 19, state.lencode, 0, state.work, opts);\r\n              state.lenbits = opts.bits;\r\n\r\n              if (ret) {\r\n                strm.msg = 'invalid code lengths set';\r\n                state.mode = BAD;\r\n                break;\r\n              }\r\n              //Tracev((stderr, \"inflate:       code lengths ok\\n\"));\r\n              state.have = 0;\r\n              state.mode = CODELENS;\r\n            /* falls through */\r\n            case CODELENS:\r\n              while (state.have < state.nlen + state.ndist) {\r\n                for (;;) {\r\n                  here = state.lencode[hold & ((1 << state.lenbits) - 1)];/*BITS(state.lenbits)*/\r\n                  here_bits = here >>> 24;\r\n                  here_op = (here >>> 16) & 0xff;\r\n                  here_val = here & 0xffff;\r\n\r\n                  if ((here_bits) <= bits) { break; }\r\n                  //--- PULLBYTE() ---//\r\n                  if (have === 0) { break inf_leave; }\r\n                  have--;\r\n                  hold += input[next++] << bits;\r\n                  bits += 8;\r\n                  //---//\r\n                }\r\n                if (here_val < 16) {\r\n                  //--- DROPBITS(here.bits) ---//\r\n                  hold >>>= here_bits;\r\n                  bits -= here_bits;\r\n                  //---//\r\n                  state.lens[state.have++] = here_val;\r\n                }\r\n                else {\r\n                  if (here_val === 16) {\r\n                    //=== NEEDBITS(here.bits + 2);\r\n                    n = here_bits + 2;\r\n                    while (bits < n) {\r\n                      if (have === 0) { break inf_leave; }\r\n                      have--;\r\n                      hold += input[next++] << bits;\r\n                      bits += 8;\r\n                    }\r\n                    //===//\r\n                    //--- DROPBITS(here.bits) ---//\r\n                    hold >>>= here_bits;\r\n                    bits -= here_bits;\r\n                    //---//\r\n                    if (state.have === 0) {\r\n                      strm.msg = 'invalid bit length repeat';\r\n                      state.mode = BAD;\r\n                      break;\r\n                    }\r\n                    len = state.lens[state.have - 1];\r\n                    copy = 3 + (hold & 0x03);//BITS(2);\r\n                    //--- DROPBITS(2) ---//\r\n                    hold >>>= 2;\r\n                    bits -= 2;\r\n                    //---//\r\n                  }\r\n                  else if (here_val === 17) {\r\n                    //=== NEEDBITS(here.bits + 3);\r\n                    n = here_bits + 3;\r\n                    while (bits < n) {\r\n                      if (have === 0) { break inf_leave; }\r\n                      have--;\r\n                      hold += input[next++] << bits;\r\n                      bits += 8;\r\n                    }\r\n                    //===//\r\n                    //--- DROPBITS(here.bits) ---//\r\n                    hold >>>= here_bits;\r\n                    bits -= here_bits;\r\n                    //---//\r\n                    len = 0;\r\n                    copy = 3 + (hold & 0x07);//BITS(3);\r\n                    //--- DROPBITS(3) ---//\r\n                    hold >>>= 3;\r\n                    bits -= 3;\r\n                    //---//\r\n                  }\r\n                  else {\r\n                    //=== NEEDBITS(here.bits + 7);\r\n                    n = here_bits + 7;\r\n                    while (bits < n) {\r\n                      if (have === 0) { break inf_leave; }\r\n                      have--;\r\n                      hold += input[next++] << bits;\r\n                      bits += 8;\r\n                    }\r\n                    //===//\r\n                    //--- DROPBITS(here.bits) ---//\r\n                    hold >>>= here_bits;\r\n                    bits -= here_bits;\r\n                    //---//\r\n                    len = 0;\r\n                    copy = 11 + (hold & 0x7f);//BITS(7);\r\n                    //--- DROPBITS(7) ---//\r\n                    hold >>>= 7;\r\n                    bits -= 7;\r\n                    //---//\r\n                  }\r\n                  if (state.have + copy > state.nlen + state.ndist) {\r\n                    strm.msg = 'invalid bit length repeat';\r\n                    state.mode = BAD;\r\n                    break;\r\n                  }\r\n                  while (copy--) {\r\n                    state.lens[state.have++] = len;\r\n                  }\r\n                }\r\n              }\r\n\r\n              /* handle error breaks in while */\r\n              if (state.mode === BAD) { break; }\r\n\r\n              /* check for end-of-block code (better have one) */\r\n              if (state.lens[256] === 0) {\r\n                strm.msg = 'invalid code -- missing end-of-block';\r\n                state.mode = BAD;\r\n                break;\r\n              }\r\n\r\n              /* build code tables -- note: do not change the lenbits or distbits\r\n         values here (9 and 6) without reading the comments in inftrees.h\r\n         concerning the ENOUGH constants, which depend on those values */\r\n              state.lenbits = 9;\r\n\r\n              opts = {bits: state.lenbits};\r\n              ret = inflate_table(LENS, state.lens, 0, state.nlen, state.lencode, 0, state.work, opts);\r\n              // We have separate tables & no pointers. 2 commented lines below not needed.\r\n              // state.next_index = opts.table_index;\r\n              state.lenbits = opts.bits;\r\n              // state.lencode = state.next;\r\n\r\n              if (ret) {\r\n                strm.msg = 'invalid literal/lengths set';\r\n                state.mode = BAD;\r\n                break;\r\n              }\r\n\r\n              state.distbits = 6;\r\n              //state.distcode.copy(state.codes);\r\n              // Switch to use dynamic table\r\n              state.distcode = state.distdyn;\r\n              opts = {bits: state.distbits};\r\n              ret = inflate_table(DISTS, state.lens, state.nlen, state.ndist, state.distcode, 0, state.work, opts);\r\n              // We have separate tables & no pointers. 2 commented lines below not needed.\r\n              // state.next_index = opts.table_index;\r\n              state.distbits = opts.bits;\r\n              // state.distcode = state.next;\r\n\r\n              if (ret) {\r\n                strm.msg = 'invalid distances set';\r\n                state.mode = BAD;\r\n                break;\r\n              }\r\n              //Tracev((stderr, 'inflate:       codes ok\\n'));\r\n              state.mode = LEN_;\r\n              if (flush === Z_TREES) { break inf_leave; }\r\n            /* falls through */\r\n            case LEN_:\r\n              state.mode = LEN;\r\n            /* falls through */\r\n            case LEN:\r\n              if (have >= 6 && left >= 258) {\r\n                //--- RESTORE() ---\r\n                strm.next_out = put;\r\n                strm.avail_out = left;\r\n                strm.next_in = next;\r\n                strm.avail_in = have;\r\n                state.hold = hold;\r\n                state.bits = bits;\r\n                //---\r\n                inflate_fast(strm, _out);\r\n                //--- LOAD() ---\r\n                put = strm.next_out;\r\n                output = strm.output;\r\n                left = strm.avail_out;\r\n                next = strm.next_in;\r\n                input = strm.input;\r\n                have = strm.avail_in;\r\n                hold = state.hold;\r\n                bits = state.bits;\r\n                //---\r\n\r\n                if (state.mode === TYPE) {\r\n                  state.back = -1;\r\n                }\r\n                break;\r\n              }\r\n              state.back = 0;\r\n              for (;;) {\r\n                here = state.lencode[hold & ((1 << state.lenbits) -1)];  /*BITS(state.lenbits)*/\r\n                here_bits = here >>> 24;\r\n                here_op = (here >>> 16) & 0xff;\r\n                here_val = here & 0xffff;\r\n\r\n                if (here_bits <= bits) { break; }\r\n                //--- PULLBYTE() ---//\r\n                if (have === 0) { break inf_leave; }\r\n                have--;\r\n                hold += input[next++] << bits;\r\n                bits += 8;\r\n                //---//\r\n              }\r\n              if (here_op && (here_op & 0xf0) === 0) {\r\n                last_bits = here_bits;\r\n                last_op = here_op;\r\n                last_val = here_val;\r\n                for (;;) {\r\n                  here = state.lencode[last_val +\r\n                  ((hold & ((1 << (last_bits + last_op)) -1))/*BITS(last.bits + last.op)*/ >> last_bits)];\r\n                  here_bits = here >>> 24;\r\n                  here_op = (here >>> 16) & 0xff;\r\n                  here_val = here & 0xffff;\r\n\r\n                  if ((last_bits + here_bits) <= bits) { break; }\r\n                  //--- PULLBYTE() ---//\r\n                  if (have === 0) { break inf_leave; }\r\n                  have--;\r\n                  hold += input[next++] << bits;\r\n                  bits += 8;\r\n                  //---//\r\n                }\r\n                //--- DROPBITS(last.bits) ---//\r\n                hold >>>= last_bits;\r\n                bits -= last_bits;\r\n                //---//\r\n                state.back += last_bits;\r\n              }\r\n              //--- DROPBITS(here.bits) ---//\r\n              hold >>>= here_bits;\r\n              bits -= here_bits;\r\n              //---//\r\n              state.back += here_bits;\r\n              state.length = here_val;\r\n              if (here_op === 0) {\r\n                //Tracevv((stderr, here.val >= 0x20 && here.val < 0x7f ?\r\n                //        \"inflate:         literal '%c'\\n\" :\r\n                //        \"inflate:         literal 0x%02x\\n\", here.val));\r\n                state.mode = LIT;\r\n                break;\r\n              }\r\n              if (here_op & 32) {\r\n                //Tracevv((stderr, \"inflate:         end of block\\n\"));\r\n                state.back = -1;\r\n                state.mode = TYPE;\r\n                break;\r\n              }\r\n              if (here_op & 64) {\r\n                strm.msg = 'invalid literal/length code';\r\n                state.mode = BAD;\r\n                break;\r\n              }\r\n              state.extra = here_op & 15;\r\n              state.mode = LENEXT;\r\n            /* falls through */\r\n            case LENEXT:\r\n              if (state.extra) {\r\n                //=== NEEDBITS(state.extra);\r\n                n = state.extra;\r\n                while (bits < n) {\r\n                  if (have === 0) { break inf_leave; }\r\n                  have--;\r\n                  hold += input[next++] << bits;\r\n                  bits += 8;\r\n                }\r\n                //===//\r\n                state.length += hold & ((1 << state.extra) -1)/*BITS(state.extra)*/;\r\n                //--- DROPBITS(state.extra) ---//\r\n                hold >>>= state.extra;\r\n                bits -= state.extra;\r\n                //---//\r\n                state.back += state.extra;\r\n              }\r\n              //Tracevv((stderr, \"inflate:         length %u\\n\", state.length));\r\n              state.was = state.length;\r\n              state.mode = DIST;\r\n            /* falls through */\r\n            case DIST:\r\n              for (;;) {\r\n                here = state.distcode[hold & ((1 << state.distbits) -1)];/*BITS(state.distbits)*/\r\n                here_bits = here >>> 24;\r\n                here_op = (here >>> 16) & 0xff;\r\n                here_val = here & 0xffff;\r\n\r\n                if ((here_bits) <= bits) { break; }\r\n                //--- PULLBYTE() ---//\r\n                if (have === 0) { break inf_leave; }\r\n                have--;\r\n                hold += input[next++] << bits;\r\n                bits += 8;\r\n                //---//\r\n              }\r\n              if ((here_op & 0xf0) === 0) {\r\n                last_bits = here_bits;\r\n                last_op = here_op;\r\n                last_val = here_val;\r\n                for (;;) {\r\n                  here = state.distcode[last_val +\r\n                  ((hold & ((1 << (last_bits + last_op)) -1))/*BITS(last.bits + last.op)*/ >> last_bits)];\r\n                  here_bits = here >>> 24;\r\n                  here_op = (here >>> 16) & 0xff;\r\n                  here_val = here & 0xffff;\r\n\r\n                  if ((last_bits + here_bits) <= bits) { break; }\r\n                  //--- PULLBYTE() ---//\r\n                  if (have === 0) { break inf_leave; }\r\n                  have--;\r\n                  hold += input[next++] << bits;\r\n                  bits += 8;\r\n                  //---//\r\n                }\r\n                //--- DROPBITS(last.bits) ---//\r\n                hold >>>= last_bits;\r\n                bits -= last_bits;\r\n                //---//\r\n                state.back += last_bits;\r\n              }\r\n              //--- DROPBITS(here.bits) ---//\r\n              hold >>>= here_bits;\r\n              bits -= here_bits;\r\n              //---//\r\n              state.back += here_bits;\r\n              if (here_op & 64) {\r\n                strm.msg = 'invalid distance code';\r\n                state.mode = BAD;\r\n                break;\r\n              }\r\n              state.offset = here_val;\r\n              state.extra = (here_op) & 15;\r\n              state.mode = DISTEXT;\r\n            /* falls through */\r\n            case DISTEXT:\r\n              if (state.extra) {\r\n                //=== NEEDBITS(state.extra);\r\n                n = state.extra;\r\n                while (bits < n) {\r\n                  if (have === 0) { break inf_leave; }\r\n                  have--;\r\n                  hold += input[next++] << bits;\r\n                  bits += 8;\r\n                }\r\n                //===//\r\n                state.offset += hold & ((1 << state.extra) -1)/*BITS(state.extra)*/;\r\n                //--- DROPBITS(state.extra) ---//\r\n                hold >>>= state.extra;\r\n                bits -= state.extra;\r\n                //---//\r\n                state.back += state.extra;\r\n              }\r\n//#ifdef INFLATE_STRICT\r\n              if (state.offset > state.dmax) {\r\n                strm.msg = 'invalid distance too far back';\r\n                state.mode = BAD;\r\n                break;\r\n              }\r\n//#endif\r\n              //Tracevv((stderr, \"inflate:         distance %u\\n\", state.offset));\r\n              state.mode = MATCH;\r\n            /* falls through */\r\n            case MATCH:\r\n              if (left === 0) { break inf_leave; }\r\n              copy = _out - left;\r\n              if (state.offset > copy) {         /* copy from window */\r\n                copy = state.offset - copy;\r\n                if (copy > state.whave) {\r\n                  if (state.sane) {\r\n                    strm.msg = 'invalid distance too far back';\r\n                    state.mode = BAD;\r\n                    break;\r\n                  }\r\n// (!) This block is disabled in zlib defailts,\r\n// don't enable it for binary compatibility\r\n//#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR\r\n//          Trace((stderr, \"inflate.c too far\\n\"));\r\n//          copy -= state.whave;\r\n//          if (copy > state.length) { copy = state.length; }\r\n//          if (copy > left) { copy = left; }\r\n//          left -= copy;\r\n//          state.length -= copy;\r\n//          do {\r\n//            output[put++] = 0;\r\n//          } while (--copy);\r\n//          if (state.length === 0) { state.mode = LEN; }\r\n//          break;\r\n//#endif\r\n                }\r\n                if (copy > state.wnext) {\r\n                  copy -= state.wnext;\r\n                  from = state.wsize - copy;\r\n                }\r\n                else {\r\n                  from = state.wnext - copy;\r\n                }\r\n                if (copy > state.length) { copy = state.length; }\r\n                from_source = state.window;\r\n              }\r\n              else {                              /* copy from output */\r\n                from_source = output;\r\n                from = put - state.offset;\r\n                copy = state.length;\r\n              }\r\n              if (copy > left) { copy = left; }\r\n              left -= copy;\r\n              state.length -= copy;\r\n              do {\r\n                output[put++] = from_source[from++];\r\n              } while (--copy);\r\n              if (state.length === 0) { state.mode = LEN; }\r\n              break;\r\n            case LIT:\r\n              if (left === 0) { break inf_leave; }\r\n              output[put++] = state.length;\r\n              left--;\r\n              state.mode = LEN;\r\n              break;\r\n            case CHECK:\r\n              if (state.wrap) {\r\n                //=== NEEDBITS(32);\r\n                while (bits < 32) {\r\n                  if (have === 0) { break inf_leave; }\r\n                  have--;\r\n                  // Use '|' insdead of '+' to make sure that result is signed\r\n                  hold |= input[next++] << bits;\r\n                  bits += 8;\r\n                }\r\n                //===//\r\n                _out -= left;\r\n                strm.total_out += _out;\r\n                state.total += _out;\r\n                if (_out) {\r\n                  strm.adler = state.check =\r\n                    /*UPDATE(state.check, put - _out, _out);*/\r\n                    (state.flags ? crc32(state.check, output, _out, put - _out) : adler32(state.check, output, _out, put - _out));\r\n\r\n                }\r\n                _out = left;\r\n                // NB: crc32 stored as signed 32-bit int, ZSWAP32 returns signed too\r\n                if ((state.flags ? hold : ZSWAP32(hold)) !== state.check) {\r\n                  strm.msg = 'incorrect data check';\r\n                  state.mode = BAD;\r\n                  break;\r\n                }\r\n                //=== INITBITS();\r\n                hold = 0;\r\n                bits = 0;\r\n                //===//\r\n                //Tracev((stderr, \"inflate:   check matches trailer\\n\"));\r\n              }\r\n              state.mode = LENGTH;\r\n            /* falls through */\r\n            case LENGTH:\r\n              if (state.wrap && state.flags) {\r\n                //=== NEEDBITS(32);\r\n                while (bits < 32) {\r\n                  if (have === 0) { break inf_leave; }\r\n                  have--;\r\n                  hold += input[next++] << bits;\r\n                  bits += 8;\r\n                }\r\n                //===//\r\n                if (hold !== (state.total & 0xffffffff)) {\r\n                  strm.msg = 'incorrect length check';\r\n                  state.mode = BAD;\r\n                  break;\r\n                }\r\n                //=== INITBITS();\r\n                hold = 0;\r\n                bits = 0;\r\n                //===//\r\n                //Tracev((stderr, \"inflate:   length matches trailer\\n\"));\r\n              }\r\n              state.mode = DONE;\r\n            /* falls through */\r\n            case DONE:\r\n              ret = Z_STREAM_END;\r\n              break inf_leave;\r\n            case BAD:\r\n              ret = Z_DATA_ERROR;\r\n              break inf_leave;\r\n            case MEM:\r\n              return Z_MEM_ERROR;\r\n            case SYNC:\r\n            /* falls through */\r\n            default:\r\n              return Z_STREAM_ERROR;\r\n          }\r\n        }\r\n\r\n      // inf_leave <- here is real place for \"goto inf_leave\", emulated via \"break inf_leave\"\r\n\r\n      /*\r\n     Return from inflate(), updating the total counts and the check value.\r\n     If there was no progress during the inflate() call, return a buffer\r\n     error.  Call updatewindow() to create and/or update the window state.\r\n     Note: a memory error from inflate() is non-recoverable.\r\n   */\r\n\r\n      //--- RESTORE() ---\r\n      strm.next_out = put;\r\n      strm.avail_out = left;\r\n      strm.next_in = next;\r\n      strm.avail_in = have;\r\n      state.hold = hold;\r\n      state.bits = bits;\r\n      //---\r\n\r\n      if (state.wsize || (_out !== strm.avail_out && state.mode < BAD &&\r\n        (state.mode < CHECK || flush !== Z_FINISH))) {\r\n        if (updatewindow(strm, strm.output, strm.next_out, _out - strm.avail_out)) {\r\n          state.mode = MEM;\r\n          return Z_MEM_ERROR;\r\n        }\r\n      }\r\n      _in -= strm.avail_in;\r\n      _out -= strm.avail_out;\r\n      strm.total_in += _in;\r\n      strm.total_out += _out;\r\n      state.total += _out;\r\n      if (state.wrap && _out) {\r\n        strm.adler = state.check = /*UPDATE(state.check, strm.next_out - _out, _out);*/\r\n          (state.flags ? crc32(state.check, output, _out, strm.next_out - _out) : adler32(state.check, output, _out, strm.next_out - _out));\r\n      }\r\n      strm.data_type = state.bits + (state.last ? 64 : 0) +\r\n        (state.mode === TYPE ? 128 : 0) +\r\n        (state.mode === LEN_ || state.mode === COPY_ ? 256 : 0);\r\n      if (((_in === 0 && _out === 0) || flush === Z_FINISH) && ret === Z_OK) {\r\n        ret = Z_BUF_ERROR;\r\n      }\r\n      return ret;\r\n    }\r\n\r\n    function inflateEnd(strm) {\r\n\r\n      if (!strm || !strm.state /*|| strm->zfree == (free_func)0*/) {\r\n        return Z_STREAM_ERROR;\r\n      }\r\n\r\n      var state = strm.state;\r\n      if (state.window) {\r\n        state.window = null;\r\n      }\r\n      strm.state = null;\r\n      return Z_OK;\r\n    }\r\n\r\n    function inflateGetHeader(strm, head) {\r\n      var state;\r\n\r\n      /* check state */\r\n      if (!strm || !strm.state) { return Z_STREAM_ERROR; }\r\n      state = strm.state;\r\n      if ((state.wrap & 2) === 0) { return Z_STREAM_ERROR; }\r\n\r\n      /* save header structure */\r\n      state.head = head;\r\n      head.done = false;\r\n      return Z_OK;\r\n    }\r\n\r\n\r\n    exports.inflateReset = inflateReset;\r\n    exports.inflateReset2 = inflateReset2;\r\n    exports.inflateResetKeep = inflateResetKeep;\r\n    exports.inflateInit = inflateInit;\r\n    exports.inflateInit2 = inflateInit2;\r\n    exports.inflate = inflate;\r\n    exports.inflateEnd = inflateEnd;\r\n    exports.inflateGetHeader = inflateGetHeader;\r\n    exports.inflateInfo = 'pako inflate (from Nodeca project)';\r\n\r\n    /* Not implemented\r\nexports.inflateCopy = inflateCopy;\r\nexports.inflateGetDictionary = inflateGetDictionary;\r\nexports.inflateMark = inflateMark;\r\nexports.inflatePrime = inflatePrime;\r\nexports.inflateSetDictionary = inflateSetDictionary;\r\nexports.inflateSync = inflateSync;\r\nexports.inflateSyncPoint = inflateSyncPoint;\r\nexports.inflateUndermine = inflateUndermine;\r\n*/\r\n  },{\"../utils/common\":27,\"./adler32\":29,\"./crc32\":31,\"./inffast\":34,\"./inftrees\":36}],36:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n\r\n    var utils = _dereq_('../utils/common');\r\n\r\n    var MAXBITS = 15;\r\n    var ENOUGH_LENS = 852;\r\n    var ENOUGH_DISTS = 592;\r\n//var ENOUGH = (ENOUGH_LENS+ENOUGH_DISTS);\r\n\r\n    var CODES = 0;\r\n    var LENS = 1;\r\n    var DISTS = 2;\r\n\r\n    var lbase = [ /* Length codes 257..285 base */\r\n      3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31,\r\n      35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0\r\n    ];\r\n\r\n    var lext = [ /* Length codes 257..285 extra */\r\n      16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18,\r\n      19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78\r\n    ];\r\n\r\n    var dbase = [ /* Distance codes 0..29 base */\r\n      1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193,\r\n      257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145,\r\n      8193, 12289, 16385, 24577, 0, 0\r\n    ];\r\n\r\n    var dext = [ /* Distance codes 0..29 extra */\r\n      16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22,\r\n      23, 23, 24, 24, 25, 25, 26, 26, 27, 27,\r\n      28, 28, 29, 29, 64, 64\r\n    ];\r\n\r\n    module.exports = function inflate_table(type, lens, lens_index, codes, table, table_index, work, opts)\r\n    {\r\n      var bits = opts.bits;\r\n      //here = opts.here; /* table entry for duplication */\r\n\r\n      var len = 0;               /* a code's length in bits */\r\n      var sym = 0;               /* index of code symbols */\r\n      var min = 0, max = 0;          /* minimum and maximum code lengths */\r\n      var root = 0;              /* number of index bits for root table */\r\n      var curr = 0;              /* number of index bits for current table */\r\n      var drop = 0;              /* code bits to drop for sub-table */\r\n      var left = 0;                   /* number of prefix codes available */\r\n      var used = 0;              /* code entries in table used */\r\n      var huff = 0;              /* Huffman code */\r\n      var incr;              /* for incrementing code, index */\r\n      var fill;              /* index for replicating entries */\r\n      var low;               /* low bits for current root entry */\r\n      var mask;              /* mask for low root bits */\r\n      var next;             /* next available space in table */\r\n      var base = null;     /* base value table to use */\r\n      var base_index = 0;\r\n//  var shoextra;    /* extra bits table to use */\r\n      var end;                    /* use base and extra for symbol > end */\r\n      var count = new utils.Buf16(MAXBITS+1); //[MAXBITS+1];    /* number of codes of each length */\r\n      var offs = new utils.Buf16(MAXBITS+1); //[MAXBITS+1];     /* offsets in table for each length */\r\n      var extra = null;\r\n      var extra_index = 0;\r\n\r\n      var here_bits, here_op, here_val;\r\n\r\n      /*\r\n   Process a set of code lengths to create a canonical Huffman code.  The\r\n   code lengths are lens[0..codes-1].  Each length corresponds to the\r\n   symbols 0..codes-1.  The Huffman code is generated by first sorting the\r\n   symbols by length from short to long, and retaining the symbol order\r\n   for codes with equal lengths.  Then the code starts with all zero bits\r\n   for the first code of the shortest length, and the codes are integer\r\n   increments for the same length, and zeros are appended as the length\r\n   increases.  For the deflate format, these bits are stored backwards\r\n   from their more natural integer increment ordering, and so when the\r\n   decoding tables are built in the large loop below, the integer codes\r\n   are incremented backwards.\r\n\r\n   This routine assumes, but does not check, that all of the entries in\r\n   lens[] are in the range 0..MAXBITS.  The caller must assure this.\r\n   1..MAXBITS is interpreted as that code length.  zero means that that\r\n   symbol does not occur in this code.\r\n\r\n   The codes are sorted by computing a count of codes for each length,\r\n   creating from that a table of starting indices for each length in the\r\n   sorted table, and then entering the symbols in order in the sorted\r\n   table.  The sorted table is work[], with that space being provided by\r\n   the caller.\r\n\r\n   The length counts are used for other purposes as well, i.e. finding\r\n   the minimum and maximum length codes, determining if there are any\r\n   codes at all, checking for a valid set of lengths, and looking ahead\r\n   at length counts to determine sub-table sizes when building the\r\n   decoding tables.\r\n   */\r\n\r\n      /* accumulate lengths for codes (assumes lens[] all in 0..MAXBITS) */\r\n      for (len = 0; len <= MAXBITS; len++) {\r\n        count[len] = 0;\r\n      }\r\n      for (sym = 0; sym < codes; sym++) {\r\n        count[lens[lens_index + sym]]++;\r\n      }\r\n\r\n      /* bound code lengths, force root to be within code lengths */\r\n      root = bits;\r\n      for (max = MAXBITS; max >= 1; max--) {\r\n        if (count[max] !== 0) { break; }\r\n      }\r\n      if (root > max) {\r\n        root = max;\r\n      }\r\n      if (max === 0) {                     /* no symbols to code at all */\r\n        //table.op[opts.table_index] = 64;  //here.op = (var char)64;    /* invalid code marker */\r\n        //table.bits[opts.table_index] = 1;   //here.bits = (var char)1;\r\n        //table.val[opts.table_index++] = 0;   //here.val = (var short)0;\r\n        table[table_index++] = (1 << 24) | (64 << 16) | 0;\r\n\r\n\r\n        //table.op[opts.table_index] = 64;\r\n        //table.bits[opts.table_index] = 1;\r\n        //table.val[opts.table_index++] = 0;\r\n        table[table_index++] = (1 << 24) | (64 << 16) | 0;\r\n\r\n        opts.bits = 1;\r\n        return 0;     /* no symbols, but wait for decoding to report error */\r\n      }\r\n      for (min = 1; min < max; min++) {\r\n        if (count[min] !== 0) { break; }\r\n      }\r\n      if (root < min) {\r\n        root = min;\r\n      }\r\n\r\n      /* check for an over-subscribed or incomplete set of lengths */\r\n      left = 1;\r\n      for (len = 1; len <= MAXBITS; len++) {\r\n        left <<= 1;\r\n        left -= count[len];\r\n        if (left < 0) {\r\n          return -1;\r\n        }        /* over-subscribed */\r\n      }\r\n      if (left > 0 && (type === CODES || max !== 1)) {\r\n        return -1;                      /* incomplete set */\r\n      }\r\n\r\n      /* generate offsets into symbol table for each length for sorting */\r\n      offs[1] = 0;\r\n      for (len = 1; len < MAXBITS; len++) {\r\n        offs[len + 1] = offs[len] + count[len];\r\n      }\r\n\r\n      /* sort symbols by length, by symbol order within each length */\r\n      for (sym = 0; sym < codes; sym++) {\r\n        if (lens[lens_index + sym] !== 0) {\r\n          work[offs[lens[lens_index + sym]]++] = sym;\r\n        }\r\n      }\r\n\r\n      /*\r\n   Create and fill in decoding tables.  In this loop, the table being\r\n   filled is at next and has curr index bits.  The code being used is huff\r\n   with length len.  That code is converted to an index by dropping drop\r\n   bits off of the bottom.  For codes where len is less than drop + curr,\r\n   those top drop + curr - len bits are incremented through all values to\r\n   fill the table with replicated entries.\r\n\r\n   root is the number of index bits for the root table.  When len exceeds\r\n   root, sub-tables are created pointed to by the root entry with an index\r\n   of the low root bits of huff.  This is saved in low to check for when a\r\n   new sub-table should be started.  drop is zero when the root table is\r\n   being filled, and drop is root when sub-tables are being filled.\r\n\r\n   When a new sub-table is needed, it is necessary to look ahead in the\r\n   code lengths to determine what size sub-table is needed.  The length\r\n   counts are used for this, and so count[] is decremented as codes are\r\n   entered in the tables.\r\n\r\n   used keeps track of how many table entries have been allocated from the\r\n   provided *table space.  It is checked for LENS and DIST tables against\r\n   the constants ENOUGH_LENS and ENOUGH_DISTS to guard against changes in\r\n   the initial root table size constants.  See the comments in inftrees.h\r\n   for more information.\r\n\r\n   sym increments through all symbols, and the loop terminates when\r\n   all codes of length max, i.e. all codes, have been processed.  This\r\n   routine permits incomplete codes, so another loop after this one fills\r\n   in the rest of the decoding tables with invalid code markers.\r\n   */\r\n\r\n      /* set up for code type */\r\n      // poor man optimization - use if-else instead of switch,\r\n      // to avoid deopts in old v8\r\n      if (type === CODES) {\r\n        base = extra = work;    /* dummy value--not used */\r\n        end = 19;\r\n      } else if (type === LENS) {\r\n        base = lbase;\r\n        base_index -= 257;\r\n        extra = lext;\r\n        extra_index -= 257;\r\n        end = 256;\r\n      } else {                    /* DISTS */\r\n        base = dbase;\r\n        extra = dext;\r\n        end = -1;\r\n      }\r\n\r\n      /* initialize opts for loop */\r\n      huff = 0;                   /* starting code */\r\n      sym = 0;                    /* starting code symbol */\r\n      len = min;                  /* starting code length */\r\n      next = table_index;              /* current table to fill in */\r\n      curr = root;                /* current table index bits */\r\n      drop = 0;                   /* current bits to drop from code for index */\r\n      low = -1;                   /* trigger new sub-table when len > root */\r\n      used = 1 << root;          /* use root table entries */\r\n      mask = used - 1;            /* mask for comparing low */\r\n\r\n      /* check available table space */\r\n      if ((type === LENS && used > ENOUGH_LENS) ||\r\n        (type === DISTS && used > ENOUGH_DISTS)) {\r\n        return 1;\r\n      }\r\n\r\n      var i=0;\r\n      /* process all codes and make table entries */\r\n      for (;;) {\r\n        i++;\r\n        /* create table entry */\r\n        here_bits = len - drop;\r\n        if (work[sym] < end) {\r\n          here_op = 0;\r\n          here_val = work[sym];\r\n        }\r\n        else if (work[sym] > end) {\r\n          here_op = extra[extra_index + work[sym]];\r\n          here_val = base[base_index + work[sym]];\r\n        }\r\n        else {\r\n          here_op = 32 + 64;         /* end of block */\r\n          here_val = 0;\r\n        }\r\n\r\n        /* replicate for those indices with low len bits equal to huff */\r\n        incr = 1 << (len - drop);\r\n        fill = 1 << curr;\r\n        min = fill;                 /* save offset to next table */\r\n        do {\r\n          fill -= incr;\r\n          table[next + (huff >> drop) + fill] = (here_bits << 24) | (here_op << 16) | here_val |0;\r\n        } while (fill !== 0);\r\n\r\n        /* backwards increment the len-bit code huff */\r\n        incr = 1 << (len - 1);\r\n        while (huff & incr) {\r\n          incr >>= 1;\r\n        }\r\n        if (incr !== 0) {\r\n          huff &= incr - 1;\r\n          huff += incr;\r\n        } else {\r\n          huff = 0;\r\n        }\r\n\r\n        /* go to next symbol, update count, len */\r\n        sym++;\r\n        if (--count[len] === 0) {\r\n          if (len === max) { break; }\r\n          len = lens[lens_index + work[sym]];\r\n        }\r\n\r\n        /* create new sub-table if needed */\r\n        if (len > root && (huff & mask) !== low) {\r\n          /* if first time, transition to sub-tables */\r\n          if (drop === 0) {\r\n            drop = root;\r\n          }\r\n\r\n          /* increment past last table */\r\n          next += min;            /* here min is 1 << curr */\r\n\r\n          /* determine length of next table */\r\n          curr = len - drop;\r\n          left = 1 << curr;\r\n          while (curr + drop < max) {\r\n            left -= count[curr + drop];\r\n            if (left <= 0) { break; }\r\n            curr++;\r\n            left <<= 1;\r\n          }\r\n\r\n          /* check for enough space */\r\n          used += 1 << curr;\r\n          if ((type === LENS && used > ENOUGH_LENS) ||\r\n            (type === DISTS && used > ENOUGH_DISTS)) {\r\n            return 1;\r\n          }\r\n\r\n          /* point entry in root table to sub-table */\r\n          low = huff & mask;\r\n          /*table.op[low] = curr;\r\n      table.bits[low] = root;\r\n      table.val[low] = next - opts.table_index;*/\r\n          table[low] = (root << 24) | (curr << 16) | (next - table_index) |0;\r\n        }\r\n      }\r\n\r\n      /* fill in remaining table entry if code is incomplete (guaranteed to have\r\n   at most one remaining entry, since if the code is incomplete, the\r\n   maximum code length that was allowed to get this far is one bit) */\r\n      if (huff !== 0) {\r\n        //table.op[next + huff] = 64;            /* invalid code marker */\r\n        //table.bits[next + huff] = len - drop;\r\n        //table.val[next + huff] = 0;\r\n        table[next + huff] = ((len - drop) << 24) | (64 << 16) |0;\r\n      }\r\n\r\n      /* set return parameters */\r\n      //opts.table_index += used;\r\n      opts.bits = root;\r\n      return 0;\r\n    };\r\n\r\n  },{\"../utils/common\":27}],37:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n    module.exports = {\r\n      '2':    'need dictionary',     /* Z_NEED_DICT       2  */\r\n      '1':    'stream end',          /* Z_STREAM_END      1  */\r\n      '0':    '',                    /* Z_OK              0  */\r\n      '-1':   'file error',          /* Z_ERRNO         (-1) */\r\n      '-2':   'stream error',        /* Z_STREAM_ERROR  (-2) */\r\n      '-3':   'data error',          /* Z_DATA_ERROR    (-3) */\r\n      '-4':   'insufficient memory', /* Z_MEM_ERROR     (-4) */\r\n      '-5':   'buffer error',        /* Z_BUF_ERROR     (-5) */\r\n      '-6':   'incompatible version' /* Z_VERSION_ERROR (-6) */\r\n    };\r\n  },{}],38:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n\r\n    var utils = _dereq_('../utils/common');\r\n\r\n    /* Public constants ==========================================================*/\r\n    /* ===========================================================================*/\r\n\r\n\r\n//var Z_FILTERED          = 1;\r\n//var Z_HUFFMAN_ONLY      = 2;\r\n//var Z_RLE               = 3;\r\n    var Z_FIXED               = 4;\r\n//var Z_DEFAULT_STRATEGY  = 0;\r\n\r\n    /* Possible values of the data_type field (though see inflate()) */\r\n    var Z_BINARY              = 0;\r\n    var Z_TEXT                = 1;\r\n//var Z_ASCII             = 1; // = Z_TEXT\r\n    var Z_UNKNOWN             = 2;\r\n\r\n    /*============================================================================*/\r\n\r\n\r\n    function zero(buf) { var len = buf.length; while (--len >= 0) { buf[len] = 0; } }\r\n\r\n// From zutil.h\r\n\r\n    var STORED_BLOCK = 0;\r\n    var STATIC_TREES = 1;\r\n    var DYN_TREES    = 2;\r\n    /* The three kinds of block type */\r\n\r\n    var MIN_MATCH    = 3;\r\n    var MAX_MATCH    = 258;\r\n    /* The minimum and maximum match lengths */\r\n\r\n// From deflate.h\r\n    /* ===========================================================================\r\n * Internal compression state.\r\n */\r\n\r\n    var LENGTH_CODES  = 29;\r\n    /* number of length codes, not counting the special END_BLOCK code */\r\n\r\n    var LITERALS      = 256;\r\n    /* number of literal bytes 0..255 */\r\n\r\n    var L_CODES       = LITERALS + 1 + LENGTH_CODES;\r\n    /* number of Literal or Length codes, including the END_BLOCK code */\r\n\r\n    var D_CODES       = 30;\r\n    /* number of distance codes */\r\n\r\n    var BL_CODES      = 19;\r\n    /* number of codes used to transfer the bit lengths */\r\n\r\n    var HEAP_SIZE     = 2*L_CODES + 1;\r\n    /* maximum heap size */\r\n\r\n    var MAX_BITS      = 15;\r\n    /* All codes must not exceed MAX_BITS bits */\r\n\r\n    var Buf_size      = 16;\r\n    /* size of bit buffer in bi_buf */\r\n\r\n\r\n    /* ===========================================================================\r\n * Constants\r\n */\r\n\r\n    var MAX_BL_BITS = 7;\r\n    /* Bit length codes must not exceed MAX_BL_BITS bits */\r\n\r\n    var END_BLOCK   = 256;\r\n    /* end of block literal code */\r\n\r\n    var REP_3_6     = 16;\r\n    /* repeat previous bit length 3-6 times (2 bits of repeat count) */\r\n\r\n    var REPZ_3_10   = 17;\r\n    /* repeat a zero length 3-10 times  (3 bits of repeat count) */\r\n\r\n    var REPZ_11_138 = 18;\r\n    /* repeat a zero length 11-138 times  (7 bits of repeat count) */\r\n\r\n    var extra_lbits =   /* extra bits for each length code */\r\n      [0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];\r\n\r\n    var extra_dbits =   /* extra bits for each distance code */\r\n      [0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];\r\n\r\n    var extra_blbits =  /* extra bits for each bit length code */\r\n      [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];\r\n\r\n    var bl_order =\r\n      [16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];\r\n    /* The lengths of the bit length codes are sent in order of decreasing\r\n * probability, to avoid transmitting the lengths for unused bit length codes.\r\n */\r\n\r\n    /* ===========================================================================\r\n * Local data. These are initialized only once.\r\n */\r\n\r\n// We pre-fill arrays with 0 to avoid uninitialized gaps\r\n\r\n    var DIST_CODE_LEN = 512; /* see definition of array dist_code below */\r\n\r\n// !!!! Use flat array insdead of structure, Freq = i*2, Len = i*2+1\r\n    var static_ltree  = new Array((L_CODES+2) * 2);\r\n    zero(static_ltree);\r\n    /* The static literal tree. Since the bit lengths are imposed, there is no\r\n * need for the L_CODES extra codes used during heap construction. However\r\n * The codes 286 and 287 are needed to build a canonical tree (see _tr_init\r\n * below).\r\n */\r\n\r\n    var static_dtree  = new Array(D_CODES * 2);\r\n    zero(static_dtree);\r\n    /* The static distance tree. (Actually a trivial tree since all codes use\r\n * 5 bits.)\r\n */\r\n\r\n    var _dist_code    = new Array(DIST_CODE_LEN);\r\n    zero(_dist_code);\r\n    /* Distance codes. The first 256 values correspond to the distances\r\n * 3 .. 258, the last 256 values correspond to the top 8 bits of\r\n * the 15 bit distances.\r\n */\r\n\r\n    var _length_code  = new Array(MAX_MATCH-MIN_MATCH+1);\r\n    zero(_length_code);\r\n    /* length code for each normalized match length (0 == MIN_MATCH) */\r\n\r\n    var base_length   = new Array(LENGTH_CODES);\r\n    zero(base_length);\r\n    /* First normalized length for each code (0 = MIN_MATCH) */\r\n\r\n    var base_dist     = new Array(D_CODES);\r\n    zero(base_dist);\r\n    /* First normalized distance for each code (0 = distance of 1) */\r\n\r\n\r\n    var StaticTreeDesc = function (static_tree, extra_bits, extra_base, elems, max_length) {\r\n\r\n      this.static_tree  = static_tree;  /* static tree or NULL */\r\n      this.extra_bits   = extra_bits;   /* extra bits for each code or NULL */\r\n      this.extra_base   = extra_base;   /* base index for extra_bits */\r\n      this.elems        = elems;        /* max number of elements in the tree */\r\n      this.max_length   = max_length;   /* max bit length for the codes */\r\n\r\n      // show if `static_tree` has data or dummy - needed for monomorphic objects\r\n      this.has_stree    = static_tree && static_tree.length;\r\n    };\r\n\r\n\r\n    var static_l_desc;\r\n    var static_d_desc;\r\n    var static_bl_desc;\r\n\r\n\r\n    var TreeDesc = function(dyn_tree, stat_desc) {\r\n      this.dyn_tree = dyn_tree;     /* the dynamic tree */\r\n      this.max_code = 0;            /* largest code with non zero frequency */\r\n      this.stat_desc = stat_desc;   /* the corresponding static tree */\r\n    };\r\n\r\n\r\n\r\n    function d_code(dist) {\r\n      return dist < 256 ? _dist_code[dist] : _dist_code[256 + (dist >>> 7)];\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Output a short LSB first on the stream.\r\n * IN assertion: there is enough room in pendingBuf.\r\n */\r\n    function put_short (s, w) {\r\n//    put_byte(s, (uch)((w) & 0xff));\r\n//    put_byte(s, (uch)((ush)(w) >> 8));\r\n      s.pending_buf[s.pending++] = (w) & 0xff;\r\n      s.pending_buf[s.pending++] = (w >>> 8) & 0xff;\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Send a value on a given number of bits.\r\n * IN assertion: length <= 16 and value fits in length bits.\r\n */\r\n    function send_bits(s, value, length) {\r\n      if (s.bi_valid > (Buf_size - length)) {\r\n        s.bi_buf |= (value << s.bi_valid) & 0xffff;\r\n        put_short(s, s.bi_buf);\r\n        s.bi_buf = value >> (Buf_size - s.bi_valid);\r\n        s.bi_valid += length - Buf_size;\r\n      } else {\r\n        s.bi_buf |= (value << s.bi_valid) & 0xffff;\r\n        s.bi_valid += length;\r\n      }\r\n    }\r\n\r\n\r\n    function send_code(s, c, tree) {\r\n      send_bits(s, tree[c*2]/*.Code*/, tree[c*2 + 1]/*.Len*/);\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Reverse the first len bits of a code, using straightforward code (a faster\r\n * method would use a table)\r\n * IN assertion: 1 <= len <= 15\r\n */\r\n    function bi_reverse(code, len) {\r\n      var res = 0;\r\n      do {\r\n        res |= code & 1;\r\n        code >>>= 1;\r\n        res <<= 1;\r\n      } while (--len > 0);\r\n      return res >>> 1;\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Flush the bit buffer, keeping at most 7 bits in it.\r\n */\r\n    function bi_flush(s) {\r\n      if (s.bi_valid === 16) {\r\n        put_short(s, s.bi_buf);\r\n        s.bi_buf = 0;\r\n        s.bi_valid = 0;\r\n\r\n      } else if (s.bi_valid >= 8) {\r\n        s.pending_buf[s.pending++] = s.bi_buf & 0xff;\r\n        s.bi_buf >>= 8;\r\n        s.bi_valid -= 8;\r\n      }\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Compute the optimal bit lengths for a tree and update the total bit length\r\n * for the current block.\r\n * IN assertion: the fields freq and dad are set, heap[heap_max] and\r\n *    above are the tree nodes sorted by increasing frequency.\r\n * OUT assertions: the field len is set to the optimal bit length, the\r\n *     array bl_count contains the frequencies for each bit length.\r\n *     The length opt_len is updated; static_len is also updated if stree is\r\n *     not null.\r\n */\r\n    function gen_bitlen(s, desc)\r\n//    deflate_state *s;\r\n//    tree_desc *desc;    /* the tree descriptor */\r\n    {\r\n      var tree            = desc.dyn_tree;\r\n      var max_code        = desc.max_code;\r\n      var stree           = desc.stat_desc.static_tree;\r\n      var has_stree       = desc.stat_desc.has_stree;\r\n      var extra           = desc.stat_desc.extra_bits;\r\n      var base            = desc.stat_desc.extra_base;\r\n      var max_length      = desc.stat_desc.max_length;\r\n      var h;              /* heap index */\r\n      var n, m;           /* iterate over the tree elements */\r\n      var bits;           /* bit length */\r\n      var xbits;          /* extra bits */\r\n      var f;              /* frequency */\r\n      var overflow = 0;   /* number of elements with bit length too large */\r\n\r\n      for (bits = 0; bits <= MAX_BITS; bits++) {\r\n        s.bl_count[bits] = 0;\r\n      }\r\n\r\n      /* In a first pass, compute the optimal bit lengths (which may\r\n   * overflow in the case of the bit length tree).\r\n   */\r\n      tree[s.heap[s.heap_max]*2 + 1]/*.Len*/ = 0; /* root of the heap */\r\n\r\n      for (h = s.heap_max+1; h < HEAP_SIZE; h++) {\r\n        n = s.heap[h];\r\n        bits = tree[tree[n*2 +1]/*.Dad*/ * 2 + 1]/*.Len*/ + 1;\r\n        if (bits > max_length) {\r\n          bits = max_length;\r\n          overflow++;\r\n        }\r\n        tree[n*2 + 1]/*.Len*/ = bits;\r\n        /* We overwrite tree[n].Dad which is no longer needed */\r\n\r\n        if (n > max_code) { continue; } /* not a leaf node */\r\n\r\n        s.bl_count[bits]++;\r\n        xbits = 0;\r\n        if (n >= base) {\r\n          xbits = extra[n-base];\r\n        }\r\n        f = tree[n * 2]/*.Freq*/;\r\n        s.opt_len += f * (bits + xbits);\r\n        if (has_stree) {\r\n          s.static_len += f * (stree[n*2 + 1]/*.Len*/ + xbits);\r\n        }\r\n      }\r\n      if (overflow === 0) { return; }\r\n\r\n      // Trace((stderr,\"\\nbit length overflow\\n\"));\r\n      /* This happens for example on obj2 and pic of the Calgary corpus */\r\n\r\n      /* Find the first bit length which could increase: */\r\n      do {\r\n        bits = max_length-1;\r\n        while (s.bl_count[bits] === 0) { bits--; }\r\n        s.bl_count[bits]--;      /* move one leaf down the tree */\r\n        s.bl_count[bits+1] += 2; /* move one overflow item as its brother */\r\n        s.bl_count[max_length]--;\r\n        /* The brother of the overflow item also moves one step up,\r\n     * but this does not affect bl_count[max_length]\r\n     */\r\n        overflow -= 2;\r\n      } while (overflow > 0);\r\n\r\n      /* Now recompute all bit lengths, scanning in increasing frequency.\r\n   * h is still equal to HEAP_SIZE. (It is simpler to reconstruct all\r\n   * lengths instead of fixing only the wrong ones. This idea is taken\r\n   * from 'ar' written by Haruhiko Okumura.)\r\n   */\r\n      for (bits = max_length; bits !== 0; bits--) {\r\n        n = s.bl_count[bits];\r\n        while (n !== 0) {\r\n          m = s.heap[--h];\r\n          if (m > max_code) { continue; }\r\n          if (tree[m*2 + 1]/*.Len*/ !== bits) {\r\n            // Trace((stderr,\"code %d bits %d->%d\\n\", m, tree[m].Len, bits));\r\n            s.opt_len += (bits - tree[m*2 + 1]/*.Len*/)*tree[m*2]/*.Freq*/;\r\n            tree[m*2 + 1]/*.Len*/ = bits;\r\n          }\r\n          n--;\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Generate the codes for a given tree and bit counts (which need not be\r\n * optimal).\r\n * IN assertion: the array bl_count contains the bit length statistics for\r\n * the given tree and the field len is set for all tree elements.\r\n * OUT assertion: the field code is set for all tree elements of non\r\n *     zero code length.\r\n */\r\n    function gen_codes(tree, max_code, bl_count)\r\n//    ct_data *tree;             /* the tree to decorate */\r\n//    int max_code;              /* largest code with non zero frequency */\r\n//    ushf *bl_count;            /* number of codes at each bit length */\r\n    {\r\n      var next_code = new Array(MAX_BITS+1); /* next code value for each bit length */\r\n      var code = 0;              /* running code value */\r\n      var bits;                  /* bit index */\r\n      var n;                     /* code index */\r\n\r\n      /* The distribution counts are first used to generate the code values\r\n   * without bit reversal.\r\n   */\r\n      for (bits = 1; bits <= MAX_BITS; bits++) {\r\n        next_code[bits] = code = (code + bl_count[bits-1]) << 1;\r\n      }\r\n      /* Check that the bit counts in bl_count are consistent. The last code\r\n   * must be all ones.\r\n   */\r\n      //Assert (code + bl_count[MAX_BITS]-1 == (1<<MAX_BITS)-1,\r\n      //        \"inconsistent bit counts\");\r\n      //Tracev((stderr,\"\\ngen_codes: max_code %d \", max_code));\r\n\r\n      for (n = 0;  n <= max_code; n++) {\r\n        var len = tree[n*2 + 1]/*.Len*/;\r\n        if (len === 0) { continue; }\r\n        /* Now reverse the bits */\r\n        tree[n*2]/*.Code*/ = bi_reverse(next_code[len]++, len);\r\n\r\n        //Tracecv(tree != static_ltree, (stderr,\"\\nn %3d %c l %2d c %4x (%x) \",\r\n        //     n, (isgraph(n) ? n : ' '), len, tree[n].Code, next_code[len]-1));\r\n      }\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Initialize the various 'constant' tables.\r\n */\r\n    function tr_static_init() {\r\n      var n;        /* iterates over tree elements */\r\n      var bits;     /* bit counter */\r\n      var length;   /* length value */\r\n      var code;     /* code value */\r\n      var dist;     /* distance index */\r\n      var bl_count = new Array(MAX_BITS+1);\r\n      /* number of codes at each bit length for an optimal tree */\r\n\r\n      // do check in _tr_init()\r\n      //if (static_init_done) return;\r\n\r\n      /* For some embedded targets, global variables are not initialized: */\r\n      /*#ifdef NO_INIT_GLOBAL_POINTERS\r\n  static_l_desc.static_tree = static_ltree;\r\n  static_l_desc.extra_bits = extra_lbits;\r\n  static_d_desc.static_tree = static_dtree;\r\n  static_d_desc.extra_bits = extra_dbits;\r\n  static_bl_desc.extra_bits = extra_blbits;\r\n#endif*/\r\n\r\n      /* Initialize the mapping length (0..255) -> length code (0..28) */\r\n      length = 0;\r\n      for (code = 0; code < LENGTH_CODES-1; code++) {\r\n        base_length[code] = length;\r\n        for (n = 0; n < (1<<extra_lbits[code]); n++) {\r\n          _length_code[length++] = code;\r\n        }\r\n      }\r\n      //Assert (length == 256, \"tr_static_init: length != 256\");\r\n      /* Note that the length 255 (match length 258) can be represented\r\n   * in two different ways: code 284 + 5 bits or code 285, so we\r\n   * overwrite length_code[255] to use the best encoding:\r\n   */\r\n      _length_code[length-1] = code;\r\n\r\n      /* Initialize the mapping dist (0..32K) -> dist code (0..29) */\r\n      dist = 0;\r\n      for (code = 0 ; code < 16; code++) {\r\n        base_dist[code] = dist;\r\n        for (n = 0; n < (1<<extra_dbits[code]); n++) {\r\n          _dist_code[dist++] = code;\r\n        }\r\n      }\r\n      //Assert (dist == 256, \"tr_static_init: dist != 256\");\r\n      dist >>= 7; /* from now on, all distances are divided by 128 */\r\n      for ( ; code < D_CODES; code++) {\r\n        base_dist[code] = dist << 7;\r\n        for (n = 0; n < (1<<(extra_dbits[code]-7)); n++) {\r\n          _dist_code[256 + dist++] = code;\r\n        }\r\n      }\r\n      //Assert (dist == 256, \"tr_static_init: 256+dist != 512\");\r\n\r\n      /* Construct the codes of the static literal tree */\r\n      for (bits = 0; bits <= MAX_BITS; bits++) {\r\n        bl_count[bits] = 0;\r\n      }\r\n\r\n      n = 0;\r\n      while (n <= 143) {\r\n        static_ltree[n*2 + 1]/*.Len*/ = 8;\r\n        n++;\r\n        bl_count[8]++;\r\n      }\r\n      while (n <= 255) {\r\n        static_ltree[n*2 + 1]/*.Len*/ = 9;\r\n        n++;\r\n        bl_count[9]++;\r\n      }\r\n      while (n <= 279) {\r\n        static_ltree[n*2 + 1]/*.Len*/ = 7;\r\n        n++;\r\n        bl_count[7]++;\r\n      }\r\n      while (n <= 287) {\r\n        static_ltree[n*2 + 1]/*.Len*/ = 8;\r\n        n++;\r\n        bl_count[8]++;\r\n      }\r\n      /* Codes 286 and 287 do not exist, but we must include them in the\r\n   * tree construction to get a canonical Huffman tree (longest code\r\n   * all ones)\r\n   */\r\n      gen_codes(static_ltree, L_CODES+1, bl_count);\r\n\r\n      /* The static distance tree is trivial: */\r\n      for (n = 0; n < D_CODES; n++) {\r\n        static_dtree[n*2 + 1]/*.Len*/ = 5;\r\n        static_dtree[n*2]/*.Code*/ = bi_reverse(n, 5);\r\n      }\r\n\r\n      // Now data ready and we can init static trees\r\n      static_l_desc = new StaticTreeDesc(static_ltree, extra_lbits, LITERALS+1, L_CODES, MAX_BITS);\r\n      static_d_desc = new StaticTreeDesc(static_dtree, extra_dbits, 0,          D_CODES, MAX_BITS);\r\n      static_bl_desc =new StaticTreeDesc(new Array(0), extra_blbits, 0,         BL_CODES, MAX_BL_BITS);\r\n\r\n      //static_init_done = true;\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Initialize a new block.\r\n */\r\n    function init_block(s) {\r\n      var n; /* iterates over tree elements */\r\n\r\n      /* Initialize the trees. */\r\n      for (n = 0; n < L_CODES;  n++) { s.dyn_ltree[n*2]/*.Freq*/ = 0; }\r\n      for (n = 0; n < D_CODES;  n++) { s.dyn_dtree[n*2]/*.Freq*/ = 0; }\r\n      for (n = 0; n < BL_CODES; n++) { s.bl_tree[n*2]/*.Freq*/ = 0; }\r\n\r\n      s.dyn_ltree[END_BLOCK*2]/*.Freq*/ = 1;\r\n      s.opt_len = s.static_len = 0;\r\n      s.last_lit = s.matches = 0;\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Flush the bit buffer and align the output on a byte boundary\r\n */\r\n    function bi_windup(s)\r\n    {\r\n      if (s.bi_valid > 8) {\r\n        put_short(s, s.bi_buf);\r\n      } else if (s.bi_valid > 0) {\r\n        //put_byte(s, (Byte)s->bi_buf);\r\n        s.pending_buf[s.pending++] = s.bi_buf;\r\n      }\r\n      s.bi_buf = 0;\r\n      s.bi_valid = 0;\r\n    }\r\n\r\n    /* ===========================================================================\r\n * Copy a stored block, storing first the length and its\r\n * one's complement if requested.\r\n */\r\n    function copy_block(s, buf, len, header)\r\n//DeflateState *s;\r\n//charf    *buf;    /* the input data */\r\n//unsigned len;     /* its length */\r\n//int      header;  /* true if block header must be written */\r\n    {\r\n      bi_windup(s);        /* align on byte boundary */\r\n\r\n      if (header) {\r\n        put_short(s, len);\r\n        put_short(s, ~len);\r\n      }\r\n//  while (len--) {\r\n//    put_byte(s, *buf++);\r\n//  }\r\n      utils.arraySet(s.pending_buf, s.window, buf, len, s.pending);\r\n      s.pending += len;\r\n    }\r\n\r\n    /* ===========================================================================\r\n * Compares to subtrees, using the tree depth as tie breaker when\r\n * the subtrees have equal frequency. This minimizes the worst case length.\r\n */\r\n    function smaller(tree, n, m, depth) {\r\n      var _n2 = n*2;\r\n      var _m2 = m*2;\r\n      return (tree[_n2]/*.Freq*/ < tree[_m2]/*.Freq*/ ||\r\n        (tree[_n2]/*.Freq*/ === tree[_m2]/*.Freq*/ && depth[n] <= depth[m]));\r\n    }\r\n\r\n    /* ===========================================================================\r\n * Restore the heap property by moving down the tree starting at node k,\r\n * exchanging a node with the smallest of its two sons if necessary, stopping\r\n * when the heap property is re-established (each father smaller than its\r\n * two sons).\r\n */\r\n    function pqdownheap(s, tree, k)\r\n//    deflate_state *s;\r\n//    ct_data *tree;  /* the tree to restore */\r\n//    int k;               /* node to move down */\r\n    {\r\n      var v = s.heap[k];\r\n      var j = k << 1;  /* left son of k */\r\n      while (j <= s.heap_len) {\r\n        /* Set j to the smallest of the two sons: */\r\n        if (j < s.heap_len &&\r\n          smaller(tree, s.heap[j+1], s.heap[j], s.depth)) {\r\n          j++;\r\n        }\r\n        /* Exit if v is smaller than both sons */\r\n        if (smaller(tree, v, s.heap[j], s.depth)) { break; }\r\n\r\n        /* Exchange v with the smallest son */\r\n        s.heap[k] = s.heap[j];\r\n        k = j;\r\n\r\n        /* And continue down the tree, setting j to the left son of k */\r\n        j <<= 1;\r\n      }\r\n      s.heap[k] = v;\r\n    }\r\n\r\n\r\n// inlined manually\r\n// var SMALLEST = 1;\r\n\r\n    /* ===========================================================================\r\n * Send the block data compressed using the given Huffman trees\r\n */\r\n    function compress_block(s, ltree, dtree)\r\n//    deflate_state *s;\r\n//    const ct_data *ltree; /* literal tree */\r\n//    const ct_data *dtree; /* distance tree */\r\n    {\r\n      var dist;           /* distance of matched string */\r\n      var lc;             /* match length or unmatched char (if dist == 0) */\r\n      var lx = 0;         /* running index in l_buf */\r\n      var code;           /* the code to send */\r\n      var extra;          /* number of extra bits to send */\r\n\r\n      if (s.last_lit !== 0) {\r\n        do {\r\n          dist = (s.pending_buf[s.d_buf + lx*2] << 8) | (s.pending_buf[s.d_buf + lx*2 + 1]);\r\n          lc = s.pending_buf[s.l_buf + lx];\r\n          lx++;\r\n\r\n          if (dist === 0) {\r\n            send_code(s, lc, ltree); /* send a literal byte */\r\n            //Tracecv(isgraph(lc), (stderr,\" '%c' \", lc));\r\n          } else {\r\n            /* Here, lc is the match length - MIN_MATCH */\r\n            code = _length_code[lc];\r\n            send_code(s, code+LITERALS+1, ltree); /* send the length code */\r\n            extra = extra_lbits[code];\r\n            if (extra !== 0) {\r\n              lc -= base_length[code];\r\n              send_bits(s, lc, extra);       /* send the extra length bits */\r\n            }\r\n            dist--; /* dist is now the match distance - 1 */\r\n            code = d_code(dist);\r\n            //Assert (code < D_CODES, \"bad d_code\");\r\n\r\n            send_code(s, code, dtree);       /* send the distance code */\r\n            extra = extra_dbits[code];\r\n            if (extra !== 0) {\r\n              dist -= base_dist[code];\r\n              send_bits(s, dist, extra);   /* send the extra distance bits */\r\n            }\r\n          } /* literal or match pair ? */\r\n\r\n          /* Check that the overlay between pending_buf and d_buf+l_buf is ok: */\r\n          //Assert((uInt)(s->pending) < s->lit_bufsize + 2*lx,\r\n          //       \"pendingBuf overflow\");\r\n\r\n        } while (lx < s.last_lit);\r\n      }\r\n\r\n      send_code(s, END_BLOCK, ltree);\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Construct one Huffman tree and assigns the code bit strings and lengths.\r\n * Update the total bit length for the current block.\r\n * IN assertion: the field freq is set for all tree elements.\r\n * OUT assertions: the fields len and code are set to the optimal bit length\r\n *     and corresponding code. The length opt_len is updated; static_len is\r\n *     also updated if stree is not null. The field max_code is set.\r\n */\r\n    function build_tree(s, desc)\r\n//    deflate_state *s;\r\n//    tree_desc *desc; /* the tree descriptor */\r\n    {\r\n      var tree     = desc.dyn_tree;\r\n      var stree    = desc.stat_desc.static_tree;\r\n      var has_stree = desc.stat_desc.has_stree;\r\n      var elems    = desc.stat_desc.elems;\r\n      var n, m;          /* iterate over heap elements */\r\n      var max_code = -1; /* largest code with non zero frequency */\r\n      var node;          /* new node being created */\r\n\r\n      /* Construct the initial heap, with least frequent element in\r\n   * heap[SMALLEST]. The sons of heap[n] are heap[2*n] and heap[2*n+1].\r\n   * heap[0] is not used.\r\n   */\r\n      s.heap_len = 0;\r\n      s.heap_max = HEAP_SIZE;\r\n\r\n      for (n = 0; n < elems; n++) {\r\n        if (tree[n * 2]/*.Freq*/ !== 0) {\r\n          s.heap[++s.heap_len] = max_code = n;\r\n          s.depth[n] = 0;\r\n\r\n        } else {\r\n          tree[n*2 + 1]/*.Len*/ = 0;\r\n        }\r\n      }\r\n\r\n      /* The pkzip format requires that at least one distance code exists,\r\n   * and that at least one bit should be sent even if there is only one\r\n   * possible code. So to avoid special checks later on we force at least\r\n   * two codes of non zero frequency.\r\n   */\r\n      while (s.heap_len < 2) {\r\n        node = s.heap[++s.heap_len] = (max_code < 2 ? ++max_code : 0);\r\n        tree[node * 2]/*.Freq*/ = 1;\r\n        s.depth[node] = 0;\r\n        s.opt_len--;\r\n\r\n        if (has_stree) {\r\n          s.static_len -= stree[node*2 + 1]/*.Len*/;\r\n        }\r\n        /* node is 0 or 1 so it does not have extra bits */\r\n      }\r\n      desc.max_code = max_code;\r\n\r\n      /* The elements heap[heap_len/2+1 .. heap_len] are leaves of the tree,\r\n   * establish sub-heaps of increasing lengths:\r\n   */\r\n      for (n = (s.heap_len >> 1/*int /2*/); n >= 1; n--) { pqdownheap(s, tree, n); }\r\n\r\n      /* Construct the Huffman tree by repeatedly combining the least two\r\n   * frequent nodes.\r\n   */\r\n      node = elems;              /* next internal node of the tree */\r\n      do {\r\n        //pqremove(s, tree, n);  /* n = node of least frequency */\r\n        /*** pqremove ***/\r\n        n = s.heap[1/*SMALLEST*/];\r\n        s.heap[1/*SMALLEST*/] = s.heap[s.heap_len--];\r\n        pqdownheap(s, tree, 1/*SMALLEST*/);\r\n        /***/\r\n\r\n        m = s.heap[1/*SMALLEST*/]; /* m = node of next least frequency */\r\n\r\n        s.heap[--s.heap_max] = n; /* keep the nodes sorted by frequency */\r\n        s.heap[--s.heap_max] = m;\r\n\r\n        /* Create a new node father of n and m */\r\n        tree[node * 2]/*.Freq*/ = tree[n * 2]/*.Freq*/ + tree[m * 2]/*.Freq*/;\r\n        s.depth[node] = (s.depth[n] >= s.depth[m] ? s.depth[n] : s.depth[m]) + 1;\r\n        tree[n*2 + 1]/*.Dad*/ = tree[m*2 + 1]/*.Dad*/ = node;\r\n\r\n        /* and insert the new node in the heap */\r\n        s.heap[1/*SMALLEST*/] = node++;\r\n        pqdownheap(s, tree, 1/*SMALLEST*/);\r\n\r\n      } while (s.heap_len >= 2);\r\n\r\n      s.heap[--s.heap_max] = s.heap[1/*SMALLEST*/];\r\n\r\n      /* At this point, the fields freq and dad are set. We can now\r\n   * generate the bit lengths.\r\n   */\r\n      gen_bitlen(s, desc);\r\n\r\n      /* The field len is now set, we can generate the bit codes */\r\n      gen_codes(tree, max_code, s.bl_count);\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Scan a literal or distance tree to determine the frequencies of the codes\r\n * in the bit length tree.\r\n */\r\n    function scan_tree(s, tree, max_code)\r\n//    deflate_state *s;\r\n//    ct_data *tree;   /* the tree to be scanned */\r\n//    int max_code;    /* and its largest code of non zero frequency */\r\n    {\r\n      var n;                     /* iterates over all tree elements */\r\n      var prevlen = -1;          /* last emitted length */\r\n      var curlen;                /* length of current code */\r\n\r\n      var nextlen = tree[0*2 + 1]/*.Len*/; /* length of next code */\r\n\r\n      var count = 0;             /* repeat count of the current code */\r\n      var max_count = 7;         /* max repeat count */\r\n      var min_count = 4;         /* min repeat count */\r\n\r\n      if (nextlen === 0) {\r\n        max_count = 138;\r\n        min_count = 3;\r\n      }\r\n      tree[(max_code+1)*2 + 1]/*.Len*/ = 0xffff; /* guard */\r\n\r\n      for (n = 0; n <= max_code; n++) {\r\n        curlen = nextlen;\r\n        nextlen = tree[(n+1)*2 + 1]/*.Len*/;\r\n\r\n        if (++count < max_count && curlen === nextlen) {\r\n          continue;\r\n\r\n        } else if (count < min_count) {\r\n          s.bl_tree[curlen * 2]/*.Freq*/ += count;\r\n\r\n        } else if (curlen !== 0) {\r\n\r\n          if (curlen !== prevlen) { s.bl_tree[curlen * 2]/*.Freq*/++; }\r\n          s.bl_tree[REP_3_6*2]/*.Freq*/++;\r\n\r\n        } else if (count <= 10) {\r\n          s.bl_tree[REPZ_3_10*2]/*.Freq*/++;\r\n\r\n        } else {\r\n          s.bl_tree[REPZ_11_138*2]/*.Freq*/++;\r\n        }\r\n\r\n        count = 0;\r\n        prevlen = curlen;\r\n\r\n        if (nextlen === 0) {\r\n          max_count = 138;\r\n          min_count = 3;\r\n\r\n        } else if (curlen === nextlen) {\r\n          max_count = 6;\r\n          min_count = 3;\r\n\r\n        } else {\r\n          max_count = 7;\r\n          min_count = 4;\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Send a literal or distance tree in compressed form, using the codes in\r\n * bl_tree.\r\n */\r\n    function send_tree(s, tree, max_code)\r\n//    deflate_state *s;\r\n//    ct_data *tree; /* the tree to be scanned */\r\n//    int max_code;       /* and its largest code of non zero frequency */\r\n    {\r\n      var n;                     /* iterates over all tree elements */\r\n      var prevlen = -1;          /* last emitted length */\r\n      var curlen;                /* length of current code */\r\n\r\n      var nextlen = tree[0*2 + 1]/*.Len*/; /* length of next code */\r\n\r\n      var count = 0;             /* repeat count of the current code */\r\n      var max_count = 7;         /* max repeat count */\r\n      var min_count = 4;         /* min repeat count */\r\n\r\n      /* tree[max_code+1].Len = -1; */  /* guard already set */\r\n      if (nextlen === 0) {\r\n        max_count = 138;\r\n        min_count = 3;\r\n      }\r\n\r\n      for (n = 0; n <= max_code; n++) {\r\n        curlen = nextlen;\r\n        nextlen = tree[(n+1)*2 + 1]/*.Len*/;\r\n\r\n        if (++count < max_count && curlen === nextlen) {\r\n          continue;\r\n\r\n        } else if (count < min_count) {\r\n          do { send_code(s, curlen, s.bl_tree); } while (--count !== 0);\r\n\r\n        } else if (curlen !== 0) {\r\n          if (curlen !== prevlen) {\r\n            send_code(s, curlen, s.bl_tree);\r\n            count--;\r\n          }\r\n          //Assert(count >= 3 && count <= 6, \" 3_6?\");\r\n          send_code(s, REP_3_6, s.bl_tree);\r\n          send_bits(s, count-3, 2);\r\n\r\n        } else if (count <= 10) {\r\n          send_code(s, REPZ_3_10, s.bl_tree);\r\n          send_bits(s, count-3, 3);\r\n\r\n        } else {\r\n          send_code(s, REPZ_11_138, s.bl_tree);\r\n          send_bits(s, count-11, 7);\r\n        }\r\n\r\n        count = 0;\r\n        prevlen = curlen;\r\n        if (nextlen === 0) {\r\n          max_count = 138;\r\n          min_count = 3;\r\n\r\n        } else if (curlen === nextlen) {\r\n          max_count = 6;\r\n          min_count = 3;\r\n\r\n        } else {\r\n          max_count = 7;\r\n          min_count = 4;\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Construct the Huffman tree for the bit lengths and return the index in\r\n * bl_order of the last bit length code to send.\r\n */\r\n    function build_bl_tree(s) {\r\n      var max_blindex;  /* index of last bit length code of non zero freq */\r\n\r\n      /* Determine the bit length frequencies for literal and distance trees */\r\n      scan_tree(s, s.dyn_ltree, s.l_desc.max_code);\r\n      scan_tree(s, s.dyn_dtree, s.d_desc.max_code);\r\n\r\n      /* Build the bit length tree: */\r\n      build_tree(s, s.bl_desc);\r\n      /* opt_len now includes the length of the tree representations, except\r\n   * the lengths of the bit lengths codes and the 5+5+4 bits for the counts.\r\n   */\r\n\r\n      /* Determine the number of bit length codes to send. The pkzip format\r\n   * requires that at least 4 bit length codes be sent. (appnote.txt says\r\n   * 3 but the actual value used is 4.)\r\n   */\r\n      for (max_blindex = BL_CODES-1; max_blindex >= 3; max_blindex--) {\r\n        if (s.bl_tree[bl_order[max_blindex]*2 + 1]/*.Len*/ !== 0) {\r\n          break;\r\n        }\r\n      }\r\n      /* Update opt_len to include the bit length tree and counts */\r\n      s.opt_len += 3*(max_blindex+1) + 5+5+4;\r\n      //Tracev((stderr, \"\\ndyn trees: dyn %ld, stat %ld\",\r\n      //        s->opt_len, s->static_len));\r\n\r\n      return max_blindex;\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Send the header for a block using dynamic Huffman trees: the counts, the\r\n * lengths of the bit length codes, the literal tree and the distance tree.\r\n * IN assertion: lcodes >= 257, dcodes >= 1, blcodes >= 4.\r\n */\r\n    function send_all_trees(s, lcodes, dcodes, blcodes)\r\n//    deflate_state *s;\r\n//    int lcodes, dcodes, blcodes; /* number of codes for each tree */\r\n    {\r\n      var rank;                    /* index in bl_order */\r\n\r\n      //Assert (lcodes >= 257 && dcodes >= 1 && blcodes >= 4, \"not enough codes\");\r\n      //Assert (lcodes <= L_CODES && dcodes <= D_CODES && blcodes <= BL_CODES,\r\n      //        \"too many codes\");\r\n      //Tracev((stderr, \"\\nbl counts: \"));\r\n      send_bits(s, lcodes-257, 5); /* not +255 as stated in appnote.txt */\r\n      send_bits(s, dcodes-1,   5);\r\n      send_bits(s, blcodes-4,  4); /* not -3 as stated in appnote.txt */\r\n      for (rank = 0; rank < blcodes; rank++) {\r\n        //Tracev((stderr, \"\\nbl code %2d \", bl_order[rank]));\r\n        send_bits(s, s.bl_tree[bl_order[rank]*2 + 1]/*.Len*/, 3);\r\n      }\r\n      //Tracev((stderr, \"\\nbl tree: sent %ld\", s->bits_sent));\r\n\r\n      send_tree(s, s.dyn_ltree, lcodes-1); /* literal tree */\r\n      //Tracev((stderr, \"\\nlit tree: sent %ld\", s->bits_sent));\r\n\r\n      send_tree(s, s.dyn_dtree, dcodes-1); /* distance tree */\r\n      //Tracev((stderr, \"\\ndist tree: sent %ld\", s->bits_sent));\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Check if the data type is TEXT or BINARY, using the following algorithm:\r\n * - TEXT if the two conditions below are satisfied:\r\n *    a) There are no non-portable control characters belonging to the\r\n *       \"black list\" (0..6, 14..25, 28..31).\r\n *    b) There is at least one printable character belonging to the\r\n *       \"white list\" (9 {TAB}, 10 {LF}, 13 {CR}, 32..255).\r\n * - BINARY otherwise.\r\n * - The following partially-portable control characters form a\r\n *   \"gray list\" that is ignored in this detection algorithm:\r\n *   (7 {BEL}, 8 {BS}, 11 {VT}, 12 {FF}, 26 {SUB}, 27 {ESC}).\r\n * IN assertion: the fields Freq of dyn_ltree are set.\r\n */\r\n    function detect_data_type(s) {\r\n      /* black_mask is the bit mask of black-listed bytes\r\n   * set bits 0..6, 14..25, and 28..31\r\n   * 0xf3ffc07f = binary 11110011111111111100000001111111\r\n   */\r\n      var black_mask = 0xf3ffc07f;\r\n      var n;\r\n\r\n      /* Check for non-textual (\"black-listed\") bytes. */\r\n      for (n = 0; n <= 31; n++, black_mask >>>= 1) {\r\n        if ((black_mask & 1) && (s.dyn_ltree[n*2]/*.Freq*/ !== 0)) {\r\n          return Z_BINARY;\r\n        }\r\n      }\r\n\r\n      /* Check for textual (\"white-listed\") bytes. */\r\n      if (s.dyn_ltree[9 * 2]/*.Freq*/ !== 0 || s.dyn_ltree[10 * 2]/*.Freq*/ !== 0 ||\r\n        s.dyn_ltree[13 * 2]/*.Freq*/ !== 0) {\r\n        return Z_TEXT;\r\n      }\r\n      for (n = 32; n < LITERALS; n++) {\r\n        if (s.dyn_ltree[n * 2]/*.Freq*/ !== 0) {\r\n          return Z_TEXT;\r\n        }\r\n      }\r\n\r\n      /* There are no \"black-listed\" or \"white-listed\" bytes:\r\n   * this stream either is empty or has tolerated (\"gray-listed\") bytes only.\r\n   */\r\n      return Z_BINARY;\r\n    }\r\n\r\n\r\n    var static_init_done = false;\r\n\r\n    /* ===========================================================================\r\n * Initialize the tree data structures for a new zlib stream.\r\n */\r\n    function _tr_init(s)\r\n    {\r\n\r\n      if (!static_init_done) {\r\n        tr_static_init();\r\n        static_init_done = true;\r\n      }\r\n\r\n      s.l_desc  = new TreeDesc(s.dyn_ltree, static_l_desc);\r\n      s.d_desc  = new TreeDesc(s.dyn_dtree, static_d_desc);\r\n      s.bl_desc = new TreeDesc(s.bl_tree, static_bl_desc);\r\n\r\n      s.bi_buf = 0;\r\n      s.bi_valid = 0;\r\n\r\n      /* Initialize the first block of the first file: */\r\n      init_block(s);\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Send a stored block\r\n */\r\n    function _tr_stored_block(s, buf, stored_len, last)\r\n//DeflateState *s;\r\n//charf *buf;       /* input block */\r\n//ulg stored_len;   /* length of input block */\r\n//int last;         /* one if this is the last block for a file */\r\n    {\r\n      send_bits(s, (STORED_BLOCK<<1)+(last ? 1 : 0), 3);    /* send block type */\r\n      copy_block(s, buf, stored_len, true); /* with header */\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Send one empty static block to give enough lookahead for inflate.\r\n * This takes 10 bits, of which 7 may remain in the bit buffer.\r\n */\r\n    function _tr_align(s) {\r\n      send_bits(s, STATIC_TREES<<1, 3);\r\n      send_code(s, END_BLOCK, static_ltree);\r\n      bi_flush(s);\r\n    }\r\n\r\n\r\n    /* ===========================================================================\r\n * Determine the best encoding for the current block: dynamic trees, static\r\n * trees or store, and output the encoded block to the zip file.\r\n */\r\n    function _tr_flush_block(s, buf, stored_len, last)\r\n//DeflateState *s;\r\n//charf *buf;       /* input block, or NULL if too old */\r\n//ulg stored_len;   /* length of input block */\r\n//int last;         /* one if this is the last block for a file */\r\n    {\r\n      var opt_lenb, static_lenb;  /* opt_len and static_len in bytes */\r\n      var max_blindex = 0;        /* index of last bit length code of non zero freq */\r\n\r\n      /* Build the Huffman trees unless a stored block is forced */\r\n      if (s.level > 0) {\r\n\r\n        /* Check if the file is binary or text */\r\n        if (s.strm.data_type === Z_UNKNOWN) {\r\n          s.strm.data_type = detect_data_type(s);\r\n        }\r\n\r\n        /* Construct the literal and distance trees */\r\n        build_tree(s, s.l_desc);\r\n        // Tracev((stderr, \"\\nlit data: dyn %ld, stat %ld\", s->opt_len,\r\n        //        s->static_len));\r\n\r\n        build_tree(s, s.d_desc);\r\n        // Tracev((stderr, \"\\ndist data: dyn %ld, stat %ld\", s->opt_len,\r\n        //        s->static_len));\r\n        /* At this point, opt_len and static_len are the total bit lengths of\r\n     * the compressed block data, excluding the tree representations.\r\n     */\r\n\r\n        /* Build the bit length tree for the above two trees, and get the index\r\n     * in bl_order of the last bit length code to send.\r\n     */\r\n        max_blindex = build_bl_tree(s);\r\n\r\n        /* Determine the best encoding. Compute the block lengths in bytes. */\r\n        opt_lenb = (s.opt_len+3+7) >>> 3;\r\n        static_lenb = (s.static_len+3+7) >>> 3;\r\n\r\n        // Tracev((stderr, \"\\nopt %lu(%lu) stat %lu(%lu) stored %lu lit %u \",\r\n        //        opt_lenb, s->opt_len, static_lenb, s->static_len, stored_len,\r\n        //        s->last_lit));\r\n\r\n        if (static_lenb <= opt_lenb) { opt_lenb = static_lenb; }\r\n\r\n      } else {\r\n        // Assert(buf != (char*)0, \"lost buf\");\r\n        opt_lenb = static_lenb = stored_len + 5; /* force a stored block */\r\n      }\r\n\r\n      if ((stored_len+4 <= opt_lenb) && (buf !== -1)) {\r\n        /* 4: two words for the lengths */\r\n\r\n        /* The test buf != NULL is only necessary if LIT_BUFSIZE > WSIZE.\r\n     * Otherwise we can't have processed more than WSIZE input bytes since\r\n     * the last block flush, because compression would have been\r\n     * successful. If LIT_BUFSIZE <= WSIZE, it is never too late to\r\n     * transform a block into a stored block.\r\n     */\r\n        _tr_stored_block(s, buf, stored_len, last);\r\n\r\n      } else if (s.strategy === Z_FIXED || static_lenb === opt_lenb) {\r\n\r\n        send_bits(s, (STATIC_TREES<<1) + (last ? 1 : 0), 3);\r\n        compress_block(s, static_ltree, static_dtree);\r\n\r\n      } else {\r\n        send_bits(s, (DYN_TREES<<1) + (last ? 1 : 0), 3);\r\n        send_all_trees(s, s.l_desc.max_code+1, s.d_desc.max_code+1, max_blindex+1);\r\n        compress_block(s, s.dyn_ltree, s.dyn_dtree);\r\n      }\r\n      // Assert (s->compressed_len == s->bits_sent, \"bad compressed size\");\r\n      /* The above check is made mod 2^32, for files larger than 512 MB\r\n   * and uLong implemented on 32 bits.\r\n   */\r\n      init_block(s);\r\n\r\n      if (last) {\r\n        bi_windup(s);\r\n      }\r\n      // Tracev((stderr,\"\\ncomprlen %lu(%lu) \", s->compressed_len>>3,\r\n      //       s->compressed_len-7*last));\r\n    }\r\n\r\n    /* ===========================================================================\r\n * Save the match info and tally the frequency counts. Return true if\r\n * the current block must be flushed.\r\n */\r\n    function _tr_tally(s, dist, lc)\r\n//    deflate_state *s;\r\n//    unsigned dist;  /* distance of matched string */\r\n//    unsigned lc;    /* match length-MIN_MATCH or unmatched char (if dist==0) */\r\n    {\r\n      //var out_length, in_length, dcode;\r\n\r\n      s.pending_buf[s.d_buf + s.last_lit * 2]     = (dist >>> 8) & 0xff;\r\n      s.pending_buf[s.d_buf + s.last_lit * 2 + 1] = dist & 0xff;\r\n\r\n      s.pending_buf[s.l_buf + s.last_lit] = lc & 0xff;\r\n      s.last_lit++;\r\n\r\n      if (dist === 0) {\r\n        /* lc is the unmatched char */\r\n        s.dyn_ltree[lc*2]/*.Freq*/++;\r\n      } else {\r\n        s.matches++;\r\n        /* Here, lc is the match length - MIN_MATCH */\r\n        dist--;             /* dist = match distance - 1 */\r\n        //Assert((ush)dist < (ush)MAX_DIST(s) &&\r\n        //       (ush)lc <= (ush)(MAX_MATCH-MIN_MATCH) &&\r\n        //       (ush)d_code(dist) < (ush)D_CODES,  \"_tr_tally: bad match\");\r\n\r\n        s.dyn_ltree[(_length_code[lc]+LITERALS+1) * 2]/*.Freq*/++;\r\n        s.dyn_dtree[d_code(dist) * 2]/*.Freq*/++;\r\n      }\r\n\r\n// (!) This block is disabled in zlib defailts,\r\n// don't enable it for binary compatibility\r\n\r\n//#ifdef TRUNCATE_BLOCK\r\n//  /* Try to guess if it is profitable to stop the current block here */\r\n//  if ((s.last_lit & 0x1fff) === 0 && s.level > 2) {\r\n//    /* Compute an upper bound for the compressed length */\r\n//    out_length = s.last_lit*8;\r\n//    in_length = s.strstart - s.block_start;\r\n//\r\n//    for (dcode = 0; dcode < D_CODES; dcode++) {\r\n//      out_length += s.dyn_dtree[dcode*2]/*.Freq*/ * (5 + extra_dbits[dcode]);\r\n//    }\r\n//    out_length >>>= 3;\r\n//    //Tracev((stderr,\"\\nlast_lit %u, in %ld, out ~%ld(%ld%%) \",\r\n//    //       s->last_lit, in_length, out_length,\r\n//    //       100L - out_length*100L/in_length));\r\n//    if (s.matches < (s.last_lit>>1)/*int /2*/ && out_length < (in_length>>1)/*int /2*/) {\r\n//      return true;\r\n//    }\r\n//  }\r\n//#endif\r\n\r\n      return (s.last_lit === s.lit_bufsize-1);\r\n      /* We avoid equality with lit_bufsize because of wraparound at 64K\r\n   * on 16 bit machines and because stored blocks are restricted to\r\n   * 64K-1 bytes.\r\n   */\r\n    }\r\n\r\n    exports._tr_init  = _tr_init;\r\n    exports._tr_stored_block = _tr_stored_block;\r\n    exports._tr_flush_block  = _tr_flush_block;\r\n    exports._tr_tally = _tr_tally;\r\n    exports._tr_align = _tr_align;\r\n  },{\"../utils/common\":27}],39:[function(_dereq_,module,exports){\r\n    'use strict';\r\n\r\n\r\n    function ZStream() {\r\n      /* next input byte */\r\n      this.input = null; // JS specific, because we have no pointers\r\n      this.next_in = 0;\r\n      /* number of bytes available at input */\r\n      this.avail_in = 0;\r\n      /* total number of input bytes read so far */\r\n      this.total_in = 0;\r\n      /* next output byte should be put there */\r\n      this.output = null; // JS specific, because we have no pointers\r\n      this.next_out = 0;\r\n      /* remaining free space at output */\r\n      this.avail_out = 0;\r\n      /* total number of bytes output so far */\r\n      this.total_out = 0;\r\n      /* last error message, NULL if no error */\r\n      this.msg = ''/*Z_NULL*/;\r\n      /* not visible by applications */\r\n      this.state = null;\r\n      /* best guess about the data type: binary or text */\r\n      this.data_type = 2/*Z_UNKNOWN*/;\r\n      /* adler32 value of the uncompressed data */\r\n      this.adler = 0;\r\n    }\r\n\r\n    module.exports = ZStream;\r\n  },{}]},{},[9])\r\n(9)\r\n}));","/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */\r\n/* vim: set ts=2: */\r\n/*exported XLSX */\r\n/*global global, exports, module, require:false, process:false, Buffer:false, ArrayBuffer:false */\r\n// jeffrey: jszip import\r\nimport JSZipSync from './jszip.js';\r\n\r\nvar XLSX = {};\r\nfunction make_xlsx_lib(XLSX){\r\n  XLSX.version = '0.14.3';\r\n  var current_codepage = 1200, current_ansi = 1252;\r\n  /*global cptable:true, window */\r\n  if(typeof module !== \"undefined\" && typeof require !== 'undefined') {\r\n    if(typeof cptable === 'undefined') {\r\n      if(typeof global !== 'undefined') global.cptable = undefined;\r\n      else if(typeof window !== 'undefined') window.cptable = undefined;\r\n    }\r\n  }\r\n\r\n  var VALID_ANSI = [ 874, 932, 936, 949, 950 ];\r\n  for(var i = 0; i <= 8; ++i) VALID_ANSI.push(1250 + i);\r\n  /* ECMA-376 Part I 18.4.1 charset to codepage mapping */\r\n  var CS2CP = ({\r\n    0:    1252, /* ANSI */\r\n    1:   65001, /* DEFAULT */\r\n    2:   65001, /* SYMBOL */\r\n    77:  10000, /* MAC */\r\n    128:   932, /* SHIFTJIS */\r\n    129:   949, /* HANGUL */\r\n    130:  1361, /* JOHAB */\r\n    134:   936, /* GB2312 */\r\n    136:   950, /* CHINESEBIG5 */\r\n    161:  1253, /* GREEK */\r\n    162:  1254, /* TURKISH */\r\n    163:  1258, /* VIETNAMESE */\r\n    177:  1255, /* HEBREW */\r\n    178:  1256, /* ARABIC */\r\n    186:  1257, /* BALTIC */\r\n    204:  1251, /* RUSSIAN */\r\n    222:   874, /* THAI */\r\n    238:  1250, /* EASTEUROPE */\r\n    255:  1252, /* OEM */\r\n    69:   6969  /* MISC */\r\n  });\r\n\r\n  var set_ansi = function(cp) { if(VALID_ANSI.indexOf(cp) == -1) return; current_ansi = CS2CP[0] = cp; };\r\n  function reset_ansi() { set_ansi(1252); }\r\n\r\n  var set_cp = function(cp) { current_codepage = cp; set_ansi(cp); };\r\n  function reset_cp() { set_cp(1200); reset_ansi(); }\r\n\r\n  function char_codes(data) { var o = []; for(var i = 0, len = data.length; i < len; ++i) o[i] = data.charCodeAt(i); return o; }\r\n\r\n  function utf16leread(data) {\r\n    var o = [];\r\n    for(var i = 0; i < (data.length>>1); ++i) o[i] = String.fromCharCode(data.charCodeAt(2*i) + (data.charCodeAt(2*i+1)<<8));\r\n    return o.join(\"\");\r\n  }\r\n  function utf16beread(data) {\r\n    var o = [];\r\n    for(var i = 0; i < (data.length>>1); ++i) o[i] = String.fromCharCode(data.charCodeAt(2*i+1) + (data.charCodeAt(2*i)<<8));\r\n    return o.join(\"\");\r\n  }\r\n\r\n  var debom = function(data) {\r\n    var c1 = data.charCodeAt(0), c2 = data.charCodeAt(1);\r\n    if(c1 == 0xFF && c2 == 0xFE) return utf16leread(data.slice(2));\r\n    if(c1 == 0xFE && c2 == 0xFF) return utf16beread(data.slice(2));\r\n    if(c1 == 0xFEFF) return data.slice(1);\r\n    return data;\r\n  };\r\n\r\n  var _getchar = function _gc1(x) { return String.fromCharCode(x); };\r\n  if(typeof cptable !== 'undefined') {\r\n    set_cp = function(cp) { current_codepage = cp; };\r\n    debom = function(data) {\r\n      if(data.charCodeAt(0) === 0xFF && data.charCodeAt(1) === 0xFE) { return cptable.utils.decode(1200, char_codes(data.slice(2))); }\r\n      return data;\r\n    };\r\n    _getchar = function _gc2(x) {\r\n      if(current_codepage === 1200) return String.fromCharCode(x);\r\n      return cptable.utils.decode(current_codepage, [x&255,x>>8])[0];\r\n    };\r\n  }\r\n  var DENSE = null;\r\n  var DIF_XL = true;\r\n  var Base64 = (function make_b64(){\r\n    var map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\r\n    return {\r\n      encode: function(input) {\r\n        var o = \"\";\r\n        var c1=0, c2=0, c3=0, e1=0, e2=0, e3=0, e4=0;\r\n        for(var i = 0; i < input.length; ) {\r\n          c1 = input.charCodeAt(i++);\r\n          e1 = (c1 >> 2);\r\n\r\n          c2 = input.charCodeAt(i++);\r\n          e2 = ((c1 & 3) << 4) | (c2 >> 4);\r\n\r\n          c3 = input.charCodeAt(i++);\r\n          e3 = ((c2 & 15) << 2) | (c3 >> 6);\r\n          e4 = (c3 & 63);\r\n          if (isNaN(c2)) { e3 = e4 = 64; }\r\n          else if (isNaN(c3)) { e4 = 64; }\r\n          o += map.charAt(e1) + map.charAt(e2) + map.charAt(e3) + map.charAt(e4);\r\n        }\r\n        return o;\r\n      },\r\n      decode: function b64_decode(input) {\r\n        var o = \"\";\r\n        var c1=0, c2=0, c3=0, e1=0, e2=0, e3=0, e4=0;\r\n        input = input.replace(/[^\\w\\+\\/\\=]/g, \"\");\r\n        for(var i = 0; i < input.length;) {\r\n          e1 = map.indexOf(input.charAt(i++));\r\n          e2 = map.indexOf(input.charAt(i++));\r\n          c1 = (e1 << 2) | (e2 >> 4);\r\n          o += String.fromCharCode(c1);\r\n\r\n          e3 = map.indexOf(input.charAt(i++));\r\n          c2 = ((e2 & 15) << 4) | (e3 >> 2);\r\n          if (e3 !== 64) { o += String.fromCharCode(c2); }\r\n\r\n          e4 = map.indexOf(input.charAt(i++));\r\n          c3 = ((e3 & 3) << 6) | e4;\r\n          if (e4 !== 64) { o += String.fromCharCode(c3); }\r\n        }\r\n        return o;\r\n      }\r\n    };\r\n  })();\r\n  var has_buf = (typeof Buffer !== 'undefined' && typeof process !== 'undefined' && typeof process.versions !== 'undefined' && !!process.versions.node);\r\n\r\n  var Buffer_from = function(){};\r\n\r\n  if(typeof Buffer !== 'undefined') {\r\n    var nbfs = !Buffer.from;\r\n    if(!nbfs) try { Buffer.from(\"foo\", \"utf8\"); } catch(e) { nbfs = true; }\r\n    Buffer_from = nbfs ? function(buf, enc) { return (enc) ? new Buffer(buf, enc) : new Buffer(buf); } : Buffer.from.bind(Buffer);\r\n    // $FlowIgnore\r\n    if(!Buffer.alloc) Buffer.alloc = function(n) { return new Buffer(n); };\r\n    // $FlowIgnore\r\n    if(!Buffer.allocUnsafe) Buffer.allocUnsafe = function(n) { return new Buffer(n); };\r\n  }\r\n\r\n  function new_raw_buf(len) {\r\n    /* jshint -W056 */\r\n    return has_buf ? Buffer.alloc(len) : new Array(len);\r\n    /* jshint +W056 */\r\n  }\r\n\r\n  function new_unsafe_buf(len) {\r\n    /* jshint -W056 */\r\n    return has_buf ? Buffer.allocUnsafe(len) : new Array(len);\r\n    /* jshint +W056 */\r\n  }\r\n\r\n  var s2a = function s2a(s) {\r\n    // $FlowIgnore\r\n    if(has_buf) return Buffer_from(s, \"binary\");\r\n    return s.split(\"\").map(function(x){ return x.charCodeAt(0) & 0xff; });\r\n  };\r\n\r\n  function s2ab(s) {\r\n    if(typeof ArrayBuffer === 'undefined') return s2a(s);\r\n    var buf = new ArrayBuffer(s.length), view = new Uint8Array(buf);\r\n    for (var i=0; i!=s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\r\n    return buf;\r\n  }\r\n\r\n  function a2s(data) {\r\n    if(Array.isArray(data)) return data.map(_chr).join(\"\");\r\n    var o = []; for(var i = 0; i < data.length; ++i) o[i] = _chr(data[i]); return o.join(\"\");\r\n  }\r\n\r\n  function a2u(data) {\r\n    if(typeof Uint8Array === 'undefined') throw new Error(\"Unsupported\");\r\n    return new Uint8Array(data);\r\n  }\r\n\r\n  function ab2a(data) {\r\n    if(typeof ArrayBuffer == 'undefined') throw new Error(\"Unsupported\");\r\n    if(data instanceof ArrayBuffer) return ab2a(new Uint8Array(data));\r\n    var o = new Array(data.length);\r\n    for(var i = 0; i < data.length; ++i) o[i] = data[i];\r\n    return o;\r\n  }\r\n\r\n  var bconcat = function(bufs) { return [].concat.apply([], bufs); };\r\n\r\n  var chr0 = /\\u0000/g, chr1 = /[\\u0001-\\u0006]/g;\r\n  /* ssf.js (C) 2013-present SheetJS -- http://sheetjs.com */\r\n  /*jshint -W041 */\r\n  var SSF = ({});\r\n  var make_ssf = function make_ssf(SSF){\r\n    SSF.version = '0.10.2';\r\n    function _strrev(x) { var o = \"\", i = x.length-1; while(i>=0) o += x.charAt(i--); return o; }\r\n    function fill(c,l) { var o = \"\"; while(o.length < l) o+=c; return o; }\r\n    function pad0(v,d){var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\r\n    function pad_(v,d){var t=\"\"+v;return t.length>=d?t:fill(' ',d-t.length)+t;}\r\n    function rpad_(v,d){var t=\"\"+v; return t.length>=d?t:t+fill(' ',d-t.length);}\r\n    function pad0r1(v,d){var t=\"\"+Math.round(v); return t.length>=d?t:fill('0',d-t.length)+t;}\r\n    function pad0r2(v,d){var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\r\n    var p2_32 = Math.pow(2,32);\r\n    function pad0r(v,d){if(v>p2_32||v<-p2_32) return pad0r1(v,d); var i = Math.round(v); return pad0r2(i,d); }\r\n    function isgeneral(s, i) { i = i || 0; return s.length >= 7 + i && (s.charCodeAt(i)|32) === 103 && (s.charCodeAt(i+1)|32) === 101 && (s.charCodeAt(i+2)|32) === 110 && (s.charCodeAt(i+3)|32) === 101 && (s.charCodeAt(i+4)|32) === 114 && (s.charCodeAt(i+5)|32) === 97 && (s.charCodeAt(i+6)|32) === 108; }\r\n    var days = [\r\n      ['Sun', 'Sunday'],\r\n      ['Mon', 'Monday'],\r\n      ['Tue', 'Tuesday'],\r\n      ['Wed', 'Wednesday'],\r\n      ['Thu', 'Thursday'],\r\n      ['Fri', 'Friday'],\r\n      ['Sat', 'Saturday']\r\n    ];\r\n    var months = [\r\n      ['J', 'Jan', 'January'],\r\n      ['F', 'Feb', 'February'],\r\n      ['M', 'Mar', 'March'],\r\n      ['A', 'Apr', 'April'],\r\n      ['M', 'May', 'May'],\r\n      ['J', 'Jun', 'June'],\r\n      ['J', 'Jul', 'July'],\r\n      ['A', 'Aug', 'August'],\r\n      ['S', 'Sep', 'September'],\r\n      ['O', 'Oct', 'October'],\r\n      ['N', 'Nov', 'November'],\r\n      ['D', 'Dec', 'December']\r\n    ];\r\n    function init_table(t) {\r\n      t[0]=  'General';\r\n      t[1]=  '0';\r\n      t[2]=  '0.00';\r\n      t[3]=  '#,##0';\r\n      t[4]=  '#,##0.00';\r\n      t[9]=  '0%';\r\n      t[10]= '0.00%';\r\n      t[11]= '0.00E+00';\r\n      t[12]= '# ?/?';\r\n      t[13]= '# ??/??';\r\n      t[14]= 'm/d/yy';\r\n      t[15]= 'd-mmm-yy';\r\n      t[16]= 'd-mmm';\r\n      t[17]= 'mmm-yy';\r\n      t[18]= 'h:mm AM/PM';\r\n      t[19]= 'h:mm:ss AM/PM';\r\n      t[20]= 'h:mm';\r\n      t[21]= 'h:mm:ss';\r\n      t[22]= 'm/d/yy h:mm';\r\n      t[37]= '#,##0 ;(#,##0)';\r\n      t[38]= '#,##0 ;[Red](#,##0)';\r\n      t[39]= '#,##0.00;(#,##0.00)';\r\n      t[40]= '#,##0.00;[Red](#,##0.00)';\r\n      t[45]= 'mm:ss';\r\n      t[46]= '[h]:mm:ss';\r\n      t[47]= 'mmss.0';\r\n      t[48]= '##0.0E+0';\r\n      t[49]= '@';\r\n      t[56]= '\"/ \"hh\"\"mm\"\"ss\" \"';\r\n      t[65535]= 'General';\r\n    }\r\n\r\n    var table_fmt = {};\r\n    init_table(table_fmt);\r\n    function frac(x, D, mixed) {\r\n      var sgn = x < 0 ? -1 : 1;\r\n      var B = x * sgn;\r\n      var P_2 = 0, P_1 = 1, P = 0;\r\n      var Q_2 = 1, Q_1 = 0, Q = 0;\r\n      var A = Math.floor(B);\r\n      while(Q_1 < D) {\r\n        A = Math.floor(B);\r\n        P = A * P_1 + P_2;\r\n        Q = A * Q_1 + Q_2;\r\n        if((B - A) < 0.00000005) break;\r\n        B = 1 / (B - A);\r\n        P_2 = P_1; P_1 = P;\r\n        Q_2 = Q_1; Q_1 = Q;\r\n      }\r\n      if(Q > D) { if(Q_1 > D) { Q = Q_2; P = P_2; } else { Q = Q_1; P = P_1; } }\r\n      if(!mixed) return [0, sgn * P, Q];\r\n      var q = Math.floor(sgn * P/Q);\r\n      return [q, sgn*P - q*Q, Q];\r\n    }\r\n    function parse_date_code(v,opts,b2) {\r\n      if(v > 2958465 || v < 0) return null;\r\n      var date = (v|0), time = Math.floor(86400 * (v - date)), dow=0;\r\n      var dout=[];\r\n      var out={D:date, T:time, u:86400*(v-date)-time,y:0,m:0,d:0,H:0,M:0,S:0,q:0};\r\n      if(Math.abs(out.u) < 1e-6) out.u = 0;\r\n      if(opts && opts.date1904) date += 1462;\r\n      if(out.u > 0.9999) {\r\n        out.u = 0;\r\n        if(++time == 86400) { out.T = time = 0; ++date; ++out.D; }\r\n      }\r\n      if(date === 60) {dout = b2 ? [1317,10,29] : [1900,2,29]; dow=3;}\r\n      else if(date === 0) {dout = b2 ? [1317,8,29] : [1900,1,0]; dow=6;}\r\n      else {\r\n        if(date > 60) --date;\r\n        /* 1 = Jan 1 1900 in Gregorian */\r\n        var d = new Date(1900, 0, 1);\r\n        d.setDate(d.getDate() + date - 1);\r\n        dout = [d.getFullYear(), d.getMonth()+1,d.getDate()];\r\n        dow = d.getDay();\r\n        if(date < 60) dow = (dow + 6) % 7;\r\n        if(b2) dow = fix_hijri(d, dout);\r\n      }\r\n      out.y = dout[0]; out.m = dout[1]; out.d = dout[2];\r\n      out.S = time % 60; time = Math.floor(time / 60);\r\n      out.M = time % 60; time = Math.floor(time / 60);\r\n      out.H = time;\r\n      out.q = dow;\r\n      return out;\r\n    }\r\n    SSF.parse_date_code = parse_date_code;\r\n    var basedate = new Date(1899, 11, 31, 0, 0, 0);\r\n    var dnthresh = basedate.getTime();\r\n    var base1904 = new Date(1900, 2, 1, 0, 0, 0);\r\n    function datenum_local(v, date1904) {\r\n      var epoch = v.getTime();\r\n      if(date1904) epoch -= 1461*24*60*60*1000;\r\n      else if(v >= base1904) epoch += 24*60*60*1000;\r\n      return (epoch - (dnthresh + (v.getTimezoneOffset() - basedate.getTimezoneOffset()) * 60000)) / (24 * 60 * 60 * 1000);\r\n    }\r\n    function general_fmt_int(v) { return v.toString(10); }\r\n    SSF._general_int = general_fmt_int;\r\n    var general_fmt_num = (function make_general_fmt_num() {\r\n      var gnr1 = /\\.(\\d*[1-9])0+$/, gnr2 = /\\.0*$/, gnr4 = /\\.(\\d*[1-9])0+/, gnr5 = /\\.0*[Ee]/, gnr6 = /(E[+-])(\\d)$/;\r\n      function gfn2(v) {\r\n        var w = (v<0?12:11);\r\n        var o = gfn5(v.toFixed(12)); if(o.length <= w) return o;\r\n        o = v.toPrecision(10); if(o.length <= w) return o;\r\n        return v.toExponential(5);\r\n      }\r\n      function gfn3(v) {\r\n        var o = v.toFixed(11).replace(gnr1,\".$1\");\r\n        if(o.length > (v<0?12:11)) o = v.toPrecision(6);\r\n        return o;\r\n      }\r\n      function gfn4(o) {\r\n        for(var i = 0; i != o.length; ++i) if((o.charCodeAt(i) | 0x20) === 101) return o.replace(gnr4,\".$1\").replace(gnr5,\"E\").replace(\"e\",\"E\").replace(gnr6,\"$10$2\");\r\n        return o;\r\n      }\r\n      function gfn5(o) {\r\n        return o.indexOf(\".\") > -1 ? o.replace(gnr2,\"\").replace(gnr1,\".$1\") : o;\r\n      }\r\n      return function general_fmt_num(v) {\r\n        var V = Math.floor(Math.log(Math.abs(v))*Math.LOG10E), o;\r\n        if(V >= -4 && V <= -1) o = v.toPrecision(10+V);\r\n        else if(Math.abs(V) <= 9) o = gfn2(v);\r\n        else if(V === 10) o = v.toFixed(10).substr(0,12);\r\n        else o = gfn3(v);\r\n        return gfn5(gfn4(o));\r\n      };})();\r\n    SSF._general_num = general_fmt_num;\r\n    function general_fmt(v, opts) {\r\n      switch(typeof v) {\r\n        case 'string': return v;\r\n        case 'boolean': return v ? \"TRUE\" : \"FALSE\";\r\n        case 'number': return (v|0) === v ? general_fmt_int(v) : general_fmt_num(v);\r\n        case 'undefined': return \"\";\r\n        case 'object':\r\n          if(v == null) return \"\";\r\n          if(v instanceof Date) return format(14, datenum_local(v, opts && opts.date1904), opts);\r\n      }\r\n      throw new Error(\"unsupported value in General format: \" + v);\r\n    }\r\n    SSF._general = general_fmt;\r\n    function fix_hijri() { return 0; }\r\n    /*jshint -W086 */\r\n    function write_date(type, fmt, val, ss0) {\r\n      var o=\"\", ss=0, tt=0, y = val.y, out, outl = 0;\r\n      switch(type) {\r\n        case 98: /* 'b' buddhist year */\r\n          y = val.y + 543;\r\n        /* falls through */\r\n        case 121: /* 'y' year */\r\n          switch(fmt.length) {\r\n            case 1: case 2: out = y % 100; outl = 2; break;\r\n            default: out = y % 10000; outl = 4; break;\r\n          } break;\r\n        case 109: /* 'm' month */\r\n          switch(fmt.length) {\r\n            case 1: case 2: out = val.m; outl = fmt.length; break;\r\n            case 3: return months[val.m-1][1];\r\n            case 5: return months[val.m-1][0];\r\n            default: return months[val.m-1][2];\r\n          } break;\r\n        case 100: /* 'd' day */\r\n          switch(fmt.length) {\r\n            case 1: case 2: out = val.d; outl = fmt.length; break;\r\n            case 3: return days[val.q][0];\r\n            default: return days[val.q][1];\r\n          } break;\r\n        case 104: /* 'h' 12-hour */\r\n          switch(fmt.length) {\r\n            case 1: case 2: out = 1+(val.H+11)%12; outl = fmt.length; break;\r\n            default: throw 'bad hour format: ' + fmt;\r\n          } break;\r\n        case 72: /* 'H' 24-hour */\r\n          switch(fmt.length) {\r\n            case 1: case 2: out = val.H; outl = fmt.length; break;\r\n            default: throw 'bad hour format: ' + fmt;\r\n          } break;\r\n        case 77: /* 'M' minutes */\r\n          switch(fmt.length) {\r\n            case 1: case 2: out = val.M; outl = fmt.length; break;\r\n            default: throw 'bad minute format: ' + fmt;\r\n          } break;\r\n        case 115: /* 's' seconds */\r\n          if(fmt != 's' && fmt != 'ss' && fmt != '.0' && fmt != '.00' && fmt != '.000') throw 'bad second format: ' + fmt;\r\n          if(val.u === 0 && (fmt == \"s\" || fmt == \"ss\")) return pad0(val.S, fmt.length);\r\n          if(ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;\r\n          else tt = ss0 === 1 ? 10 : 1;\r\n          ss = Math.round((tt)*(val.S + val.u));\r\n          if(ss >= 60*tt) ss = 0;\r\n          if(fmt === 's') return ss === 0 ? \"0\" : \"\"+ss/tt;\r\n          o = pad0(ss,2 + ss0);\r\n          if(fmt === 'ss') return o.substr(0,2);\r\n          return \".\" + o.substr(2,fmt.length-1);\r\n        case 90: /* 'Z' absolute time */\r\n          switch(fmt) {\r\n            case '[h]': case '[hh]': out = val.D*24+val.H; break;\r\n            case '[m]': case '[mm]': out = (val.D*24+val.H)*60+val.M; break;\r\n            case '[s]': case '[ss]': out = ((val.D*24+val.H)*60+val.M)*60+Math.round(val.S+val.u); break;\r\n            default: throw 'bad abstime format: ' + fmt;\r\n          } outl = fmt.length === 3 ? 1 : 2; break;\r\n        case 101: /* 'e' era */\r\n          out = y; outl = 1;\r\n      }\r\n      if(outl > 0) return pad0(out, outl); else return \"\";\r\n    }\r\n    /*jshint +W086 */\r\n    function commaify(s) {\r\n      var w = 3;\r\n      if(s.length <= w) return s;\r\n      var j = (s.length % w), o = s.substr(0,j);\r\n      for(; j!=s.length; j+=w) o+=(o.length > 0 ? \",\" : \"\") + s.substr(j,w);\r\n      return o;\r\n    }\r\n    var write_num = (function make_write_num(){\r\n      var pct1 = /%/g;\r\n      function write_num_pct(type, fmt, val){\r\n        var sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\r\n        return write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\r\n      }\r\n      function write_num_cm(type, fmt, val){\r\n        var idx = fmt.length - 1;\r\n        while(fmt.charCodeAt(idx-1) === 44) --idx;\r\n        return write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\r\n      }\r\n      function write_num_exp(fmt, val){\r\n        var o;\r\n        var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\r\n        if(fmt.match(/^#+0.0E\\+0$/)) {\r\n          if(val == 0) return \"0.0E+0\";\r\n          else if(val < 0) return \"-\" + write_num_exp(fmt, -val);\r\n          var period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\r\n          var ee = Math.floor(Math.log(val)*Math.LOG10E)%period;\r\n          if(ee < 0) ee += period;\r\n          o = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\r\n          if(o.indexOf(\"e\") === -1) {\r\n            var fakee = Math.floor(Math.log(val)*Math.LOG10E);\r\n            if(o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\r\n            else o += \"E+\" + (fakee - ee);\r\n            while(o.substr(0,2) === \"0.\") {\r\n              o = o.charAt(0) + o.substr(2,period) + \".\" + o.substr(2+period);\r\n              o = o.replace(/^0+([1-9])/,\"$1\").replace(/^0+\\./,\"0.\");\r\n            }\r\n            o = o.replace(/\\+-/,\"-\");\r\n          }\r\n          o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\r\n        } else o = val.toExponential(idx);\r\n        if(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o.charAt(o.length-1);\r\n        if(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\r\n        return o.replace(\"e\",\"E\");\r\n      }\r\n      var frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\r\n      function write_num_f1(r, aval, sign) {\r\n        var den = parseInt(r[4],10), rr = Math.round(aval * den), base = Math.floor(rr/den);\r\n        var myn = (rr - base*den), myd = den;\r\n        return sign + (base === 0 ? \"\" : \"\"+base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn,r[1].length) + r[2] + \"/\" + r[3] + pad0(myd,r[4].length));\r\n      }\r\n      function write_num_f2(r, aval, sign) {\r\n        return sign + (aval === 0 ? \"\" : \"\"+aval) + fill(\" \", r[1].length + 2 + r[4].length);\r\n      }\r\n      var dec1 = /^#*0*\\.([0#]+)/;\r\n      var closeparen = /\\).*[0#]/;\r\n      var phone = /\\(###\\) ###\\\\?-####/;\r\n      function hashq(str) {\r\n        var o = \"\", cc;\r\n        for(var i = 0; i != str.length; ++i) switch((cc=str.charCodeAt(i))) {\r\n          case 35: break;\r\n          case 63: o+= \" \"; break;\r\n          case 48: o+= \"0\"; break;\r\n          default: o+= String.fromCharCode(cc);\r\n        }\r\n        return o;\r\n      }\r\n      function rnd(val, d) { var dd = Math.pow(10,d); return \"\"+(Math.round(val * dd)/dd); }\r\n      function dec(val, d) {\r\n        if (d < ('' + Math.round((val-Math.floor(val))*Math.pow(10,d))).length) {\r\n          return 0;\r\n        }\r\n        return Math.round((val-Math.floor(val))*Math.pow(10,d));\r\n      }\r\n      function carry(val, d) {\r\n        if (d < ('' + Math.round((val-Math.floor(val))*Math.pow(10,d))).length) {\r\n          return 1;\r\n        }\r\n        return 0;\r\n      }\r\n      function flr(val) { if(val < 2147483647 && val > -2147483648) return \"\"+(val >= 0 ? (val|0) : (val-1|0)); return \"\"+Math.floor(val); }\r\n      function write_num_flt(type, fmt, val) {\r\n        if(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\r\n          var ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\r\n          if(val >= 0) return write_num_flt('n', ffmt, val);\r\n          return '(' + write_num_flt('n', ffmt, -val) + ')';\r\n        }\r\n        if(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\r\n        if(fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\r\n        if(fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\r\n        if(fmt.charCodeAt(0) === 36) return \"$\"+write_num_flt(type,fmt.substr(fmt.charAt(1)==' '?2:1),val);\r\n        var o;\r\n        var r, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\r\n        if(fmt.match(/^00+$/)) return sign + pad0r(aval,fmt.length);\r\n        if(fmt.match(/^[#?]+$/)) {\r\n          o = pad0r(val,0); if(o === \"0\") o = \"\";\r\n          return o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\r\n        }\r\n        if((r = fmt.match(frac1))) return write_num_f1(r, aval, sign);\r\n        if(fmt.match(/^#+0+$/)) return sign + pad0r(aval,fmt.length - fmt.indexOf(\"0\"));\r\n        if((r = fmt.match(dec1))) {\r\n          o = rnd(val, r[1].length).replace(/^([^\\.]+)$/,\"$1.\"+hashq(r[1])).replace(/\\.$/,\".\"+hashq(r[1])).replace(/\\.(\\d*)$/,function($$, $1) { return \".\" + $1 + fill(\"0\", hashq(r[1]).length-$1.length); });\r\n          return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\r\n        }\r\n        fmt = fmt.replace(/^#+([0.])/, \"$1\");\r\n        if((r = fmt.match(/^(0*)\\.(#*)$/))) {\r\n          return sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\r\n        }\r\n        if((r = fmt.match(/^#{1,3},##0(\\.?)$/))) return sign + commaify(pad0r(aval,0));\r\n        if((r = fmt.match(/^#,##0\\.([#0]*0)$/))) {\r\n          return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\"+(Math.floor(val) + carry(val, r[1].length))) + \".\" + pad0(dec(val, r[1].length),r[1].length);\r\n        }\r\n        if((r = fmt.match(/^#,#*,#0/))) return write_num_flt(type,fmt.replace(/^#,#*,/,\"\"),val);\r\n        if((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/))) {\r\n          o = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g,\"\"), val));\r\n          ri = 0;\r\n          return _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o.charAt(ri++):x==='0'?'0':\"\";}));\r\n        }\r\n        if(fmt.match(phone)) {\r\n          o = write_num_flt(type, \"##########\", val);\r\n          return \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\r\n        }\r\n        var oa = \"\";\r\n        if((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\r\n          ri = Math.min(r[4].length,7);\r\n          ff = frac(aval, Math.pow(10,ri)-1, false);\r\n          o = \"\" + sign;\r\n          oa = write_num(\"n\", r[1], ff[1]);\r\n          if(oa.charAt(oa.length-1) == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\r\n          o += oa + r[2] + \"/\" + r[3];\r\n          oa = rpad_(ff[2],ri);\r\n          if(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\r\n          o += oa;\r\n          return o;\r\n        }\r\n        if((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\r\n          ri = Math.min(Math.max(r[1].length, r[4].length),7);\r\n          ff = frac(aval, Math.pow(10,ri)-1, true);\r\n          return sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\r\n        }\r\n        if((r = fmt.match(/^[#0?]+$/))) {\r\n          o = pad0r(val, 0);\r\n          if(fmt.length <= o.length) return o;\r\n          return hashq(fmt.substr(0,fmt.length-o.length)) + o;\r\n        }\r\n        if((r = fmt.match(/^([#0?]+)\\.([#0]+)$/))) {\r\n          o = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\r\n          ri = o.indexOf(\".\");\r\n          var lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\r\n          return hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\r\n        }\r\n        if((r = fmt.match(/^00,000\\.([#0]*0)$/))) {\r\n          ri = dec(val, r[1].length);\r\n          return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(ri,r[1].length);\r\n        }\r\n        switch(fmt) {\r\n          case \"###,##0.00\": return write_num_flt(type, \"#,##0.00\", val);\r\n          case \"###,###\":\r\n          case \"##,###\":\r\n          case \"#,###\": var x = commaify(pad0r(aval,0)); return x !== \"0\" ? sign + x : \"\";\r\n          case \"###,###.00\": return write_num_flt(type, \"###,##0.00\",val).replace(/^0\\./,\".\");\r\n          case \"#,###.00\": return write_num_flt(type, \"#,##0.00\",val).replace(/^0\\./,\".\");\r\n          default:\r\n        }\r\n        throw new Error(\"unsupported format |\" + fmt + \"|\");\r\n      }\r\n      function write_num_cm2(type, fmt, val){\r\n        var idx = fmt.length - 1;\r\n        while(fmt.charCodeAt(idx-1) === 44) --idx;\r\n        return write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\r\n      }\r\n      function write_num_pct2(type, fmt, val){\r\n        var sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\r\n        return write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\r\n      }\r\n      function write_num_exp2(fmt, val){\r\n        var o;\r\n        var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\r\n        if(fmt.match(/^#+0.0E\\+0$/)) {\r\n          if(val == 0) return \"0.0E+0\";\r\n          else if(val < 0) return \"-\" + write_num_exp2(fmt, -val);\r\n          var period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\r\n          var ee = Math.floor(Math.log(val)*Math.LOG10E)%period;\r\n          if(ee < 0) ee += period;\r\n          o = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\r\n          if(!o.match(/[Ee]/)) {\r\n            var fakee = Math.floor(Math.log(val)*Math.LOG10E);\r\n            if(o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\r\n            else o += \"E+\" + (fakee - ee);\r\n            o = o.replace(/\\+-/,\"-\");\r\n          }\r\n          o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\r\n        } else o = val.toExponential(idx);\r\n        if(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o.charAt(o.length-1);\r\n        if(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\r\n        return o.replace(\"e\",\"E\");\r\n      }\r\n      function write_num_int(type, fmt, val) {\r\n        if(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\r\n          var ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\r\n          if(val >= 0) return write_num_int('n', ffmt, val);\r\n          return '(' + write_num_int('n', ffmt, -val) + ')';\r\n        }\r\n        if(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\r\n        if(fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\r\n        if(fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\r\n        if(fmt.charCodeAt(0) === 36) return \"$\"+write_num_int(type,fmt.substr(fmt.charAt(1)==' '?2:1),val);\r\n        var o;\r\n        var r, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\r\n        if(fmt.match(/^00+$/)) return sign + pad0(aval,fmt.length);\r\n        if(fmt.match(/^[#?]+$/)) {\r\n          o = (\"\"+val); if(val === 0) o = \"\";\r\n          return o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\r\n        }\r\n        if((r = fmt.match(frac1))) return write_num_f2(r, aval, sign);\r\n        if(fmt.match(/^#+0+$/)) return sign + pad0(aval,fmt.length - fmt.indexOf(\"0\"));\r\n        if((r = fmt.match(dec1))) {\r\n          o = (\"\"+val).replace(/^([^\\.]+)$/,\"$1.\"+hashq(r[1])).replace(/\\.$/,\".\"+hashq(r[1]));\r\n          o = o.replace(/\\.(\\d*)$/,function($$, $1) {\r\n            return \".\" + $1 + fill(\"0\", hashq(r[1]).length-$1.length); });\r\n          return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\r\n        }\r\n        fmt = fmt.replace(/^#+([0.])/, \"$1\");\r\n        if((r = fmt.match(/^(0*)\\.(#*)$/))) {\r\n          return sign + (\"\"+aval).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\r\n        }\r\n        if((r = fmt.match(/^#{1,3},##0(\\.?)$/))) return sign + commaify((\"\"+aval));\r\n        if((r = fmt.match(/^#,##0\\.([#0]*0)$/))) {\r\n          return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify((\"\"+val)) + \".\" + fill('0',r[1].length);\r\n        }\r\n        if((r = fmt.match(/^#,#*,#0/))) return write_num_int(type,fmt.replace(/^#,#*,/,\"\"),val);\r\n        if((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/))) {\r\n          o = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g,\"\"), val));\r\n          ri = 0;\r\n          return _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o.charAt(ri++):x==='0'?'0':\"\";}));\r\n        }\r\n        if(fmt.match(phone)) {\r\n          o = write_num_int(type, \"##########\", val);\r\n          return \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\r\n        }\r\n        var oa = \"\";\r\n        if((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\r\n          ri = Math.min(r[4].length,7);\r\n          ff = frac(aval, Math.pow(10,ri)-1, false);\r\n          o = \"\" + sign;\r\n          oa = write_num(\"n\", r[1], ff[1]);\r\n          if(oa.charAt(oa.length-1) == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\r\n          o += oa + r[2] + \"/\" + r[3];\r\n          oa = rpad_(ff[2],ri);\r\n          if(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\r\n          o += oa;\r\n          return o;\r\n        }\r\n        if((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\r\n          ri = Math.min(Math.max(r[1].length, r[4].length),7);\r\n          ff = frac(aval, Math.pow(10,ri)-1, true);\r\n          return sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\r\n        }\r\n        if((r = fmt.match(/^[#0?]+$/))) {\r\n          o = \"\" + val;\r\n          if(fmt.length <= o.length) return o;\r\n          return hashq(fmt.substr(0,fmt.length-o.length)) + o;\r\n        }\r\n        if((r = fmt.match(/^([#0]+)\\.([#0]+)$/))) {\r\n          o = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\r\n          ri = o.indexOf(\".\");\r\n          var lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\r\n          return hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\r\n        }\r\n        if((r = fmt.match(/^00,000\\.([#0]*0)$/))) {\r\n          return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\"+val).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(0,r[1].length);\r\n        }\r\n        switch(fmt) {\r\n          case \"###,###\":\r\n          case \"##,###\":\r\n          case \"#,###\": var x = commaify(\"\"+aval); return x !== \"0\" ? sign + x : \"\";\r\n          default:\r\n            if(fmt.match(/\\.[0#?]*$/)) return write_num_int(type, fmt.slice(0,fmt.lastIndexOf(\".\")), val) + hashq(fmt.slice(fmt.lastIndexOf(\".\")));\r\n        }\r\n        throw new Error(\"unsupported format |\" + fmt + \"|\");\r\n      }\r\n      return function write_num(type, fmt, val) {\r\n        return (val|0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\r\n      };})();\r\n    function split_fmt(fmt) {\r\n      var out = [];\r\n      var in_str = false/*, cc*/;\r\n      for(var i = 0, j = 0; i < fmt.length; ++i) switch((/*cc=*/fmt.charCodeAt(i))) {\r\n        case 34: /* '\"' */\r\n          in_str = !in_str; break;\r\n        case 95: case 42: case 92: /* '_' '*' '\\\\' */\r\n          ++i; break;\r\n        case 59: /* ';' */\r\n          out[out.length] = fmt.substr(j,i-j);\r\n          j = i+1;\r\n      }\r\n      out[out.length] = fmt.substr(j);\r\n      if(in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\r\n      return out;\r\n    }\r\n    SSF._split = split_fmt;\r\n    var abstime = /\\[[HhMmSs]*\\]/;\r\n    function fmt_is_date(fmt) {\r\n      var i = 0, /*cc = 0,*/ c = \"\", o = \"\";\r\n      while(i < fmt.length) {\r\n        switch((c = fmt.charAt(i))) {\r\n          case 'G': if(isgeneral(fmt, i)) i+= 6; i++; break;\r\n          case '\"': for(;(/*cc=*/fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) ++i; ++i; break;\r\n          case '\\\\': i+=2; break;\r\n          case '_': i+=2; break;\r\n          case '@': ++i; break;\r\n          case 'B': case 'b':\r\n            if(fmt.charAt(i+1) === \"1\" || fmt.charAt(i+1) === \"2\") return true;\r\n          /* falls through */\r\n          case 'M': case 'D': case 'Y': case 'H': case 'S': case 'E':\r\n          /* falls through */\r\n          case 'm': case 'd': case 'y': case 'h': case 's': case 'e': case 'g': return true;\r\n          case 'A': case 'a':\r\n            if(fmt.substr(i, 3).toUpperCase() === \"A/P\") return true;\r\n            if(fmt.substr(i, 5).toUpperCase() === \"AM/PM\") return true;\r\n            ++i; break;\r\n          case '[':\r\n            o = c;\r\n            while(fmt.charAt(i++) !== ']' && i < fmt.length) o += fmt.charAt(i);\r\n            if(o.match(abstime)) return true;\r\n            break;\r\n          case '.':\r\n          /* falls through */\r\n          case '0': case '#':\r\n            while(i < fmt.length && (\"0#?.,E+-%\".indexOf(c=fmt.charAt(++i)) > -1 || (c=='\\\\' && fmt.charAt(i+1) == \"-\" && \"0#\".indexOf(fmt.charAt(i+2))>-1))){/* empty */}\r\n            break;\r\n          case '?': while(fmt.charAt(++i) === c){/* empty */} break;\r\n          case '*': ++i; if(fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i; break;\r\n          case '(': case ')': ++i; break;\r\n          case '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':\r\n            while(i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1){/* empty */} break;\r\n          case ' ': ++i; break;\r\n          default: ++i; break;\r\n        }\r\n      }\r\n      return false;\r\n    }\r\n    SSF.is_date = fmt_is_date;\r\n    function eval_fmt(fmt, v, opts, flen) {\r\n      var out = [], o = \"\", i = 0, c = \"\", lst='t', dt, j, cc;\r\n      var hr='H';\r\n      /* Tokenize */\r\n      while(i < fmt.length) {\r\n        switch((c = fmt.charAt(i))) {\r\n          case 'G': /* General */\r\n            if(!isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' +fmt);\r\n            out[out.length] = {t:'G', v:'General'}; i+=7; break;\r\n          case '\"': /* Literal text */\r\n            for(o=\"\";(cc=fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) o += String.fromCharCode(cc);\r\n            out[out.length] = {t:'t', v:o}; ++i; break;\r\n          case '\\\\': var w = fmt.charAt(++i), t = (w === \"(\" || w === \")\") ? w : 't';\r\n            out[out.length] = {t:t, v:w}; ++i; break;\r\n          case '_': out[out.length] = {t:'t', v:\" \"}; i+=2; break;\r\n          case '@': /* Text Placeholder */\r\n            out[out.length] = {t:'T', v:v}; ++i; break;\r\n          case 'B': case 'b':\r\n            if(fmt.charAt(i+1) === \"1\" || fmt.charAt(i+1) === \"2\") {\r\n              if(dt==null) { dt=parse_date_code(v, opts, fmt.charAt(i+1) === \"2\"); if(dt==null) return \"\"; }\r\n              out[out.length] = {t:'X', v:fmt.substr(i,2)}; lst = c; i+=2; break;\r\n            }\r\n          /* falls through */\r\n          case 'M': case 'D': case 'Y': case 'H': case 'S': case 'E':\r\n            c = c.toLowerCase();\r\n          /* falls through */\r\n          case 'm': case 'd': case 'y': case 'h': case 's': case 'e': case 'g':\r\n            if(v < 0) return \"\";\r\n            if(dt==null) { dt=parse_date_code(v, opts); if(dt==null) return \"\"; }\r\n            o = c; while(++i < fmt.length && fmt.charAt(i).toLowerCase() === c) o+=c;\r\n            if(c === 'm' && lst.toLowerCase() === 'h') c = 'M';\r\n            if(c === 'h') c = hr;\r\n            out[out.length] = {t:c, v:o}; lst = c; break;\r\n          case 'A': case 'a':\r\n            var q={t:c, v:c};\r\n            if(dt==null) dt=parse_date_code(v, opts);\r\n            if(fmt.substr(i, 3).toUpperCase() === \"A/P\") { if(dt!=null) q.v = dt.H >= 12 ? \"P\" : \"A\"; q.t = 'T'; hr='h';i+=3;}\r\n            else if(fmt.substr(i,5).toUpperCase() === \"AM/PM\") { if(dt!=null) q.v = dt.H >= 12 ? \"PM\" : \"AM\"; q.t = 'T'; i+=5; hr='h'; }\r\n            else { q.t = \"t\"; ++i; }\r\n            if(dt==null && q.t === 'T') return \"\";\r\n            out[out.length] = q; lst = c; break;\r\n          case '[':\r\n            o = c;\r\n            while(fmt.charAt(i++) !== ']' && i < fmt.length) o += fmt.charAt(i);\r\n            if(o.slice(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\r\n            if(o.match(abstime)) {\r\n              if(dt==null) { dt=parse_date_code(v, opts); if(dt==null) return \"\"; }\r\n              out[out.length] = {t:'Z', v:o.toLowerCase()};\r\n              lst = o.charAt(1);\r\n            } else if(o.indexOf(\"$\") > -1) {\r\n              o = (o.match(/\\$([^-\\[\\]]*)/)||[])[1]||\"$\";\r\n              if(!fmt_is_date(fmt)) out[out.length] = {t:'t',v:o};\r\n            }\r\n            break;\r\n          /* Numbers */\r\n          case '.':\r\n            if(dt != null) {\r\n              o = c; while(++i < fmt.length && (c=fmt.charAt(i)) === \"0\") o += c;\r\n              out[out.length] = {t:'s', v:o}; break;\r\n            }\r\n          /* falls through */\r\n          case '0': case '#':\r\n            o = c; while((++i < fmt.length && \"0#?.,E+-%\".indexOf(c=fmt.charAt(i)) > -1) || (c=='\\\\' && fmt.charAt(i+1) == \"-\" && i < fmt.length - 2 && \"0#\".indexOf(fmt.charAt(i+2))>-1)) o += c;\r\n            out[out.length] = {t:'n', v:o}; break;\r\n          case '?':\r\n            o = c; while(fmt.charAt(++i) === c) o+=c;\r\n            out[out.length] = {t:c, v:o}; lst = c; break;\r\n          case '*': ++i; if(fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i; break; // **\r\n          case '(': case ')': out[out.length] = {t:(flen===1?'t':c), v:c}; ++i; break;\r\n          case '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':\r\n            o = c; while(i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1) o+=fmt.charAt(i);\r\n            out[out.length] = {t:'D', v:o}; break;\r\n          case ' ': out[out.length] = {t:c, v:c}; ++i; break;\r\n          default:\r\n            if(\",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\r\n            out[out.length] = {t:'t', v:c}; ++i; break;\r\n        }\r\n      }\r\n      var bt = 0, ss0 = 0, ssm;\r\n      for(i=out.length-1, lst='t'; i >= 0; --i) {\r\n        switch(out[i].t) {\r\n          case 'h': case 'H': out[i].t = hr; lst='h'; if(bt < 1) bt = 1; break;\r\n          case 's':\r\n            if((ssm=out[i].v.match(/\\.0+$/))) ss0=Math.max(ss0,ssm[0].length-1);\r\n            if(bt < 3) bt = 3;\r\n          /* falls through */\r\n          case 'd': case 'y': case 'M': case 'e': lst=out[i].t; break;\r\n          case 'm': if(lst === 's') { out[i].t = 'M'; if(bt < 2) bt = 2; } break;\r\n          case 'X': /*if(out[i].v === \"B2\");*/\r\n            break;\r\n          case 'Z':\r\n            if(bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\r\n            if(bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\r\n            if(bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\r\n        }\r\n      }\r\n      switch(bt) {\r\n        case 0: break;\r\n        case 1:\r\n          if(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\r\n          if(dt.S >=  60) { dt.S = 0; ++dt.M; }\r\n          if(dt.M >=  60) { dt.M = 0; ++dt.H; }\r\n          break;\r\n        case 2:\r\n          if(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\r\n          if(dt.S >=  60) { dt.S = 0; ++dt.M; }\r\n          break;\r\n      }\r\n      /* replace fields */\r\n      var nstr = \"\", jj;\r\n      for(i=0; i < out.length; ++i) {\r\n        switch(out[i].t) {\r\n          case 't': case 'T': case ' ': case 'D': break;\r\n          case 'X': out[i].v = \"\"; out[i].t = \";\"; break;\r\n          case 'd': case 'm': case 'y': case 'h': case 'H': case 'M': case 's': case 'e': case 'b': case 'Z':\r\n            out[i].v = write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\r\n            out[i].t = 't'; break;\r\n          case 'n': case '(': case '?':\r\n            jj = i+1;\r\n            while(out[jj] != null && (\r\n              (c=out[jj].t) === \"?\" || c === \"D\" ||\r\n              ((c === \" \" || c === \"t\") && out[jj+1] != null && (out[jj+1].t === '?' || out[jj+1].t === \"t\" && out[jj+1].v === '/')) ||\r\n              (out[i].t === '(' && (c === ' ' || c === 'n' || c === ')')) ||\r\n              (c === 't' && (out[jj].v === '/' || out[jj].v === ' ' && out[jj+1] != null && out[jj+1].t == '?'))\r\n            )) {\r\n              out[i].v += out[jj].v;\r\n              out[jj] = {v:\"\", t:\";\"}; ++jj;\r\n            }\r\n            nstr += out[i].v;\r\n            i = jj-1; break;\r\n          case 'G': out[i].t = 't'; out[i].v = general_fmt(v,opts); break;\r\n        }\r\n      }\r\n      var vv = \"\", myv, ostr;\r\n      if(nstr.length > 0) {\r\n        if(nstr.charCodeAt(0) == 40) /* '(' */ {\r\n          myv = (v<0&&nstr.charCodeAt(0) === 45 ? -v : v);\r\n          ostr = write_num('(', nstr, myv);\r\n        } else {\r\n          myv = (v<0 && flen > 1 ? -v : v);\r\n          ostr = write_num('n', nstr, myv);\r\n          if(myv < 0 && out[0] && out[0].t == 't') {\r\n            ostr = ostr.substr(1);\r\n            out[0].v = \"-\" + out[0].v;\r\n          }\r\n        }\r\n        jj=ostr.length-1;\r\n        var decpt = out.length;\r\n        for(i=0; i < out.length; ++i) if(out[i] != null && out[i].t != 't' && out[i].v.indexOf(\".\") > -1) { decpt = i; break; }\r\n        var lasti=out.length;\r\n        if(decpt === out.length && ostr.indexOf(\"E\") === -1) {\r\n          for(i=out.length-1; i>= 0;--i) {\r\n            if(out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\r\n            if(jj>=out[i].v.length-1) { jj -= out[i].v.length; out[i].v = ostr.substr(jj+1, out[i].v.length); }\r\n            else if(jj < 0) out[i].v = \"\";\r\n            else { out[i].v = ostr.substr(0, jj+1); jj = -1; }\r\n            out[i].t = 't';\r\n            lasti = i;\r\n          }\r\n          if(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\r\n        }\r\n        else if(decpt !== out.length && ostr.indexOf(\"E\") === -1) {\r\n          jj = ostr.indexOf(\".\")-1;\r\n          for(i=decpt; i>= 0; --i) {\r\n            if(out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\r\n            j=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")-1:out[i].v.length-1;\r\n            vv = out[i].v.substr(j+1);\r\n            for(; j>=0; --j) {\r\n              if(jj>=0 && (out[i].v.charAt(j) === \"0\" || out[i].v.charAt(j) === \"#\")) vv = ostr.charAt(jj--) + vv;\r\n            }\r\n            out[i].v = vv;\r\n            out[i].t = 't';\r\n            lasti = i;\r\n          }\r\n          if(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\r\n          jj = ostr.indexOf(\".\")+1;\r\n          for(i=decpt; i<out.length; ++i) {\r\n            if(out[i] == null || ('n?('.indexOf(out[i].t) === -1 && i !== decpt)) continue;\r\n            j=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")+1:0;\r\n            vv = out[i].v.substr(0,j);\r\n            for(; j<out[i].v.length; ++j) {\r\n              if(jj<ostr.length) vv += ostr.charAt(jj++);\r\n            }\r\n            out[i].v = vv;\r\n            out[i].t = 't';\r\n            lasti = i;\r\n          }\r\n        }\r\n      }\r\n      for(i=0; i<out.length; ++i) if(out[i] != null && 'n(?'.indexOf(out[i].t)>-1) {\r\n        myv = (flen >1 && v < 0 && i>0 && out[i-1].v === \"-\" ? -v:v);\r\n        out[i].v = write_num(out[i].t, out[i].v, myv);\r\n        out[i].t = 't';\r\n      }\r\n      var retval = \"\";\r\n      for(i=0; i !== out.length; ++i) if(out[i] != null) retval += out[i].v;\r\n      return retval;\r\n    }\r\n    SSF._eval = eval_fmt;\r\n    var cfregex = /\\[[=<>]/;\r\n    var cfregex2 = /\\[(=|>[=]?|<[>=]?)(-?\\d+(?:\\.\\d*)?)\\]/;\r\n    function chkcond(v, rr) {\r\n      if(rr == null) return false;\r\n      var thresh = parseFloat(rr[2]);\r\n      switch(rr[1]) {\r\n        case \"=\":  if(v == thresh) return true; break;\r\n        case \">\":  if(v >  thresh) return true; break;\r\n        case \"<\":  if(v <  thresh) return true; break;\r\n        case \"<>\": if(v != thresh) return true; break;\r\n        case \">=\": if(v >= thresh) return true; break;\r\n        case \"<=\": if(v <= thresh) return true; break;\r\n      }\r\n      return false;\r\n    }\r\n    function choose_fmt(f, v) {\r\n      var fmt = split_fmt(f);\r\n      var l = fmt.length, lat = fmt[l-1].indexOf(\"@\");\r\n      if(l<4 && lat>-1) --l;\r\n      if(fmt.length > 4) throw new Error(\"cannot find right format for |\" + fmt.join(\"|\") + \"|\");\r\n      if(typeof v !== \"number\") return [4, fmt.length === 4 || lat>-1?fmt[fmt.length-1]:\"@\"];\r\n      switch(fmt.length) {\r\n        case 1: fmt = lat>-1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"]; break;\r\n        case 2: fmt = lat>-1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"]; break;\r\n        case 3: fmt = lat>-1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"]; break;\r\n        case 4: break;\r\n      }\r\n      var ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\r\n      if(fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\r\n      if(fmt[0].match(cfregex) != null || fmt[1].match(cfregex) != null) {\r\n        var m1 = fmt[0].match(cfregex2);\r\n        var m2 = fmt[1].match(cfregex2);\r\n        return chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\r\n      }\r\n      return [l, ff];\r\n    }\r\n    function format(fmt,v,o) {\r\n      if(o == null) o = {};\r\n      var sfmt = \"\";\r\n      switch(typeof fmt) {\r\n        case \"string\":\r\n          if(fmt == \"m/d/yy\" && o.dateNF) sfmt = o.dateNF;\r\n          else sfmt = fmt;\r\n          break;\r\n        case \"number\":\r\n          if(fmt == 14 && o.dateNF) sfmt = o.dateNF;\r\n          else sfmt = (o.table != null ? (o.table) : table_fmt)[fmt];\r\n          break;\r\n      }\r\n      if(isgeneral(sfmt,0)) return general_fmt(v, o);\r\n      if(v instanceof Date) v = datenum_local(v, o.date1904);\r\n      var f = choose_fmt(sfmt, v);\r\n      if(isgeneral(f[1])) return general_fmt(v, o);\r\n      if(v === true) v = \"TRUE\"; else if(v === false) v = \"FALSE\";\r\n      else if(v === \"\" || v == null) return \"\";\r\n      return eval_fmt(f[1], v, o, f[0]);\r\n    }\r\n    function load_entry(fmt, idx) {\r\n      if(typeof idx != 'number') {\r\n        idx = +idx || -1;\r\n        for(var i = 0; i < 0x0188; ++i) {\r\n          if(table_fmt[i] == undefined) { if(idx < 0) idx = i; continue; }\r\n          if(table_fmt[i] == fmt) { idx = i; break; }\r\n        }\r\n        if(idx < 0) idx = 0x187;\r\n      }\r\n      table_fmt[idx] = fmt;\r\n      return idx;\r\n    }\r\n    SSF.load = load_entry;\r\n    SSF._table = table_fmt;\r\n    SSF.get_table = function get_table() { return table_fmt; };\r\n    SSF.load_table = function load_table(tbl) {\r\n      for(var i=0; i!=0x0188; ++i)\r\n        if(tbl[i] !== undefined) load_entry(tbl[i], i);\r\n    };\r\n    SSF.init_table = init_table;\r\n    SSF.format = format;\r\n  };\r\n  make_ssf(SSF);\r\n  /* map from xlml named formats to SSF TODO: localize */\r\n  var XLMLFormatMap/*{[string]:string}*/ = ({\r\n    \"General Number\": \"General\",\r\n    \"General Date\": SSF._table[22],\r\n    \"Long Date\": \"dddd, mmmm dd, yyyy\",\r\n    \"Medium Date\": SSF._table[15],\r\n    \"Short Date\": SSF._table[14],\r\n    \"Long Time\": SSF._table[19],\r\n    \"Medium Time\": SSF._table[18],\r\n    \"Short Time\": SSF._table[20],\r\n    \"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\r\n    \"Fixed\": SSF._table[2],\r\n    \"Standard\": SSF._table[4],\r\n    \"Percent\": SSF._table[10],\r\n    \"Scientific\": SSF._table[11],\r\n    \"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\r\n    \"True/False\": '\"True\";\"True\";\"False\";@',\r\n    \"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\r\n  });\r\n\r\n  var SSFImplicit/*{[number]:string}*/ = ({\r\n    \"5\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\r\n    \"6\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\r\n    \"7\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\r\n    \"8\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\r\n    \"23\": 'General', \"24\": 'General', \"25\": 'General', \"26\": 'General',\r\n    \"27\": 'm/d/yy', \"28\": 'm/d/yy', \"29\": 'm/d/yy', \"30\": 'm/d/yy', \"31\": 'm/d/yy',\r\n    \"32\": 'h:mm:ss', \"33\": 'h:mm:ss', \"34\": 'h:mm:ss', \"35\": 'h:mm:ss',\r\n    \"36\": 'm/d/yy',\r\n    \"41\": '_(* #,##0_);_(* \\(#,##0\\);_(* \"-\"_);_(@_)',\r\n    \"42\": '_(\"$\"* #,##0_);_(\"$\"* \\(#,##0\\);_(\"$\"* \"-\"_);_(@_)',\r\n    \"43\": '_(* #,##0.00_);_(* \\(#,##0.00\\);_(* \"-\"??_);_(@_)',\r\n    \"44\": '_(\"$\"* #,##0.00_);_(\"$\"* \\(#,##0.00\\);_(\"$\"* \"-\"??_);_(@_)',\r\n    \"50\": 'm/d/yy', \"51\": 'm/d/yy', \"52\": 'm/d/yy', \"53\": 'm/d/yy', \"54\": 'm/d/yy',\r\n    \"55\": 'm/d/yy', \"56\": 'm/d/yy', \"57\": 'm/d/yy', \"58\": 'm/d/yy',\r\n    \"59\": '0',\r\n    \"60\": '0.00',\r\n    \"61\": '#,##0',\r\n    \"62\": '#,##0.00',\r\n    \"63\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\r\n    \"64\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\r\n    \"65\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\r\n    \"66\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\r\n    \"67\": '0%',\r\n    \"68\": '0.00%',\r\n    \"69\": '# ?/?',\r\n    \"70\": '# ??/??',\r\n    \"71\": 'm/d/yy',\r\n    \"72\": 'm/d/yy',\r\n    \"73\": 'd-mmm-yy',\r\n    \"74\": 'd-mmm',\r\n    \"75\": 'mmm-yy',\r\n    \"76\": 'h:mm',\r\n    \"77\": 'h:mm:ss',\r\n    \"78\": 'm/d/yy h:mm',\r\n    \"79\": 'mm:ss',\r\n    \"80\": '[h]:mm:ss',\r\n    \"81\": 'mmss.0'\r\n  });\r\n\r\n  /* dateNF parse TODO: move to SSF */\r\n  var dateNFregex = /[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;\r\n  function dateNF_regex(dateNF) {\r\n    var fmt = typeof dateNF == \"number\" ? SSF._table[dateNF] : dateNF;\r\n    fmt = fmt.replace(dateNFregex, \"(\\\\d+)\");\r\n    return new RegExp(\"^\" + fmt + \"$\");\r\n  }\r\n  function dateNF_fix(str, dateNF, match) {\r\n    var Y = -1, m = -1, d = -1, H = -1, M = -1, S = -1;\r\n    (dateNF.match(dateNFregex)||[]).forEach(function(n, i) {\r\n      var v = parseInt(match[i+1], 10);\r\n      switch(n.toLowerCase().charAt(0)) {\r\n        case 'y': Y = v; break; case 'd': d = v; break;\r\n        case 'h': H = v; break; case 's': S = v; break;\r\n        case 'm': if(H >= 0) M = v; else m = v; break;\r\n      }\r\n    });\r\n    if(S >= 0 && M == -1 && m >= 0) { M = m; m = -1; }\r\n    var datestr = ((\"\" + (Y>=0?Y: new Date().getFullYear())).slice(-4) + \"-\" + (\"00\" + (m>=1?m:1)).slice(-2) + \"-\" + (\"00\" + (d>=1?d:1)).slice(-2));\r\n    if(datestr.length == 7) datestr = \"0\" + datestr;\r\n    if(datestr.length == 8) datestr = \"20\" + datestr;\r\n    var timestr = ((\"00\" + (H>=0?H:0)).slice(-2) + \":\" + (\"00\" + (M>=0?M:0)).slice(-2) + \":\" + (\"00\" + (S>=0?S:0)).slice(-2));\r\n    if(H == -1 && M == -1 && S == -1) return datestr;\r\n    if(Y == -1 && m == -1 && d == -1) return timestr;\r\n    return datestr + \"T\" + timestr;\r\n  }\r\n\r\n  var DO_NOT_EXPORT_CFB = true;\r\n  /* cfb.js (C) 2013-present SheetJS -- http://sheetjs.com */\r\n  /* vim: set ts=2: */\r\n  /*jshint eqnull:true */\r\n  /*exported CFB */\r\n  /*global module, require:false, process:false, Buffer:false, Uint8Array:false, Uint16Array:false */\r\n\r\n  /* crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */\r\n  /* vim: set ts=2: */\r\n  /*exported CRC32 */\r\n  var CRC32;\r\n  (function (factory) {\r\n    /*jshint ignore:start */\r\n    /*eslint-disable */\r\n    factory(CRC32 = {});\r\n    /*eslint-enable */\r\n    /*jshint ignore:end */\r\n  }(function(CRC32) {\r\n    CRC32.version = '1.2.0';\r\n    /* see perf/crc32table.js */\r\n    /*global Int32Array */\r\n    function signed_crc_table() {\r\n      var c = 0, table = new Array(256);\r\n\r\n      for(var n =0; n != 256; ++n){\r\n        c = n;\r\n        c = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\r\n        c = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\r\n        c = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\r\n        c = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\r\n        c = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\r\n        c = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\r\n        c = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\r\n        c = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\r\n        table[n] = c;\r\n      }\r\n\r\n      return typeof Int32Array !== 'undefined' ? new Int32Array(table) : table;\r\n    }\r\n\r\n    var T = signed_crc_table();\r\n    function crc32_bstr(bstr, seed) {\r\n      var C = seed ^ -1, L = bstr.length - 1;\r\n      for(var i = 0; i < L;) {\r\n        C = (C>>>8) ^ T[(C^bstr.charCodeAt(i++))&0xFF];\r\n        C = (C>>>8) ^ T[(C^bstr.charCodeAt(i++))&0xFF];\r\n      }\r\n      if(i === L) C = (C>>>8) ^ T[(C ^ bstr.charCodeAt(i))&0xFF];\r\n      return C ^ -1;\r\n    }\r\n\r\n    function crc32_buf(buf, seed) {\r\n      if(buf.length > 10000) return crc32_buf_8(buf, seed);\r\n      var C = seed ^ -1, L = buf.length - 3;\r\n      for(var i = 0; i < L;) {\r\n        C = (C>>>8) ^ T[(C^buf[i++])&0xFF];\r\n        C = (C>>>8) ^ T[(C^buf[i++])&0xFF];\r\n        C = (C>>>8) ^ T[(C^buf[i++])&0xFF];\r\n        C = (C>>>8) ^ T[(C^buf[i++])&0xFF];\r\n      }\r\n      while(i < L+3) C = (C>>>8) ^ T[(C^buf[i++])&0xFF];\r\n      return C ^ -1;\r\n    }\r\n\r\n    function crc32_buf_8(buf, seed) {\r\n      var C = seed ^ -1, L = buf.length - 7;\r\n      for(var i = 0; i < L;) {\r\n        C = (C>>>8) ^ T[(C^buf[i++])&0xFF];\r\n        C = (C>>>8) ^ T[(C^buf[i++])&0xFF];\r\n        C = (C>>>8) ^ T[(C^buf[i++])&0xFF];\r\n        C = (C>>>8) ^ T[(C^buf[i++])&0xFF];\r\n        C = (C>>>8) ^ T[(C^buf[i++])&0xFF];\r\n        C = (C>>>8) ^ T[(C^buf[i++])&0xFF];\r\n        C = (C>>>8) ^ T[(C^buf[i++])&0xFF];\r\n        C = (C>>>8) ^ T[(C^buf[i++])&0xFF];\r\n      }\r\n      while(i < L+7) C = (C>>>8) ^ T[(C^buf[i++])&0xFF];\r\n      return C ^ -1;\r\n    }\r\n\r\n    function crc32_str(str, seed) {\r\n      var C = seed ^ -1;\r\n      for(var i = 0, L=str.length, c, d; i < L;) {\r\n        c = str.charCodeAt(i++);\r\n        if(c < 0x80) {\r\n          C = (C>>>8) ^ T[(C ^ c)&0xFF];\r\n        } else if(c < 0x800) {\r\n          C = (C>>>8) ^ T[(C ^ (192|((c>>6)&31)))&0xFF];\r\n          C = (C>>>8) ^ T[(C ^ (128|(c&63)))&0xFF];\r\n        } else if(c >= 0xD800 && c < 0xE000) {\r\n          c = (c&1023)+64; d = str.charCodeAt(i++)&1023;\r\n          C = (C>>>8) ^ T[(C ^ (240|((c>>8)&7)))&0xFF];\r\n          C = (C>>>8) ^ T[(C ^ (128|((c>>2)&63)))&0xFF];\r\n          C = (C>>>8) ^ T[(C ^ (128|((d>>6)&15)|((c&3)<<4)))&0xFF];\r\n          C = (C>>>8) ^ T[(C ^ (128|(d&63)))&0xFF];\r\n        } else {\r\n          C = (C>>>8) ^ T[(C ^ (224|((c>>12)&15)))&0xFF];\r\n          C = (C>>>8) ^ T[(C ^ (128|((c>>6)&63)))&0xFF];\r\n          C = (C>>>8) ^ T[(C ^ (128|(c&63)))&0xFF];\r\n        }\r\n      }\r\n      return C ^ -1;\r\n    }\r\n    CRC32.table = T;\r\n    CRC32.bstr = crc32_bstr;\r\n    CRC32.buf = crc32_buf;\r\n    CRC32.str = crc32_str;\r\n  }));\r\n  /* [MS-CFB] v20171201 */\r\n  var CFB = (function _CFB(){\r\n    var exports = {};\r\n    exports.version = '1.1.0';\r\n    /* [MS-CFB] 2.6.4 */\r\n    function namecmp(l, r) {\r\n      var L = l.split(\"/\"), R = r.split(\"/\");\r\n      for(var i = 0, c = 0, Z = Math.min(L.length, R.length); i < Z; ++i) {\r\n        if((c = L[i].length - R[i].length)) return c;\r\n        if(L[i] != R[i]) return L[i] < R[i] ? -1 : 1;\r\n      }\r\n      return L.length - R.length;\r\n    }\r\n    function dirname(p) {\r\n      if(p.charAt(p.length - 1) == \"/\") return (p.slice(0,-1).indexOf(\"/\") === -1) ? p : dirname(p.slice(0, -1));\r\n      var c = p.lastIndexOf(\"/\");\r\n      return (c === -1) ? p : p.slice(0, c+1);\r\n    }\r\n\r\n    function filename(p) {\r\n      if(p.charAt(p.length - 1) == \"/\") return filename(p.slice(0, -1));\r\n      var c = p.lastIndexOf(\"/\");\r\n      return (c === -1) ? p : p.slice(c+1);\r\n    }\r\n    /* -------------------------------------------------------------------------- */\r\n    /* DOS Date format:\r\n   high|YYYYYYYm.mmmddddd.HHHHHMMM.MMMSSSSS|low\r\n   add 1980 to stored year\r\n   stored second should be doubled\r\n*/\r\n\r\n    /* write JS date to buf as a DOS date */\r\n    function write_dos_date(buf, date) {\r\n      if(typeof date === \"string\") date = new Date(date);\r\n      var hms = date.getHours();\r\n      hms = hms << 6 | date.getMinutes();\r\n      hms = hms << 5 | (date.getSeconds()>>>1);\r\n      buf.write_shift(2, hms);\r\n      var ymd = (date.getFullYear() - 1980);\r\n      ymd = ymd << 4 | (date.getMonth()+1);\r\n      ymd = ymd << 5 | date.getDate();\r\n      buf.write_shift(2, ymd);\r\n    }\r\n\r\n    /* read four bytes from buf and interpret as a DOS date */\r\n    function parse_dos_date(buf) {\r\n      var hms = buf.read_shift(2) & 0xFFFF;\r\n      var ymd = buf.read_shift(2) & 0xFFFF;\r\n      var val = new Date();\r\n      var d = ymd & 0x1F; ymd >>>= 5;\r\n      var m = ymd & 0x0F; ymd >>>= 4;\r\n      val.setMilliseconds(0);\r\n      val.setFullYear(ymd + 1980);\r\n      val.setMonth(m-1);\r\n      val.setDate(d);\r\n      var S = hms & 0x1F; hms >>>= 5;\r\n      var M = hms & 0x3F; hms >>>= 6;\r\n      val.setHours(hms);\r\n      val.setMinutes(M);\r\n      val.setSeconds(S<<1);\r\n      return val;\r\n    }\r\n    function parse_extra_field(blob) {\r\n      prep_blob(blob, 0);\r\n      var o = {};\r\n      var flags = 0;\r\n      while(blob.l <= blob.length - 4) {\r\n        var type = blob.read_shift(2);\r\n        var sz = blob.read_shift(2), tgt = blob.l + sz;\r\n        var p = {};\r\n        switch(type) {\r\n          /* UNIX-style Timestamps */\r\n          case 0x5455: {\r\n            flags = blob.read_shift(1);\r\n            if(flags & 1) p.mtime = blob.read_shift(4);\r\n            /* for some reason, CD flag corresponds to LFH */\r\n            if(sz > 5) {\r\n              if(flags & 2) p.atime = blob.read_shift(4);\r\n              if(flags & 4) p.ctime = blob.read_shift(4);\r\n            }\r\n            if(p.mtime) p.mt = new Date(p.mtime*1000);\r\n          }\r\n            break;\r\n        }\r\n        blob.l = tgt;\r\n        o[type] = p;\r\n      }\r\n      return o;\r\n    }\r\n    var fs;\r\n    // function get_fs() { return fs || (fs = require('fs')); }\r\n    function parse(file, options) {\r\n      if(file[0] == 0x50 && file[1] == 0x4b) return parse_zip(file, options);\r\n      if(file.length < 512) throw new Error(\"CFB file size \" + file.length + \" < 512\");\r\n      var mver = 3;\r\n      var ssz = 512;\r\n      var nmfs = 0; // number of mini FAT sectors\r\n      var difat_sec_cnt = 0;\r\n      var dir_start = 0;\r\n      var minifat_start = 0;\r\n      var difat_start = 0;\r\n\r\n      var fat_addrs = []; // locations of FAT sectors\r\n\r\n      /* [MS-CFB] 2.2 Compound File Header */\r\n      var blob = file.slice(0,512);\r\n      prep_blob(blob, 0);\r\n\r\n      /* major version */\r\n      var mv = check_get_mver(blob);\r\n      mver = mv[0];\r\n      switch(mver) {\r\n        case 3: ssz = 512; break; case 4: ssz = 4096; break;\r\n        case 0: if(mv[1] == 0) return parse_zip(file, options);\r\n        /* falls through */\r\n        default: throw new Error(\"Major Version: Expected 3 or 4 saw \" + mver);\r\n      }\r\n\r\n      /* reprocess header */\r\n      if(ssz !== 512) { blob = file.slice(0,ssz); prep_blob(blob, 28 /* blob.l */); }\r\n      /* Save header for final object */\r\n      var header = file.slice(0,ssz);\r\n\r\n      check_shifts(blob, mver);\r\n\r\n// Number of Directory Sectors\r\n      var dir_cnt = blob.read_shift(4, 'i');\r\n      if(mver === 3 && dir_cnt !== 0) throw new Error('# Directory Sectors: Expected 0 saw ' + dir_cnt);\r\n\r\n// Number of FAT Sectors\r\n      blob.l += 4;\r\n\r\n// First Directory Sector Location\r\n      dir_start = blob.read_shift(4, 'i');\r\n\r\n// Transaction Signature\r\n      blob.l += 4;\r\n\r\n// Mini Stream Cutoff Size\r\n      blob.chk('00100000', 'Mini Stream Cutoff Size: ');\r\n\r\n// First Mini FAT Sector Location\r\n      minifat_start = blob.read_shift(4, 'i');\r\n\r\n// Number of Mini FAT Sectors\r\n      nmfs = blob.read_shift(4, 'i');\r\n\r\n// First DIFAT sector location\r\n      difat_start = blob.read_shift(4, 'i');\r\n\r\n// Number of DIFAT Sectors\r\n      difat_sec_cnt = blob.read_shift(4, 'i');\r\n\r\n// Grab FAT Sector Locations\r\n      for(var q = -1, j = 0; j < 109; ++j) { /* 109 = (512 - blob.l)>>>2; */\r\n        q = blob.read_shift(4, 'i');\r\n        if(q<0) break;\r\n        fat_addrs[j] = q;\r\n      }\r\n\r\n      /** Break the file up into sectors */\r\n      var sectors = sectorify(file, ssz);\r\n\r\n      sleuth_fat(difat_start, difat_sec_cnt, sectors, ssz, fat_addrs);\r\n\r\n      /** Chains */\r\n      var sector_list = make_sector_list(sectors, dir_start, fat_addrs, ssz);\r\n\r\n      sector_list[dir_start].name = \"!Directory\";\r\n      if(nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\r\n      sector_list[fat_addrs[0]].name = \"!FAT\";\r\n      sector_list.fat_addrs = fat_addrs;\r\n      sector_list.ssz = ssz;\r\n\r\n      /* [MS-CFB] 2.6.1 Compound File Directory Entry */\r\n      var files = {}, Paths = [], FileIndex = [], FullPaths = [];\r\n      read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex, minifat_start);\r\n\r\n      build_full_paths(FileIndex, FullPaths, Paths);\r\n      Paths.shift();\r\n\r\n      var o = {\r\n        FileIndex: FileIndex,\r\n        FullPaths: FullPaths\r\n      };\r\n\r\n// $FlowIgnore\r\n      if(options && options.raw) o.raw = {header: header, sectors: sectors};\r\n      return o;\r\n    } // parse\r\n\r\n    /* [MS-CFB] 2.2 Compound File Header -- read up to major version */\r\n    function check_get_mver(blob) {\r\n      if(blob[blob.l] == 0x50 && blob[blob.l + 1] == 0x4b) return [0, 0];\r\n      // header signature 8\r\n      blob.chk(HEADER_SIGNATURE, 'Header Signature: ');\r\n\r\n      // clsid 16\r\n      blob.chk(HEADER_CLSID, 'CLSID: ');\r\n\r\n      // minor version 2\r\n      var mver = blob.read_shift(2, 'u');\r\n\r\n      return [blob.read_shift(2,'u'), mver];\r\n    }\r\n    function check_shifts(blob, mver) {\r\n      var shift = 0x09;\r\n\r\n      // Byte Order\r\n      //blob.chk('feff', 'Byte Order: '); // note: some writers put 0xffff\r\n      blob.l += 2;\r\n\r\n      // Sector Shift\r\n      switch((shift = blob.read_shift(2))) {\r\n        case 0x09: if(mver != 3) throw new Error('Sector Shift: Expected 9 saw ' + shift); break;\r\n        case 0x0c: if(mver != 4) throw new Error('Sector Shift: Expected 12 saw ' + shift); break;\r\n        default: throw new Error('Sector Shift: Expected 9 or 12 saw ' + shift);\r\n      }\r\n\r\n      // Mini Sector Shift\r\n      blob.chk('0600', 'Mini Sector Shift: ');\r\n\r\n      // Reserved\r\n      blob.chk('000000000000', 'Reserved: ');\r\n    }\r\n\r\n    /** Break the file up into sectors */\r\n    function sectorify(file, ssz) {\r\n      var nsectors = Math.ceil(file.length/ssz)-1;\r\n      var sectors = [];\r\n      for(var i=1; i < nsectors; ++i) sectors[i-1] = file.slice(i*ssz,(i+1)*ssz);\r\n      sectors[nsectors-1] = file.slice(nsectors*ssz);\r\n      return sectors;\r\n    }\r\n\r\n    /* [MS-CFB] 2.6.4 Red-Black Tree */\r\n    function build_full_paths(FI, FP, Paths) {\r\n      var i = 0, L = 0, R = 0, C = 0, j = 0, pl = Paths.length;\r\n      var dad = [], q = [];\r\n\r\n      for(; i < pl; ++i) { dad[i]=q[i]=i; FP[i]=Paths[i]; }\r\n\r\n      for(; j < q.length; ++j) {\r\n        i = q[j];\r\n        L = FI[i].L; R = FI[i].R; C = FI[i].C;\r\n        if(dad[i] === i) {\r\n          if(L !== -1 /*NOSTREAM*/ && dad[L] !== L) dad[i] = dad[L];\r\n          if(R !== -1 && dad[R] !== R) dad[i] = dad[R];\r\n        }\r\n        if(C !== -1 /*NOSTREAM*/) dad[C] = i;\r\n        if(L !== -1) { dad[L] = dad[i]; if(q.lastIndexOf(L) < j) q.push(L); }\r\n        if(R !== -1) { dad[R] = dad[i]; if(q.lastIndexOf(R) < j) q.push(R); }\r\n      }\r\n      for(i=1; i < pl; ++i) if(dad[i] === i) {\r\n        if(R !== -1 /*NOSTREAM*/ && dad[R] !== R) dad[i] = dad[R];\r\n        else if(L !== -1 && dad[L] !== L) dad[i] = dad[L];\r\n      }\r\n\r\n      for(i=1; i < pl; ++i) {\r\n        if(FI[i].type === 0 /* unknown */) continue;\r\n        j = dad[i];\r\n        if(j === 0) FP[i] = FP[0] + \"/\" + FP[i];\r\n        else while(j !== 0 && j !== dad[j]) {\r\n          FP[i] = FP[j] + \"/\" + FP[i];\r\n          j = dad[j];\r\n        }\r\n        dad[i] = 0;\r\n      }\r\n\r\n      FP[0] += \"/\";\r\n      for(i=1; i < pl; ++i) {\r\n        if(FI[i].type !== 2 /* stream */) FP[i] += \"/\";\r\n      }\r\n    }\r\n\r\n    function get_mfat_entry(entry, payload, mini) {\r\n      var start = entry.start, size = entry.size;\r\n      //return (payload.slice(start*MSSZ, start*MSSZ + size));\r\n      var o = [];\r\n      var idx = start;\r\n      while(mini && size > 0 && idx >= 0) {\r\n        o.push(payload.slice(idx * MSSZ, idx * MSSZ + MSSZ));\r\n        size -= MSSZ;\r\n        idx = __readInt32LE(mini, idx * 4);\r\n      }\r\n      if(o.length === 0) return (new_buf(0));\r\n      return (bconcat(o).slice(0, entry.size));\r\n    }\r\n\r\n    /** Chase down the rest of the DIFAT chain to build a comprehensive list\r\n     DIFAT chains by storing the next sector number as the last 32 bits */\r\n    function sleuth_fat(idx, cnt, sectors, ssz, fat_addrs) {\r\n      var q = ENDOFCHAIN;\r\n      if(idx === ENDOFCHAIN) {\r\n        if(cnt !== 0) throw new Error(\"DIFAT chain shorter than expected\");\r\n      } else if(idx !== -1 /*FREESECT*/) {\r\n        var sector = sectors[idx], m = (ssz>>>2)-1;\r\n        if(!sector) return;\r\n        for(var i = 0; i < m; ++i) {\r\n          if((q = __readInt32LE(sector,i*4)) === ENDOFCHAIN) break;\r\n          fat_addrs.push(q);\r\n        }\r\n        sleuth_fat(__readInt32LE(sector,ssz-4),cnt - 1, sectors, ssz, fat_addrs);\r\n      }\r\n    }\r\n\r\n    /** Follow the linked list of sectors for a given starting point */\r\n    function get_sector_list(sectors, start, fat_addrs, ssz, chkd) {\r\n      var buf = [], buf_chain = [];\r\n      if(!chkd) chkd = [];\r\n      var modulus = ssz - 1, j = 0, jj = 0;\r\n      for(j=start; j>=0;) {\r\n        chkd[j] = true;\r\n        buf[buf.length] = j;\r\n        buf_chain.push(sectors[j]);\r\n        var addr = fat_addrs[Math.floor(j*4/ssz)];\r\n        jj = ((j*4) & modulus);\r\n        if(ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \"+ssz);\r\n        if(!sectors[addr]) break;\r\n        j = __readInt32LE(sectors[addr], jj);\r\n      }\r\n      return {nodes: buf, data:__toBuffer([buf_chain])};\r\n    }\r\n\r\n    /** Chase down the sector linked lists */\r\n    function make_sector_list(sectors, dir_start, fat_addrs, ssz) {\r\n      var sl = sectors.length, sector_list = ([]);\r\n      var chkd = [], buf = [], buf_chain = [];\r\n      var modulus = ssz - 1, i=0, j=0, k=0, jj=0;\r\n      for(i=0; i < sl; ++i) {\r\n        buf = ([]);\r\n        k = (i + dir_start); if(k >= sl) k-=sl;\r\n        if(chkd[k]) continue;\r\n        buf_chain = [];\r\n        for(j=k; j>=0;) {\r\n          chkd[j] = true;\r\n          buf[buf.length] = j;\r\n          buf_chain.push(sectors[j]);\r\n          var addr = fat_addrs[Math.floor(j*4/ssz)];\r\n          jj = ((j*4) & modulus);\r\n          if(ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \"+ssz);\r\n          if(!sectors[addr]) break;\r\n          j = __readInt32LE(sectors[addr], jj);\r\n        }\r\n        sector_list[k] = ({nodes: buf, data:__toBuffer([buf_chain])});\r\n      }\r\n      return sector_list;\r\n    }\r\n\r\n    /* [MS-CFB] 2.6.1 Compound File Directory Entry */\r\n    function read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex, mini) {\r\n      var minifat_store = 0, pl = (Paths.length?2:0);\r\n      var sector = sector_list[dir_start].data;\r\n      var i = 0, namelen = 0, name;\r\n      for(; i < sector.length; i+= 128) {\r\n        var blob = sector.slice(i, i+128);\r\n        prep_blob(blob, 64);\r\n        namelen = blob.read_shift(2);\r\n        name = __utf16le(blob,0,namelen-pl);\r\n        Paths.push(name);\r\n        var o = ({\r\n          name:  name,\r\n          type:  blob.read_shift(1),\r\n          color: blob.read_shift(1),\r\n          L:     blob.read_shift(4, 'i'),\r\n          R:     blob.read_shift(4, 'i'),\r\n          C:     blob.read_shift(4, 'i'),\r\n          clsid: blob.read_shift(16),\r\n          state: blob.read_shift(4, 'i'),\r\n          start: 0,\r\n          size: 0\r\n        });\r\n        var ctime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\r\n        if(ctime !== 0) o.ct = read_date(blob, blob.l-8);\r\n        var mtime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\r\n        if(mtime !== 0) o.mt = read_date(blob, blob.l-8);\r\n        o.start = blob.read_shift(4, 'i');\r\n        o.size = blob.read_shift(4, 'i');\r\n        if(o.size < 0 && o.start < 0) { o.size = o.type = 0; o.start = ENDOFCHAIN; o.name = \"\"; }\r\n        if(o.type === 5) { /* root */\r\n          minifat_store = o.start;\r\n          if(nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\r\n          /*minifat_size = o.size;*/\r\n        } else if(o.size >= 4096 /* MSCSZ */) {\r\n          o.storage = 'fat';\r\n          if(sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\r\n          sector_list[o.start].name = o.name;\r\n          o.content = (sector_list[o.start].data.slice(0,o.size));\r\n        } else {\r\n          o.storage = 'minifat';\r\n          if(o.size < 0) o.size = 0;\r\n          else if(minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN && sector_list[minifat_store]) {\r\n            o.content = get_mfat_entry(o, sector_list[minifat_store].data, (sector_list[mini]||{}).data);\r\n          }\r\n        }\r\n        if(o.content) prep_blob(o.content, 0);\r\n        files[name] = o;\r\n        FileIndex.push(o);\r\n      }\r\n    }\r\n\r\n    function read_date(blob, offset) {\r\n      return new Date(( ( (__readUInt32LE(blob,offset+4)/1e7)*Math.pow(2,32)+__readUInt32LE(blob,offset)/1e7 ) - 11644473600)*1000);\r\n    }\r\n\r\n    function read_file(filename, options) {\r\n      // get_fs();\r\n      return parse(fs.readFileSync(filename), options);\r\n    }\r\n\r\n    function read(blob, options) {\r\n      switch(options && options.type || \"base64\") {\r\n        case \"file\": return read_file(blob, options);\r\n        case \"base64\": return parse(s2a(Base64.decode(blob)), options);\r\n        case \"binary\": return parse(s2a(blob), options);\r\n      }\r\n      return parse(blob, options);\r\n    }\r\n\r\n    function init_cfb(cfb, opts) {\r\n      var o = opts || {}, root = o.root || \"Root Entry\";\r\n      if(!cfb.FullPaths) cfb.FullPaths = [];\r\n      if(!cfb.FileIndex) cfb.FileIndex = [];\r\n      if(cfb.FullPaths.length !== cfb.FileIndex.length) throw new Error(\"inconsistent CFB structure\");\r\n      if(cfb.FullPaths.length === 0) {\r\n        cfb.FullPaths[0] = root + \"/\";\r\n        cfb.FileIndex[0] = ({ name: root, type: 5 });\r\n      }\r\n      if(o.CLSID) cfb.FileIndex[0].clsid = o.CLSID;\r\n      seed_cfb(cfb);\r\n    }\r\n    function seed_cfb(cfb) {\r\n      var nm = \"\\u0001Sh33tJ5\";\r\n      if(CFB.find(cfb, \"/\" + nm)) return;\r\n      var p = new_buf(4); p[0] = 55; p[1] = p[3] = 50; p[2] = 54;\r\n      cfb.FileIndex.push(({ name: nm, type: 2, content:p, size:4, L:69, R:69, C:69 }));\r\n      cfb.FullPaths.push(cfb.FullPaths[0] + nm);\r\n      rebuild_cfb(cfb);\r\n    }\r\n    function rebuild_cfb(cfb, f) {\r\n      init_cfb(cfb);\r\n      var gc = false, s = false;\r\n      for(var i = cfb.FullPaths.length - 1; i >= 0; --i) {\r\n        var _file = cfb.FileIndex[i];\r\n        switch(_file.type) {\r\n          case 0:\r\n            if(s) gc = true;\r\n            else { cfb.FileIndex.pop(); cfb.FullPaths.pop(); }\r\n            break;\r\n          case 1: case 2: case 5:\r\n            s = true;\r\n            if(isNaN(_file.R * _file.L * _file.C)) gc = true;\r\n            if(_file.R > -1 && _file.L > -1 && _file.R == _file.L) gc = true;\r\n            break;\r\n          default: gc = true; break;\r\n        }\r\n      }\r\n      if(!gc && !f) return;\r\n\r\n      var now = new Date(1987, 1, 19), j = 0;\r\n      var data = [];\r\n      for(i = 0; i < cfb.FullPaths.length; ++i) {\r\n        if(cfb.FileIndex[i].type === 0) continue;\r\n        data.push([cfb.FullPaths[i], cfb.FileIndex[i]]);\r\n      }\r\n      for(i = 0; i < data.length; ++i) {\r\n        var dad = dirname(data[i][0]);\r\n        s = false;\r\n        for(j = 0; j < data.length; ++j) if(data[j][0] === dad) s = true;\r\n        if(!s) data.push([dad, ({\r\n          name: filename(dad).replace(\"/\",\"\"),\r\n          type: 1,\r\n          clsid: HEADER_CLSID,\r\n          ct: now, mt: now,\r\n          content: null\r\n        })]);\r\n      }\r\n\r\n      data.sort(function(x,y) { return namecmp(x[0], y[0]); });\r\n      cfb.FullPaths = []; cfb.FileIndex = [];\r\n      for(i = 0; i < data.length; ++i) { cfb.FullPaths[i] = data[i][0]; cfb.FileIndex[i] = data[i][1]; }\r\n      for(i = 0; i < data.length; ++i) {\r\n        var elt = cfb.FileIndex[i];\r\n        var nm = cfb.FullPaths[i];\r\n\r\n        elt.name =  filename(nm).replace(\"/\",\"\");\r\n        elt.L = elt.R = elt.C = -(elt.color = 1);\r\n        elt.size = elt.content ? elt.content.length : 0;\r\n        elt.start = 0;\r\n        elt.clsid = (elt.clsid || HEADER_CLSID);\r\n        if(i === 0) {\r\n          elt.C = data.length > 1 ? 1 : -1;\r\n          elt.size = 0;\r\n          elt.type = 5;\r\n        } else if(nm.slice(-1) == \"/\") {\r\n          for(j=i+1;j < data.length; ++j) if(dirname(cfb.FullPaths[j])==nm) break;\r\n          elt.C = j >= data.length ? -1 : j;\r\n          for(j=i+1;j < data.length; ++j) if(dirname(cfb.FullPaths[j])==dirname(nm)) break;\r\n          elt.R = j >= data.length ? -1 : j;\r\n          elt.type = 1;\r\n        } else {\r\n          if(dirname(cfb.FullPaths[i+1]||\"\") == dirname(nm)) elt.R = i + 1;\r\n          elt.type = 2;\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    function _write(cfb, options) {\r\n      var _opts = options || {};\r\n      rebuild_cfb(cfb);\r\n      if(_opts.fileType == 'zip') return write_zip(cfb, _opts);\r\n      var L = (function(cfb){\r\n        var mini_size = 0, fat_size = 0;\r\n        for(var i = 0; i < cfb.FileIndex.length; ++i) {\r\n          var file = cfb.FileIndex[i];\r\n          if(!file.content) continue;\r\n          var flen = file.content.length;\r\n          if(flen > 0){\r\n            if(flen < 0x1000) mini_size += (flen + 0x3F) >> 6;\r\n            else fat_size += (flen + 0x01FF) >> 9;\r\n          }\r\n        }\r\n        var dir_cnt = (cfb.FullPaths.length +3) >> 2;\r\n        var mini_cnt = (mini_size + 7) >> 3;\r\n        var mfat_cnt = (mini_size + 0x7F) >> 7;\r\n        var fat_base = mini_cnt + fat_size + dir_cnt + mfat_cnt;\r\n        var fat_cnt = (fat_base + 0x7F) >> 7;\r\n        var difat_cnt = fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt-109)/0x7F);\r\n        while(((fat_base + fat_cnt + difat_cnt + 0x7F) >> 7) > fat_cnt) difat_cnt = ++fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt-109)/0x7F);\r\n        var L =  [1, difat_cnt, fat_cnt, mfat_cnt, dir_cnt, fat_size, mini_size, 0];\r\n        cfb.FileIndex[0].size = mini_size << 6;\r\n        L[7] = (cfb.FileIndex[0].start=L[0]+L[1]+L[2]+L[3]+L[4]+L[5])+((L[6]+7) >> 3);\r\n        return L;\r\n      })(cfb);\r\n      var o = new_buf(L[7] << 9);\r\n      var i = 0, T = 0;\r\n      {\r\n        for(i = 0; i < 8; ++i) o.write_shift(1, HEADER_SIG[i]);\r\n        for(i = 0; i < 8; ++i) o.write_shift(2, 0);\r\n        o.write_shift(2, 0x003E);\r\n        o.write_shift(2, 0x0003);\r\n        o.write_shift(2, 0xFFFE);\r\n        o.write_shift(2, 0x0009);\r\n        o.write_shift(2, 0x0006);\r\n        for(i = 0; i < 3; ++i) o.write_shift(2, 0);\r\n        o.write_shift(4, 0);\r\n        o.write_shift(4, L[2]);\r\n        o.write_shift(4, L[0] + L[1] + L[2] + L[3] - 1);\r\n        o.write_shift(4, 0);\r\n        o.write_shift(4, 1<<12);\r\n        o.write_shift(4, L[3] ? L[0] + L[1] + L[2] - 1: ENDOFCHAIN);\r\n        o.write_shift(4, L[3]);\r\n        o.write_shift(-4, L[1] ? L[0] - 1: ENDOFCHAIN);\r\n        o.write_shift(4, L[1]);\r\n        for(i = 0; i < 109; ++i) o.write_shift(-4, i < L[2] ? L[1] + i : -1);\r\n      }\r\n      if(L[1]) {\r\n        for(T = 0; T < L[1]; ++T) {\r\n          for(; i < 236 + T * 127; ++i) o.write_shift(-4, i < L[2] ? L[1] + i : -1);\r\n          o.write_shift(-4, T === L[1] - 1 ? ENDOFCHAIN : T + 1);\r\n        }\r\n      }\r\n      var chainit = function(w) {\r\n        for(T += w; i<T-1; ++i) o.write_shift(-4, i+1);\r\n        if(w) { ++i; o.write_shift(-4, ENDOFCHAIN); }\r\n      };\r\n      T = i = 0;\r\n      for(T+=L[1]; i<T; ++i) o.write_shift(-4, consts.DIFSECT);\r\n      for(T+=L[2]; i<T; ++i) o.write_shift(-4, consts.FATSECT);\r\n      chainit(L[3]);\r\n      chainit(L[4]);\r\n      var j = 0, flen = 0;\r\n      var file = cfb.FileIndex[0];\r\n      for(; j < cfb.FileIndex.length; ++j) {\r\n        file = cfb.FileIndex[j];\r\n        if(!file.content) continue;\r\n        flen = file.content.length;\r\n        if(flen < 0x1000) continue;\r\n        file.start = T;\r\n        chainit((flen + 0x01FF) >> 9);\r\n      }\r\n      chainit((L[6] + 7) >> 3);\r\n      while(o.l & 0x1FF) o.write_shift(-4, consts.ENDOFCHAIN);\r\n      T = i = 0;\r\n      for(j = 0; j < cfb.FileIndex.length; ++j) {\r\n        file = cfb.FileIndex[j];\r\n        if(!file.content) continue;\r\n        flen = file.content.length;\r\n        if(!flen || flen >= 0x1000) continue;\r\n        file.start = T;\r\n        chainit((flen + 0x3F) >> 6);\r\n      }\r\n      while(o.l & 0x1FF) o.write_shift(-4, consts.ENDOFCHAIN);\r\n      for(i = 0; i < L[4]<<2; ++i) {\r\n        var nm = cfb.FullPaths[i];\r\n        if(!nm || nm.length === 0) {\r\n          for(j = 0; j < 17; ++j) o.write_shift(4, 0);\r\n          for(j = 0; j < 3; ++j) o.write_shift(4, -1);\r\n          for(j = 0; j < 12; ++j) o.write_shift(4, 0);\r\n          continue;\r\n        }\r\n        file = cfb.FileIndex[i];\r\n        if(i === 0) file.start = file.size ? file.start - 1 : ENDOFCHAIN;\r\n        var _nm = (i === 0 && _opts.root) || file.name;\r\n        flen = 2*(_nm.length+1);\r\n        o.write_shift(64, _nm, \"utf16le\");\r\n        o.write_shift(2, flen);\r\n        o.write_shift(1, file.type);\r\n        o.write_shift(1, file.color);\r\n        o.write_shift(-4, file.L);\r\n        o.write_shift(-4, file.R);\r\n        o.write_shift(-4, file.C);\r\n        if(!file.clsid) for(j = 0; j < 4; ++j) o.write_shift(4, 0);\r\n        else o.write_shift(16, file.clsid, \"hex\");\r\n        o.write_shift(4, file.state || 0);\r\n        o.write_shift(4, 0); o.write_shift(4, 0);\r\n        o.write_shift(4, 0); o.write_shift(4, 0);\r\n        o.write_shift(4, file.start);\r\n        o.write_shift(4, file.size); o.write_shift(4, 0);\r\n      }\r\n      for(i = 1; i < cfb.FileIndex.length; ++i) {\r\n        file = cfb.FileIndex[i];\r\n        if(file.size >= 0x1000) {\r\n          o.l = (file.start+1) << 9;\r\n          for(j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);\r\n          for(; j & 0x1FF; ++j) o.write_shift(1, 0);\r\n        }\r\n      }\r\n      for(i = 1; i < cfb.FileIndex.length; ++i) {\r\n        file = cfb.FileIndex[i];\r\n        if(file.size > 0 && file.size < 0x1000) {\r\n          for(j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);\r\n          for(; j & 0x3F; ++j) o.write_shift(1, 0);\r\n        }\r\n      }\r\n      while(o.l < o.length) o.write_shift(1, 0);\r\n      return o;\r\n    }\r\n    /* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\r\n    function find(cfb, path) {\r\n      var UCFullPaths = cfb.FullPaths.map(function(x) { return x.toUpperCase(); });\r\n      var UCPaths = UCFullPaths.map(function(x) { var y = x.split(\"/\"); return y[y.length - (x.slice(-1) == \"/\" ? 2 : 1)]; });\r\n      var k = false;\r\n      if(path.charCodeAt(0) === 47 /* \"/\" */) { k = true; path = UCFullPaths[0].slice(0, -1) + path; }\r\n      else k = path.indexOf(\"/\") !== -1;\r\n      var UCPath = path.toUpperCase();\r\n      var w = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\r\n      if(w !== -1) return cfb.FileIndex[w];\r\n\r\n      var m = !UCPath.match(chr1);\r\n      UCPath = UCPath.replace(chr0,'');\r\n      if(m) UCPath = UCPath.replace(chr1,'!');\r\n      for(w = 0; w < UCFullPaths.length; ++w) {\r\n        if((m ? UCFullPaths[w].replace(chr1,'!') : UCFullPaths[w]).replace(chr0,'') == UCPath) return cfb.FileIndex[w];\r\n        if((m ? UCPaths[w].replace(chr1,'!') : UCPaths[w]).replace(chr0,'') == UCPath) return cfb.FileIndex[w];\r\n      }\r\n      return null;\r\n    }\r\n    /** CFB Constants */\r\n    var MSSZ = 64; /* Mini Sector Size = 1<<6 */\r\n//var MSCSZ = 4096; /* Mini Stream Cutoff Size */\r\n    /* 2.1 Compound File Sector Numbers and Types */\r\n    var ENDOFCHAIN = -2;\r\n    /* 2.2 Compound File Header */\r\n    var HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\r\n    var HEADER_SIG = [0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1];\r\n    var HEADER_CLSID = '00000000000000000000000000000000';\r\n    var consts = {\r\n      /* 2.1 Compund File Sector Numbers and Types */\r\n      MAXREGSECT: -6,\r\n      DIFSECT: -4,\r\n      FATSECT: -3,\r\n      ENDOFCHAIN: ENDOFCHAIN,\r\n      FREESECT: -1,\r\n      /* 2.2 Compound File Header */\r\n      HEADER_SIGNATURE: HEADER_SIGNATURE,\r\n      HEADER_MINOR_VERSION: '3e00',\r\n      MAXREGSID: -6,\r\n      NOSTREAM: -1,\r\n      HEADER_CLSID: HEADER_CLSID,\r\n      /* 2.6.1 Compound File Directory Entry */\r\n      EntryTypes: ['unknown','storage','stream','lockbytes','property','root']\r\n    };\r\n\r\n    function write_file(cfb, filename, options) {\r\n      // get_fs();\r\n      var o = _write(cfb, options);\r\n      fs.writeFileSync(filename, o);\r\n    }\r\n\r\n    function a2s(o) {\r\n      var out = new Array(o.length);\r\n      for(var i = 0; i < o.length; ++i) out[i] = String.fromCharCode(o[i]);\r\n      return out.join(\"\");\r\n    }\r\n\r\n    function write(cfb, options) {\r\n      var o = _write(cfb, options);\r\n      switch(options && options.type) {\r\n        case \"file\": /*get_fs();*/ fs.writeFileSync(options.filename, (o)); return o;\r\n        case \"binary\": return a2s(o);\r\n        case \"base64\": return Base64.encode(a2s(o));\r\n      }\r\n      return o;\r\n    }\r\n    /* node < 8.1 zlib does not expose bytesRead, so default to pure JS */\r\n    var _zlib;\r\n    function use_zlib(zlib) { try {\r\n      var InflateRaw = zlib.InflateRaw;\r\n      var InflRaw = new InflateRaw();\r\n      InflRaw._processChunk(new Uint8Array([3, 0]), InflRaw._finishFlushFlag);\r\n      if(InflRaw.bytesRead) _zlib = zlib;\r\n      else throw new Error(\"zlib does not expose bytesRead\");\r\n    } catch(e) {console.error(\"cannot use native zlib: \" + (e.message || e)); } }\r\n\r\n    function _inflateRawSync(payload, usz) {\r\n      if(!_zlib) return _inflate(payload, usz);\r\n      var InflateRaw = _zlib.InflateRaw;\r\n      var InflRaw = new InflateRaw();\r\n      var out = InflRaw._processChunk(payload.slice(payload.l), InflRaw._finishFlushFlag);\r\n      payload.l += InflRaw.bytesRead;\r\n      return out;\r\n    }\r\n\r\n    function _deflateRawSync(payload) {\r\n      return _zlib ? _zlib.deflateRawSync(payload) : _deflate(payload);\r\n    }\r\n    var CLEN_ORDER = [ 16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15 ];\r\n\r\n    /*  LEN_ID = [ 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285 ]; */\r\n    var LEN_LN = [   3,   4,   5,   6,   7,   8,   9,  10,  11,  13 , 15,  17,  19,  23,  27,  31,  35,  43,  51,  59,  67,  83,  99, 115, 131, 163, 195, 227, 258 ];\r\n\r\n    /*  DST_ID = [  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13,  14,  15,  16,  17,  18,  19,   20,   21,   22,   23,   24,   25,   26,    27,    28,    29 ]; */\r\n    var DST_LN = [  1,  2,  3,  4,  5,  7,  9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577 ];\r\n\r\n    function bit_swap_8(n) { var t = (((((n<<1)|(n<<11)) & 0x22110) | (((n<<5)|(n<<15)) & 0x88440))); return ((t>>16) | (t>>8) |t)&0xFF; }\r\n\r\n    var use_typed_arrays = typeof Uint8Array !== 'undefined';\r\n\r\n    var bitswap8 = use_typed_arrays ? new Uint8Array(1<<8) : [];\r\n    for(var q = 0; q < (1<<8); ++q) bitswap8[q] = bit_swap_8(q);\r\n\r\n    function bit_swap_n(n, b) {\r\n      var rev = bitswap8[n & 0xFF];\r\n      if(b <= 8) return rev >>> (8-b);\r\n      rev = (rev << 8) | bitswap8[(n>>8)&0xFF];\r\n      if(b <= 16) return rev >>> (16-b);\r\n      rev = (rev << 8) | bitswap8[(n>>16)&0xFF];\r\n      return rev >>> (24-b);\r\n    }\r\n\r\n    /* helpers for unaligned bit reads */\r\n    function read_bits_2(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 6 ? 0 : buf[h+1]<<8))>>>w)& 0x03; }\r\n    function read_bits_3(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 5 ? 0 : buf[h+1]<<8))>>>w)& 0x07; }\r\n    function read_bits_4(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 4 ? 0 : buf[h+1]<<8))>>>w)& 0x0F; }\r\n    function read_bits_5(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 3 ? 0 : buf[h+1]<<8))>>>w)& 0x1F; }\r\n    function read_bits_7(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 1 ? 0 : buf[h+1]<<8))>>>w)& 0x7F; }\r\n\r\n    /* works up to n = 3 * 8 + 1 = 25 */\r\n    function read_bits_n(buf, bl, n) {\r\n      var w = (bl&7), h = (bl>>>3), f = ((1<<n)-1);\r\n      var v = buf[h] >>> w;\r\n      if(n < 8 - w) return v & f;\r\n      v |= buf[h+1]<<(8-w);\r\n      if(n < 16 - w) return v & f;\r\n      v |= buf[h+2]<<(16-w);\r\n      if(n < 24 - w) return v & f;\r\n      v |= buf[h+3]<<(24-w);\r\n      return v & f;\r\n    }\r\n\r\n    /* until ArrayBuffer#realloc is a thing, fake a realloc */\r\n    function realloc(b, sz) {\r\n      var L = b.length, M = 2*L > sz ? 2*L : sz + 5, i = 0;\r\n      if(L >= sz) return b;\r\n      if(has_buf) {\r\n        var o = new_unsafe_buf(M);\r\n        // $FlowIgnore\r\n        if(b.copy) b.copy(o);\r\n        else for(; i < b.length; ++i) o[i] = b[i];\r\n        return o;\r\n      } else if(use_typed_arrays) {\r\n        var a = new Uint8Array(M);\r\n        if(a.set) a.set(b);\r\n        else for(; i < b.length; ++i) a[i] = b[i];\r\n        return a;\r\n      }\r\n      b.length = M;\r\n      return b;\r\n    }\r\n\r\n    /* zero-filled arrays for older browsers */\r\n    function zero_fill_array(n) {\r\n      var o = new Array(n);\r\n      for(var i = 0; i < n; ++i) o[i] = 0;\r\n      return o;\r\n    }var _deflate = (function() {\r\n      var _deflateRaw = (function() {\r\n        return function deflateRaw(data, out) {\r\n          var boff = 0;\r\n          while(boff < data.length) {\r\n            var L = Math.min(0xFFFF, data.length - boff);\r\n            var h = boff + L == data.length;\r\n            /* TODO: this is only type 0 stored */\r\n            out.write_shift(1, +h);\r\n            out.write_shift(2, L);\r\n            out.write_shift(2, (~L) & 0xFFFF);\r\n            while(L-- > 0) out[out.l++] = data[boff++];\r\n          }\r\n          return out.l;\r\n        };\r\n      })();\r\n\r\n      return function(data) {\r\n        var buf = new_buf(50+Math.floor(data.length*1.1));\r\n        var off = _deflateRaw(data, buf);\r\n        return buf.slice(0, off);\r\n      };\r\n    })();\r\n    /* modified inflate function also moves original read head */\r\n\r\n    /* build tree (used for literals and lengths) */\r\n    function build_tree(clens, cmap, MAX) {\r\n      var maxlen = 1, w = 0, i = 0, j = 0, ccode = 0, L = clens.length;\r\n\r\n      var bl_count  = use_typed_arrays ? new Uint16Array(32) : zero_fill_array(32);\r\n      for(i = 0; i < 32; ++i) bl_count[i] = 0;\r\n\r\n      for(i = L; i < MAX; ++i) clens[i] = 0;\r\n      L = clens.length;\r\n\r\n      var ctree = use_typed_arrays ? new Uint16Array(L) : zero_fill_array(L); // []\r\n\r\n      /* build code tree */\r\n      for(i = 0; i < L; ++i) {\r\n        bl_count[(w = clens[i])]++;\r\n        if(maxlen < w) maxlen = w;\r\n        ctree[i] = 0;\r\n      }\r\n      bl_count[0] = 0;\r\n      for(i = 1; i <= maxlen; ++i) bl_count[i+16] = (ccode = (ccode + bl_count[i-1])<<1);\r\n      for(i = 0; i < L; ++i) {\r\n        ccode = clens[i];\r\n        if(ccode != 0) ctree[i] = bl_count[ccode+16]++;\r\n      }\r\n\r\n      /* cmap[maxlen + 4 bits] = (off&15) + (lit<<4) reverse mapping */\r\n      var cleni = 0;\r\n      for(i = 0; i < L; ++i) {\r\n        cleni = clens[i];\r\n        if(cleni != 0) {\r\n          ccode = bit_swap_n(ctree[i], maxlen)>>(maxlen-cleni);\r\n          for(j = (1<<(maxlen + 4 - cleni)) - 1; j>=0; --j)\r\n            cmap[ccode|(j<<cleni)] = (cleni&15) | (i<<4);\r\n        }\r\n      }\r\n      return maxlen;\r\n    }\r\n\r\n    var fix_lmap = use_typed_arrays ? new Uint16Array(512) : zero_fill_array(512);\r\n    var fix_dmap = use_typed_arrays ? new Uint16Array(32)  : zero_fill_array(32);\r\n    if(!use_typed_arrays) {\r\n      for(var i = 0; i < 512; ++i) fix_lmap[i] = 0;\r\n      for(i = 0; i < 32; ++i) fix_dmap[i] = 0;\r\n    }\r\n    (function() {\r\n      var dlens = [];\r\n      var i = 0;\r\n      for(;i<32; i++) dlens.push(5);\r\n      build_tree(dlens, fix_dmap, 32);\r\n\r\n      var clens = [];\r\n      i = 0;\r\n      for(; i<=143; i++) clens.push(8);\r\n      for(; i<=255; i++) clens.push(9);\r\n      for(; i<=279; i++) clens.push(7);\r\n      for(; i<=287; i++) clens.push(8);\r\n      build_tree(clens, fix_lmap, 288);\r\n    })();\r\n\r\n    var dyn_lmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\r\n    var dyn_dmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\r\n    var dyn_cmap = use_typed_arrays ? new Uint16Array(128)   : zero_fill_array(128);\r\n    var dyn_len_1 = 1, dyn_len_2 = 1;\r\n\r\n    /* 5.5.3 Expanding Huffman Codes */\r\n    function dyn(data, boff) {\r\n      /* nomenclature from RFC1951 refers to bit values; these are offset by the implicit constant */\r\n      var _HLIT = read_bits_5(data, boff) + 257; boff += 5;\r\n      var _HDIST = read_bits_5(data, boff) + 1; boff += 5;\r\n      var _HCLEN = read_bits_4(data, boff) + 4; boff += 4;\r\n      var w = 0;\r\n\r\n      /* grab and store code lengths */\r\n      var clens = use_typed_arrays ? new Uint8Array(19) : zero_fill_array(19);\r\n      var ctree = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];\r\n      var maxlen = 1;\r\n      var bl_count =  use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\r\n      var next_code = use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\r\n      var L = clens.length; /* 19 */\r\n      for(var i = 0; i < _HCLEN; ++i) {\r\n        clens[CLEN_ORDER[i]] = w = read_bits_3(data, boff);\r\n        if(maxlen < w) maxlen = w;\r\n        bl_count[w]++;\r\n        boff += 3;\r\n      }\r\n\r\n      /* build code tree */\r\n      var ccode = 0;\r\n      bl_count[0] = 0;\r\n      for(i = 1; i <= maxlen; ++i) next_code[i] = ccode = (ccode + bl_count[i-1])<<1;\r\n      for(i = 0; i < L; ++i) if((ccode = clens[i]) != 0) ctree[i] = next_code[ccode]++;\r\n      /* cmap[7 bits from stream] = (off&7) + (lit<<3) */\r\n      var cleni = 0;\r\n      for(i = 0; i < L; ++i) {\r\n        cleni = clens[i];\r\n        if(cleni != 0) {\r\n          ccode = bitswap8[ctree[i]]>>(8-cleni);\r\n          for(var j = (1<<(7-cleni))-1; j>=0; --j) dyn_cmap[ccode|(j<<cleni)] = (cleni&7) | (i<<3);\r\n        }\r\n      }\r\n\r\n      /* read literal and dist codes at once */\r\n      var hcodes = [];\r\n      maxlen = 1;\r\n      for(; hcodes.length < _HLIT + _HDIST;) {\r\n        ccode = dyn_cmap[read_bits_7(data, boff)];\r\n        boff += ccode & 7;\r\n        switch((ccode >>>= 3)) {\r\n          case 16:\r\n            w = 3 + read_bits_2(data, boff); boff += 2;\r\n            ccode = hcodes[hcodes.length - 1];\r\n            while(w-- > 0) hcodes.push(ccode);\r\n            break;\r\n          case 17:\r\n            w = 3 + read_bits_3(data, boff); boff += 3;\r\n            while(w-- > 0) hcodes.push(0);\r\n            break;\r\n          case 18:\r\n            w = 11 + read_bits_7(data, boff); boff += 7;\r\n            while(w -- > 0) hcodes.push(0);\r\n            break;\r\n          default:\r\n            hcodes.push(ccode);\r\n            if(maxlen < ccode) maxlen = ccode;\r\n            break;\r\n        }\r\n      }\r\n\r\n      /* build literal / length trees */\r\n      var h1 = hcodes.slice(0, _HLIT), h2 = hcodes.slice(_HLIT);\r\n      for(i = _HLIT; i < 286; ++i) h1[i] = 0;\r\n      for(i = _HDIST; i < 30; ++i) h2[i] = 0;\r\n      dyn_len_1 = build_tree(h1, dyn_lmap, 286);\r\n      dyn_len_2 = build_tree(h2, dyn_dmap, 30);\r\n      return boff;\r\n    }\r\n\r\n    /* return [ data, bytesRead ] */\r\n    function inflate(data, usz) {\r\n      /* shortcircuit for empty buffer [0x03, 0x00] */\r\n      if(data[0] == 3 && !(data[1] & 0x3)) { return [new_raw_buf(usz), 2]; }\r\n\r\n      /* bit offset */\r\n      var boff = 0;\r\n\r\n      /* header includes final bit and type bits */\r\n      var header = 0;\r\n\r\n      var outbuf = new_unsafe_buf(usz ? usz : (1<<18));\r\n      var woff = 0;\r\n      var OL = outbuf.length>>>0;\r\n      var max_len_1 = 0, max_len_2 = 0;\r\n\r\n      while((header&1) == 0) {\r\n        header = read_bits_3(data, boff); boff += 3;\r\n        if((header >>> 1) == 0) {\r\n          /* Stored block */\r\n          if(boff & 7) boff += 8 - (boff&7);\r\n          /* 2 bytes sz, 2 bytes bit inverse */\r\n          var sz = data[boff>>>3] | data[(boff>>>3)+1]<<8;\r\n          boff += 32;\r\n          /* push sz bytes */\r\n          if(!usz && OL < woff + sz) { outbuf = realloc(outbuf, woff + sz); OL = outbuf.length; }\r\n          if(typeof data.copy === 'function') {\r\n            // $FlowIgnore\r\n            data.copy(outbuf, woff, boff>>>3, (boff>>>3)+sz);\r\n            woff += sz; boff += 8*sz;\r\n          } else while(sz-- > 0) { outbuf[woff++] = data[boff>>>3]; boff += 8; }\r\n          continue;\r\n        } else if((header >>> 1) == 1) {\r\n          /* Fixed Huffman */\r\n          max_len_1 = 9; max_len_2 = 5;\r\n        } else {\r\n          /* Dynamic Huffman */\r\n          boff = dyn(data, boff);\r\n          max_len_1 = dyn_len_1; max_len_2 = dyn_len_2;\r\n        }\r\n        if(!usz && (OL < woff + 32767)) { outbuf = realloc(outbuf, woff + 32767); OL = outbuf.length; }\r\n        for(;;) { // while(true) is apparently out of vogue in modern JS circles\r\n          /* ingest code and move read head */\r\n          var bits = read_bits_n(data, boff, max_len_1);\r\n          var code = (header>>>1) == 1 ? fix_lmap[bits] : dyn_lmap[bits];\r\n          boff += code & 15; code >>>= 4;\r\n          /* 0-255 are literals, 256 is end of block token, 257+ are copy tokens */\r\n          if(((code>>>8)&0xFF) === 0) outbuf[woff++] = code;\r\n          else if(code == 256) break;\r\n          else {\r\n            code -= 257;\r\n            var len_eb = (code < 8) ? 0 : ((code-4)>>2); if(len_eb > 5) len_eb = 0;\r\n            var tgt = woff + LEN_LN[code];\r\n            /* length extra bits */\r\n            if(len_eb > 0) {\r\n              tgt += read_bits_n(data, boff, len_eb);\r\n              boff += len_eb;\r\n            }\r\n\r\n            /* dist code */\r\n            bits = read_bits_n(data, boff, max_len_2);\r\n            code = (header>>>1) == 1 ? fix_dmap[bits] : dyn_dmap[bits];\r\n            boff += code & 15; code >>>= 4;\r\n            var dst_eb = (code < 4 ? 0 : (code-2)>>1);\r\n            var dst = DST_LN[code];\r\n            /* dist extra bits */\r\n            if(dst_eb > 0) {\r\n              dst += read_bits_n(data, boff, dst_eb);\r\n              boff += dst_eb;\r\n            }\r\n\r\n            /* in the common case, manual byte copy is faster than TA set / Buffer copy */\r\n            if(!usz && OL < tgt) { outbuf = realloc(outbuf, tgt); OL = outbuf.length; }\r\n            while(woff < tgt) { outbuf[woff] = outbuf[woff - dst]; ++woff; }\r\n          }\r\n        }\r\n      }\r\n      return [usz ? outbuf : outbuf.slice(0, woff), (boff+7)>>>3];\r\n    }\r\n\r\n    function _inflate(payload, usz) {\r\n      var data = payload.slice(payload.l||0);\r\n      var out = inflate(data, usz);\r\n      payload.l += out[1];\r\n      return out[0];\r\n    }\r\n\r\n    function warn_or_throw(wrn, msg) {\r\n      if(wrn) { if(typeof console !== 'undefined') console.error(msg); }\r\n      else throw new Error(msg);\r\n    }\r\n\r\n    function parse_zip(file, options) {\r\n      var blob = file;\r\n      prep_blob(blob, 0);\r\n\r\n      var FileIndex = [], FullPaths = [];\r\n      var o = {\r\n        FileIndex: FileIndex,\r\n        FullPaths: FullPaths\r\n      };\r\n      init_cfb(o, { root: options.root });\r\n\r\n      /* find end of central directory, start just after signature */\r\n      var i = blob.length - 4;\r\n      while((blob[i] != 0x50 || blob[i+1] != 0x4b || blob[i+2] != 0x05 || blob[i+3] != 0x06) && i >= 0) --i;\r\n      blob.l = i + 4;\r\n\r\n      /* parse end of central directory */\r\n      blob.l += 4;\r\n      var fcnt = blob.read_shift(2);\r\n      blob.l += 6;\r\n      var start_cd = blob.read_shift(4);\r\n\r\n      /* parse central directory */\r\n      blob.l = start_cd;\r\n\r\n      for(i = 0; i < fcnt; ++i) {\r\n        /* trust local file header instead of CD entry */\r\n        blob.l += 20;\r\n        var csz = blob.read_shift(4);\r\n        var usz = blob.read_shift(4);\r\n        var namelen = blob.read_shift(2);\r\n        var efsz = blob.read_shift(2);\r\n        var fcsz = blob.read_shift(2);\r\n        blob.l += 8;\r\n        var offset = blob.read_shift(4);\r\n        var EF = parse_extra_field(blob.slice(blob.l+namelen, blob.l+namelen+efsz));\r\n        blob.l += namelen + efsz + fcsz;\r\n\r\n        var L = blob.l;\r\n        blob.l = offset + 4;\r\n        parse_local_file(blob, csz, usz, o, EF);\r\n        blob.l = L;\r\n      }\r\n\r\n      return o;\r\n    }\r\n\r\n\r\n    /* head starts just after local file header signature */\r\n    function parse_local_file(blob, csz, usz, o, EF) {\r\n      /* [local file header] */\r\n      blob.l += 2;\r\n      var flags = blob.read_shift(2);\r\n      var meth = blob.read_shift(2);\r\n      var date = parse_dos_date(blob);\r\n\r\n      if(flags & 0x2041) throw new Error(\"Unsupported ZIP encryption\");\r\n      var crc32 = blob.read_shift(4);\r\n      var _csz = blob.read_shift(4);\r\n      var _usz = blob.read_shift(4);\r\n\r\n      var namelen = blob.read_shift(2);\r\n      var efsz = blob.read_shift(2);\r\n\r\n      // TODO: flags & (1<<11) // UTF8\r\n      var name = \"\"; for(var i = 0; i < namelen; ++i) name += String.fromCharCode(blob[blob.l++]);\r\n      if(efsz) {\r\n        var ef = parse_extra_field(blob.slice(blob.l, blob.l + efsz));\r\n        if((ef[0x5455]||{}).mt) date = ef[0x5455].mt;\r\n        if(((EF||{})[0x5455]||{}).mt) date = EF[0x5455].mt;\r\n      }\r\n      blob.l += efsz;\r\n\r\n      /* [encryption header] */\r\n\r\n      /* [file data] */\r\n      var data = blob.slice(blob.l, blob.l + _csz);\r\n      switch(meth) {\r\n        case 8: data = _inflateRawSync(blob, _usz); break;\r\n        case 0: break;\r\n        default: throw new Error(\"Unsupported ZIP Compression method \" + meth);\r\n      }\r\n\r\n      /* [data descriptor] */\r\n      var wrn = false;\r\n      if(flags & 8) {\r\n        crc32 = blob.read_shift(4);\r\n        if(crc32 == 0x08074b50) { crc32 = blob.read_shift(4); wrn = true; }\r\n        _csz = blob.read_shift(4);\r\n        _usz = blob.read_shift(4);\r\n      }\r\n\r\n      if(_csz != csz) warn_or_throw(wrn, \"Bad compressed size: \" + csz + \" != \" + _csz);\r\n      if(_usz != usz) warn_or_throw(wrn, \"Bad uncompressed size: \" + usz + \" != \" + _usz);\r\n      var _crc32 = CRC32.buf(data, 0);\r\n      if(crc32 != _crc32) warn_or_throw(wrn, \"Bad CRC32 checksum: \" + crc32 + \" != \" + _crc32);\r\n      cfb_add(o, name, data, {unsafe: true, mt: date});\r\n    }\r\n    function write_zip(cfb, options) {\r\n      var _opts = options || {};\r\n      var out = [], cdirs = [];\r\n      var o = new_buf(1);\r\n      var method = (_opts.compression ? 8 : 0), flags = 0;\r\n      var desc = false;\r\n      if(desc) flags |= 8;\r\n      var i = 0, j = 0;\r\n\r\n      var start_cd = 0, fcnt = 0;\r\n      var root = cfb.FullPaths[0], fp = root, fi = cfb.FileIndex[0];\r\n      var crcs = [];\r\n      var sz_cd = 0;\r\n\r\n      for(i = 1; i < cfb.FullPaths.length; ++i) {\r\n        fp = cfb.FullPaths[i].slice(root.length); fi = cfb.FileIndex[i];\r\n        if(!fi.size || !fi.content || fp == \"\\u0001Sh33tJ5\") continue;\r\n        var start = start_cd;\r\n\r\n        /* TODO: CP437 filename */\r\n        var namebuf = new_buf(fp.length);\r\n        for(j = 0; j < fp.length; ++j) namebuf.write_shift(1, fp.charCodeAt(j) & 0x7F);\r\n        namebuf = namebuf.slice(0, namebuf.l);\r\n        crcs[fcnt] = CRC32.buf(fi.content, 0);\r\n\r\n        var outbuf = fi.content;\r\n        if(method == 8) outbuf = _deflateRawSync(outbuf);\r\n\r\n        /* local file header */\r\n        o = new_buf(30);\r\n        o.write_shift(4, 0x04034b50);\r\n        o.write_shift(2, 20);\r\n        o.write_shift(2, flags);\r\n        o.write_shift(2, method);\r\n        /* TODO: last mod file time/date */\r\n        if(fi.mt) write_dos_date(o, fi.mt);\r\n        else o.write_shift(4, 0);\r\n        o.write_shift(-4, (flags & 8) ? 0 : crcs[fcnt]);\r\n        o.write_shift(4,  (flags & 8) ? 0 : outbuf.length);\r\n        o.write_shift(4,  (flags & 8) ? 0 : fi.content.length);\r\n        o.write_shift(2, namebuf.length);\r\n        o.write_shift(2, 0);\r\n\r\n        start_cd += o.length;\r\n        out.push(o);\r\n        start_cd += namebuf.length;\r\n        out.push(namebuf);\r\n\r\n        /* TODO: encryption header ? */\r\n        start_cd += outbuf.length;\r\n        out.push(outbuf);\r\n\r\n        /* data descriptor */\r\n        if(flags & 8) {\r\n          o = new_buf(12);\r\n          o.write_shift(-4, crcs[fcnt]);\r\n          o.write_shift(4, outbuf.length);\r\n          o.write_shift(4, fi.content.length);\r\n          start_cd += o.l;\r\n          out.push(o);\r\n        }\r\n\r\n        /* central directory */\r\n        o = new_buf(46);\r\n        o.write_shift(4, 0x02014b50);\r\n        o.write_shift(2, 0);\r\n        o.write_shift(2, 20);\r\n        o.write_shift(2, flags);\r\n        o.write_shift(2, method);\r\n        o.write_shift(4, 0); /* TODO: last mod file time/date */\r\n        o.write_shift(-4, crcs[fcnt]);\r\n\r\n        o.write_shift(4, outbuf.length);\r\n        o.write_shift(4, fi.content.length);\r\n        o.write_shift(2, namebuf.length);\r\n        o.write_shift(2, 0);\r\n        o.write_shift(2, 0);\r\n        o.write_shift(2, 0);\r\n        o.write_shift(2, 0);\r\n        o.write_shift(4, 0);\r\n        o.write_shift(4, start);\r\n\r\n        sz_cd += o.l;\r\n        cdirs.push(o);\r\n        sz_cd += namebuf.length;\r\n        cdirs.push(namebuf);\r\n        ++fcnt;\r\n      }\r\n\r\n      /* end of central directory */\r\n      o = new_buf(22);\r\n      o.write_shift(4, 0x06054b50);\r\n      o.write_shift(2, 0);\r\n      o.write_shift(2, 0);\r\n      o.write_shift(2, fcnt);\r\n      o.write_shift(2, fcnt);\r\n      o.write_shift(4, sz_cd);\r\n      o.write_shift(4, start_cd);\r\n      o.write_shift(2, 0);\r\n\r\n      return bconcat(([bconcat((out)), bconcat(cdirs), o]));\r\n    }\r\n    function cfb_new(opts) {\r\n      var o = ({});\r\n      init_cfb(o, opts);\r\n      return o;\r\n    }\r\n\r\n    function cfb_add(cfb, name, content, opts) {\r\n      var unsafe = opts && opts.unsafe;\r\n      if(!unsafe) init_cfb(cfb);\r\n      var file = !unsafe && CFB.find(cfb, name);\r\n      if(!file) {\r\n        var fpath = cfb.FullPaths[0];\r\n        if(name.slice(0, fpath.length) == fpath) fpath = name;\r\n        else {\r\n          if(fpath.slice(-1) != \"/\") fpath += \"/\";\r\n          fpath = (fpath + name).replace(\"//\",\"/\");\r\n        }\r\n        file = ({name: filename(name), type: 2});\r\n        cfb.FileIndex.push(file);\r\n        cfb.FullPaths.push(fpath);\r\n        if(!unsafe) CFB.utils.cfb_gc(cfb);\r\n      }\r\n      file.content = (content);\r\n      file.size = content ? content.length : 0;\r\n      if(opts) {\r\n        if(opts.CLSID) file.clsid = opts.CLSID;\r\n        if(opts.mt) file.mt = opts.mt;\r\n        if(opts.ct) file.ct = opts.ct;\r\n      }\r\n      return file;\r\n    }\r\n\r\n    function cfb_del(cfb, name) {\r\n      init_cfb(cfb);\r\n      var file = CFB.find(cfb, name);\r\n      if(file) for(var j = 0; j < cfb.FileIndex.length; ++j) if(cfb.FileIndex[j] == file) {\r\n        cfb.FileIndex.splice(j, 1);\r\n        cfb.FullPaths.splice(j, 1);\r\n        return true;\r\n      }\r\n      return false;\r\n    }\r\n\r\n    function cfb_mov(cfb, old_name, new_name) {\r\n      init_cfb(cfb);\r\n      var file = CFB.find(cfb, old_name);\r\n      if(file) for(var j = 0; j < cfb.FileIndex.length; ++j) if(cfb.FileIndex[j] == file) {\r\n        cfb.FileIndex[j].name = filename(new_name);\r\n        cfb.FullPaths[j] = new_name;\r\n        return true;\r\n      }\r\n      return false;\r\n    }\r\n\r\n    function cfb_gc(cfb) { rebuild_cfb(cfb, true); }\r\n\r\n    exports.find = find;\r\n    exports.read = read;\r\n    exports.parse = parse;\r\n    exports.write = write;\r\n    exports.writeFile = write_file;\r\n    exports.utils = {\r\n      cfb_new: cfb_new,\r\n      cfb_add: cfb_add,\r\n      cfb_del: cfb_del,\r\n      cfb_mov: cfb_mov,\r\n      cfb_gc: cfb_gc,\r\n      ReadShift: ReadShift,\r\n      CheckField: CheckField,\r\n      prep_blob: prep_blob,\r\n      bconcat: bconcat,\r\n      use_zlib: use_zlib,\r\n      _deflateRaw: _deflate,\r\n      _inflateRaw: _inflate,\r\n      consts: consts\r\n    };\r\n\r\n    return exports;\r\n  })();\r\n\r\n  if(typeof require !== 'undefined' && typeof module !== 'undefined' && typeof DO_NOT_EXPORT_CFB === 'undefined') { module.exports = CFB; }\r\n  var _fs;\r\n  if(typeof require !== 'undefined') try { _fs = require('fs'); } catch(e) {}\r\n\r\n  /* normalize data for blob ctor */\r\n  function blobify(data) {\r\n    if(typeof data === \"string\") return s2ab(data);\r\n    if(Array.isArray(data)) return a2u(data);\r\n    return data;\r\n  }\r\n  /* write or download file */\r\n  function write_dl(fname, payload, enc) {\r\n    /*global IE_SaveFile, Blob, navigator, saveAs, URL, document, File, chrome */\r\n    if(typeof _fs !== 'undefined' && _fs.writeFileSync) return enc ? _fs.writeFileSync(fname, payload, enc) : _fs.writeFileSync(fname, payload);\r\n    var data = (enc == \"utf8\") ? utf8write(payload) : payload;\r\n    if(typeof IE_SaveFile !== 'undefined') return IE_SaveFile(data, fname);\r\n    if(typeof Blob !== 'undefined') {\r\n      var blob = new Blob([blobify(data)], {type:\"application/octet-stream\"});\r\n      if(typeof navigator !== 'undefined' && navigator.msSaveBlob) return navigator.msSaveBlob(blob, fname);\r\n      if(typeof saveAs !== 'undefined') return saveAs(blob, fname);\r\n      if(typeof URL !== 'undefined' && typeof document !== 'undefined' && document.createElement && URL.createObjectURL) {\r\n        var url = URL.createObjectURL(blob);\r\n        if(typeof chrome === 'object' && typeof (chrome.downloads||{}).download == \"function\") {\r\n          if(URL.revokeObjectURL && typeof setTimeout !== 'undefined') setTimeout(function() { URL.revokeObjectURL(url); }, 60000);\r\n          return chrome.downloads.download({ url: url, filename: fname, saveAs: true});\r\n        }\r\n        var a = document.createElement(\"a\");\r\n        if(a.download != null) {\r\n          a.download = fname; a.href = url; document.body.appendChild(a); a.click();\r\n          document.body.removeChild(a);\r\n          if(URL.revokeObjectURL && typeof setTimeout !== 'undefined') setTimeout(function() { URL.revokeObjectURL(url); }, 60000);\r\n          return url;\r\n        }\r\n      }\r\n    }\r\n    // $FlowIgnore\r\n    if(typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try { // extendscript\r\n      // $FlowIgnore\r\n      var out = File(fname); out.open(\"w\"); out.encoding = \"binary\";\r\n      if(Array.isArray(payload)) payload = a2s(payload);\r\n      out.write(payload); out.close(); return payload;\r\n    } catch(e) { if(!e.message || !e.message.match(/onstruct/)) throw e; }\r\n    throw new Error(\"cannot save file \" + fname);\r\n  }\r\n\r\n  /* read binary data from file */\r\n  function read_binary(path) {\r\n    if(typeof _fs !== 'undefined') return _fs.readFileSync(path);\r\n    // $FlowIgnore\r\n    if(typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try { // extendscript\r\n      // $FlowIgnore\r\n      var infile = File(path); infile.open(\"r\"); infile.encoding = \"binary\";\r\n      var data = infile.read(); infile.close();\r\n      return data;\r\n    } catch(e) { if(!e.message || !e.message.match(/onstruct/)) throw e; }\r\n    throw new Error(\"Cannot access file \" + path);\r\n  }\r\n  function keys(o) {\r\n    var ks = Object.keys(o), o2 = [];\r\n    for(var i = 0; i < ks.length; ++i) if(o.hasOwnProperty(ks[i])) o2.push(ks[i]);\r\n    return o2;\r\n  }\r\n\r\n  function evert_key(obj, key) {\r\n    var o = ([]), K = keys(obj);\r\n    for(var i = 0; i !== K.length; ++i) if(o[obj[K[i]][key]] == null) o[obj[K[i]][key]] = K[i];\r\n    return o;\r\n  }\r\n\r\n  function evert(obj) {\r\n    var o = ([]), K = keys(obj);\r\n    for(var i = 0; i !== K.length; ++i) o[obj[K[i]]] = K[i];\r\n    return o;\r\n  }\r\n\r\n  function evert_num(obj) {\r\n    var o = ([]), K = keys(obj);\r\n    for(var i = 0; i !== K.length; ++i) o[obj[K[i]]] = parseInt(K[i],10);\r\n    return o;\r\n  }\r\n\r\n  function evert_arr(obj) {\r\n    var o = ([]), K = keys(obj);\r\n    for(var i = 0; i !== K.length; ++i) {\r\n      if(o[obj[K[i]]] == null) o[obj[K[i]]] = [];\r\n      o[obj[K[i]]].push(K[i]);\r\n    }\r\n    return o;\r\n  }\r\n\r\n  var basedate = new Date(1899, 11, 30, 0, 0, 0); // 2209161600000\r\n  var dnthresh = basedate.getTime() + (new Date().getTimezoneOffset() - basedate.getTimezoneOffset()) * 60000;\r\n  function datenum(v, date1904) {\r\n    var epoch = v.getTime();\r\n    if(date1904) epoch -= 1462*24*60*60*1000;\r\n    return (epoch - dnthresh) / (24 * 60 * 60 * 1000);\r\n  }\r\n  function numdate(v) {\r\n    var out = new Date();\r\n    out.setTime(v * 24 * 60 * 60 * 1000 + dnthresh);\r\n    return out;\r\n  }\r\n\r\n  /* ISO 8601 Duration */\r\n  function parse_isodur(s) {\r\n    var sec = 0, mt = 0, time = false;\r\n    var m = s.match(/P([0-9\\.]+Y)?([0-9\\.]+M)?([0-9\\.]+D)?T([0-9\\.]+H)?([0-9\\.]+M)?([0-9\\.]+S)?/);\r\n    if(!m) throw new Error(\"|\" + s + \"| is not an ISO8601 Duration\");\r\n    for(var i = 1; i != m.length; ++i) {\r\n      if(!m[i]) continue;\r\n      mt = 1;\r\n      if(i > 3) time = true;\r\n      switch(m[i].slice(m[i].length-1)) {\r\n        case 'Y':\r\n          throw new Error(\"Unsupported ISO Duration Field: \" + m[i].slice(m[i].length-1));\r\n        case 'D': mt *= 24;\r\n        /* falls through */\r\n        case 'H': mt *= 60;\r\n        /* falls through */\r\n        case 'M':\r\n          if(!time) throw new Error(\"Unsupported ISO Duration Field: M\");\r\n          else mt *= 60;\r\n        /* falls through */\r\n        case 'S': break;\r\n      }\r\n      sec += mt * parseInt(m[i], 10);\r\n    }\r\n    return sec;\r\n  }\r\n\r\n  var good_pd_date = new Date('2017-02-19T19:06:09.000Z');\r\n  if(isNaN(good_pd_date.getFullYear())) good_pd_date = new Date('2/19/17');\r\n  var good_pd = good_pd_date.getFullYear() == 2017;\r\n  /* parses a date as a local date */\r\n  function parseDate(str, fixdate) {\r\n    var d = new Date(str);\r\n    if(good_pd) {\r\n      if(fixdate > 0) d.setTime(d.getTime() + d.getTimezoneOffset() * 60 * 1000);\r\n      else if(fixdate < 0) d.setTime(d.getTime() - d.getTimezoneOffset() * 60 * 1000);\r\n      return d;\r\n    }\r\n    if(str instanceof Date) return str;\r\n    if(good_pd_date.getFullYear() == 1917 && !isNaN(d.getFullYear())) {\r\n      var s = d.getFullYear();\r\n      if(str.indexOf(\"\" + s) > -1) return d;\r\n      d.setFullYear(d.getFullYear() + 100); return d;\r\n    }\r\n    var n = str.match(/\\d+/g)||[\"2017\",\"2\",\"19\",\"0\",\"0\",\"0\"];\r\n    var out = new Date(+n[0], +n[1] - 1, +n[2], (+n[3]||0), (+n[4]||0), (+n[5]||0));\r\n    if(str.indexOf(\"Z\") > -1) out = new Date(out.getTime() - out.getTimezoneOffset() * 60 * 1000);\r\n    return out;\r\n  }\r\n\r\n  function cc2str(arr) {\r\n    var o = \"\";\r\n    for(var i = 0; i != arr.length; ++i) o += String.fromCharCode(arr[i]);\r\n    return o;\r\n  }\r\n\r\n  function dup(o) {\r\n    if(typeof JSON != 'undefined' && !Array.isArray(o)) return JSON.parse(JSON.stringify(o));\r\n    if(typeof o != 'object' || o == null) return o;\r\n    if(o instanceof Date) return new Date(o.getTime());\r\n    var out = {};\r\n    for(var k in o) if(o.hasOwnProperty(k)) out[k] = dup(o[k]);\r\n    return out;\r\n  }\r\n\r\n  function fill(c,l) { var o = \"\"; while(o.length < l) o+=c; return o; }\r\n\r\n  /* TODO: stress test */\r\n  function fuzzynum(s) {\r\n    var v = Number(s);\r\n    if(!isNaN(v)) return v;\r\n    var wt = 1;\r\n    var ss = s.replace(/([\\d]),([\\d])/g,\"$1$2\").replace(/[$]/g,\"\").replace(/[%]/g, function() { wt *= 100; return \"\";});\r\n    if(!isNaN(v = Number(ss))) return v / wt;\r\n    ss = ss.replace(/[(](.*)[)]/,function($$, $1) { wt = -wt; return $1;});\r\n    if(!isNaN(v = Number(ss))) return v / wt;\r\n    return v;\r\n  }\r\n  function fuzzydate(s) {\r\n    var o = new Date(s), n = new Date(NaN);\r\n    var y = o.getYear(), m = o.getMonth(), d = o.getDate();\r\n    if(isNaN(d)) return n;\r\n    if(y < 0 || y > 8099) return n;\r\n    if((m > 0 || d > 1) && y != 101) return o;\r\n    if(s.toLowerCase().match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)) return o;\r\n    if(s.match(/[^-0-9:,\\/\\\\]/)) return n;\r\n    return o;\r\n  }\r\n\r\n  var safe_split_regex = \"abacaba\".split(/(:?b)/i).length == 5;\r\n  function split_regex(str, re, def) {\r\n    if(safe_split_regex || typeof re == \"string\") return str.split(re);\r\n    var p = str.split(re), o = [p[0]];\r\n    for(var i = 1; i < p.length; ++i) { o.push(def); o.push(p[i]); }\r\n    return o;\r\n  }\r\n  function getdatastr(data) {\r\n    if(!data) return null;\r\n    if(data.data) return debom(data.data);\r\n    if(data.asNodeBuffer && has_buf) return debom(data.asNodeBuffer().toString('binary'));\r\n    if(data.asBinary) return debom(data.asBinary());\r\n    if(data._data && data._data.getContent) return debom(cc2str(Array.prototype.slice.call(data._data.getContent(),0)));\r\n    return null;\r\n  }\r\n\r\n  function getdatabin(data) {\r\n    if(!data) return null;\r\n    if(data.data) return char_codes(data.data);\r\n    if(data.asNodeBuffer && has_buf) return data.asNodeBuffer();\r\n    if(data._data && data._data.getContent) {\r\n      var o = data._data.getContent();\r\n      if(typeof o == \"string\") return char_codes(o);\r\n      return Array.prototype.slice.call(o);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  function getdata(data) { return (data && data.name.slice(-4) === \".bin\") ? getdatabin(data) : getdatastr(data); }\r\n\r\n  /* Part 2 Section 10.1.2 \"Mapping Content Types\" Names are case-insensitive */\r\n  /* OASIS does not comment on filename case sensitivity */\r\n  function safegetzipfile(zip, file) {\r\n    var k = keys(zip.files);\r\n    var f = file.toLowerCase(), g = f.replace(/\\//g,'\\\\');\r\n    for(var i=0; i<k.length; ++i) {\r\n      var n = k[i].toLowerCase();\r\n      if(f == n || g == n) return zip.files[k[i]];\r\n    }\r\n    return null;\r\n  }\r\n\r\n  function getzipfile(zip, file) {\r\n    var o = safegetzipfile(zip, file);\r\n    if(o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\r\n    return o;\r\n  }\r\n\r\n  function getzipdata(zip, file, safe) {\r\n    if(!safe) return getdata(getzipfile(zip, file));\r\n    if(!file) return null;\r\n    try { return getzipdata(zip, file); } catch(e) { return null; }\r\n  }\r\n\r\n  function getzipstr(zip, file, safe) {\r\n    if(!safe) return getdatastr(getzipfile(zip, file));\r\n    if(!file) return null;\r\n    try { return getzipstr(zip, file); } catch(e) { return null; }\r\n  }\r\n\r\n  function zipentries(zip) {\r\n    var k = keys(zip.files), o = [];\r\n    for(var i = 0; i < k.length; ++i) if(k[i].slice(-1) != '/') o.push(k[i]);\r\n    return o.sort();\r\n  }\r\n\r\n  var jszip;\r\n  /*global JSZipSync:true */\r\n  if(typeof JSZipSync !== 'undefined') jszip = JSZipSync;\r\n  if(typeof exports !== 'undefined') {\r\n    if(typeof module !== 'undefined' && module.exports) {\r\n      if(typeof jszip === 'undefined') jszip = undefined;\r\n    }\r\n  }\r\n\r\n  function resolve_path(path, base) {\r\n    var result = base.split('/');\r\n    if(base.slice(-1) != \"/\") result.pop(); // folder path\r\n    var target = path.split('/');\r\n    while (target.length !== 0) {\r\n      var step = target.shift();\r\n      if (step === '..') result.pop();\r\n      else if (step !== '.') result.push(step);\r\n    }\r\n    return result.join('/');\r\n  }\r\n  var XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\r\n  var attregexg=/([^\"\\s?>\\/]+)\\s*=\\s*((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:')|([^'\">\\s]+))/g;\r\n  var tagregex=/<[\\/\\?]?[a-zA-Z0-9:]+(?:\\s+[^\"\\s?>\\/]+\\s*=\\s*(?:\"[^\"]*\"|'[^']*'|[^'\">\\s=]+))*\\s?[\\/\\?]?>/g;\r\n  if(!(XML_HEADER.match(tagregex))) tagregex = /<[^>]*>/g;\r\n  var nsregex=/<\\w*:/, nsregex2 = /<(\\/?)\\w+:/;\r\n  function parsexmltag(tag, skip_root) {\r\n    var z = ({});\r\n    var eq = 0, c = 0;\r\n    for(; eq !== tag.length; ++eq) if((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\r\n    if(!skip_root) z[0] = tag.slice(0, eq);\r\n    if(eq === tag.length) return z;\r\n    var m = tag.match(attregexg), j=0, v=\"\", i=0, q=\"\", cc=\"\", quot = 1;\r\n    if(m) for(i = 0; i != m.length; ++i) {\r\n      cc = m[i];\r\n      for(c=0; c != cc.length; ++c) if(cc.charCodeAt(c) === 61) break;\r\n      q = cc.slice(0,c).trim();\r\n      while(cc.charCodeAt(c+1) == 32) ++c;\r\n      quot = ((eq=cc.charCodeAt(c+1)) == 34 || eq == 39) ? 1 : 0;\r\n      v = cc.slice(c+1+quot, cc.length-quot);\r\n      for(j=0;j!=q.length;++j) if(q.charCodeAt(j) === 58) break;\r\n      if(j===q.length) {\r\n        if(q.indexOf(\"_\") > 0) q = q.slice(0, q.indexOf(\"_\")); // from ods\r\n        z[q] = v;\r\n        z[q.toLowerCase()] = v;\r\n      }\r\n      else {\r\n        var k = (j===5 && q.slice(0,5)===\"xmlns\"?\"xmlns\":\"\")+q.slice(j+1);\r\n        if(z[k] && q.slice(j-3,j) == \"ext\") continue; // from ods\r\n        z[k] = v;\r\n        z[k.toLowerCase()] = v;\r\n      }\r\n    }\r\n    return z;\r\n  }\r\n  function strip_ns(x) { return x.replace(nsregex2, \"<$1\"); }\r\n\r\n  var encodings = {\r\n    '&quot;': '\"',\r\n    '&apos;': \"'\",\r\n    '&gt;': '>',\r\n    '&lt;': '<',\r\n    '&amp;': '&'\r\n  };\r\n  var rencoding = evert(encodings);\r\n//var rencstr = \"&<>'\\\"\".split(\"\");\r\n\r\n// TODO: CP remap (need to read file version to determine OS)\r\n  var unescapexml = (function() {\r\n    /* 22.4.2.4 bstr (Basic String) */\r\n    var encregex = /&(?:quot|apos|gt|lt|amp|#x?([\\da-fA-F]+));/g, coderegex = /_x([\\da-fA-F]{4})_/g;\r\n    return function unescapexml(text) {\r\n      var s = text + '', i = s.indexOf(\"<![CDATA[\");\r\n      if(i == -1) return s.replace(encregex, function($$, $1) { return encodings[$$]||String.fromCharCode(parseInt($1,$$.indexOf(\"x\")>-1?16:10))||$$; }).replace(coderegex,function(m,c) {return String.fromCharCode(parseInt(c,16));});\r\n      var j = s.indexOf(\"]]>\");\r\n      return unescapexml(s.slice(0, i)) + s.slice(i+9,j) + unescapexml(s.slice(j+3));\r\n    };\r\n  })();\r\n\r\n  var decregex=/[&<>'\"]/g, charegex = /[\\u0000-\\u0008\\u000b-\\u001f]/g;\r\n  function escapexml(text){\r\n    var s = text + '';\r\n    return s.replace(decregex, function(y) { return rencoding[y]; }).replace(charegex,function(s) { return \"_x\" + (\"000\"+s.charCodeAt(0).toString(16)).slice(-4) + \"_\";});\r\n  }\r\n  function escapexmltag(text){ return escapexml(text).replace(/ /g,\"_x0020_\"); }\r\n\r\n  var htmlcharegex = /[\\u0000-\\u001f]/g;\r\n  function escapehtml(text){\r\n    var s = text + '';\r\n    return s.replace(decregex, function(y) { return rencoding[y]; }).replace(/\\n/g, \"<br/>\").replace(htmlcharegex,function(s) { return \"&#x\" + (\"000\"+s.charCodeAt(0).toString(16)).slice(-4) + \";\"; });\r\n  }\r\n\r\n  function escapexlml(text){\r\n    var s = text + '';\r\n    return s.replace(decregex, function(y) { return rencoding[y]; }).replace(htmlcharegex,function(s) { return \"&#x\" + (s.charCodeAt(0).toString(16)).toUpperCase() + \";\"; });\r\n  }\r\n\r\n  /* TODO: handle codepages */\r\n  var xlml_fixstr = (function() {\r\n    var entregex = /&#(\\d+);/g;\r\n    function entrepl($$,$1) { return String.fromCharCode(parseInt($1,10)); }\r\n    return function xlml_fixstr(str) { return str.replace(entregex,entrepl); };\r\n  })();\r\n  var xlml_unfixstr = (function() {\r\n    return function xlml_unfixstr(str) { return str.replace(/(\\r\\n|[\\r\\n])/g,\"\\&#10;\"); };\r\n  })();\r\n\r\n  function parsexmlbool(value) {\r\n    switch(value) {\r\n      case 1: case true: case '1': case 'true': case 'TRUE': return true;\r\n      /* case '0': case 'false': case 'FALSE':*/\r\n      default: return false;\r\n    }\r\n  }\r\n\r\n  var utf8read = function utf8reada(orig) {\r\n    var out = \"\", i = 0, c = 0, d = 0, e = 0, f = 0, w = 0;\r\n    while (i < orig.length) {\r\n      c = orig.charCodeAt(i++);\r\n      if (c < 128) { out += String.fromCharCode(c); continue; }\r\n      d = orig.charCodeAt(i++);\r\n      if (c>191 && c<224) { f = ((c & 31) << 6); f |= (d & 63); out += String.fromCharCode(f); continue; }\r\n      e = orig.charCodeAt(i++);\r\n      if (c < 240) { out += String.fromCharCode(((c & 15) << 12) | ((d & 63) << 6) | (e & 63)); continue; }\r\n      f = orig.charCodeAt(i++);\r\n      w = (((c & 7) << 18) | ((d & 63) << 12) | ((e & 63) << 6) | (f & 63))-65536;\r\n      out += String.fromCharCode(0xD800 + ((w>>>10)&1023));\r\n      out += String.fromCharCode(0xDC00 + (w&1023));\r\n    }\r\n    return out;\r\n  };\r\n\r\n  var utf8write = function(orig) {\r\n    var out = [], i = 0, c = 0, d = 0;\r\n    while(i < orig.length) {\r\n      c = orig.charCodeAt(i++);\r\n      switch(true) {\r\n        case c < 128: out.push(String.fromCharCode(c)); break;\r\n        case c < 2048:\r\n          out.push(String.fromCharCode(192 + (c >> 6)));\r\n          out.push(String.fromCharCode(128 + (c & 63)));\r\n          break;\r\n        case c >= 55296 && c < 57344:\r\n          c -= 55296; d = orig.charCodeAt(i++) - 56320 + (c<<10);\r\n          out.push(String.fromCharCode(240 + ((d >>18) & 7)));\r\n          out.push(String.fromCharCode(144 + ((d >>12) & 63)));\r\n          out.push(String.fromCharCode(128 + ((d >> 6) & 63)));\r\n          out.push(String.fromCharCode(128 + (d & 63)));\r\n          break;\r\n        default:\r\n          out.push(String.fromCharCode(224 + (c >> 12)));\r\n          out.push(String.fromCharCode(128 + ((c >> 6) & 63)));\r\n          out.push(String.fromCharCode(128 + (c & 63)));\r\n      }\r\n    }\r\n    return out.join(\"\");\r\n  };\r\n\r\n  if(has_buf) {\r\n    var utf8readb = function utf8readb(data) {\r\n      var out = Buffer.alloc(2*data.length), w, i, j = 1, k = 0, ww=0, c;\r\n      for(i = 0; i < data.length; i+=j) {\r\n        j = 1;\r\n        if((c=data.charCodeAt(i)) < 128) w = c;\r\n        else if(c < 224) { w = (c&31)*64+(data.charCodeAt(i+1)&63); j=2; }\r\n        else if(c < 240) { w=(c&15)*4096+(data.charCodeAt(i+1)&63)*64+(data.charCodeAt(i+2)&63); j=3; }\r\n        else { j = 4;\r\n          w = (c & 7)*262144+(data.charCodeAt(i+1)&63)*4096+(data.charCodeAt(i+2)&63)*64+(data.charCodeAt(i+3)&63);\r\n          w -= 65536; ww = 0xD800 + ((w>>>10)&1023); w = 0xDC00 + (w&1023);\r\n        }\r\n        if(ww !== 0) { out[k++] = ww&255; out[k++] = ww>>>8; ww = 0; }\r\n        out[k++] = w%256; out[k++] = w>>>8;\r\n      }\r\n      return out.slice(0,k).toString('ucs2');\r\n    };\r\n    var corpus = \"foo bar baz\\u00e2\\u0098\\u0083\\u00f0\\u009f\\u008d\\u00a3\";\r\n    if(utf8read(corpus) == utf8readb(corpus)) utf8read = utf8readb;\r\n    // $FlowIgnore\r\n    var utf8readc = function utf8readc(data) { return Buffer_from(data, 'binary').toString('utf8'); };\r\n    if(utf8read(corpus) == utf8readc(corpus)) utf8read = utf8readc;\r\n\r\n    // $FlowIgnore\r\n    utf8write = function(data) { return Buffer_from(data, 'utf8').toString(\"binary\"); };\r\n  }\r\n\r\n// matches <foo>...</foo> extracts content\r\n  var matchtag = (function() {\r\n    var mtcache = ({});\r\n    return function matchtag(f,g) {\r\n      var t = f+\"|\"+(g||\"\");\r\n      if(mtcache[t]) return mtcache[t];\r\n      return (mtcache[t] = new RegExp('<(?:\\\\w+:)?'+f+'(?: xml:space=\"preserve\")?(?:[^>]*)>([\\\\s\\\\S]*?)</(?:\\\\w+:)?'+f+'>',((g||\"\"))));\r\n    };\r\n  })();\r\n\r\n  var htmldecode = (function() {\r\n    var entities = [\r\n      ['nbsp', ' '], ['middot', ''],\r\n      ['quot', '\"'], ['apos', \"'\"], ['gt',   '>'], ['lt',   '<'], ['amp',  '&']\r\n    ].map(function(x) { return [new RegExp('&' + x[0] + ';', \"g\"), x[1]]; });\r\n    return function htmldecode(str) {\r\n      var o = str.replace(/^[\\t\\n\\r ]+/, \"\").replace(/[\\t\\n\\r ]+$/,\"\").replace(/[\\t\\n\\r ]+/g, \" \").replace(/<\\s*[bB][rR]\\s*\\/?>/g,\"\\n\").replace(/<[^>]*>/g,\"\");\r\n      for(var i = 0; i < entities.length; ++i) o = o.replace(entities[i][0], entities[i][1]);\r\n      return o;\r\n    };\r\n  })();\r\n\r\n  var vtregex = (function(){ var vt_cache = {};\r\n    return function vt_regex(bt) {\r\n      if(vt_cache[bt] !== undefined) return vt_cache[bt];\r\n      return (vt_cache[bt] = new RegExp(\"<(?:vt:)?\" + bt + \">([\\\\s\\\\S]*?)</(?:vt:)?\" + bt + \">\", 'g') );\r\n    };})();\r\n  var vtvregex = /<\\/?(?:vt:)?variant>/g, vtmregex = /<(?:vt:)([^>]*)>([\\s\\S]*)</;\r\n  function parseVector(data, opts) {\r\n    var h = parsexmltag(data);\r\n\r\n    var matches = data.match(vtregex(h.baseType))||[];\r\n    var res = [];\r\n    if(matches.length != h.size) {\r\n      if(opts.WTF) throw new Error(\"unexpected vector length \" + matches.length + \" != \" + h.size);\r\n      return res;\r\n    }\r\n    matches.forEach(function(x) {\r\n      var v = x.replace(vtvregex,\"\").match(vtmregex);\r\n      if(v) res.push({v:utf8read(v[2]), t:v[1]});\r\n    });\r\n    return res;\r\n  }\r\n\r\n  var wtregex = /(^\\s|\\s$|\\n)/;\r\n  function writetag(f,g) { return '<' + f + (g.match(wtregex)?' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f + '>'; }\r\n\r\n  function wxt_helper(h) { return keys(h).map(function(k) { return \" \" + k + '=\"' + h[k] + '\"';}).join(\"\"); }\r\n  function writextag(f,g,h) { return '<' + f + ((h != null) ? wxt_helper(h) : \"\") + ((g != null) ? (g.match(wtregex)?' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f : \"/\") + '>';}\r\n\r\n  function write_w3cdtf(d, t) { try { return d.toISOString().replace(/\\.\\d*/,\"\"); } catch(e) { if(t) throw e; } return \"\"; }\r\n\r\n  function write_vt(s) {\r\n    switch(typeof s) {\r\n      case 'string': return writextag('vt:lpwstr', s);\r\n      case 'number': return writextag((s|0)==s?'vt:i4':'vt:r8', String(s));\r\n      case 'boolean': return writextag('vt:bool',s?'true':'false');\r\n    }\r\n    if(s instanceof Date) return writextag('vt:filetime', write_w3cdtf(s));\r\n    throw new Error(\"Unable to serialize \" + s);\r\n  }\r\n\r\n  var XMLNS = ({\r\n    'dc': 'http://purl.org/dc/elements/1.1/',\r\n    'dcterms': 'http://purl.org/dc/terms/',\r\n    'dcmitype': 'http://purl.org/dc/dcmitype/',\r\n    'mx': 'http://schemas.microsoft.com/office/mac/excel/2008/main',\r\n    'r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\r\n    'sjs': 'http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties',\r\n    'vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\r\n    'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\r\n    'xsd': 'http://www.w3.org/2001/XMLSchema'\r\n  });\r\n\r\n  XMLNS.main = [\r\n    'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\r\n    'http://purl.oclc.org/ooxml/spreadsheetml/main',\r\n    'http://schemas.microsoft.com/office/excel/2006/main',\r\n    'http://schemas.microsoft.com/office/excel/2006/2'\r\n  ];\r\n\r\n  var XLMLNS = ({\r\n    'o':    'urn:schemas-microsoft-com:office:office',\r\n    'x':    'urn:schemas-microsoft-com:office:excel',\r\n    'ss':   'urn:schemas-microsoft-com:office:spreadsheet',\r\n    'dt':   'uuid:C2F41010-65B3-11d1-A29F-00AA00C14882',\r\n    'mv':   'http://macVmlSchemaUri',\r\n    'v':    'urn:schemas-microsoft-com:vml',\r\n    'html': 'http://www.w3.org/TR/REC-html40'\r\n  });\r\n  function read_double_le(b, idx) {\r\n    var s = 1 - 2 * (b[idx + 7] >>> 7);\r\n    var e = ((b[idx + 7] & 0x7f) << 4) + ((b[idx + 6] >>> 4) & 0x0f);\r\n    var m = (b[idx+6]&0x0f);\r\n    for(var i = 5; i >= 0; --i) m = m * 256 + b[idx + i];\r\n    if(e == 0x7ff) return m == 0 ? (s * Infinity) : NaN;\r\n    if(e == 0) e = -1022;\r\n    else { e -= 1023; m += Math.pow(2,52); }\r\n    return s * Math.pow(2, e - 52) * m;\r\n  }\r\n\r\n  function write_double_le(b, v, idx) {\r\n    var bs = ((((v < 0) || (1/v == -Infinity)) ? 1 : 0) << 7), e = 0, m = 0;\r\n    var av = bs ? (-v) : v;\r\n    if(!isFinite(av)) { e = 0x7ff; m = isNaN(v) ? 0x6969 : 0; }\r\n    else if(av == 0) e = m = 0;\r\n    else {\r\n      e = Math.floor(Math.log(av) / Math.LN2);\r\n      m = av * Math.pow(2, 52 - e);\r\n      if((e <= -1023) && (!isFinite(m) || (m < Math.pow(2,52)))) { e = -1022; }\r\n      else { m -= Math.pow(2,52); e+=1023; }\r\n    }\r\n    for(var i = 0; i <= 5; ++i, m/=256) b[idx + i] = m & 0xff;\r\n    b[idx + 6] = ((e & 0x0f) << 4) | (m & 0xf);\r\n    b[idx + 7] = (e >> 4) | bs;\r\n  }\r\n\r\n  var __toBuffer = function(bufs) { var x=[],w=10240; for(var i=0;i<bufs[0].length;++i) if(bufs[0][i]) for(var j=0,L=bufs[0][i].length;j<L;j+=w) x.push.apply(x, bufs[0][i].slice(j,j+w)); return x; };\r\n  var ___toBuffer = __toBuffer;\r\n  var __utf16le = function(b,s,e) { var ss=[]; for(var i=s; i<e; i+=2) ss.push(String.fromCharCode(__readUInt16LE(b,i))); return ss.join(\"\").replace(chr0,''); };\r\n  var ___utf16le = __utf16le;\r\n  var __hexlify = function(b,s,l) { var ss=[]; for(var i=s; i<s+l; ++i) ss.push((\"0\" + b[i].toString(16)).slice(-2)); return ss.join(\"\"); };\r\n  var ___hexlify = __hexlify;\r\n  var __utf8 = function(b,s,e) { var ss=[]; for(var i=s; i<e; i++) ss.push(String.fromCharCode(__readUInt8(b,i))); return ss.join(\"\"); };\r\n  var ___utf8 = __utf8;\r\n  var __lpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\r\n  var ___lpstr = __lpstr;\r\n  var __cpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\r\n  var ___cpstr = __cpstr;\r\n  var __lpwstr = function(b,i) { var len = 2*__readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\r\n  var ___lpwstr = __lpwstr;\r\n  var __lpp4, ___lpp4;\r\n  __lpp4 = ___lpp4 = function lpp4_(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf16le(b, i+4,i+4+len) : \"\";};\r\n  var __8lpp4 = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len) : \"\";};\r\n  var ___8lpp4 = __8lpp4;\r\n  var __double, ___double;\r\n  __double = ___double = function(b, idx) { return read_double_le(b, idx);};\r\n  var is_buf = function is_buf_a(a) { return Array.isArray(a); };\r\n\r\n  if(has_buf) {\r\n    __utf16le = function(b,s,e) { if(!Buffer.isBuffer(b)) return ___utf16le(b,s,e); return b.toString('utf16le',s,e).replace(chr0,'')/*.replace(chr1,'!')*/; };\r\n    __hexlify = function(b,s,l) { return Buffer.isBuffer(b) ? b.toString('hex',s,s+l) : ___hexlify(b,s,l); };\r\n    __lpstr = function lpstr_b(b, i) { if(!Buffer.isBuffer(b)) return ___lpstr(b, i); var len = b.readUInt32LE(i); return len > 0 ? b.toString('utf8',i+4,i+4+len-1) : \"\";};\r\n    __cpstr = function cpstr_b(b, i) { if(!Buffer.isBuffer(b)) return ___cpstr(b, i); var len = b.readUInt32LE(i); return len > 0 ? b.toString('utf8',i+4,i+4+len-1) : \"\";};\r\n    __lpwstr = function lpwstr_b(b, i) { if(!Buffer.isBuffer(b)) return ___lpwstr(b, i); var len = 2*b.readUInt32LE(i); return b.toString('utf16le',i+4,i+4+len-1);};\r\n    __lpp4 = function lpp4_b(b, i) { if(!Buffer.isBuffer(b)) return ___lpp4(b, i); var len = b.readUInt32LE(i); return b.toString('utf16le',i+4,i+4+len);};\r\n    __8lpp4 = function lpp4_8b(b, i) { if(!Buffer.isBuffer(b)) return ___8lpp4(b, i); var len = b.readUInt32LE(i); return b.toString('utf8',i+4,i+4+len);};\r\n    __utf8 = function utf8_b(b, s, e) { return (Buffer.isBuffer(b)) ? b.toString('utf8',s,e) : ___utf8(b,s,e); };\r\n    __toBuffer = function(bufs) { return (bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0])) ? Buffer.concat(bufs[0]) : ___toBuffer(bufs);};\r\n    bconcat = function(bufs) { return Buffer.isBuffer(bufs[0]) ? Buffer.concat(bufs) : [].concat.apply([], bufs); };\r\n    __double = function double_(b, i) { if(Buffer.isBuffer(b)) return b.readDoubleLE(i); return ___double(b,i); };\r\n    is_buf = function is_buf_b(a) { return Buffer.isBuffer(a) || Array.isArray(a); };\r\n  }\r\n\r\n  /* from js-xls */\r\n  if(typeof cptable !== 'undefined') {\r\n    __utf16le = function(b,s,e) { return cptable.utils.decode(1200, b.slice(s,e)).replace(chr0, ''); };\r\n    __utf8 = function(b,s,e) { return cptable.utils.decode(65001, b.slice(s,e)); };\r\n    __lpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? cptable.utils.decode(current_ansi, b.slice(i+4, i+4+len-1)) : \"\";};\r\n    __cpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? cptable.utils.decode(current_codepage, b.slice(i+4, i+4+len-1)) : \"\";};\r\n    __lpwstr = function(b,i) { var len = 2*__readUInt32LE(b,i); return len > 0 ? cptable.utils.decode(1200, b.slice(i+4,i+4+len-1)) : \"\";};\r\n    __lpp4 = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? cptable.utils.decode(1200, b.slice(i+4,i+4+len)) : \"\";};\r\n    __8lpp4 = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? cptable.utils.decode(65001, b.slice(i+4,i+4+len)) : \"\";};\r\n  }\r\n\r\n  var __readUInt8 = function(b, idx) { return b[idx]; };\r\n  var __readUInt16LE = function(b, idx) { return (b[idx+1]*(1<<8))+b[idx]; };\r\n  var __readInt16LE = function(b, idx) { var u = (b[idx+1]*(1<<8))+b[idx]; return (u < 0x8000) ? u : ((0xffff - u + 1) * -1); };\r\n  var __readUInt32LE = function(b, idx) { return b[idx+3]*(1<<24)+(b[idx+2]<<16)+(b[idx+1]<<8)+b[idx]; };\r\n  var __readInt32LE = function(b, idx) { return (b[idx+3]<<24)|(b[idx+2]<<16)|(b[idx+1]<<8)|b[idx]; };\r\n  var __readInt32BE = function(b, idx) { return (b[idx]<<24)|(b[idx+1]<<16)|(b[idx+2]<<8)|b[idx+3]; };\r\n\r\n  function ReadShift(size, t) {\r\n    var o=\"\", oI, oR, oo=[], w, vv, i, loc;\r\n    switch(t) {\r\n      case 'dbcs':\r\n        loc = this.l;\r\n        if(has_buf && Buffer.isBuffer(this)) o = this.slice(this.l, this.l+2*size).toString(\"utf16le\");\r\n        else for(i = 0; i < size; ++i) { o+=String.fromCharCode(__readUInt16LE(this, loc)); loc+=2; }\r\n        size *= 2;\r\n        break;\r\n\r\n      case 'utf8': o = __utf8(this, this.l, this.l + size); break;\r\n      case 'utf16le': size *= 2; o = __utf16le(this, this.l, this.l + size); break;\r\n\r\n      case 'wstr':\r\n        if(typeof cptable !== 'undefined') o = cptable.utils.decode(current_codepage, this.slice(this.l, this.l+2*size));\r\n        else return ReadShift.call(this, size, 'dbcs');\r\n        size = 2 * size; break;\r\n\r\n      /* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\r\n      case 'lpstr-ansi': o = __lpstr(this, this.l); size = 4 + __readUInt32LE(this, this.l); break;\r\n      case 'lpstr-cp': o = __cpstr(this, this.l); size = 4 + __readUInt32LE(this, this.l); break;\r\n      /* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\r\n      case 'lpwstr': o = __lpwstr(this, this.l); size = 4 + 2 * __readUInt32LE(this, this.l); break;\r\n      /* [MS-OFFCRYPTO] 2.1.2 Length-Prefixed Padded Unicode String (UNICODE-LP-P4) */\r\n      case 'lpp4': size = 4 +  __readUInt32LE(this, this.l); o = __lpp4(this, this.l); if(size & 0x02) size += 2; break;\r\n      /* [MS-OFFCRYPTO] 2.1.3 Length-Prefixed UTF-8 String (UTF-8-LP-P4) */\r\n      case '8lpp4': size = 4 +  __readUInt32LE(this, this.l); o = __8lpp4(this, this.l); if(size & 0x03) size += 4 - (size & 0x03); break;\r\n\r\n      case 'cstr': size = 0; o = \"\";\r\n        while((w=__readUInt8(this, this.l + size++))!==0) oo.push(_getchar(w));\r\n        o = oo.join(\"\"); break;\r\n      case '_wstr': size = 0; o = \"\";\r\n        while((w=__readUInt16LE(this,this.l +size))!==0){oo.push(_getchar(w));size+=2;}\r\n        size+=2; o = oo.join(\"\"); break;\r\n\r\n      /* sbcs and dbcs support continue records in the SST way TODO codepages */\r\n      case 'dbcs-cont': o = \"\"; loc = this.l;\r\n        for(i = 0; i < size; ++i) {\r\n          if(this.lens && this.lens.indexOf(loc) !== -1) {\r\n            w = __readUInt8(this, loc);\r\n            this.l = loc + 1;\r\n            vv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\r\n            return oo.join(\"\") + vv;\r\n          }\r\n          oo.push(_getchar(__readUInt16LE(this, loc)));\r\n          loc+=2;\r\n        } o = oo.join(\"\"); size *= 2; break;\r\n\r\n      case 'cpstr':\r\n        if(typeof cptable !== 'undefined') {\r\n          o = cptable.utils.decode(current_codepage, this.slice(this.l, this.l + size));\r\n          break;\r\n        }\r\n      /* falls through */\r\n      case 'sbcs-cont': o = \"\"; loc = this.l;\r\n        for(i = 0; i != size; ++i) {\r\n          if(this.lens && this.lens.indexOf(loc) !== -1) {\r\n            w = __readUInt8(this, loc);\r\n            this.l = loc + 1;\r\n            vv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\r\n            return oo.join(\"\") + vv;\r\n          }\r\n          oo.push(_getchar(__readUInt8(this, loc)));\r\n          loc+=1;\r\n        } o = oo.join(\"\"); break;\r\n\r\n      default:\r\n        switch(size) {\r\n          case 1: oI = __readUInt8(this, this.l); this.l++; return oI;\r\n          case 2: oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l); this.l += 2; return oI;\r\n          case 4: case -4:\r\n            if(t === 'i' || ((this[this.l+3] & 0x80)===0)) { oI = ((size > 0) ? __readInt32LE : __readInt32BE)(this, this.l); this.l += 4; return oI; }\r\n            else { oR = __readUInt32LE(this, this.l); this.l += 4; } return oR;\r\n          case 8: case -8:\r\n            if(t === 'f') {\r\n              if(size == 8) oR = __double(this, this.l);\r\n              else oR = __double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]], 0);\r\n              this.l += 8; return oR;\r\n            } else size = 8;\r\n          /* falls through */\r\n          case 16: o = __hexlify(this, this.l, size); break;\r\n        }}\r\n    this.l+=size; return o;\r\n  }\r\n\r\n  var __writeUInt32LE = function(b, val, idx) { b[idx] = (val & 0xFF); b[idx+1] = ((val >>> 8) & 0xFF); b[idx+2] = ((val >>> 16) & 0xFF); b[idx+3] = ((val >>> 24) & 0xFF); };\r\n  var __writeInt32LE  = function(b, val, idx) { b[idx] = (val & 0xFF); b[idx+1] = ((val >> 8) & 0xFF); b[idx+2] = ((val >> 16) & 0xFF); b[idx+3] = ((val >> 24) & 0xFF); };\r\n  var __writeUInt16LE = function(b, val, idx) { b[idx] = (val & 0xFF); b[idx+1] = ((val >>> 8) & 0xFF); };\r\n\r\n  function WriteShift(t, val, f) {\r\n    var size = 0, i = 0;\r\n    if(f === 'dbcs') {\r\n      for(i = 0; i != val.length; ++i) __writeUInt16LE(this, val.charCodeAt(i), this.l + 2 * i);\r\n      size = 2 * val.length;\r\n    } else if(f === 'sbcs') {\r\n      /* TODO: codepage */\r\n      val = val.replace(/[^\\x00-\\x7F]/g, \"_\");\r\n      for(i = 0; i != val.length; ++i) this[this.l + i] = (val.charCodeAt(i) & 0xFF);\r\n      size = val.length;\r\n    } else if(f === 'hex') {\r\n      for(; i < t; ++i) {\r\n        this[this.l++] = (parseInt(val.slice(2*i, 2*i+2), 16)||0);\r\n      } return this;\r\n    } else if(f === 'utf16le') {\r\n      var end = Math.min(this.l + t, this.length);\r\n      for(i = 0; i < Math.min(val.length, t); ++i) {\r\n        var cc = val.charCodeAt(i);\r\n        this[this.l++] = (cc & 0xff);\r\n        this[this.l++] = (cc >> 8);\r\n      }\r\n      while(this.l < end) this[this.l++] = 0;\r\n      return this;\r\n    } else  switch(t) {\r\n      case  1: size = 1; this[this.l] = val&0xFF; break;\r\n      case  2: size = 2; this[this.l] = val&0xFF; val >>>= 8; this[this.l+1] = val&0xFF; break;\r\n      case  3: size = 3; this[this.l] = val&0xFF; val >>>= 8; this[this.l+1] = val&0xFF; val >>>= 8; this[this.l+2] = val&0xFF; break;\r\n      case  4: size = 4; __writeUInt32LE(this, val, this.l); break;\r\n      case  8: size = 8; if(f === 'f') { write_double_le(this, val, this.l); break; }\r\n      /* falls through */\r\n      case 16: break;\r\n      case -4: size = 4; __writeInt32LE(this, val, this.l); break;\r\n    }\r\n    this.l += size; return this;\r\n  }\r\n\r\n  function CheckField(hexstr, fld) {\r\n    var m = __hexlify(this,this.l,hexstr.length>>1);\r\n    if(m !== hexstr) throw new Error(fld + 'Expected ' + hexstr + ' saw ' + m);\r\n    this.l += hexstr.length>>1;\r\n  }\r\n\r\n  function prep_blob(blob, pos) {\r\n    blob.l = pos;\r\n    blob.read_shift = ReadShift;\r\n    blob.chk = CheckField;\r\n    blob.write_shift = WriteShift;\r\n  }\r\n\r\n  function parsenoop(blob, length) { blob.l += length; }\r\n\r\n  function new_buf(sz) {\r\n    var o = new_raw_buf(sz);\r\n    prep_blob(o, 0);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.1.4 Record */\r\n  function recordhopper(data, cb, opts) {\r\n    if(!data) return;\r\n    var tmpbyte, cntbyte, length;\r\n    prep_blob(data, data.l || 0);\r\n    var L = data.length, RT = 0, tgt = 0;\r\n    while(data.l < L) {\r\n      RT = data.read_shift(1);\r\n      if(RT & 0x80) RT = (RT & 0x7F) + ((data.read_shift(1) & 0x7F)<<7);\r\n      var R = XLSBRecordEnum[RT] || XLSBRecordEnum[0xFFFF];\r\n      tmpbyte = data.read_shift(1);\r\n      length = tmpbyte & 0x7F;\r\n      for(cntbyte = 1; cntbyte <4 && (tmpbyte & 0x80); ++cntbyte) length += ((tmpbyte = data.read_shift(1)) & 0x7F)<<(7*cntbyte);\r\n      tgt = data.l + length;\r\n      var d = (R.f||parsenoop)(data, length, opts);\r\n      data.l = tgt;\r\n      if(cb(d, R.n, RT)) return;\r\n    }\r\n  }\r\n\r\n  /* control buffer usage for fixed-length buffers */\r\n  function buf_array() {\r\n    var bufs = [], blksz = has_buf ? 256 : 2048;\r\n    var newblk = function ba_newblk(sz) {\r\n      var o = (new_buf(sz));\r\n      prep_blob(o, 0);\r\n      return o;\r\n    };\r\n\r\n    var curbuf = newblk(blksz);\r\n\r\n    var endbuf = function ba_endbuf() {\r\n      if(!curbuf) return;\r\n      if(curbuf.length > curbuf.l) { curbuf = curbuf.slice(0, curbuf.l); curbuf.l = curbuf.length; }\r\n      if(curbuf.length > 0) bufs.push(curbuf);\r\n      curbuf = null;\r\n    };\r\n\r\n    var next = function ba_next(sz) {\r\n      if(curbuf && (sz < (curbuf.length - curbuf.l))) return curbuf;\r\n      endbuf();\r\n      return (curbuf = newblk(Math.max(sz+1, blksz)));\r\n    };\r\n\r\n    var end = function ba_end() {\r\n      endbuf();\r\n      return __toBuffer([bufs]);\r\n    };\r\n\r\n    var push = function ba_push(buf) { endbuf(); curbuf = buf; if(curbuf.l == null) curbuf.l = curbuf.length; next(blksz); };\r\n\r\n    return ({ next:next, push:push, end:end, _bufs:bufs });\r\n  }\r\n\r\n  function write_record(ba, type, payload, length) {\r\n    var t = +XLSBRE[type], l;\r\n    if(isNaN(t)) return; // TODO: throw something here?\r\n    if(!length) length = XLSBRecordEnum[t].p || (payload||[]).length || 0;\r\n    l = 1 + (t >= 0x80 ? 1 : 0) + 1/* + length*/;\r\n    if(length >= 0x80) ++l; if(length >= 0x4000) ++l; if(length >= 0x200000) ++l;\r\n    var o = ba.next(l);\r\n    if(t <= 0x7F) o.write_shift(1, t);\r\n    else {\r\n      o.write_shift(1, (t & 0x7F) + 0x80);\r\n      o.write_shift(1, (t >> 7));\r\n    }\r\n    for(var i = 0; i != 4; ++i) {\r\n      if(length >= 0x80) { o.write_shift(1, (length & 0x7F)+0x80); length >>= 7; }\r\n      else { o.write_shift(1, length); break; }\r\n    }\r\n    if(length > 0 && is_buf(payload)) ba.push(payload);\r\n  }\r\n  /* XLS ranges enforced */\r\n  function shift_cell_xls(cell, tgt, opts) {\r\n    var out = dup(cell);\r\n    if(tgt.s) {\r\n      if(out.cRel) out.c += tgt.s.c;\r\n      if(out.rRel) out.r += tgt.s.r;\r\n    } else {\r\n      if(out.cRel) out.c += tgt.c;\r\n      if(out.rRel) out.r += tgt.r;\r\n    }\r\n    if(!opts || opts.biff < 12) {\r\n      while(out.c >= 0x100) out.c -= 0x100;\r\n      while(out.r >= 0x10000) out.r -= 0x10000;\r\n    }\r\n    return out;\r\n  }\r\n\r\n  function shift_range_xls(cell, range, opts) {\r\n    var out = dup(cell);\r\n    out.s = shift_cell_xls(out.s, range.s, opts);\r\n    out.e = shift_cell_xls(out.e, range.s, opts);\r\n    return out;\r\n  }\r\n\r\n  function encode_cell_xls(c, biff) {\r\n    if(c.cRel && c.c < 0) { c = dup(c); c.c += (biff > 8) ? 0x4000 : 0x100; }\r\n    if(c.rRel && c.r < 0) { c = dup(c); c.r += (biff > 8) ? 0x100000 : ((biff > 5) ? 0x10000 : 0x4000); }\r\n    var s = encode_cell(c);\r\n    if(c.cRel === 0) s = fix_col(s);\r\n    if(c.rRel === 0) s = fix_row(s);\r\n    return s;\r\n  }\r\n\r\n  function encode_range_xls(r, opts) {\r\n    if(r.s.r == 0 && !r.s.rRel) {\r\n      if(r.e.r == (opts.biff >= 12 ? 0xFFFFF : (opts.biff >= 8 ? 0x10000 : 0x4000)) && !r.e.rRel) {\r\n        return (r.s.cRel ? \"\" : \"$\") + encode_col(r.s.c) + \":\" + (r.e.cRel ? \"\" : \"$\") + encode_col(r.e.c);\r\n      }\r\n    }\r\n    if(r.s.c == 0 && !r.s.cRel) {\r\n      if(r.e.c == (opts.biff >= 12 ? 0xFFFF : 0xFF) && !r.e.cRel) {\r\n        return (r.s.rRel ? \"\" : \"$\") + encode_row(r.s.r) + \":\" + (r.e.rRel ? \"\" : \"$\") + encode_row(r.e.r);\r\n      }\r\n    }\r\n    return encode_cell_xls(r.s, opts.biff) + \":\" + encode_cell_xls(r.e, opts.biff);\r\n  }\r\n  var OFFCRYPTO = {};\r\n\r\n  var make_offcrypto = function(O, _crypto) {\r\n    var crypto;\r\n    if(typeof _crypto !== 'undefined') crypto = _crypto;\r\n    else if(typeof require !== 'undefined') {\r\n      try { crypto = undefined; }\r\n      catch(e) { crypto = null; }\r\n    }\r\n\r\n    O.rc4 = function(key, data) {\r\n      var S = new Array(256);\r\n      var c = 0, i = 0, j = 0, t = 0;\r\n      for(i = 0; i != 256; ++i) S[i] = i;\r\n      for(i = 0; i != 256; ++i) {\r\n        j = (j + S[i] + (key[i%key.length]).charCodeAt(0))&255;\r\n        t = S[i]; S[i] = S[j]; S[j] = t;\r\n      }\r\n      // $FlowIgnore\r\n      i = j = 0; var out = Buffer(data.length);\r\n      for(c = 0; c != data.length; ++c) {\r\n        i = (i + 1)&255;\r\n        j = (j + S[i])%256;\r\n        t = S[i]; S[i] = S[j]; S[j] = t;\r\n        out[c] = (data[c] ^ S[(S[i]+S[j])&255]);\r\n      }\r\n      return out;\r\n    };\r\n\r\n    O.md5 = function(hex) {\r\n      if(!crypto) throw new Error(\"Unsupported crypto\");\r\n      return crypto.createHash('md5').update(hex).digest('hex');\r\n    };\r\n  };\r\n  /*global crypto:true */\r\n  make_offcrypto(OFFCRYPTO, typeof crypto !== \"undefined\" ? crypto : undefined);\r\n\r\n  function decode_row(rowstr) { return parseInt(unfix_row(rowstr),10) - 1; }\r\n  function encode_row(row) { return \"\" + (row + 1); }\r\n  function fix_row(cstr) { return cstr.replace(/([A-Z]|^)(\\d+)$/,\"$1$$$2\"); }\r\n  function unfix_row(cstr) { return cstr.replace(/\\$(\\d+)$/,\"$1\"); }\r\n\r\n  function decode_col(colstr) { var c = unfix_col(colstr), d = 0, i = 0; for(; i !== c.length; ++i) d = 26*d + c.charCodeAt(i) - 64; return d - 1; }\r\n  function encode_col(col) { var s=\"\"; for(++col; col; col=Math.floor((col-1)/26)) s = String.fromCharCode(((col-1)%26) + 65) + s; return s; }\r\n  function fix_col(cstr) { return cstr.replace(/^([A-Z])/,\"$$$1\"); }\r\n  function unfix_col(cstr) { return cstr.replace(/^\\$([A-Z])/,\"$1\"); }\r\n\r\n  function split_cell(cstr) { return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/,\"$1,$2\").split(\",\"); }\r\n  function decode_cell(cstr) { var splt = split_cell(cstr); return { c:decode_col(splt[0]), r:decode_row(splt[1]) }; }\r\n  function encode_cell(cell) { return encode_col(cell.c) + encode_row(cell.r); }\r\n  function decode_range(range) { var x =range.split(\":\").map(decode_cell); return {s:x[0],e:x[x.length-1]}; }\r\n  function encode_range(cs,ce) {\r\n    if(typeof ce === 'undefined' || typeof ce === 'number') {\r\n      return encode_range(cs.s, cs.e);\r\n    }\r\n    if(typeof cs !== 'string') cs = encode_cell((cs));\r\n    if(typeof ce !== 'string') ce = encode_cell((ce));\r\n    return cs == ce ? cs : cs + \":\" + ce;\r\n  }\r\n\r\n  function safe_decode_range(range) {\r\n    var o = {s:{c:0,r:0},e:{c:0,r:0}};\r\n    var idx = 0, i = 0, cc = 0;\r\n    var len = range.length;\r\n    for(idx = 0; i < len; ++i) {\r\n      if((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\r\n      idx = 26*idx + cc;\r\n    }\r\n    o.s.c = --idx;\r\n\r\n    for(idx = 0; i < len; ++i) {\r\n      if((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\r\n      idx = 10*idx + cc;\r\n    }\r\n    o.s.r = --idx;\r\n\r\n    if(i === len || range.charCodeAt(++i) === 58) { o.e.c=o.s.c; o.e.r=o.s.r; return o; }\r\n\r\n    for(idx = 0; i != len; ++i) {\r\n      if((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\r\n      idx = 26*idx + cc;\r\n    }\r\n    o.e.c = --idx;\r\n\r\n    for(idx = 0; i != len; ++i) {\r\n      if((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\r\n      idx = 10*idx + cc;\r\n    }\r\n    o.e.r = --idx;\r\n    return o;\r\n  }\r\n\r\n  function safe_format_cell(cell, v) {\r\n    var q = (cell.t == 'd' && v instanceof Date);\r\n    if(cell.z != null) try { return (cell.w = SSF.format(cell.z, q ? datenum(v) : v)); } catch(e) { }\r\n    try { return (cell.w = SSF.format((cell.XF||{}).numFmtId||(q ? 14 : 0),  q ? datenum(v) : v)); } catch(e) { return ''+v; }\r\n  }\r\n\r\n  function format_cell(cell, v, o) {\r\n    if(cell == null || cell.t == null || cell.t == 'z') return \"\";\r\n    if(cell.w !== undefined) return cell.w;\r\n    if(cell.t == 'd' && !cell.z && o && o.dateNF) cell.z = o.dateNF;\r\n    if(v == undefined) return safe_format_cell(cell, cell.v);\r\n    return safe_format_cell(cell, v);\r\n  }\r\n\r\n  function sheet_to_workbook(sheet, opts) {\r\n    var n = opts && opts.sheet ? opts.sheet : \"Sheet1\";\r\n    var sheets = {}; sheets[n] = sheet;\r\n    return { SheetNames: [n], Sheets: sheets };\r\n  }\r\n\r\n  function sheet_add_aoa(_ws, data, opts) {\r\n    var o = opts || {};\r\n    var dense = _ws ? Array.isArray(_ws) : o.dense;\r\n    if(DENSE != null && dense == null) dense = DENSE;\r\n    var ws = _ws || (dense ? ([]) : ({}));\r\n    var _R = 0, _C = 0;\r\n    if(ws && o.origin != null) {\r\n      if(typeof o.origin == 'number') _R = o.origin;\r\n      else {\r\n        var _origin = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\r\n        _R = _origin.r; _C = _origin.c;\r\n      }\r\n    }\r\n    var range = ({s: {c:10000000, r:10000000}, e: {c:0, r:0}});\r\n    if(ws['!ref']) {\r\n      var _range = safe_decode_range(ws['!ref']);\r\n      range.s.c = _range.s.c;\r\n      range.s.r = _range.s.r;\r\n      range.e.c = Math.max(range.e.c, _range.e.c);\r\n      range.e.r = Math.max(range.e.r, _range.e.r);\r\n      if(_R == -1) range.e.r = _R = _range.e.r + 1;\r\n    }\r\n    for(var R = 0; R != data.length; ++R) {\r\n      if(!data[R]) continue;\r\n      if(!Array.isArray(data[R])) throw new Error(\"aoa_to_sheet expects an array of arrays\");\r\n      for(var C = 0; C != data[R].length; ++C) {\r\n        if(typeof data[R][C] === 'undefined') continue;\r\n        var cell = ({v: data[R][C] });\r\n        var __R = _R + R, __C = _C + C;\r\n        if(range.s.r > __R) range.s.r = __R;\r\n        if(range.s.c > __C) range.s.c = __C;\r\n        if(range.e.r < __R) range.e.r = __R;\r\n        if(range.e.c < __C) range.e.c = __C;\r\n        if(data[R][C] && typeof data[R][C] === 'object' && !Array.isArray(data[R][C]) && !(data[R][C] instanceof Date)) cell = data[R][C];\r\n        else {\r\n          if(Array.isArray(cell.v)) { cell.f = data[R][C][1]; cell.v = cell.v[0]; }\r\n          if(cell.v === null) { if(cell.f) cell.t = 'n'; else if(!o.sheetStubs) continue; else cell.t = 'z'; }\r\n          else if(typeof cell.v === 'number') cell.t = 'n';\r\n          else if(typeof cell.v === 'boolean') cell.t = 'b';\r\n          else if(cell.v instanceof Date) {\r\n            cell.z = o.dateNF || SSF._table[14];\r\n            if(o.cellDates) { cell.t = 'd'; cell.w = SSF.format(cell.z, datenum(cell.v)); }\r\n            else { cell.t = 'n'; cell.v = datenum(cell.v); cell.w = SSF.format(cell.z, cell.v); }\r\n          }\r\n          else cell.t = 's';\r\n        }\r\n        if(dense) {\r\n          if(!ws[__R]) ws[__R] = [];\r\n          ws[__R][__C] = cell;\r\n        } else {\r\n          var cell_ref = encode_cell(({c:__C,r:__R}));\r\n          ws[cell_ref] = cell;\r\n        }\r\n      }\r\n    }\r\n    if(range.s.c < 10000000) ws['!ref'] = encode_range(range);\r\n    return ws;\r\n  }\r\n  function aoa_to_sheet(data, opts) { return sheet_add_aoa(null, data, opts); }\r\n\r\n  function write_UInt32LE(x, o) {\r\n    if(!o) o = new_buf(4);\r\n    o.write_shift(4, x);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.5.168 */\r\n  function parse_XLWideString(data) {\r\n    var cchCharacters = data.read_shift(4);\r\n    return cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, 'dbcs');\r\n  }\r\n  function write_XLWideString(data, o) {\r\n    var _null = false; if(o == null) { _null = true; o = new_buf(4+2*data.length); }\r\n    o.write_shift(4, data.length);\r\n    if(data.length > 0) o.write_shift(0, data, 'dbcs');\r\n    return _null ? o.slice(0, o.l) : o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.5.143 */\r\n  function parse_StrRun(data) {\r\n    return { ich: data.read_shift(2), ifnt: data.read_shift(2) };\r\n  }\r\n  function write_StrRun(run, o) {\r\n    if(!o) o = new_buf(4);\r\n    o.write_shift(2, run.ich || 0);\r\n    o.write_shift(2, run.ifnt || 0);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.5.121 */\r\n  function parse_RichStr(data, length) {\r\n    var start = data.l;\r\n    var flags = data.read_shift(1);\r\n    var str = parse_XLWideString(data);\r\n    var rgsStrRun = [];\r\n    var z = ({ t: str, h: str });\r\n    if((flags & 1) !== 0) { /* fRichStr */\r\n      /* TODO: formatted string */\r\n      var dwSizeStrRun = data.read_shift(4);\r\n      for(var i = 0; i != dwSizeStrRun; ++i) rgsStrRun.push(parse_StrRun(data));\r\n      z.r = rgsStrRun;\r\n    }\r\n    else z.r = [{ich:0, ifnt:0}];\r\n    //if((flags & 2) !== 0) { /* fExtStr */\r\n    //\t/* TODO: phonetic string */\r\n    //}\r\n    data.l = start + length;\r\n    return z;\r\n  }\r\n  function write_RichStr(str, o) {\r\n    /* TODO: formatted string */\r\n    var _null = false; if(o == null) { _null = true; o = new_buf(15+4*str.t.length); }\r\n    o.write_shift(1,0);\r\n    write_XLWideString(str.t, o);\r\n    return _null ? o.slice(0, o.l) : o;\r\n  }\r\n  /* [MS-XLSB] 2.4.328 BrtCommentText (RichStr w/1 run) */\r\n  var parse_BrtCommentText = parse_RichStr;\r\n  function write_BrtCommentText(str, o) {\r\n    /* TODO: formatted string */\r\n    var _null = false; if(o == null) { _null = true; o = new_buf(23+4*str.t.length); }\r\n    o.write_shift(1,1);\r\n    write_XLWideString(str.t, o);\r\n    o.write_shift(4,1);\r\n    write_StrRun({ich:0,ifnt:0}, o);\r\n    return _null ? o.slice(0, o.l) : o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.5.9 */\r\n  function parse_XLSBCell(data) {\r\n    var col = data.read_shift(4);\r\n    var iStyleRef = data.read_shift(2);\r\n    iStyleRef += data.read_shift(1) <<16;\r\n    data.l++; //var fPhShow = data.read_shift(1);\r\n    return { c:col, iStyleRef: iStyleRef };\r\n  }\r\n  function write_XLSBCell(cell, o) {\r\n    if(o == null) o = new_buf(8);\r\n    o.write_shift(-4, cell.c);\r\n    o.write_shift(3, cell.iStyleRef || cell.s);\r\n    o.write_shift(1, 0); /* fPhShow */\r\n    return o;\r\n  }\r\n\r\n\r\n  /* [MS-XLSB] 2.5.21 */\r\n  var parse_XLSBCodeName = parse_XLWideString;\r\n  var write_XLSBCodeName = write_XLWideString;\r\n\r\n  /* [MS-XLSB] 2.5.166 */\r\n  function parse_XLNullableWideString(data) {\r\n    var cchCharacters = data.read_shift(4);\r\n    return cchCharacters === 0 || cchCharacters === 0xFFFFFFFF ? \"\" : data.read_shift(cchCharacters, 'dbcs');\r\n  }\r\n  function write_XLNullableWideString(data, o) {\r\n    var _null = false; if(o == null) { _null = true; o = new_buf(127); }\r\n    o.write_shift(4, data.length > 0 ? data.length : 0xFFFFFFFF);\r\n    if(data.length > 0) o.write_shift(0, data, 'dbcs');\r\n    return _null ? o.slice(0, o.l) : o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.5.165 */\r\n  var parse_XLNameWideString = parse_XLWideString;\r\n//var write_XLNameWideString = write_XLWideString;\r\n\r\n  /* [MS-XLSB] 2.5.114 */\r\n  var parse_RelID = parse_XLNullableWideString;\r\n  var write_RelID = write_XLNullableWideString;\r\n\r\n\r\n  /* [MS-XLS] 2.5.217 ; [MS-XLSB] 2.5.122 */\r\n  function parse_RkNumber(data) {\r\n    var b = data.slice(data.l, data.l+4);\r\n    var fX100 = (b[0] & 1), fInt = (b[0] & 2);\r\n    data.l+=4;\r\n    b[0] &= 0xFC; // b[0] &= ~3;\r\n    var RK = fInt === 0 ? __double([0,0,0,0,b[0],b[1],b[2],b[3]],0) : __readInt32LE(b,0)>>2;\r\n    return fX100 ? (RK/100) : RK;\r\n  }\r\n  function write_RkNumber(data, o) {\r\n    if(o == null) o = new_buf(4);\r\n    var fX100 = 0, fInt = 0, d100 = data * 100;\r\n    if((data == (data | 0)) && (data >= -(1<<29)) && (data < (1 << 29))) { fInt = 1; }\r\n    else if((d100 == (d100 | 0)) && (d100 >= -(1<<29)) && (d100 < (1 << 29))) { fInt = 1; fX100 = 1; }\r\n    if(fInt) o.write_shift(-4, ((fX100 ? d100 : data) << 2) + (fX100 + 2));\r\n    else throw new Error(\"unsupported RkNumber \" + data); // TODO\r\n  }\r\n\r\n\r\n  /* [MS-XLSB] 2.5.117 RfX */\r\n  function parse_RfX(data ) {\r\n    var cell = ({s: {}, e: {}});\r\n    cell.s.r = data.read_shift(4);\r\n    cell.e.r = data.read_shift(4);\r\n    cell.s.c = data.read_shift(4);\r\n    cell.e.c = data.read_shift(4);\r\n    return cell;\r\n  }\r\n  function write_RfX(r, o) {\r\n    if(!o) o = new_buf(16);\r\n    o.write_shift(4, r.s.r);\r\n    o.write_shift(4, r.e.r);\r\n    o.write_shift(4, r.s.c);\r\n    o.write_shift(4, r.e.c);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.5.153 UncheckedRfX */\r\n  var parse_UncheckedRfX = parse_RfX;\r\n  var write_UncheckedRfX = write_RfX;\r\n\r\n  /* [MS-XLS] 2.5.342 ; [MS-XLSB] 2.5.171 */\r\n  /* TODO: error checking, NaN and Infinity values are not valid Xnum */\r\n  function parse_Xnum(data) { return data.read_shift(8, 'f'); }\r\n  function write_Xnum(data, o) { return (o || new_buf(8)).write_shift(8, data, 'f'); }\r\n\r\n  /* [MS-XLSB] 2.5.97.2 */\r\n  var BErr = {\r\n    0x00: \"#NULL!\",\r\n    0x07: \"#DIV/0!\",\r\n    0x0F: \"#VALUE!\",\r\n    0x17: \"#REF!\",\r\n    0x1D: \"#NAME?\",\r\n    0x24: \"#NUM!\",\r\n    0x2A: \"#N/A\",\r\n    0x2B: \"#GETTING_DATA\",\r\n    0xFF: \"#WTF?\"\r\n  };\r\n  var RBErr = evert_num(BErr);\r\n\r\n  /* [MS-XLSB] 2.4.324 BrtColor */\r\n  function parse_BrtColor(data) {\r\n    var out = {};\r\n    var d = data.read_shift(1);\r\n\r\n    //var fValidRGB = d & 1;\r\n    var xColorType = d >>> 1;\r\n\r\n    var index = data.read_shift(1);\r\n    var nTS = data.read_shift(2, 'i');\r\n    var bR = data.read_shift(1);\r\n    var bG = data.read_shift(1);\r\n    var bB = data.read_shift(1);\r\n    data.l++; //var bAlpha = data.read_shift(1);\r\n\r\n    switch(xColorType) {\r\n      case 0: out.auto = 1; break;\r\n      case 1:\r\n        out.index = index;\r\n        var icv = XLSIcv[index];\r\n        /* automatic pseudo index 81 */\r\n        if(icv) out.rgb = rgb2Hex(icv);\r\n        break;\r\n      case 2:\r\n        /* if(!fValidRGB) throw new Error(\"invalid\"); */\r\n        out.rgb = rgb2Hex([bR, bG, bB]);\r\n        break;\r\n      case 3: out.theme = index; break;\r\n    }\r\n    if(nTS != 0) out.tint = nTS > 0 ? nTS / 32767 : nTS / 32768;\r\n\r\n    return out;\r\n  }\r\n  function write_BrtColor(color, o) {\r\n    if(!o) o = new_buf(8);\r\n    if(!color||color.auto) { o.write_shift(4, 0); o.write_shift(4, 0); return o; }\r\n    if(color.index) {\r\n      o.write_shift(1, 0x02);\r\n      o.write_shift(1, color.index);\r\n    } else if(color.theme) {\r\n      o.write_shift(1, 0x06);\r\n      o.write_shift(1, color.theme);\r\n    } else {\r\n      o.write_shift(1, 0x05);\r\n      o.write_shift(1, 0);\r\n    }\r\n    var nTS = color.tint || 0;\r\n    if(nTS > 0) nTS *= 32767;\r\n    else if(nTS < 0) nTS *= 32768;\r\n    o.write_shift(2, nTS);\r\n    if(!color.rgb) {\r\n      o.write_shift(2, 0);\r\n      o.write_shift(1, 0);\r\n      o.write_shift(1, 0);\r\n    } else {\r\n      var rgb = (color.rgb || 'FFFFFF');\r\n      o.write_shift(1, parseInt(rgb.slice(0,2),16));\r\n      o.write_shift(1, parseInt(rgb.slice(2,4),16));\r\n      o.write_shift(1, parseInt(rgb.slice(4,6),16));\r\n      o.write_shift(1, 0xFF);\r\n    }\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.5.52 */\r\n  function parse_FontFlags(data) {\r\n    var d = data.read_shift(1);\r\n    data.l++;\r\n    var out = {\r\n      /* fBold: d & 0x01 */\r\n      fItalic: d & 0x02,\r\n      /* fUnderline: d & 0x04 */\r\n      fStrikeout: d & 0x08,\r\n      fOutline: d & 0x10,\r\n      fShadow: d & 0x20,\r\n      fCondense: d & 0x40,\r\n      fExtend: d & 0x80\r\n    };\r\n    return out;\r\n  }\r\n  function write_FontFlags(font, o) {\r\n    if(!o) o = new_buf(2);\r\n    var grbit =\r\n      (font.italic   ? 0x02 : 0) |\r\n      (font.strike   ? 0x08 : 0) |\r\n      (font.outline  ? 0x10 : 0) |\r\n      (font.shadow   ? 0x20 : 0) |\r\n      (font.condense ? 0x40 : 0) |\r\n      (font.extend   ? 0x80 : 0);\r\n    o.write_shift(1, grbit);\r\n    o.write_shift(1, 0);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-OLEDS] 2.3.1 and 2.3.2 */\r\n  function parse_ClipboardFormatOrString(o, w) {\r\n    // $FlowIgnore\r\n    var ClipFmt = {2:\"BITMAP\",3:\"METAFILEPICT\",8:\"DIB\",14:\"ENHMETAFILE\"};\r\n    var m = o.read_shift(4);\r\n    switch(m) {\r\n      case 0x00000000: return \"\";\r\n      case 0xffffffff: case 0xfffffffe: return ClipFmt[o.read_shift(4)]||\"\";\r\n    }\r\n    if(m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\r\n    o.l -= 4;\r\n    return o.read_shift(0, w == 1 ? \"lpstr\" : \"lpwstr\");\r\n  }\r\n  function parse_ClipboardFormatOrAnsiString(o) { return parse_ClipboardFormatOrString(o, 1); }\r\n  function parse_ClipboardFormatOrUnicodeString(o) { return parse_ClipboardFormatOrString(o, 2); }\r\n\r\n  /* [MS-OLEPS] 2.2 PropertyType */\r\n//var VT_EMPTY    = 0x0000;\r\n//var VT_NULL     = 0x0001;\r\n  var VT_I2       = 0x0002;\r\n  var VT_I4       = 0x0003;\r\n//var VT_R4       = 0x0004;\r\n//var VT_R8       = 0x0005;\r\n//var VT_CY       = 0x0006;\r\n//var VT_DATE     = 0x0007;\r\n//var VT_BSTR     = 0x0008;\r\n//var VT_ERROR    = 0x000A;\r\n  var VT_BOOL     = 0x000B;\r\n  var VT_VARIANT  = 0x000C;\r\n//var VT_DECIMAL  = 0x000E;\r\n//var VT_I1       = 0x0010;\r\n//var VT_UI1      = 0x0011;\r\n//var VT_UI2      = 0x0012;\r\n  var VT_UI4      = 0x0013;\r\n//var VT_I8       = 0x0014;\r\n//var VT_UI8      = 0x0015;\r\n//var VT_INT      = 0x0016;\r\n//var VT_UINT     = 0x0017;\r\n  var VT_LPSTR    = 0x001E;\r\n//var VT_LPWSTR   = 0x001F;\r\n  var VT_FILETIME = 0x0040;\r\n  var VT_BLOB     = 0x0041;\r\n//var VT_STREAM   = 0x0042;\r\n//var VT_STORAGE  = 0x0043;\r\n//var VT_STREAMED_Object  = 0x0044;\r\n//var VT_STORED_Object    = 0x0045;\r\n//var VT_BLOB_Object      = 0x0046;\r\n  var VT_CF       = 0x0047;\r\n//var VT_CLSID    = 0x0048;\r\n//var VT_VERSIONED_STREAM = 0x0049;\r\n  var VT_VECTOR   = 0x1000;\r\n//var VT_ARRAY    = 0x2000;\r\n\r\n  var VT_STRING   = 0x0050; // 2.3.3.1.11 VtString\r\n  var VT_USTR     = 0x0051; // 2.3.3.1.12 VtUnalignedString\r\n  var VT_CUSTOM   = [VT_STRING, VT_USTR];\r\n\r\n  /* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\r\n  var DocSummaryPIDDSI = {\r\n    0x01: { n: 'CodePage', t: VT_I2 },\r\n    0x02: { n: 'Category', t: VT_STRING },\r\n    0x03: { n: 'PresentationFormat', t: VT_STRING },\r\n    0x04: { n: 'ByteCount', t: VT_I4 },\r\n    0x05: { n: 'LineCount', t: VT_I4 },\r\n    0x06: { n: 'ParagraphCount', t: VT_I4 },\r\n    0x07: { n: 'SlideCount', t: VT_I4 },\r\n    0x08: { n: 'NoteCount', t: VT_I4 },\r\n    0x09: { n: 'HiddenCount', t: VT_I4 },\r\n    0x0a: { n: 'MultimediaClipCount', t: VT_I4 },\r\n    0x0b: { n: 'ScaleCrop', t: VT_BOOL },\r\n    0x0c: { n: 'HeadingPairs', t: VT_VECTOR | VT_VARIANT },\r\n    0x0d: { n: 'TitlesOfParts', t: VT_VECTOR | VT_LPSTR },\r\n    0x0e: { n: 'Manager', t: VT_STRING },\r\n    0x0f: { n: 'Company', t: VT_STRING },\r\n    0x10: { n: 'LinksUpToDate', t: VT_BOOL },\r\n    0x11: { n: 'CharacterCount', t: VT_I4 },\r\n    0x13: { n: 'SharedDoc', t: VT_BOOL },\r\n    0x16: { n: 'HyperlinksChanged', t: VT_BOOL },\r\n    0x17: { n: 'AppVersion', t: VT_I4, p: 'version' },\r\n    0x18: { n: 'DigSig', t: VT_BLOB },\r\n    0x1A: { n: 'ContentType', t: VT_STRING },\r\n    0x1B: { n: 'ContentStatus', t: VT_STRING },\r\n    0x1C: { n: 'Language', t: VT_STRING },\r\n    0x1D: { n: 'Version', t: VT_STRING },\r\n    0xFF: {}\r\n  };\r\n\r\n  /* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\r\n  var SummaryPIDSI = {\r\n    0x01: { n: 'CodePage', t: VT_I2 },\r\n    0x02: { n: 'Title', t: VT_STRING },\r\n    0x03: { n: 'Subject', t: VT_STRING },\r\n    0x04: { n: 'Author', t: VT_STRING },\r\n    0x05: { n: 'Keywords', t: VT_STRING },\r\n    0x06: { n: 'Comments', t: VT_STRING },\r\n    0x07: { n: 'Template', t: VT_STRING },\r\n    0x08: { n: 'LastAuthor', t: VT_STRING },\r\n    0x09: { n: 'RevNumber', t: VT_STRING },\r\n    0x0A: { n: 'EditTime', t: VT_FILETIME },\r\n    0x0B: { n: 'LastPrinted', t: VT_FILETIME },\r\n    0x0C: { n: 'CreatedDate', t: VT_FILETIME },\r\n    0x0D: { n: 'ModifiedDate', t: VT_FILETIME },\r\n    0x0E: { n: 'PageCount', t: VT_I4 },\r\n    0x0F: { n: 'WordCount', t: VT_I4 },\r\n    0x10: { n: 'CharCount', t: VT_I4 },\r\n    0x11: { n: 'Thumbnail', t: VT_CF },\r\n    0x12: { n: 'Application', t: VT_STRING },\r\n    0x13: { n: 'DocSecurity', t: VT_I4 },\r\n    0xFF: {}\r\n  };\r\n\r\n  /* [MS-OLEPS] 2.18 */\r\n  var SpecialProperties = {\r\n    0x80000000: { n: 'Locale', t: VT_UI4 },\r\n    0x80000003: { n: 'Behavior', t: VT_UI4 },\r\n    0x72627262: {}\r\n  };\r\n\r\n  (function() {\r\n    for(var y in SpecialProperties) if(SpecialProperties.hasOwnProperty(y))\r\n      DocSummaryPIDDSI[y] = SummaryPIDSI[y] = SpecialProperties[y];\r\n  })();\r\n\r\n  var DocSummaryRE = evert_key(DocSummaryPIDDSI, \"n\");\r\n  var SummaryRE = evert_key(SummaryPIDSI, \"n\");\r\n\r\n  /* [MS-XLS] 2.4.63 Country/Region codes */\r\n  var CountryEnum = {\r\n    0x0001: \"US\", // United States\r\n    0x0002: \"CA\", // Canada\r\n    0x0003: \"\", // Latin America (except Brazil)\r\n    0x0007: \"RU\", // Russia\r\n    0x0014: \"EG\", // Egypt\r\n    0x001E: \"GR\", // Greece\r\n    0x001F: \"NL\", // Netherlands\r\n    0x0020: \"BE\", // Belgium\r\n    0x0021: \"FR\", // France\r\n    0x0022: \"ES\", // Spain\r\n    0x0024: \"HU\", // Hungary\r\n    0x0027: \"IT\", // Italy\r\n    0x0029: \"CH\", // Switzerland\r\n    0x002B: \"AT\", // Austria\r\n    0x002C: \"GB\", // United Kingdom\r\n    0x002D: \"DK\", // Denmark\r\n    0x002E: \"SE\", // Sweden\r\n    0x002F: \"NO\", // Norway\r\n    0x0030: \"PL\", // Poland\r\n    0x0031: \"DE\", // Germany\r\n    0x0034: \"MX\", // Mexico\r\n    0x0037: \"BR\", // Brazil\r\n    0x003d: \"AU\", // Australia\r\n    0x0040: \"NZ\", // New Zealand\r\n    0x0042: \"TH\", // Thailand\r\n    0x0051: \"JP\", // Japan\r\n    0x0052: \"KR\", // Korea\r\n    0x0054: \"VN\", // Viet Nam\r\n    0x0056: \"CN\", // China\r\n    0x005A: \"TR\", // Turkey\r\n    0x0069: \"JS\", // Ramastan\r\n    0x00D5: \"DZ\", // Algeria\r\n    0x00D8: \"MA\", // Morocco\r\n    0x00DA: \"LY\", // Libya\r\n    0x015F: \"PT\", // Portugal\r\n    0x0162: \"IS\", // Iceland\r\n    0x0166: \"FI\", // Finland\r\n    0x01A4: \"CZ\", // Czech Republic\r\n    0x0376: \"TW\", // Taiwan\r\n    0x03C1: \"LB\", // Lebanon\r\n    0x03C2: \"JO\", // Jordan\r\n    0x03C3: \"SY\", // Syria\r\n    0x03C4: \"IQ\", // Iraq\r\n    0x03C5: \"KW\", // Kuwait\r\n    0x03C6: \"SA\", // Saudi Arabia\r\n    0x03CB: \"AE\", // United Arab Emirates\r\n    0x03CC: \"IL\", // Israel\r\n    0x03CE: \"QA\", // Qatar\r\n    0x03D5: \"IR\", // Iran\r\n    0xFFFF: \"US\"  // United States\r\n  };\r\n\r\n  /* [MS-XLS] 2.5.127 */\r\n  var XLSFillPattern = [\r\n    null,\r\n    'solid',\r\n    'mediumGray',\r\n    'darkGray',\r\n    'lightGray',\r\n    'darkHorizontal',\r\n    'darkVertical',\r\n    'darkDown',\r\n    'darkUp',\r\n    'darkGrid',\r\n    'darkTrellis',\r\n    'lightHorizontal',\r\n    'lightVertical',\r\n    'lightDown',\r\n    'lightUp',\r\n    'lightGrid',\r\n    'lightTrellis',\r\n    'gray125',\r\n    'gray0625'\r\n  ];\r\n\r\n  function rgbify(arr) { return arr.map(function(x) { return [(x>>16)&255,(x>>8)&255,x&255]; }); }\r\n\r\n  /* [MS-XLS] 2.5.161 */\r\n  /* [MS-XLSB] 2.5.75 Icv */\r\n  var XLSIcv = rgbify([\r\n    /* Color Constants */\r\n    0x000000,\r\n    0xFFFFFF,\r\n    0xFF0000,\r\n    0x00FF00,\r\n    0x0000FF,\r\n    0xFFFF00,\r\n    0xFF00FF,\r\n    0x00FFFF,\r\n\r\n    /* Overridable Defaults */\r\n    0x000000,\r\n    0xFFFFFF,\r\n    0xFF0000,\r\n    0x00FF00,\r\n    0x0000FF,\r\n    0xFFFF00,\r\n    0xFF00FF,\r\n    0x00FFFF,\r\n\r\n    0x800000,\r\n    0x008000,\r\n    0x000080,\r\n    0x808000,\r\n    0x800080,\r\n    0x008080,\r\n    0xC0C0C0,\r\n    0x808080,\r\n    0x9999FF,\r\n    0x993366,\r\n    0xFFFFCC,\r\n    0xCCFFFF,\r\n    0x660066,\r\n    0xFF8080,\r\n    0x0066CC,\r\n    0xCCCCFF,\r\n\r\n    0x000080,\r\n    0xFF00FF,\r\n    0xFFFF00,\r\n    0x00FFFF,\r\n    0x800080,\r\n    0x800000,\r\n    0x008080,\r\n    0x0000FF,\r\n    0x00CCFF,\r\n    0xCCFFFF,\r\n    0xCCFFCC,\r\n    0xFFFF99,\r\n    0x99CCFF,\r\n    0xFF99CC,\r\n    0xCC99FF,\r\n    0xFFCC99,\r\n\r\n    0x3366FF,\r\n    0x33CCCC,\r\n    0x99CC00,\r\n    0xFFCC00,\r\n    0xFF9900,\r\n    0xFF6600,\r\n    0x666699,\r\n    0x969696,\r\n    0x003366,\r\n    0x339966,\r\n    0x003300,\r\n    0x333300,\r\n    0x993300,\r\n    0x993366,\r\n    0x333399,\r\n    0x333333,\r\n\r\n    /* Other entries to appease BIFF8/12 */\r\n    0xFFFFFF, /* 0x40 icvForeground ?? */\r\n    0x000000, /* 0x41 icvBackground ?? */\r\n    0x000000, /* 0x42 icvFrame ?? */\r\n    0x000000, /* 0x43 icv3D ?? */\r\n    0x000000, /* 0x44 icv3DText ?? */\r\n    0x000000, /* 0x45 icv3DHilite ?? */\r\n    0x000000, /* 0x46 icv3DShadow ?? */\r\n    0x000000, /* 0x47 icvHilite ?? */\r\n    0x000000, /* 0x48 icvCtlText ?? */\r\n    0x000000, /* 0x49 icvCtlScrl ?? */\r\n    0x000000, /* 0x4A icvCtlInv ?? */\r\n    0x000000, /* 0x4B icvCtlBody ?? */\r\n    0x000000, /* 0x4C icvCtlFrame ?? */\r\n    0x000000, /* 0x4D icvCtlFore ?? */\r\n    0x000000, /* 0x4E icvCtlBack ?? */\r\n    0x000000, /* 0x4F icvCtlNeutral */\r\n    0x000000, /* 0x50 icvInfoBk ?? */\r\n    0x000000 /* 0x51 icvInfoText ?? */\r\n  ]);\r\n\r\n  /* Parts enumerated in OPC spec, MS-XLSB and MS-XLSX */\r\n  /* 12.3 Part Summary <SpreadsheetML> */\r\n  /* 14.2 Part Summary <DrawingML> */\r\n  /* [MS-XLSX] 2.1 Part Enumerations ; [MS-XLSB] 2.1.7 Part Enumeration */\r\n  var ct2type/*{[string]:string}*/ = ({\r\n    /* Workbook */\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\": \"workbooks\",\r\n\r\n    /* Worksheet */\r\n    \"application/vnd.ms-excel.binIndexWs\": \"TODO\", /* Binary Index */\r\n\r\n    /* Macrosheet */\r\n    \"application/vnd.ms-excel.intlmacrosheet\": \"TODO\",\r\n    \"application/vnd.ms-excel.binIndexMs\": \"TODO\", /* Binary Index */\r\n\r\n    /* File Properties */\r\n    \"application/vnd.openxmlformats-package.core-properties+xml\": \"coreprops\",\r\n    \"application/vnd.openxmlformats-officedocument.custom-properties+xml\": \"custprops\",\r\n    \"application/vnd.openxmlformats-officedocument.extended-properties+xml\": \"extprops\",\r\n\r\n    /* Custom Data Properties */\r\n    \"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty\": \"TODO\",\r\n\r\n    /* PivotTable */\r\n    \"application/vnd.ms-excel.pivotTable\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml\": \"TODO\",\r\n\r\n    /* Chart Colors */\r\n    \"application/vnd.ms-office.chartcolorstyle+xml\": \"TODO\",\r\n\r\n    /* Chart Style */\r\n    \"application/vnd.ms-office.chartstyle+xml\": \"TODO\",\r\n\r\n    /* Calculation Chain */\r\n    \"application/vnd.ms-excel.calcChain\": \"calcchains\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\": \"calcchains\",\r\n\r\n    /* Printer Settings */\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings\": \"TODO\",\r\n\r\n    /* ActiveX */\r\n    \"application/vnd.ms-office.activeX\": \"TODO\",\r\n    \"application/vnd.ms-office.activeX+xml\": \"TODO\",\r\n\r\n    /* Custom Toolbars */\r\n    \"application/vnd.ms-excel.attachedToolbars\": \"TODO\",\r\n\r\n    /* External Data Connections */\r\n    \"application/vnd.ms-excel.connections\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml\": \"TODO\",\r\n\r\n    /* External Links */\r\n    \"application/vnd.ms-excel.externalLink\": \"links\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\": \"links\",\r\n\r\n    /* Metadata */\r\n    \"application/vnd.ms-excel.sheetMetadata\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\": \"TODO\",\r\n\r\n    /* PivotCache */\r\n    \"application/vnd.ms-excel.pivotCacheDefinition\": \"TODO\",\r\n    \"application/vnd.ms-excel.pivotCacheRecords\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml\": \"TODO\",\r\n\r\n    /* Query Table */\r\n    \"application/vnd.ms-excel.queryTable\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml\": \"TODO\",\r\n\r\n    /* Shared Workbook */\r\n    \"application/vnd.ms-excel.userNames\": \"TODO\",\r\n    \"application/vnd.ms-excel.revisionHeaders\": \"TODO\",\r\n    \"application/vnd.ms-excel.revisionLog\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml\": \"TODO\",\r\n\r\n    /* Single Cell Table */\r\n    \"application/vnd.ms-excel.tableSingleCells\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml\": \"TODO\",\r\n\r\n    /* Slicer */\r\n    \"application/vnd.ms-excel.slicer\": \"TODO\",\r\n    \"application/vnd.ms-excel.slicerCache\": \"TODO\",\r\n    \"application/vnd.ms-excel.slicer+xml\": \"TODO\",\r\n    \"application/vnd.ms-excel.slicerCache+xml\": \"TODO\",\r\n\r\n    /* Sort Map */\r\n    \"application/vnd.ms-excel.wsSortMap\": \"TODO\",\r\n\r\n    /* Table */\r\n    \"application/vnd.ms-excel.table\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\": \"TODO\",\r\n\r\n    /* Themes */\r\n    \"application/vnd.openxmlformats-officedocument.theme+xml\": \"themes\",\r\n\r\n    /* Theme Override */\r\n    \"application/vnd.openxmlformats-officedocument.themeOverride+xml\": \"TODO\",\r\n\r\n    /* Timeline */\r\n    \"application/vnd.ms-excel.Timeline+xml\": \"TODO\", /* verify */\r\n    \"application/vnd.ms-excel.TimelineCache+xml\": \"TODO\", /* verify */\r\n\r\n    /* VBA */\r\n    \"application/vnd.ms-office.vbaProject\": \"vba\",\r\n    \"application/vnd.ms-office.vbaProjectSignature\": \"vba\",\r\n\r\n    /* Volatile Dependencies */\r\n    \"application/vnd.ms-office.volatileDependencies\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml\": \"TODO\",\r\n\r\n    /* Control Properties */\r\n    \"application/vnd.ms-excel.controlproperties+xml\": \"TODO\",\r\n\r\n    /* Data Model */\r\n    \"application/vnd.openxmlformats-officedocument.model+data\": \"TODO\",\r\n\r\n    /* Survey */\r\n    \"application/vnd.ms-excel.Survey+xml\": \"TODO\",\r\n\r\n    /* Drawing */\r\n    \"application/vnd.openxmlformats-officedocument.drawing+xml\": \"drawings\",\r\n    \"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml\": \"TODO\",\r\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml\": \"TODO\",\r\n\r\n    /* VML */\r\n    \"application/vnd.openxmlformats-officedocument.vmlDrawing\": \"TODO\",\r\n\r\n    \"application/vnd.openxmlformats-package.relationships+xml\": \"rels\",\r\n    \"application/vnd.openxmlformats-officedocument.oleObject\": \"TODO\",\r\n\r\n    /* Image */\r\n    \"image/png\": \"TODO\",\r\n\r\n    \"sheet\": \"js\"\r\n  });\r\n\r\n  var CT_LIST = (function(){\r\n    var o = {\r\n      workbooks: {\r\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\",\r\n        xlsm: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\r\n        xlsb: \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",\r\n        xlam: \"application/vnd.ms-excel.addin.macroEnabled.main+xml\",\r\n        xltx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\"\r\n      },\r\n      strs: { /* Shared Strings */\r\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\",\r\n        xlsb: \"application/vnd.ms-excel.sharedStrings\"\r\n      },\r\n      comments: { /* Comments */\r\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\",\r\n        xlsb: \"application/vnd.ms-excel.comments\"\r\n      },\r\n      sheets: { /* Worksheet */\r\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\",\r\n        xlsb: \"application/vnd.ms-excel.worksheet\"\r\n      },\r\n      charts: { /* Chartsheet */\r\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\",\r\n        xlsb: \"application/vnd.ms-excel.chartsheet\"\r\n      },\r\n      dialogs: { /* Dialogsheet */\r\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\",\r\n        xlsb: \"application/vnd.ms-excel.dialogsheet\"\r\n      },\r\n      macros: { /* Macrosheet (Excel 4.0 Macros) */\r\n        xlsx: \"application/vnd.ms-excel.macrosheet+xml\",\r\n        xlsb: \"application/vnd.ms-excel.macrosheet\"\r\n      },\r\n      styles: { /* Styles */\r\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\",\r\n        xlsb: \"application/vnd.ms-excel.styles\"\r\n      }\r\n    };\r\n    keys(o).forEach(function(k) { [\"xlsm\", \"xlam\"].forEach(function(v) { if(!o[k][v]) o[k][v] = o[k].xlsx; }); });\r\n    keys(o).forEach(function(k){ keys(o[k]).forEach(function(v) { ct2type[o[k][v]] = k; }); });\r\n    return o;\r\n  })();\r\n\r\n  var type2ct/*{[string]:Array<string>}*/ = evert_arr(ct2type);\r\n\r\n  XMLNS.CT = 'http://schemas.openxmlformats.org/package/2006/content-types';\r\n\r\n  function new_ct() {\r\n    return ({\r\n      workbooks:[], sheets:[], charts:[], dialogs:[], macros:[],\r\n      rels:[], strs:[], comments:[], links:[],\r\n      coreprops:[], extprops:[], custprops:[], themes:[], styles:[],\r\n      calcchains:[], vba: [], drawings: [],\r\n      TODO:[], xmlns: \"\" });\r\n  }\r\n\r\n  function parse_ct(data) {\r\n    var ct = new_ct();\r\n    if(!data || !data.match) return ct;\r\n    var ctext = {};\r\n    (data.match(tagregex)||[]).forEach(function(x) {\r\n      var y = parsexmltag(x);\r\n      switch(y[0].replace(nsregex,\"<\")) {\r\n        case '<?xml': break;\r\n        case '<Types': ct.xmlns = y['xmlns' + (y[0].match(/<(\\w+):/)||[\"\",\"\"])[1] ]; break;\r\n        case '<Default': ctext[y.Extension] = y.ContentType; break;\r\n        case '<Override':\r\n          if(ct[ct2type[y.ContentType]] !== undefined) ct[ct2type[y.ContentType]].push(y.PartName);\r\n          break;\r\n      }\r\n    });\r\n    if(ct.xmlns !== XMLNS.CT) throw new Error(\"Unknown Namespace: \" + ct.xmlns);\r\n    ct.calcchain = ct.calcchains.length > 0 ? ct.calcchains[0] : \"\";\r\n    ct.sst = ct.strs.length > 0 ? ct.strs[0] : \"\";\r\n    ct.style = ct.styles.length > 0 ? ct.styles[0] : \"\";\r\n    ct.defaults = ctext;\r\n    delete ct.calcchains;\r\n    return ct;\r\n  }\r\n\r\n  var CTYPE_XML_ROOT = writextag('Types', null, {\r\n    'xmlns': XMLNS.CT,\r\n    'xmlns:xsd': XMLNS.xsd,\r\n    'xmlns:xsi': XMLNS.xsi\r\n  });\r\n\r\n  var CTYPE_DEFAULTS = [\r\n    ['xml', 'application/xml'],\r\n    ['bin', 'application/vnd.ms-excel.sheet.binary.macroEnabled.main'],\r\n    ['vml', 'application/vnd.openxmlformats-officedocument.vmlDrawing'],\r\n    /* from test files */\r\n    ['bmp', 'image/bmp'],\r\n    ['png', 'image/png'],\r\n    ['gif', 'image/gif'],\r\n    ['emf', 'image/x-emf'],\r\n    ['wmf', 'image/x-wmf'],\r\n    ['jpg', 'image/jpeg'], ['jpeg', 'image/jpeg'],\r\n    ['tif', 'image/tiff'], ['tiff', 'image/tiff'],\r\n    ['pdf', 'application/pdf'],\r\n    ['rels', type2ct.rels[0]]\r\n  ].map(function(x) {\r\n    return writextag('Default', null, {'Extension':x[0], 'ContentType': x[1]});\r\n  });\r\n\r\n  function write_ct(ct, opts) {\r\n    var o = [], v;\r\n    o[o.length] = (XML_HEADER);\r\n    o[o.length] = (CTYPE_XML_ROOT);\r\n    o = o.concat(CTYPE_DEFAULTS);\r\n    var f1 = function(w) {\r\n      if(ct[w] && ct[w].length > 0) {\r\n        v = ct[w][0];\r\n        o[o.length] = (writextag('Override', null, {\r\n          'PartName': (v[0] == '/' ? \"\":\"/\") + v,\r\n          'ContentType': CT_LIST[w][opts.bookType || 'xlsx']\r\n        }));\r\n      }\r\n    };\r\n    var f2 = function(w) {\r\n      (ct[w]||[]).forEach(function(v) {\r\n        o[o.length] = (writextag('Override', null, {\r\n          'PartName': (v[0] == '/' ? \"\":\"/\") + v,\r\n          'ContentType': CT_LIST[w][opts.bookType || 'xlsx']\r\n        }));\r\n      });\r\n    };\r\n    var f3 = function(t) {\r\n      (ct[t]||[]).forEach(function(v) {\r\n        o[o.length] = (writextag('Override', null, {\r\n          'PartName': (v[0] == '/' ? \"\":\"/\") + v,\r\n          'ContentType': type2ct[t][0]\r\n        }));\r\n      });\r\n    };\r\n    f1('workbooks');\r\n    f2('sheets');\r\n    f2('charts');\r\n    f3('themes');\r\n    ['strs', 'styles'].forEach(f1);\r\n    ['coreprops', 'extprops', 'custprops'].forEach(f3);\r\n    f3('vba');\r\n    f3('comments');\r\n    f3('drawings');\r\n    if(o.length>2){ o[o.length] = ('</Types>'); o[1]=o[1].replace(\"/>\",\">\"); }\r\n    return o.join(\"\");\r\n  }\r\n  /* 9.3 Relationships */\r\n  var RELS = ({\r\n    WB: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\r\n    SHEET: \"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\r\n    HLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\",\r\n    VML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\",\r\n    VBA: \"http://schemas.microsoft.com/office/2006/relationships/vbaProject\"\r\n  });\r\n\r\n  /* 9.3.3 Representing Relationships */\r\n  function get_rels_path(file) {\r\n    var n = file.lastIndexOf(\"/\");\r\n    return file.slice(0,n+1) + '_rels/' + file.slice(n+1) + \".rels\";\r\n  }\r\n\r\n  function parse_rels(data, currentFilePath) {\r\n    if (!data) return data;\r\n    if (currentFilePath.charAt(0) !== '/') {\r\n      currentFilePath = '/'+currentFilePath;\r\n    }\r\n    var rels = {};\r\n    var hash = {};\r\n\r\n    (data.match(tagregex)||[]).forEach(function(x) {\r\n      var y = parsexmltag(x);\r\n      /* 9.3.2.2 OPC_Relationships */\r\n      if (y[0] === '<Relationship') {\r\n        var rel = {}; rel.Type = y.Type; rel.Target = y.Target; rel.Id = y.Id; rel.TargetMode = y.TargetMode;\r\n        var canonictarget = y.TargetMode === 'External' ? y.Target : resolve_path(y.Target, currentFilePath);\r\n        rels[canonictarget] = rel;\r\n        hash[y.Id] = rel;\r\n      }\r\n    });\r\n    rels[\"!id\"] = hash;\r\n    return rels;\r\n  }\r\n\r\n  XMLNS.RELS = 'http://schemas.openxmlformats.org/package/2006/relationships';\r\n\r\n  var RELS_ROOT = writextag('Relationships', null, {\r\n    //'xmlns:ns0': XMLNS.RELS,\r\n    'xmlns': XMLNS.RELS\r\n  });\r\n\r\n  /* TODO */\r\n  function write_rels(rels) {\r\n    var o = [XML_HEADER, RELS_ROOT];\r\n    keys(rels['!id']).forEach(function(rid) {\r\n      o[o.length] = (writextag('Relationship', null, rels['!id'][rid]));\r\n    });\r\n    if(o.length>2){ o[o.length] = ('</Relationships>'); o[1]=o[1].replace(\"/>\",\">\"); }\r\n    return o.join(\"\");\r\n  }\r\n\r\n  function add_rels(rels, rId, f, type, relobj) {\r\n    if(!relobj) relobj = {};\r\n    if(!rels['!id']) rels['!id'] = {};\r\n    if(rId < 0) for(rId = 1; rels['!id']['rId' + rId]; ++rId){/* empty */}\r\n    relobj.Id = 'rId' + rId;\r\n    relobj.Type = type;\r\n    relobj.Target = f;\r\n    if(relobj.Type == RELS.HLINK) relobj.TargetMode = \"External\";\r\n    if(rels['!id'][relobj.Id]) throw new Error(\"Cannot rewrite rId \" + rId);\r\n    rels['!id'][relobj.Id] = relobj;\r\n    rels[('/' + relobj.Target).replace(\"//\",\"/\")] = relobj;\r\n    return rId;\r\n  }\r\n  /* Open Document Format for Office Applications (OpenDocument) Version 1.2 */\r\n  /* Part 3 Section 4 Manifest File */\r\n  var CT_ODS = \"application/vnd.oasis.opendocument.spreadsheet\";\r\n  function parse_manifest(d, opts) {\r\n    var str = xlml_normalize(d);\r\n    var Rn;\r\n    var FEtag;\r\n    while((Rn = xlmlregex.exec(str))) switch(Rn[3]) {\r\n      case 'manifest': break; // 4.2 <manifest:manifest>\r\n      case 'file-entry': // 4.3 <manifest:file-entry>\r\n        FEtag = parsexmltag(Rn[0], false);\r\n        if(FEtag.path == '/' && FEtag.type !== CT_ODS) throw new Error(\"This OpenDocument is not a spreadsheet\");\r\n        break;\r\n      case 'encryption-data': // 4.4 <manifest:encryption-data>\r\n      case 'algorithm': // 4.5 <manifest:algorithm>\r\n      case 'start-key-generation': // 4.6 <manifest:start-key-generation>\r\n      case 'key-derivation': // 4.7 <manifest:key-derivation>\r\n        throw new Error(\"Unsupported ODS Encryption\");\r\n      default: if(opts && opts.WTF) throw Rn;\r\n    }\r\n  }\r\n\r\n  function write_manifest(manifest) {\r\n    var o = [XML_HEADER];\r\n    o.push('<manifest:manifest xmlns:manifest=\"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0\" manifest:version=\"1.2\">\\n');\r\n    o.push('  <manifest:file-entry manifest:full-path=\"/\" manifest:version=\"1.2\" manifest:media-type=\"application/vnd.oasis.opendocument.spreadsheet\"/>\\n');\r\n    for(var i = 0; i < manifest.length; ++i) o.push('  <manifest:file-entry manifest:full-path=\"' + manifest[i][0] + '\" manifest:media-type=\"' + manifest[i][1] + '\"/>\\n');\r\n    o.push('</manifest:manifest>');\r\n    return o.join(\"\");\r\n  }\r\n\r\n  /* Part 3 Section 6 Metadata Manifest File */\r\n  function write_rdf_type(file, res, tag) {\r\n    return [\r\n      '  <rdf:Description rdf:about=\"' + file + '\">\\n',\r\n      '    <rdf:type rdf:resource=\"http://docs.oasis-open.org/ns/office/1.2/meta/' + (tag || \"odf\") + '#' + res + '\"/>\\n',\r\n      '  </rdf:Description>\\n'\r\n    ].join(\"\");\r\n  }\r\n  function write_rdf_has(base, file) {\r\n    return [\r\n      '  <rdf:Description rdf:about=\"' + base + '\">\\n',\r\n      '    <ns0:hasPart xmlns:ns0=\"http://docs.oasis-open.org/ns/office/1.2/meta/pkg#\" rdf:resource=\"' + file + '\"/>\\n',\r\n      '  </rdf:Description>\\n'\r\n    ].join(\"\");\r\n  }\r\n  function write_rdf(rdf) {\r\n    var o = [XML_HEADER];\r\n    o.push('<rdf:RDF xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\\n');\r\n    for(var i = 0; i != rdf.length; ++i) {\r\n      o.push(write_rdf_type(rdf[i][0], rdf[i][1]));\r\n      o.push(write_rdf_has(\"\",rdf[i][0]));\r\n    }\r\n    o.push(write_rdf_type(\"\",\"Document\", \"pkg\"));\r\n    o.push('</rdf:RDF>');\r\n    return o.join(\"\");\r\n  }\r\n  /* TODO: pull properties */\r\n  var write_meta_ods = (function() {\r\n    var payload = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><office:document-meta xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:meta=\"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" office:version=\"1.2\"><office:meta><meta:generator>Sheet' + 'JS ' + XLSX.version + '</meta:generator></office:meta></office:document-meta>';\r\n    return function wmo() {\r\n      return payload;\r\n    };\r\n  })();\r\n\r\n  /* ECMA-376 Part II 11.1 Core Properties Part */\r\n  /* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\r\n  var CORE_PROPS = [\r\n    [\"cp:category\", \"Category\"],\r\n    [\"cp:contentStatus\", \"ContentStatus\"],\r\n    [\"cp:keywords\", \"Keywords\"],\r\n    [\"cp:lastModifiedBy\", \"LastAuthor\"],\r\n    [\"cp:lastPrinted\", \"LastPrinted\"],\r\n    [\"cp:revision\", \"RevNumber\"],\r\n    [\"cp:version\", \"Version\"],\r\n    [\"dc:creator\", \"Author\"],\r\n    [\"dc:description\", \"Comments\"],\r\n    [\"dc:identifier\", \"Identifier\"],\r\n    [\"dc:language\", \"Language\"],\r\n    [\"dc:subject\", \"Subject\"],\r\n    [\"dc:title\", \"Title\"],\r\n    [\"dcterms:created\", \"CreatedDate\", 'date'],\r\n    [\"dcterms:modified\", \"ModifiedDate\", 'date']\r\n  ];\r\n\r\n  XMLNS.CORE_PROPS = \"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\";\r\n  RELS.CORE_PROPS  = 'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties';\r\n\r\n  var CORE_PROPS_REGEX = (function() {\r\n    var r = new Array(CORE_PROPS.length);\r\n    for(var i = 0; i < CORE_PROPS.length; ++i) {\r\n      var f = CORE_PROPS[i];\r\n      var g = \"(?:\"+ f[0].slice(0,f[0].indexOf(\":\")) +\":)\"+ f[0].slice(f[0].indexOf(\":\")+1);\r\n      r[i] = new RegExp(\"<\" + g + \"[^>]*>([\\\\s\\\\S]*?)<\\/\" + g + \">\");\r\n    }\r\n    return r;\r\n  })();\r\n\r\n  function parse_core_props(data) {\r\n    var p = {};\r\n    data = utf8read(data);\r\n\r\n    for(var i = 0; i < CORE_PROPS.length; ++i) {\r\n      var f = CORE_PROPS[i], cur = data.match(CORE_PROPS_REGEX[i]);\r\n      if(cur != null && cur.length > 0) p[f[1]] = cur[1];\r\n      if(f[2] === 'date' && p[f[1]]) p[f[1]] = parseDate(p[f[1]]);\r\n    }\r\n\r\n    return p;\r\n  }\r\n\r\n  var CORE_PROPS_XML_ROOT = writextag('cp:coreProperties', null, {\r\n    //'xmlns': XMLNS.CORE_PROPS,\r\n    'xmlns:cp': XMLNS.CORE_PROPS,\r\n    'xmlns:dc': XMLNS.dc,\r\n    'xmlns:dcterms': XMLNS.dcterms,\r\n    'xmlns:dcmitype': XMLNS.dcmitype,\r\n    'xmlns:xsi': XMLNS.xsi\r\n  });\r\n\r\n  function cp_doit(f, g, h, o, p) {\r\n    if(p[f] != null || g == null || g === \"\") return;\r\n    p[f] = g;\r\n    o[o.length] = (h ? writextag(f,g,h) : writetag(f,g));\r\n  }\r\n\r\n  function write_core_props(cp, _opts) {\r\n    var opts = _opts || {};\r\n    var o = [XML_HEADER, CORE_PROPS_XML_ROOT], p = {};\r\n    if(!cp && !opts.Props) return o.join(\"\");\r\n\r\n    if(cp) {\r\n      if(cp.CreatedDate != null) cp_doit(\"dcterms:created\", typeof cp.CreatedDate === \"string\" ? cp.CreatedDate : write_w3cdtf(cp.CreatedDate, opts.WTF), {\"xsi:type\":\"dcterms:W3CDTF\"}, o, p);\r\n      if(cp.ModifiedDate != null) cp_doit(\"dcterms:modified\", typeof cp.ModifiedDate === \"string\" ? cp.ModifiedDate : write_w3cdtf(cp.ModifiedDate, opts.WTF), {\"xsi:type\":\"dcterms:W3CDTF\"}, o, p);\r\n    }\r\n\r\n    for(var i = 0; i != CORE_PROPS.length; ++i) {\r\n      var f = CORE_PROPS[i];\r\n      var v = opts.Props && opts.Props[f[1]] != null ? opts.Props[f[1]] : cp ? cp[f[1]] : null;\r\n      if(v === true) v = \"1\";\r\n      else if(v === false) v = \"0\";\r\n      else if(typeof v == \"number\") v = String(v);\r\n      if(v != null) cp_doit(f[0], v, null, o, p);\r\n    }\r\n    if(o.length>2){ o[o.length] = ('</cp:coreProperties>'); o[1]=o[1].replace(\"/>\",\">\"); }\r\n    return o.join(\"\");\r\n  }\r\n  /* 15.2.12.3 Extended File Properties Part */\r\n  /* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\r\n  var EXT_PROPS = [\r\n    [\"Application\", \"Application\", \"string\"],\r\n    [\"AppVersion\", \"AppVersion\", \"string\"],\r\n    [\"Company\", \"Company\", \"string\"],\r\n    [\"DocSecurity\", \"DocSecurity\", \"string\"],\r\n    [\"Manager\", \"Manager\", \"string\"],\r\n    [\"HyperlinksChanged\", \"HyperlinksChanged\", \"bool\"],\r\n    [\"SharedDoc\", \"SharedDoc\", \"bool\"],\r\n    [\"LinksUpToDate\", \"LinksUpToDate\", \"bool\"],\r\n    [\"ScaleCrop\", \"ScaleCrop\", \"bool\"],\r\n    [\"HeadingPairs\", \"HeadingPairs\", \"raw\"],\r\n    [\"TitlesOfParts\", \"TitlesOfParts\", \"raw\"]\r\n  ];\r\n\r\n  XMLNS.EXT_PROPS = \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\";\r\n  RELS.EXT_PROPS  = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties';\r\n\r\n  var PseudoPropsPairs = [\r\n    \"Worksheets\",  \"SheetNames\",\r\n    \"NamedRanges\", \"DefinedNames\",\r\n    \"Chartsheets\", \"ChartNames\"\r\n  ];\r\n  function load_props_pairs(HP, TOP, props, opts) {\r\n    var v = [];\r\n    if(typeof HP == \"string\") v = parseVector(HP, opts);\r\n    else for(var j = 0; j < HP.length; ++j) v = v.concat(HP[j].map(function(hp) { return {v:hp}; }));\r\n    var parts = (typeof TOP == \"string\") ? parseVector(TOP, opts).map(function (x) { return x.v; }) : TOP;\r\n    var idx = 0, len = 0;\r\n    if(parts.length > 0) for(var i = 0; i !== v.length; i += 2) {\r\n      len = +(v[i+1].v);\r\n      switch(v[i].v) {\r\n        case \"Worksheets\":\r\n        case \"\":\r\n        case \"\":\r\n        case \" \":\r\n        case \"\":\r\n        case \" \":\r\n        case \"Arbeitsbltter\":\r\n        case \"alma Sayfalar\":\r\n        case \"Feuilles de calcul\":\r\n        case \"Fogli di lavoro\":\r\n        case \"Folhas de clculo\":\r\n        case \"Planilhas\":\r\n        case \"Regneark\":\r\n        case \"Werkbladen\":\r\n          props.Worksheets = len;\r\n          props.SheetNames = parts.slice(idx, idx + len);\r\n          break;\r\n\r\n        case \"Named Ranges\":\r\n        case \"\":\r\n        case \"Benannte Bereiche\":\r\n        case \"Navngivne omrder\":\r\n          props.NamedRanges = len;\r\n          props.DefinedNames = parts.slice(idx, idx + len);\r\n          break;\r\n\r\n        case \"Charts\":\r\n        case \"Diagramme\":\r\n          props.Chartsheets = len;\r\n          props.ChartNames = parts.slice(idx, idx + len);\r\n          break;\r\n      }\r\n      idx += len;\r\n    }\r\n  }\r\n\r\n  function parse_ext_props(data, p, opts) {\r\n    var q = {}; if(!p) p = {};\r\n    data = utf8read(data);\r\n\r\n    EXT_PROPS.forEach(function(f) {\r\n      switch(f[2]) {\r\n        case \"string\": p[f[1]] = (data.match(matchtag(f[0]))||[])[1]; break;\r\n        case \"bool\": p[f[1]] = (data.match(matchtag(f[0]))||[])[1] === \"true\"; break;\r\n        case \"raw\":\r\n          var cur = data.match(new RegExp(\"<\" + f[0] + \"[^>]*>([\\\\s\\\\S]*?)<\\/\" + f[0] + \">\"));\r\n          if(cur && cur.length > 0) q[f[1]] = cur[1];\r\n          break;\r\n      }\r\n    });\r\n\r\n    if(q.HeadingPairs && q.TitlesOfParts) load_props_pairs(q.HeadingPairs, q.TitlesOfParts, p, opts);\r\n\r\n    return p;\r\n  }\r\n\r\n  var EXT_PROPS_XML_ROOT = writextag('Properties', null, {\r\n    'xmlns': XMLNS.EXT_PROPS,\r\n    'xmlns:vt': XMLNS.vt\r\n  });\r\n\r\n  function write_ext_props(cp) {\r\n    var o = [], W = writextag;\r\n    if(!cp) cp = {};\r\n    cp.Application = \"SheetJS\";\r\n    o[o.length] = (XML_HEADER);\r\n    o[o.length] = (EXT_PROPS_XML_ROOT);\r\n\r\n    EXT_PROPS.forEach(function(f) {\r\n      if(cp[f[1]] === undefined) return;\r\n      var v;\r\n      switch(f[2]) {\r\n        case 'string': v = String(cp[f[1]]); break;\r\n        case 'bool': v = cp[f[1]] ? 'true' : 'false'; break;\r\n      }\r\n      if(v !== undefined) o[o.length] = (W(f[0], v));\r\n    });\r\n\r\n    /* TODO: HeadingPairs, TitlesOfParts */\r\n    o[o.length] = (W('HeadingPairs', W('vt:vector', W('vt:variant', '<vt:lpstr>Worksheets</vt:lpstr>')+W('vt:variant', W('vt:i4', String(cp.Worksheets))), {size:2, baseType:\"variant\"})));\r\n    o[o.length] = (W('TitlesOfParts', W('vt:vector', cp.SheetNames.map(function(s) { return \"<vt:lpstr>\" + escapexml(s) + \"</vt:lpstr>\"; }).join(\"\"), {size: cp.Worksheets, baseType:\"lpstr\"})));\r\n    if(o.length>2){ o[o.length] = ('</Properties>'); o[1]=o[1].replace(\"/>\",\">\"); }\r\n    return o.join(\"\");\r\n  }\r\n  /* 15.2.12.2 Custom File Properties Part */\r\n  XMLNS.CUST_PROPS = \"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\";\r\n  RELS.CUST_PROPS  = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties';\r\n\r\n  var custregex = /<[^>]+>[^<]*/g;\r\n  function parse_cust_props(data, opts) {\r\n    var p = {}, name = \"\";\r\n    var m = data.match(custregex);\r\n    if(m) for(var i = 0; i != m.length; ++i) {\r\n      var x = m[i], y = parsexmltag(x);\r\n      switch(y[0]) {\r\n        case '<?xml': break;\r\n        case '<Properties': break;\r\n        case '<property': name = y.name; break;\r\n        case '</property>': name = null; break;\r\n        default: if (x.indexOf('<vt:') === 0) {\r\n          var toks = x.split('>');\r\n          var type = toks[0].slice(4), text = toks[1];\r\n          /* 22.4.2.32 (CT_Variant). Omit the binary types from 22.4 (Variant Types) */\r\n          switch(type) {\r\n            case 'lpstr': case 'bstr': case 'lpwstr':\r\n              p[name] = unescapexml(text);\r\n              break;\r\n            case 'bool':\r\n              p[name] = parsexmlbool(text);\r\n              break;\r\n            case 'i1': case 'i2': case 'i4': case 'i8': case 'int': case 'uint':\r\n              p[name] = parseInt(text, 10);\r\n              break;\r\n            case 'r4': case 'r8': case 'decimal':\r\n              p[name] = parseFloat(text);\r\n              break;\r\n            case 'filetime': case 'date':\r\n              p[name] = parseDate(text);\r\n              break;\r\n            case 'cy': case 'error':\r\n              p[name] = unescapexml(text);\r\n              break;\r\n            default:\r\n              if(type.slice(-1) == '/') break;\r\n              if(opts.WTF && typeof console !== 'undefined') console.warn('Unexpected', x, type, toks);\r\n          }\r\n        } else if(x.slice(0,2) === \"</\") {/* empty */\r\n        } else if(opts.WTF) throw new Error(x);\r\n      }\r\n    }\r\n    return p;\r\n  }\r\n\r\n  var CUST_PROPS_XML_ROOT = writextag('Properties', null, {\r\n    'xmlns': XMLNS.CUST_PROPS,\r\n    'xmlns:vt': XMLNS.vt\r\n  });\r\n\r\n  function write_cust_props(cp) {\r\n    var o = [XML_HEADER, CUST_PROPS_XML_ROOT];\r\n    if(!cp) return o.join(\"\");\r\n    var pid = 1;\r\n    keys(cp).forEach(function custprop(k) { ++pid;\r\n      o[o.length] = (writextag('property', write_vt(cp[k]), {\r\n        'fmtid': '{D5CDD505-2E9C-101B-9397-08002B2CF9AE}',\r\n        'pid': pid,\r\n        'name': k\r\n      }));\r\n    });\r\n    if(o.length>2){ o[o.length] = '</Properties>'; o[1]=o[1].replace(\"/>\",\">\"); }\r\n    return o.join(\"\");\r\n  }\r\n  /* Common Name -> XLML Name */\r\n  var XLMLDocPropsMap = {\r\n    Title: 'Title',\r\n    Subject: 'Subject',\r\n    Author: 'Author',\r\n    Keywords: 'Keywords',\r\n    Comments: 'Description',\r\n    LastAuthor: 'LastAuthor',\r\n    RevNumber: 'Revision',\r\n    Application: 'AppName',\r\n    /* TotalTime: 'TotalTime', */\r\n    LastPrinted: 'LastPrinted',\r\n    CreatedDate: 'Created',\r\n    ModifiedDate: 'LastSaved',\r\n    /* Pages */\r\n    /* Words */\r\n    /* Characters */\r\n    Category: 'Category',\r\n    /* PresentationFormat */\r\n    Manager: 'Manager',\r\n    Company: 'Company',\r\n    /* Guid */\r\n    /* HyperlinkBase */\r\n    /* Bytes */\r\n    /* Lines */\r\n    /* Paragraphs */\r\n    /* CharactersWithSpaces */\r\n    AppVersion: 'Version',\r\n\r\n    ContentStatus: 'ContentStatus', /* NOTE: missing from schema */\r\n    Identifier: 'Identifier', /* NOTE: missing from schema */\r\n    Language: 'Language' /* NOTE: missing from schema */\r\n  };\r\n  var evert_XLMLDPM = evert(XLMLDocPropsMap);\r\n\r\n  function xlml_set_prop(Props, tag, val) {\r\n    tag = evert_XLMLDPM[tag] || tag;\r\n    Props[tag] = val;\r\n  }\r\n\r\n  function xlml_write_docprops(Props, opts) {\r\n    var o = [];\r\n    keys(XLMLDocPropsMap).map(function(m) {\r\n      for(var i = 0; i < CORE_PROPS.length; ++i) if(CORE_PROPS[i][1] == m) return CORE_PROPS[i];\r\n      for(i = 0; i < EXT_PROPS.length; ++i) if(EXT_PROPS[i][1] == m) return EXT_PROPS[i];\r\n      throw m;\r\n    }).forEach(function(p) {\r\n      if(Props[p[1]] == null) return;\r\n      var m = opts && opts.Props && opts.Props[p[1]] != null ? opts.Props[p[1]] : Props[p[1]];\r\n      switch(p[2]) {\r\n        case 'date': m = new Date(m).toISOString().replace(/\\.\\d*Z/,\"Z\"); break;\r\n      }\r\n      if(typeof m == 'number') m = String(m);\r\n      else if(m === true || m === false) { m = m ? \"1\" : \"0\"; }\r\n      else if(m instanceof Date) m = new Date(m).toISOString().replace(/\\.\\d*Z/,\"\");\r\n      o.push(writetag(XLMLDocPropsMap[p[1]] || p[1], m));\r\n    });\r\n    return writextag('DocumentProperties', o.join(\"\"), {xmlns:XLMLNS.o });\r\n  }\r\n  function xlml_write_custprops(Props, Custprops) {\r\n    var BLACKLIST = [\"Worksheets\",\"SheetNames\"];\r\n    var T = 'CustomDocumentProperties';\r\n    var o = [];\r\n    if(Props) keys(Props).forEach(function(k) {\r\n      if(!Props.hasOwnProperty(k)) return;\r\n      for(var i = 0; i < CORE_PROPS.length; ++i) if(k == CORE_PROPS[i][1]) return;\r\n      for(i = 0; i < EXT_PROPS.length; ++i) if(k == EXT_PROPS[i][1]) return;\r\n      for(i = 0; i < BLACKLIST.length; ++i) if(k == BLACKLIST[i]) return;\r\n\r\n      var m = Props[k];\r\n      var t = \"string\";\r\n      if(typeof m == 'number') { t = \"float\"; m = String(m); }\r\n      else if(m === true || m === false) { t = \"boolean\"; m = m ? \"1\" : \"0\"; }\r\n      else m = String(m);\r\n      o.push(writextag(escapexmltag(k), m, {\"dt:dt\":t}));\r\n    });\r\n    if(Custprops) keys(Custprops).forEach(function(k) {\r\n      if(!Custprops.hasOwnProperty(k)) return;\r\n      if(Props && Props.hasOwnProperty(k)) return;\r\n      var m = Custprops[k];\r\n      var t = \"string\";\r\n      if(typeof m == 'number') { t = \"float\"; m = String(m); }\r\n      else if(m === true || m === false) { t = \"boolean\"; m = m ? \"1\" : \"0\"; }\r\n      else if(m instanceof Date) { t = \"dateTime.tz\"; m = m.toISOString(); }\r\n      else m = String(m);\r\n      o.push(writextag(escapexmltag(k), m, {\"dt:dt\":t}));\r\n    });\r\n    return '<' + T + ' xmlns=\"' + XLMLNS.o + '\">' + o.join(\"\") + '</' + T + '>';\r\n  }\r\n  /* [MS-DTYP] 2.3.3 FILETIME */\r\n  /* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\r\n  /* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\r\n  function parse_FILETIME(blob) {\r\n    var dwLowDateTime = blob.read_shift(4), dwHighDateTime = blob.read_shift(4);\r\n    return new Date(((dwHighDateTime/1e7*Math.pow(2,32) + dwLowDateTime/1e7) - 11644473600)*1000).toISOString().replace(/\\.000/,\"\");\r\n  }\r\n  function write_FILETIME(time) {\r\n    var date = (typeof time == \"string\") ? new Date(Date.parse(time)) : time;\r\n    var t = date.getTime() / 1000 + 11644473600;\r\n    var l = t % Math.pow(2,32), h = (t - l) / Math.pow(2,32);\r\n    l *= 1e7; h *= 1e7;\r\n    var w = (l / Math.pow(2,32)) | 0;\r\n    if(w > 0) { l = l % Math.pow(2,32); h += w; }\r\n    var o = new_buf(8); o.write_shift(4, l); o.write_shift(4, h); return o;\r\n  }\r\n\r\n  /* [MS-OSHARED] 2.3.3.1.4 Lpstr */\r\n  function parse_lpstr(blob, type, pad) {\r\n    var start = blob.l;\r\n    var str = blob.read_shift(0, 'lpstr-cp');\r\n    if(pad) while((blob.l - start) & 3) ++blob.l;\r\n    return str;\r\n  }\r\n\r\n  /* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\r\n  function parse_lpwstr(blob, type, pad) {\r\n    var str = blob.read_shift(0, 'lpwstr');\r\n    if(pad) blob.l += (4 - ((str.length+1) & 3)) & 3;\r\n    return str;\r\n  }\r\n\r\n\r\n  /* [MS-OSHARED] 2.3.3.1.11 VtString */\r\n  /* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\r\n  function parse_VtStringBase(blob, stringType, pad) {\r\n    if(stringType === 0x1F /*VT_LPWSTR*/) return parse_lpwstr(blob);\r\n    return parse_lpstr(blob, stringType, pad);\r\n  }\r\n\r\n  function parse_VtString(blob, t, pad) { return parse_VtStringBase(blob, t, pad === false ? 0: 4); }\r\n  function parse_VtUnalignedString(blob, t) { if(!t) throw new Error(\"VtUnalignedString must have positive length\"); return parse_VtStringBase(blob, t, 0); }\r\n\r\n  /* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\r\n  function parse_VtVecUnalignedLpstrValue(blob) {\r\n    var length = blob.read_shift(4);\r\n    var ret = [];\r\n    for(var i = 0; i != length; ++i) ret[i] = blob.read_shift(0, 'lpstr-cp').replace(chr0,'');\r\n    return ret;\r\n  }\r\n\r\n  /* [MS-OSHARED] 2.3.3.1.10 VtVecUnalignedLpstr */\r\n  function parse_VtVecUnalignedLpstr(blob) {\r\n    return parse_VtVecUnalignedLpstrValue(blob);\r\n  }\r\n\r\n  /* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\r\n  function parse_VtHeadingPair(blob) {\r\n    var headingString = parse_TypedPropertyValue(blob, VT_USTR);\r\n    var headerParts = parse_TypedPropertyValue(blob, VT_I4);\r\n    return [headingString, headerParts];\r\n  }\r\n\r\n  /* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\r\n  function parse_VtVecHeadingPairValue(blob) {\r\n    var cElements = blob.read_shift(4);\r\n    var out = [];\r\n    for(var i = 0; i != cElements / 2; ++i) out.push(parse_VtHeadingPair(blob));\r\n    return out;\r\n  }\r\n\r\n  /* [MS-OSHARED] 2.3.3.1.15 VtVecHeadingPair */\r\n  function parse_VtVecHeadingPair(blob) {\r\n    // NOTE: When invoked, wType & padding were already consumed\r\n    return parse_VtVecHeadingPairValue(blob);\r\n  }\r\n\r\n  /* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\r\n  function parse_dictionary(blob,CodePage) {\r\n    var cnt = blob.read_shift(4);\r\n    var dict = ({});\r\n    for(var j = 0; j != cnt; ++j) {\r\n      var pid = blob.read_shift(4);\r\n      var len = blob.read_shift(4);\r\n      dict[pid] = blob.read_shift(len, (CodePage === 0x4B0 ?'utf16le':'utf8')).replace(chr0,'').replace(chr1,'!');\r\n      if(CodePage === 0x4B0 && (len % 2)) blob.l += 2;\r\n    }\r\n    if(blob.l & 3) blob.l = (blob.l>>2+1)<<2;\r\n    return dict;\r\n  }\r\n\r\n  /* [MS-OLEPS] 2.9 BLOB */\r\n  function parse_BLOB(blob) {\r\n    var size = blob.read_shift(4);\r\n    var bytes = blob.slice(blob.l,blob.l+size);\r\n    blob.l += size;\r\n    if((size & 3) > 0) blob.l += (4 - (size & 3)) & 3;\r\n    return bytes;\r\n  }\r\n\r\n  /* [MS-OLEPS] 2.11 ClipboardData */\r\n  function parse_ClipboardData(blob) {\r\n    // TODO\r\n    var o = {};\r\n    o.Size = blob.read_shift(4);\r\n    //o.Format = blob.read_shift(4);\r\n    blob.l += o.Size + 3 - (o.Size - 1) % 4;\r\n    return o;\r\n  }\r\n\r\n  /* [MS-OLEPS] 2.15 TypedPropertyValue */\r\n  function parse_TypedPropertyValue(blob, type, _opts) {\r\n    var t = blob.read_shift(2), ret, opts = _opts||{};\r\n    blob.l += 2;\r\n    if(type !== VT_VARIANT)\r\n      if(t !== type && VT_CUSTOM.indexOf(type)===-1) throw new Error('Expected type ' + type + ' saw ' + t);\r\n    switch(type === VT_VARIANT ? t : type) {\r\n      case 0x02 /*VT_I2*/: ret = blob.read_shift(2, 'i'); if(!opts.raw) blob.l += 2; return ret;\r\n      case 0x03 /*VT_I4*/: ret = blob.read_shift(4, 'i'); return ret;\r\n      case 0x0B /*VT_BOOL*/: return blob.read_shift(4) !== 0x0;\r\n      case 0x13 /*VT_UI4*/: ret = blob.read_shift(4); return ret;\r\n      case 0x1E /*VT_LPSTR*/: return parse_lpstr(blob, t, 4).replace(chr0,'');\r\n      case 0x1F /*VT_LPWSTR*/: return parse_lpwstr(blob);\r\n      case 0x40 /*VT_FILETIME*/: return parse_FILETIME(blob);\r\n      case 0x41 /*VT_BLOB*/: return parse_BLOB(blob);\r\n      case 0x47 /*VT_CF*/: return parse_ClipboardData(blob);\r\n      case 0x50 /*VT_STRING*/: return parse_VtString(blob, t, !opts.raw).replace(chr0,'');\r\n      case 0x51 /*VT_USTR*/: return parse_VtUnalignedString(blob, t/*, 4*/).replace(chr0,'');\r\n      case 0x100C /*VT_VECTOR|VT_VARIANT*/: return parse_VtVecHeadingPair(blob);\r\n      case 0x101E /*VT_LPSTR*/: return parse_VtVecUnalignedLpstr(blob);\r\n      default: throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\r\n    }\r\n  }\r\n  function write_TypedPropertyValue(type, value) {\r\n    var o = new_buf(4), p = new_buf(4);\r\n    o.write_shift(4, type == 0x50 ? 0x1F : type);\r\n    switch(type) {\r\n      case 0x03 /*VT_I4*/: p.write_shift(-4, value); break;\r\n      case 0x05 /*VT_I4*/: p = new_buf(8); p.write_shift(8, value, 'f'); break;\r\n      case 0x0B /*VT_BOOL*/: p.write_shift(4, value ? 0x01 : 0x00); break;\r\n      case 0x40 /*VT_FILETIME*/:  p = write_FILETIME(value); break;\r\n      case 0x1F /*VT_LPWSTR*/:\r\n      case 0x50 /*VT_STRING*/:\r\n        p = new_buf(4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));\r\n        p.write_shift(4, value.length + 1);\r\n        p.write_shift(0, value, \"dbcs\");\r\n        while(p.l != p.length) p.write_shift(1, 0);\r\n        break;\r\n      default: throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + value);\r\n    }\r\n    return bconcat([o, p]);\r\n  }\r\n\r\n  /* [MS-OLEPS] 2.20 PropertySet */\r\n  function parse_PropertySet(blob, PIDSI) {\r\n    var start_addr = blob.l;\r\n    var size = blob.read_shift(4);\r\n    var NumProps = blob.read_shift(4);\r\n    var Props = [], i = 0;\r\n    var CodePage = 0;\r\n    var Dictionary = -1, DictObj = ({});\r\n    for(i = 0; i != NumProps; ++i) {\r\n      var PropID = blob.read_shift(4);\r\n      var Offset = blob.read_shift(4);\r\n      Props[i] = [PropID, Offset + start_addr];\r\n    }\r\n    Props.sort(function(x,y) { return x[1] - y[1]; });\r\n    var PropH = {};\r\n    for(i = 0; i != NumProps; ++i) {\r\n      if(blob.l !== Props[i][1]) {\r\n        var fail = true;\r\n        if(i>0 && PIDSI) switch(PIDSI[Props[i-1][0]].t) {\r\n          case 0x02 /*VT_I2*/: if(blob.l+2 === Props[i][1]) { blob.l+=2; fail = false; } break;\r\n          case 0x50 /*VT_STRING*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\r\n          case 0x100C /*VT_VECTOR|VT_VARIANT*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\r\n        }\r\n        if((!PIDSI||i==0) && blob.l <= Props[i][1]) { fail=false; blob.l = Props[i][1]; }\r\n        if(fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\r\n      }\r\n      if(PIDSI) {\r\n        var piddsi = PIDSI[Props[i][0]];\r\n        PropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, {raw:true});\r\n        if(piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + (\"0000\" + String(PropH[piddsi.n] & 0xFFFF)).slice(-4);\r\n        if(piddsi.n == \"CodePage\") switch(PropH[piddsi.n]) {\r\n          case 0: PropH[piddsi.n] = 1252;\r\n          /* falls through */\r\n          case 874:\r\n          case 932:\r\n          case 936:\r\n          case 949:\r\n          case 950:\r\n          case 1250:\r\n          case 1251:\r\n          case 1253:\r\n          case 1254:\r\n          case 1255:\r\n          case 1256:\r\n          case 1257:\r\n          case 1258:\r\n          case 10000:\r\n          case 1200:\r\n          case 1201:\r\n          case 1252:\r\n          case 65000: case -536:\r\n          case 65001: case -535:\r\n            set_cp(CodePage = (PropH[piddsi.n]>>>0) & 0xFFFF); break;\r\n          default: throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\r\n        }\r\n      } else {\r\n        if(Props[i][0] === 0x1) {\r\n          CodePage = PropH.CodePage = (parse_TypedPropertyValue(blob, VT_I2));\r\n          set_cp(CodePage);\r\n          if(Dictionary !== -1) {\r\n            var oldpos = blob.l;\r\n            blob.l = Props[Dictionary][1];\r\n            DictObj = parse_dictionary(blob,CodePage);\r\n            blob.l = oldpos;\r\n          }\r\n        } else if(Props[i][0] === 0) {\r\n          if(CodePage === 0) { Dictionary = i; blob.l = Props[i+1][1]; continue; }\r\n          DictObj = parse_dictionary(blob,CodePage);\r\n        } else {\r\n          var name = DictObj[Props[i][0]];\r\n          var val;\r\n          /* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\r\n          switch(blob[blob.l]) {\r\n            case 0x41 /*VT_BLOB*/: blob.l += 4; val = parse_BLOB(blob); break;\r\n            case 0x1E /*VT_LPSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]).replace(/\\u0000+$/,\"\"); break;\r\n            case 0x1F /*VT_LPWSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]).replace(/\\u0000+$/,\"\"); break;\r\n            case 0x03 /*VT_I4*/: blob.l += 4; val = blob.read_shift(4, 'i'); break;\r\n            case 0x13 /*VT_UI4*/: blob.l += 4; val = blob.read_shift(4); break;\r\n            case 0x05 /*VT_R8*/: blob.l += 4; val = blob.read_shift(8, 'f'); break;\r\n            case 0x0B /*VT_BOOL*/: blob.l += 4; val = parsebool(blob, 4); break;\r\n            case 0x40 /*VT_FILETIME*/: blob.l += 4; val = parseDate(parse_FILETIME(blob)); break;\r\n            default: throw new Error(\"unparsed value: \" + blob[blob.l]);\r\n          }\r\n          PropH[name] = val;\r\n        }\r\n      }\r\n    }\r\n    blob.l = start_addr + size; /* step ahead to skip padding */\r\n    return PropH;\r\n  }\r\n  var XLSPSSkip = [ \"CodePage\", \"Thumbnail\", \"_PID_LINKBASE\", \"_PID_HLINKS\", \"SystemIdentifier\", \"FMTID\" ].concat(PseudoPropsPairs);\r\n  function guess_property_type(val) {\r\n    switch(typeof val) {\r\n      case \"boolean\": return 0x0B;\r\n      case \"number\": return ((val|0)==val) ? 0x03 : 0x05;\r\n      case \"string\": return 0x1F;\r\n      case \"object\": if(val instanceof Date) return 0x40; break;\r\n    }\r\n    return -1;\r\n  }\r\n  function write_PropertySet(entries, RE, PIDSI) {\r\n    var hdr = new_buf(8), piao = [], prop = [];\r\n    var sz = 8, i = 0;\r\n\r\n    var pr = new_buf(8), pio = new_buf(8);\r\n    pr.write_shift(4, 0x0002);\r\n    pr.write_shift(4, 0x04B0);\r\n    pio.write_shift(4, 0x0001);\r\n    prop.push(pr); piao.push(pio);\r\n    sz += 8 + pr.length;\r\n\r\n    if(!RE) {\r\n      pio = new_buf(8);\r\n      pio.write_shift(4, 0);\r\n      piao.unshift(pio);\r\n\r\n      var bufs = [new_buf(4)];\r\n      bufs[0].write_shift(4, entries.length);\r\n      for(i = 0; i < entries.length; ++i) {\r\n        var value = entries[i][0];\r\n        pr = new_buf(4 + 4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));\r\n        pr.write_shift(4, i+2);\r\n        pr.write_shift(4, value.length + 1);\r\n        pr.write_shift(0, value, \"dbcs\");\r\n        while(pr.l != pr.length) pr.write_shift(1, 0);\r\n        bufs.push(pr);\r\n      }\r\n      pr = bconcat(bufs);\r\n      prop.unshift(pr);\r\n      sz += 8 + pr.length;\r\n    }\r\n\r\n    for(i = 0; i < entries.length; ++i) {\r\n      if(RE && !RE[entries[i][0]]) continue;\r\n      if(XLSPSSkip.indexOf(entries[i][0]) > -1) continue;\r\n      if(entries[i][1] == null) continue;\r\n\r\n      var val = entries[i][1], idx = 0;\r\n      if(RE) {\r\n        idx = +RE[entries[i][0]];\r\n        var pinfo = (PIDSI)[idx];\r\n        if(pinfo.p == \"version\" && typeof val == \"string\") {\r\n          var arr = val.split(\".\");\r\n          val = ((+arr[0])<<16) + ((+arr[1])||0);\r\n        }\r\n        pr = write_TypedPropertyValue(pinfo.t, val);\r\n      } else {\r\n        var T = guess_property_type(val);\r\n        if(T == -1) { T = 0x1F; val = String(val); }\r\n        pr = write_TypedPropertyValue(T, val);\r\n      }\r\n      prop.push(pr);\r\n\r\n      pio = new_buf(8);\r\n      pio.write_shift(4, !RE ? 2+i : idx);\r\n      piao.push(pio);\r\n\r\n      sz += 8 + pr.length;\r\n    }\r\n\r\n    var w = 8 * (prop.length + 1);\r\n    for(i = 0; i < prop.length; ++i) { piao[i].write_shift(4, w); w += prop[i].length; }\r\n    hdr.write_shift(4, sz);\r\n    hdr.write_shift(4, prop.length);\r\n    return bconcat([hdr].concat(piao).concat(prop));\r\n  }\r\n\r\n  /* [MS-OLEPS] 2.21 PropertySetStream */\r\n  function parse_PropertySetStream(file, PIDSI, clsid) {\r\n    var blob = file.content;\r\n    if(!blob) return ({});\r\n    prep_blob(blob, 0);\r\n\r\n    var NumSets, FMTID0, FMTID1, Offset0, Offset1 = 0;\r\n    blob.chk('feff', 'Byte Order: ');\r\n\r\n    /*var vers = */blob.read_shift(2); // TODO: check version\r\n    var SystemIdentifier = blob.read_shift(4);\r\n    var CLSID = blob.read_shift(16);\r\n    if(CLSID !== CFB.utils.consts.HEADER_CLSID && CLSID !== clsid) throw new Error(\"Bad PropertySet CLSID \" + CLSID);\r\n    NumSets = blob.read_shift(4);\r\n    if(NumSets !== 1 && NumSets !== 2) throw new Error(\"Unrecognized #Sets: \" + NumSets);\r\n    FMTID0 = blob.read_shift(16); Offset0 = blob.read_shift(4);\r\n\r\n    if(NumSets === 1 && Offset0 !== blob.l) throw new Error(\"Length mismatch: \" + Offset0 + \" !== \" + blob.l);\r\n    else if(NumSets === 2) { FMTID1 = blob.read_shift(16); Offset1 = blob.read_shift(4); }\r\n    var PSet0 = parse_PropertySet(blob, PIDSI);\r\n\r\n    var rval = ({ SystemIdentifier: SystemIdentifier });\r\n    for(var y in PSet0) rval[y] = PSet0[y];\r\n    //rval.blob = blob;\r\n    rval.FMTID = FMTID0;\r\n    //rval.PSet0 = PSet0;\r\n    if(NumSets === 1) return rval;\r\n    if(Offset1 - blob.l == 2) blob.l += 2;\r\n    if(blob.l !== Offset1) throw new Error(\"Length mismatch 2: \" + blob.l + \" !== \" + Offset1);\r\n    var PSet1;\r\n    try { PSet1 = parse_PropertySet(blob, null); } catch(e) {/* empty */}\r\n    for(y in PSet1) rval[y] = PSet1[y];\r\n    rval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\r\n    return rval;\r\n  }\r\n  function write_PropertySetStream(entries, clsid, RE, PIDSI, entries2, clsid2) {\r\n    var hdr = new_buf(entries2 ? 68 : 48);\r\n    var bufs = [hdr];\r\n    hdr.write_shift(2, 0xFFFE);\r\n    hdr.write_shift(2, 0x0000); /* TODO: type 1 props */\r\n    hdr.write_shift(4, 0x32363237);\r\n    hdr.write_shift(16, CFB.utils.consts.HEADER_CLSID, \"hex\");\r\n    hdr.write_shift(4, (entries2 ? 2 : 1));\r\n    hdr.write_shift(16, clsid, \"hex\");\r\n    hdr.write_shift(4, (entries2 ? 68 : 48));\r\n    var ps0 = write_PropertySet(entries, RE, PIDSI);\r\n    bufs.push(ps0);\r\n\r\n    if(entries2) {\r\n      var ps1 = write_PropertySet(entries2, null, null);\r\n      hdr.write_shift(16, clsid2, \"hex\");\r\n      hdr.write_shift(4, 68 + ps0.length);\r\n      bufs.push(ps1);\r\n    }\r\n    return bconcat(bufs);\r\n  }\r\n\r\n  function parsenoop2(blob, length) { blob.read_shift(length); return null; }\r\n  function writezeroes(n, o) { if(!o) o=new_buf(n); for(var j=0; j<n; ++j) o.write_shift(1, 0); return o; }\r\n\r\n  function parslurp(blob, length, cb) {\r\n    var arr = [], target = blob.l + length;\r\n    while(blob.l < target) arr.push(cb(blob, target - blob.l));\r\n    if(target !== blob.l) throw new Error(\"Slurp error\");\r\n    return arr;\r\n  }\r\n\r\n  function parsebool(blob, length) { return blob.read_shift(length) === 0x1; }\r\n  function writebool(v, o) { if(!o) o=new_buf(2); o.write_shift(2, +!!v); return o; }\r\n\r\n  function parseuint16(blob) { return blob.read_shift(2, 'u'); }\r\n  function writeuint16(v, o) { if(!o) o=new_buf(2); o.write_shift(2, v); return o; }\r\n  function parseuint16a(blob, length) { return parslurp(blob,length,parseuint16);}\r\n\r\n  /* --- 2.5 Structures --- */\r\n\r\n  /* [MS-XLS] 2.5.10 Bes (boolean or error) */\r\n  function parse_Bes(blob) {\r\n    var v = blob.read_shift(1), t = blob.read_shift(1);\r\n    return t === 0x01 ? v : v === 0x01;\r\n  }\r\n  function write_Bes(v, t, o) {\r\n    if(!o) o = new_buf(2);\r\n    o.write_shift(1, +v);\r\n    o.write_shift(1, ((t == 'e') ? 1 : 0));\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.240 ShortXLUnicodeString */\r\n  function parse_ShortXLUnicodeString(blob, length, opts) {\r\n    var cch = blob.read_shift(opts && opts.biff >= 12 ? 2 : 1);\r\n    var encoding = 'sbcs-cont';\r\n    var cp = current_codepage;\r\n    if(opts && opts.biff >= 8) current_codepage = 1200;\r\n    if(!opts || opts.biff == 8 ) {\r\n      var fHighByte = blob.read_shift(1);\r\n      if(fHighByte) { encoding = 'dbcs-cont'; }\r\n    } else if(opts.biff == 12) {\r\n      encoding = 'wstr';\r\n    }\r\n    if(opts.biff >= 2 && opts.biff <= 5) encoding = 'cpstr';\r\n    var o = cch ? blob.read_shift(cch, encoding) : \"\";\r\n    current_codepage = cp;\r\n    return o;\r\n  }\r\n\r\n  /* 2.5.293 XLUnicodeRichExtendedString */\r\n  function parse_XLUnicodeRichExtendedString(blob) {\r\n    var cp = current_codepage;\r\n    current_codepage = 1200;\r\n    var cch = blob.read_shift(2), flags = blob.read_shift(1);\r\n    var /*fHighByte = flags & 0x1,*/ fExtSt = flags & 0x4, fRichSt = flags & 0x8;\r\n    var width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\r\n    var cRun = 0, cbExtRst;\r\n    var z = {};\r\n    if(fRichSt) cRun = blob.read_shift(2);\r\n    if(fExtSt) cbExtRst = blob.read_shift(4);\r\n    var encoding = width == 2 ? 'dbcs-cont' : 'sbcs-cont';\r\n    var msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\r\n    if(fRichSt) blob.l += 4 * cRun; //TODO: parse this\r\n    if(fExtSt) blob.l += cbExtRst; //TODO: parse this\r\n    z.t = msg;\r\n    if(!fRichSt) { z.raw = \"<t>\" + z.t + \"</t>\"; z.r = z.t; }\r\n    current_codepage = cp;\r\n    return z;\r\n  }\r\n\r\n  /* 2.5.296 XLUnicodeStringNoCch */\r\n  function parse_XLUnicodeStringNoCch(blob, cch, opts) {\r\n    var retval;\r\n    if(opts) {\r\n      if(opts.biff >= 2 && opts.biff <= 5) return blob.read_shift(cch, 'cpstr');\r\n      if(opts.biff >= 12) return blob.read_shift(cch, 'dbcs-cont');\r\n    }\r\n    var fHighByte = blob.read_shift(1);\r\n    if(fHighByte===0) { retval = blob.read_shift(cch, 'sbcs-cont'); }\r\n    else { retval = blob.read_shift(cch, 'dbcs-cont'); }\r\n    return retval;\r\n  }\r\n\r\n  /* 2.5.294 XLUnicodeString */\r\n  function parse_XLUnicodeString(blob, length, opts) {\r\n    var cch = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\r\n    if(cch === 0) { blob.l++; return \"\"; }\r\n    return parse_XLUnicodeStringNoCch(blob, cch, opts);\r\n  }\r\n  /* BIFF5 override */\r\n  function parse_XLUnicodeString2(blob, length, opts) {\r\n    if(opts.biff > 5) return parse_XLUnicodeString(blob, length, opts);\r\n    var cch = blob.read_shift(1);\r\n    if(cch === 0) { blob.l++; return \"\"; }\r\n    return blob.read_shift(cch, (opts.biff <= 4 || !blob.lens ) ? 'cpstr' : 'sbcs-cont');\r\n  }\r\n  /* TODO: BIFF5 and lower, codepage awareness */\r\n  function write_XLUnicodeString(str, opts, o) {\r\n    if(!o) o = new_buf(3 + 2 * str.length);\r\n    o.write_shift(2, str.length);\r\n    o.write_shift(1, 1);\r\n    o.write_shift(31, str, 'utf16le');\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.61 ControlInfo */\r\n  function parse_ControlInfo(blob) {\r\n    var flags = blob.read_shift(1);\r\n    blob.l++;\r\n    var accel = blob.read_shift(2);\r\n    blob.l += 2;\r\n    return [flags, accel];\r\n  }\r\n\r\n  /* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\r\n  function parse_URLMoniker(blob) {\r\n    var len = blob.read_shift(4), start = blob.l;\r\n    var extra = false;\r\n    if(len > 24) {\r\n      /* look ahead */\r\n      blob.l += len - 24;\r\n      if(blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\r\n      blob.l = start;\r\n    }\r\n    var url = blob.read_shift((extra?len-24:len)>>1, 'utf16le').replace(chr0,\"\");\r\n    if(extra) blob.l += 24;\r\n    return url;\r\n  }\r\n\r\n  /* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\r\n  function parse_FileMoniker(blob) {\r\n    blob.l += 2; //var cAnti = blob.read_shift(2);\r\n    var ansiPath = blob.read_shift(0, 'lpstr-ansi');\r\n    blob.l += 2; //var endServer = blob.read_shift(2);\r\n    if(blob.read_shift(2) != 0xDEAD) throw new Error(\"Bad FileMoniker\");\r\n    var sz = blob.read_shift(4);\r\n    if(sz === 0) return ansiPath.replace(/\\\\/g,\"/\");\r\n    var bytes = blob.read_shift(4);\r\n    if(blob.read_shift(2) != 3) throw new Error(\"Bad FileMoniker\");\r\n    var unicodePath = blob.read_shift(bytes>>1, 'utf16le').replace(chr0,\"\");\r\n    return unicodePath;\r\n  }\r\n\r\n  /* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\r\n  function parse_HyperlinkMoniker(blob, length) {\r\n    var clsid = blob.read_shift(16); length -= 16;\r\n    switch(clsid) {\r\n      case \"e0c9ea79f9bace118c8200aa004ba90b\": return parse_URLMoniker(blob, length);\r\n      case \"0303000000000000c000000000000046\": return parse_FileMoniker(blob, length);\r\n      default: throw new Error(\"Unsupported Moniker \" + clsid);\r\n    }\r\n  }\r\n\r\n  /* [MS-OSHARED] 2.3.7.9 HyperlinkString */\r\n  function parse_HyperlinkString(blob) {\r\n    var len = blob.read_shift(4);\r\n    var o = len > 0 ? blob.read_shift(len, 'utf16le').replace(chr0, \"\") : \"\";\r\n    return o;\r\n  }\r\n\r\n  /* [MS-OSHARED] 2.3.7.1 Hyperlink Object */\r\n  function parse_Hyperlink(blob, length) {\r\n    var end = blob.l + length;\r\n    var sVer = blob.read_shift(4);\r\n    if(sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\r\n    var flags = blob.read_shift(2);\r\n    blob.l += 2;\r\n    var displayName, targetFrameName, moniker, oleMoniker, Loc=\"\", guid, fileTime;\r\n    if(flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\r\n    if(flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\r\n    if((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\r\n    if((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\r\n    if(flags & 0x0008) Loc = parse_HyperlinkString(blob, end - blob.l);\r\n    if(flags & 0x0020) guid = blob.read_shift(16);\r\n    if(flags & 0x0040) fileTime = parse_FILETIME(blob/*, 8*/);\r\n    blob.l = end;\r\n    var target = targetFrameName||moniker||oleMoniker||\"\";\r\n    if(target && Loc) target+=\"#\"+Loc;\r\n    if(!target) target = \"#\" + Loc;\r\n    var out = ({Target:target});\r\n    if(guid) out.guid = guid;\r\n    if(fileTime) out.time = fileTime;\r\n    if(displayName) out.Tooltip = displayName;\r\n    return out;\r\n  }\r\n  function write_Hyperlink(hl) {\r\n    var out = new_buf(512), i = 0;\r\n    var Target = hl.Target;\r\n    var F = Target.indexOf(\"#\") > -1 ? 0x1f : 0x17;\r\n    switch(Target.charAt(0)) { case \"#\": F=0x1c; break; case \".\": F&=~2; break; }\r\n    out.write_shift(4,2); out.write_shift(4, F);\r\n    var data = [8,6815827,6619237,4849780,83]; for(i = 0; i < data.length; ++i) out.write_shift(4, data[i]);\r\n    if(F == 0x1C) {\r\n      Target = Target.slice(1);\r\n      out.write_shift(4, Target.length + 1);\r\n      for(i = 0; i < Target.length; ++i) out.write_shift(2, Target.charCodeAt(i));\r\n      out.write_shift(2, 0);\r\n    } else if(F & 0x02) {\r\n      data = \"e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");\r\n      for(i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));\r\n      out.write_shift(4, 2*(Target.length + 1));\r\n      for(i = 0; i < Target.length; ++i) out.write_shift(2, Target.charCodeAt(i));\r\n      out.write_shift(2, 0);\r\n    } else {\r\n      data = \"03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46\".split(\" \");\r\n      for(i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));\r\n      var P = 0;\r\n      while(Target.slice(P*3,P*3+3)==\"../\"||Target.slice(P*3,P*3+3)==\"..\\\\\") ++P;\r\n      out.write_shift(2, P);\r\n      out.write_shift(4, Target.length + 1);\r\n      for(i = 0; i < Target.length; ++i) out.write_shift(1, Target.charCodeAt(i) & 0xFF);\r\n      out.write_shift(1, 0);\r\n      out.write_shift(2, 0xFFFF);\r\n      out.write_shift(2, 0xDEAD);\r\n      for(i = 0; i < 6; ++i) out.write_shift(4, 0);\r\n    }\r\n    return out.slice(0, out.l);\r\n  }\r\n\r\n  /* 2.5.178 LongRGBA */\r\n  function parse_LongRGBA(blob) { var r = blob.read_shift(1), g = blob.read_shift(1), b = blob.read_shift(1), a = blob.read_shift(1); return [r,g,b,a]; }\r\n\r\n  /* 2.5.177 LongRGB */\r\n  function parse_LongRGB(blob, length) { var x = parse_LongRGBA(blob, length); x[3] = 0; return x; }\r\n\r\n\r\n  /* [MS-XLS] 2.5.19 */\r\n  function parse_XLSCell(blob) {\r\n    var rw = blob.read_shift(2); // 0-indexed\r\n    var col = blob.read_shift(2);\r\n    var ixfe = blob.read_shift(2);\r\n    return ({r:rw, c:col, ixfe:ixfe});\r\n  }\r\n  function write_XLSCell(R, C, ixfe, o) {\r\n    if(!o) o = new_buf(6);\r\n    o.write_shift(2, R);\r\n    o.write_shift(2, C);\r\n    o.write_shift(2, ixfe||0);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.134 */\r\n  function parse_frtHeader(blob) {\r\n    var rt = blob.read_shift(2);\r\n    var flags = blob.read_shift(2); // TODO: parse these flags\r\n    blob.l += 8;\r\n    return {type: rt, flags: flags};\r\n  }\r\n\r\n\r\n\r\n  function parse_OptXLUnicodeString(blob, length, opts) { return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts); }\r\n\r\n  /* [MS-XLS] 2.5.344 */\r\n  function parse_XTI(blob, length, opts) {\r\n    var w = opts.biff > 8 ? 4 : 2;\r\n    var iSupBook = blob.read_shift(w), itabFirst = blob.read_shift(w,'i'), itabLast = blob.read_shift(w,'i');\r\n    return [iSupBook, itabFirst, itabLast];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.218 */\r\n  function parse_RkRec(blob) {\r\n    var ixfe = blob.read_shift(2);\r\n    var RK = parse_RkNumber(blob);\r\n    return [ixfe, RK];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.1 */\r\n  function parse_AddinUdf(blob, length, opts) {\r\n    blob.l += 4; length -= 4;\r\n    var l = blob.l + length;\r\n    var udfName = parse_ShortXLUnicodeString(blob, length, opts);\r\n    var cb = blob.read_shift(2);\r\n    l -= blob.l;\r\n    if(cb !== l) throw new Error(\"Malformed AddinUdf: padding = \" + l + \" != \" + cb);\r\n    blob.l += cb;\r\n    return udfName;\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.209 TODO: Check sizes */\r\n  function parse_Ref8U(blob) {\r\n    var rwFirst = blob.read_shift(2);\r\n    var rwLast = blob.read_shift(2);\r\n    var colFirst = blob.read_shift(2);\r\n    var colLast = blob.read_shift(2);\r\n    return {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\r\n  }\r\n  function write_Ref8U(r, o) {\r\n    if(!o) o = new_buf(8);\r\n    o.write_shift(2, r.s.r);\r\n    o.write_shift(2, r.e.r);\r\n    o.write_shift(2, r.s.c);\r\n    o.write_shift(2, r.e.c);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.211 */\r\n  function parse_RefU(blob) {\r\n    var rwFirst = blob.read_shift(2);\r\n    var rwLast = blob.read_shift(2);\r\n    var colFirst = blob.read_shift(1);\r\n    var colLast = blob.read_shift(1);\r\n    return {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.207 */\r\n  var parse_Ref = parse_RefU;\r\n\r\n  /* [MS-XLS] 2.5.143 */\r\n  function parse_FtCmo(blob) {\r\n    blob.l += 4;\r\n    var ot = blob.read_shift(2);\r\n    var id = blob.read_shift(2);\r\n    var flags = blob.read_shift(2);\r\n    blob.l+=12;\r\n    return [id, ot, flags];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.149 */\r\n  function parse_FtNts(blob) {\r\n    var out = {};\r\n    blob.l += 4;\r\n    blob.l += 16; // GUID TODO\r\n    out.fSharedNote = blob.read_shift(2);\r\n    blob.l += 4;\r\n    return out;\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.142 */\r\n  function parse_FtCf(blob) {\r\n    var out = {};\r\n    blob.l += 4;\r\n    blob.cf = blob.read_shift(2);\r\n    return out;\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.140 - 2.5.154 and friends */\r\n  function parse_FtSkip(blob) { blob.l += 2; blob.l += blob.read_shift(2); }\r\n  var FtTab = {\r\n    0x00: parse_FtSkip,      /* FtEnd */\r\n    0x04: parse_FtSkip,      /* FtMacro */\r\n    0x05: parse_FtSkip,      /* FtButton */\r\n    0x06: parse_FtSkip,      /* FtGmo */\r\n    0x07: parse_FtCf,        /* FtCf */\r\n    0x08: parse_FtSkip,      /* FtPioGrbit */\r\n    0x09: parse_FtSkip,      /* FtPictFmla */\r\n    0x0A: parse_FtSkip,      /* FtCbls */\r\n    0x0B: parse_FtSkip,      /* FtRbo */\r\n    0x0C: parse_FtSkip,      /* FtSbs */\r\n    0x0D: parse_FtNts,       /* FtNts */\r\n    0x0E: parse_FtSkip,      /* FtSbsFmla */\r\n    0x0F: parse_FtSkip,      /* FtGboData */\r\n    0x10: parse_FtSkip,      /* FtEdoData */\r\n    0x11: parse_FtSkip,      /* FtRboData */\r\n    0x12: parse_FtSkip,      /* FtCblsData */\r\n    0x13: parse_FtSkip,      /* FtLbsData */\r\n    0x14: parse_FtSkip,      /* FtCblsFmla */\r\n    0x15: parse_FtCmo\r\n  };\r\n  function parse_FtArray(blob, length) {\r\n    var tgt = blob.l + length;\r\n    var fts = [];\r\n    while(blob.l < tgt) {\r\n      var ft = blob.read_shift(2);\r\n      blob.l-=2;\r\n      try {\r\n        fts.push(FtTab[ft](blob, tgt - blob.l));\r\n      } catch(e) { blob.l = tgt; return fts; }\r\n    }\r\n    if(blob.l != tgt) blob.l = tgt; //throw new Error(\"bad Object Ft-sequence\");\r\n    return fts;\r\n  }\r\n\r\n  /* --- 2.4 Records --- */\r\n\r\n  /* [MS-XLS] 2.4.21 */\r\n  function parse_BOF(blob, length) {\r\n    var o = {BIFFVer:0, dt:0};\r\n    o.BIFFVer = blob.read_shift(2); length -= 2;\r\n    if(length >= 2) { o.dt = blob.read_shift(2); blob.l -= 2; }\r\n    switch(o.BIFFVer) {\r\n      case 0x0600: /* BIFF8 */\r\n      case 0x0500: /* BIFF5 */\r\n      case 0x0400: /* BIFF4 */\r\n      case 0x0300: /* BIFF3 */\r\n      case 0x0200: /* BIFF2 */\r\n      case 0x0002: case 0x0007: /* BIFF2 */\r\n        break;\r\n      default: if(length > 6) throw new Error(\"Unexpected BIFF Ver \" + o.BIFFVer);\r\n    }\r\n\r\n    blob.read_shift(length);\r\n    return o;\r\n  }\r\n  function write_BOF(wb, t, o) {\r\n    var h = 0x0600, w = 16;\r\n    switch(o.bookType) {\r\n      case 'biff8': break;\r\n      case 'biff5': h = 0x0500; w = 8; break;\r\n      case 'biff4': h = 0x0004; w = 6; break;\r\n      case 'biff3': h = 0x0003; w = 6; break;\r\n      case 'biff2': h = 0x0002; w = 4; break;\r\n      case 'xla': break;\r\n      default: throw new Error(\"unsupported BIFF version\");\r\n    }\r\n    var out = new_buf(w);\r\n    out.write_shift(2, h);\r\n    out.write_shift(2, t);\r\n    if(w > 4) out.write_shift(2, 0x7262);\r\n    if(w > 6) out.write_shift(2, 0x07CD);\r\n    if(w > 8) {\r\n      out.write_shift(2, 0xC009);\r\n      out.write_shift(2, 0x0001);\r\n      out.write_shift(2, 0x0706);\r\n      out.write_shift(2, 0x0000);\r\n    }\r\n    return out;\r\n  }\r\n\r\n\r\n  /* [MS-XLS] 2.4.146 */\r\n  function parse_InterfaceHdr(blob, length) {\r\n    if(length === 0) return 0x04b0;\r\n    if((blob.read_shift(2))!==0x04b0){/* empty */}\r\n    return 0x04b0;\r\n  }\r\n\r\n\r\n  /* [MS-XLS] 2.4.349 */\r\n  function parse_WriteAccess(blob, length, opts) {\r\n    if(opts.enc) { blob.l += length; return \"\"; }\r\n    var l = blob.l;\r\n    // TODO: make sure XLUnicodeString doesnt overrun\r\n    var UserName = parse_XLUnicodeString2(blob, 0, opts);\r\n    blob.read_shift(length + l - blob.l);\r\n    return UserName;\r\n  }\r\n  function write_WriteAccess(s, opts) {\r\n    var b8 = !opts || opts.biff == 8;\r\n    var o = new_buf(b8 ? 112 : 54);\r\n    o.write_shift(opts.biff == 8 ? 2 : 1, 7);\r\n    if(b8) o.write_shift(1, 0);\r\n    o.write_shift(4, 0x33336853);\r\n    o.write_shift(4, (0x00534A74 | (b8 ? 0 : 0x20000000)));\r\n    while(o.l < o.length) o.write_shift(1, (b8 ? 0 : 32));\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.351 */\r\n  function parse_WsBool(blob, length, opts) {\r\n    var flags = opts && opts.biff == 8 || length == 2 ? blob.read_shift(2) : (blob.l += length, 0);\r\n    return { fDialog: flags & 0x10 };\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.28 */\r\n  function parse_BoundSheet8(blob, length, opts) {\r\n    var pos = blob.read_shift(4);\r\n    var hidden = blob.read_shift(1) & 0x03;\r\n    var dt = blob.read_shift(1);\r\n    switch(dt) {\r\n      case 0: dt = 'Worksheet'; break;\r\n      case 1: dt = 'Macrosheet'; break;\r\n      case 2: dt = 'Chartsheet'; break;\r\n      case 6: dt = 'VBAModule'; break;\r\n    }\r\n    var name = parse_ShortXLUnicodeString(blob, 0, opts);\r\n    if(name.length === 0) name = \"Sheet1\";\r\n    return { pos:pos, hs:hidden, dt:dt, name:name };\r\n  }\r\n  function write_BoundSheet8(data, opts) {\r\n    var w = (!opts || opts.biff >= 8 ? 2 : 1);\r\n    var o = new_buf(8 + w * data.name.length);\r\n    o.write_shift(4, data.pos);\r\n    o.write_shift(1, data.hs || 0);\r\n    o.write_shift(1, data.dt);\r\n    o.write_shift(1, data.name.length);\r\n    if(opts.biff >= 8) o.write_shift(1, 1);\r\n    o.write_shift(w * data.name.length, data.name, opts.biff < 8 ? 'sbcs' : 'utf16le');\r\n    var out = o.slice(0, o.l);\r\n    out.l = o.l; return out;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.265 TODO */\r\n  function parse_SST(blob, length) {\r\n    var end = blob.l + length;\r\n    var cnt = blob.read_shift(4);\r\n    var ucnt = blob.read_shift(4);\r\n    var strs = ([]);\r\n    for(var i = 0; i != ucnt && blob.l < end; ++i) {\r\n      strs.push(parse_XLUnicodeRichExtendedString(blob));\r\n    }\r\n    strs.Count = cnt; strs.Unique = ucnt;\r\n    return strs;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.107 */\r\n  function parse_ExtSST(blob, length) {\r\n    var extsst = {};\r\n    extsst.dsst = blob.read_shift(2);\r\n    blob.l += length-2;\r\n    return extsst;\r\n  }\r\n\r\n\r\n  /* [MS-XLS] 2.4.221 TODO: check BIFF2-4 */\r\n  function parse_Row(blob) {\r\n    var z = ({});\r\n    z.r = blob.read_shift(2);\r\n    z.c = blob.read_shift(2);\r\n    z.cnt = blob.read_shift(2) - z.c;\r\n    var miyRw = blob.read_shift(2);\r\n    blob.l += 4; // reserved(2), unused(2)\r\n    var flags = blob.read_shift(1); // various flags\r\n    blob.l += 3; // reserved(8), ixfe(12), flags(4)\r\n    if(flags & 0x07) z.level = flags & 0x07;\r\n    // collapsed: flags & 0x10\r\n    if(flags & 0x20) z.hidden = true;\r\n    if(flags & 0x40) z.hpt = miyRw / 20;\r\n    return z;\r\n  }\r\n\r\n\r\n  /* [MS-XLS] 2.4.125 */\r\n  function parse_ForceFullCalculation(blob) {\r\n    var header = parse_frtHeader(blob);\r\n    if(header.type != 0x08A3) throw new Error(\"Invalid Future Record \" + header.type);\r\n    var fullcalc = blob.read_shift(4);\r\n    return fullcalc !== 0x0;\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  /* [MS-XLS] 2.4.215 rt */\r\n  function parse_RecalcId(blob) {\r\n    blob.read_shift(2);\r\n    return blob.read_shift(4);\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.87 */\r\n  function parse_DefaultRowHeight(blob, length, opts) {\r\n    var f = 0;\r\n    if(!(opts && opts.biff == 2)) {\r\n      f = blob.read_shift(2);\r\n    }\r\n    var miyRw = blob.read_shift(2);\r\n    if((opts && opts.biff == 2)) {\r\n      f = 1 - (miyRw >> 15); miyRw &= 0x7fff;\r\n    }\r\n    var fl = {Unsynced:f&1,DyZero:(f&2)>>1,ExAsc:(f&4)>>2,ExDsc:(f&8)>>3};\r\n    return [fl, miyRw];\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.345 TODO */\r\n  function parse_Window1(blob) {\r\n    var xWn = blob.read_shift(2), yWn = blob.read_shift(2), dxWn = blob.read_shift(2), dyWn = blob.read_shift(2);\r\n    var flags = blob.read_shift(2), iTabCur = blob.read_shift(2), iTabFirst = blob.read_shift(2);\r\n    var ctabSel = blob.read_shift(2), wTabRatio = blob.read_shift(2);\r\n    return { Pos: [xWn, yWn], Dim: [dxWn, dyWn], Flags: flags, CurTab: iTabCur,\r\n      FirstTab: iTabFirst, Selected: ctabSel, TabRatio: wTabRatio };\r\n  }\r\n  function write_Window1() {\r\n    var o = new_buf(18);\r\n    o.write_shift(2, 0);\r\n    o.write_shift(2, 0);\r\n    o.write_shift(2, 0x7260);\r\n    o.write_shift(2, 0x44c0);\r\n    o.write_shift(2, 0x38);\r\n    o.write_shift(2, 0);\r\n    o.write_shift(2, 0);\r\n    o.write_shift(2, 1);\r\n    o.write_shift(2, 0x01f4);\r\n    return o;\r\n  }\r\n  /* [MS-XLS] 2.4.346 TODO */\r\n  function parse_Window2(blob, length, opts) {\r\n    if(opts && opts.biff >= 2 && opts.biff < 8) return {};\r\n    var f = blob.read_shift(2);\r\n    return { RTL: f & 0x40 };\r\n  }\r\n  function write_Window2(view) {\r\n    var o = new_buf(18), f = 0x6b6;\r\n    if(view && view.RTL) f |= 0x40;\r\n    o.write_shift(2, f);\r\n    o.write_shift(4, 0);\r\n    o.write_shift(4, 64);\r\n    o.write_shift(4, 0);\r\n    o.write_shift(4, 0);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.122 TODO */\r\n  function parse_Font(blob, length, opts) {\r\n    var o = {\r\n      dyHeight: blob.read_shift(2),\r\n      fl: blob.read_shift(2)\r\n    };\r\n    switch((opts && opts.biff) || 8) {\r\n      case 2: break;\r\n      case 3: case 4: blob.l += 2; break;\r\n      default: blob.l += 10; break;\r\n    }\r\n    o.name = parse_ShortXLUnicodeString(blob, 0, opts);\r\n    return o;\r\n  }\r\n  function write_Font(data, opts) {\r\n    var name = data.name || \"Arial\";\r\n    var b5 = (opts && (opts.biff == 5)), w = (b5 ? (15 + name.length) : (16 + 2 * name.length));\r\n    var o = new_buf(w);\r\n    o.write_shift(2, (data.sz || 12) * 20);\r\n    o.write_shift(4, 0);\r\n    o.write_shift(2, 400);\r\n    o.write_shift(4, 0);\r\n    o.write_shift(2, 0);\r\n    o.write_shift(1, name.length);\r\n    if(!b5) o.write_shift(1, 1);\r\n    o.write_shift((b5 ? 1 : 2) * name.length, name, (b5 ? \"sbcs\" : \"utf16le\"));\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.149 */\r\n  function parse_LabelSst(blob) {\r\n    var cell = parse_XLSCell(blob);\r\n    cell.isst = blob.read_shift(4);\r\n    return cell;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.148 */\r\n  function parse_Label(blob, length, opts) {\r\n    var target = blob.l + length;\r\n    var cell = parse_XLSCell(blob, 6);\r\n    if(opts.biff == 2) blob.l++;\r\n    var str = parse_XLUnicodeString(blob, target - blob.l, opts);\r\n    cell.val = str;\r\n    return cell;\r\n  }\r\n  function write_Label(R, C, v, os, opts) {\r\n    var b8 = !opts || opts.biff == 8;\r\n    var o = new_buf(6 + 2 + (+b8) + (1 + b8) * v.length);\r\n    write_XLSCell(R, C, os, o);\r\n    o.write_shift(2, v.length);\r\n    if(b8) o.write_shift(1, 1);\r\n    o.write_shift((1 + b8) * v.length, v, b8 ? 'utf16le' : 'sbcs');\r\n    return o;\r\n  }\r\n\r\n\r\n  /* [MS-XLS] 2.4.126 Number Formats */\r\n  function parse_Format(blob, length, opts) {\r\n    var numFmtId = blob.read_shift(2);\r\n    var fmtstr = parse_XLUnicodeString2(blob, 0, opts);\r\n    return [numFmtId, fmtstr];\r\n  }\r\n  function write_Format(i, f, opts, o) {\r\n    var b5 = (opts && (opts.biff == 5));\r\n    if(!o) o = new_buf(b5 ? (3 + f.length) : (5 + 2 * f.length));\r\n    o.write_shift(2, i);\r\n    o.write_shift((b5 ? 1 : 2), f.length);\r\n    if(!b5) o.write_shift(1, 1);\r\n    o.write_shift((b5 ? 1 : 2) * f.length, f, (b5 ? 'sbcs' : 'utf16le'));\r\n    var out = (o.length > o.l) ? o.slice(0, o.l) : o;\r\n    if(out.l == null) out.l = out.length;\r\n    return out;\r\n  }\r\n  var parse_BIFF2Format = parse_XLUnicodeString2;\r\n\r\n  /* [MS-XLS] 2.4.90 */\r\n  function parse_Dimensions(blob, length, opts) {\r\n    var end = blob.l + length;\r\n    var w = opts.biff == 8 || !opts.biff ? 4 : 2;\r\n    var r = blob.read_shift(w), R = blob.read_shift(w);\r\n    var c = blob.read_shift(2), C = blob.read_shift(2);\r\n    blob.l = end;\r\n    return {s: {r:r, c:c}, e: {r:R, c:C}};\r\n  }\r\n  function write_Dimensions(range, opts) {\r\n    var w = opts.biff == 8 || !opts.biff ? 4 : 2;\r\n    var o = new_buf(2*w + 6);\r\n    o.write_shift(w, range.s.r);\r\n    o.write_shift(w, range.e.r + 1);\r\n    o.write_shift(2, range.s.c);\r\n    o.write_shift(2, range.e.c + 1);\r\n    o.write_shift(2, 0);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.220 */\r\n  function parse_RK(blob) {\r\n    var rw = blob.read_shift(2), col = blob.read_shift(2);\r\n    var rkrec = parse_RkRec(blob);\r\n    return {r:rw, c:col, ixfe:rkrec[0], rknum:rkrec[1]};\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.175 */\r\n  function parse_MulRk(blob, length) {\r\n    var target = blob.l + length - 2;\r\n    var rw = blob.read_shift(2), col = blob.read_shift(2);\r\n    var rkrecs = [];\r\n    while(blob.l < target) rkrecs.push(parse_RkRec(blob));\r\n    if(blob.l !== target) throw new Error(\"MulRK read error\");\r\n    var lastcol = blob.read_shift(2);\r\n    if(rkrecs.length != lastcol - col + 1) throw new Error(\"MulRK length mismatch\");\r\n    return {r:rw, c:col, C:lastcol, rkrec:rkrecs};\r\n  }\r\n  /* [MS-XLS] 2.4.174 */\r\n  function parse_MulBlank(blob, length) {\r\n    var target = blob.l + length - 2;\r\n    var rw = blob.read_shift(2), col = blob.read_shift(2);\r\n    var ixfes = [];\r\n    while(blob.l < target) ixfes.push(blob.read_shift(2));\r\n    if(blob.l !== target) throw new Error(\"MulBlank read error\");\r\n    var lastcol = blob.read_shift(2);\r\n    if(ixfes.length != lastcol - col + 1) throw new Error(\"MulBlank length mismatch\");\r\n    return {r:rw, c:col, C:lastcol, ixfe:ixfes};\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.20 2.5.249 TODO: interpret values here */\r\n  function parse_CellStyleXF(blob, length, style, opts) {\r\n    var o = {};\r\n    var a = blob.read_shift(4), b = blob.read_shift(4);\r\n    var c = blob.read_shift(4), d = blob.read_shift(2);\r\n    o.patternType = XLSFillPattern[c >> 26];\r\n\r\n    if(!opts.cellStyles) return o;\r\n    o.alc = a & 0x07;\r\n    o.fWrap = (a >> 3) & 0x01;\r\n    o.alcV = (a >> 4) & 0x07;\r\n    o.fJustLast = (a >> 7) & 0x01;\r\n    o.trot = (a >> 8) & 0xFF;\r\n    o.cIndent = (a >> 16) & 0x0F;\r\n    o.fShrinkToFit = (a >> 20) & 0x01;\r\n    o.iReadOrder = (a >> 22) & 0x02;\r\n    o.fAtrNum = (a >> 26) & 0x01;\r\n    o.fAtrFnt = (a >> 27) & 0x01;\r\n    o.fAtrAlc = (a >> 28) & 0x01;\r\n    o.fAtrBdr = (a >> 29) & 0x01;\r\n    o.fAtrPat = (a >> 30) & 0x01;\r\n    o.fAtrProt = (a >> 31) & 0x01;\r\n\r\n    o.dgLeft = b & 0x0F;\r\n    o.dgRight = (b >> 4) & 0x0F;\r\n    o.dgTop = (b >> 8) & 0x0F;\r\n    o.dgBottom = (b >> 12) & 0x0F;\r\n    o.icvLeft = (b >> 16) & 0x7F;\r\n    o.icvRight = (b >> 23) & 0x7F;\r\n    o.grbitDiag = (b >> 30) & 0x03;\r\n\r\n    o.icvTop = c & 0x7F;\r\n    o.icvBottom = (c >> 7) & 0x7F;\r\n    o.icvDiag = (c >> 14) & 0x7F;\r\n    o.dgDiag = (c >> 21) & 0x0F;\r\n\r\n    o.icvFore = d & 0x7F;\r\n    o.icvBack = (d >> 7) & 0x7F;\r\n    o.fsxButton = (d >> 14) & 0x01;\r\n    return o;\r\n  }\r\n//function parse_CellXF(blob, length, opts) {return parse_CellStyleXF(blob,length,0, opts);}\r\n//function parse_StyleXF(blob, length, opts) {return parse_CellStyleXF(blob,length,1, opts);}\r\n\r\n  /* [MS-XLS] 2.4.353 TODO: actually do this right */\r\n  function parse_XF(blob, length, opts) {\r\n    var o = {};\r\n    o.ifnt = blob.read_shift(2); o.numFmtId = blob.read_shift(2); o.flags = blob.read_shift(2);\r\n    o.fStyle = (o.flags >> 2) & 0x01;\r\n    length -= 6;\r\n    o.data = parse_CellStyleXF(blob, length, o.fStyle, opts);\r\n    return o;\r\n  }\r\n  function write_XF(data, ixfeP, opts, o) {\r\n    var b5 = (opts && (opts.biff == 5));\r\n    if(!o) o = new_buf(b5 ? 16 : 20);\r\n    o.write_shift(2, 0);\r\n    if(data.style) {\r\n      o.write_shift(2, (data.numFmtId||0));\r\n      o.write_shift(2, 0xFFF4);\r\n    } else {\r\n      o.write_shift(2, (data.numFmtId||0));\r\n      o.write_shift(2, (ixfeP<<4));\r\n    }\r\n    o.write_shift(4, 0);\r\n    o.write_shift(4, 0);\r\n    if(!b5) o.write_shift(4, 0);\r\n    o.write_shift(2, 0);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.134 */\r\n  function parse_Guts(blob) {\r\n    blob.l += 4;\r\n    var out = [blob.read_shift(2), blob.read_shift(2)];\r\n    if(out[0] !== 0) out[0]--;\r\n    if(out[1] !== 0) out[1]--;\r\n    if(out[0] > 7 || out[1] > 7) throw new Error(\"Bad Gutters: \" + out.join(\"|\"));\r\n    return out;\r\n  }\r\n  function write_Guts(guts) {\r\n    var o = new_buf(8);\r\n    o.write_shift(4, 0);\r\n    o.write_shift(2, guts[0] ? guts[0] + 1 : 0);\r\n    o.write_shift(2, guts[1] ? guts[1] + 1 : 0);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.24 */\r\n  function parse_BoolErr(blob, length, opts) {\r\n    var cell = parse_XLSCell(blob, 6);\r\n    if(opts.biff == 2) ++blob.l;\r\n    var val = parse_Bes(blob, 2);\r\n    cell.val = val;\r\n    cell.t = (val === true || val === false) ? 'b' : 'e';\r\n    return cell;\r\n  }\r\n  function write_BoolErr(R, C, v, os, opts, t) {\r\n    var o = new_buf(8);\r\n    write_XLSCell(R, C, os, o);\r\n    write_Bes(v, t, o);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.180 Number */\r\n  function parse_Number(blob) {\r\n    var cell = parse_XLSCell(blob, 6);\r\n    var xnum = parse_Xnum(blob, 8);\r\n    cell.val = xnum;\r\n    return cell;\r\n  }\r\n  function write_Number(R, C, v, os) {\r\n    var o = new_buf(14);\r\n    write_XLSCell(R, C, os, o);\r\n    write_Xnum(v, o);\r\n    return o;\r\n  }\r\n\r\n  var parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\r\n\r\n  /* [MS-XLS] 2.4.271 */\r\n  function parse_SupBook(blob, length, opts) {\r\n    var end = blob.l + length;\r\n    var ctab = blob.read_shift(2);\r\n    var cch = blob.read_shift(2);\r\n    opts.sbcch = cch;\r\n    if(cch == 0x0401 || cch == 0x3A01) return [cch, ctab];\r\n    if(cch < 0x01 || cch >0xff) throw new Error(\"Unexpected SupBook type: \"+cch);\r\n    var virtPath = parse_XLUnicodeStringNoCch(blob, cch);\r\n    /* TODO: 2.5.277 Virtual Path */\r\n    var rgst = [];\r\n    while(end > blob.l) rgst.push(parse_XLUnicodeString(blob));\r\n    return [cch, ctab, virtPath, rgst];\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.105 TODO */\r\n  function parse_ExternName(blob, length, opts) {\r\n    var flags = blob.read_shift(2);\r\n    var body;\r\n    var o = ({\r\n      fBuiltIn: flags & 0x01,\r\n      fWantAdvise: (flags >>> 1) & 0x01,\r\n      fWantPict: (flags >>> 2) & 0x01,\r\n      fOle: (flags >>> 3) & 0x01,\r\n      fOleLink: (flags >>> 4) & 0x01,\r\n      cf: (flags >>> 5) & 0x3FF,\r\n      fIcon: flags >>> 15 & 0x01\r\n    });\r\n    if(opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length-2, opts);\r\n    //else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\r\n    o.body = body || blob.read_shift(length-2);\r\n    if(typeof body === \"string\") o.Name = body;\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.150 TODO */\r\n  var XLSLblBuiltIn = [\r\n    \"_xlnm.Consolidate_Area\",\r\n    \"_xlnm.Auto_Open\",\r\n    \"_xlnm.Auto_Close\",\r\n    \"_xlnm.Extract\",\r\n    \"_xlnm.Database\",\r\n    \"_xlnm.Criteria\",\r\n    \"_xlnm.Print_Area\",\r\n    \"_xlnm.Print_Titles\",\r\n    \"_xlnm.Recorder\",\r\n    \"_xlnm.Data_Form\",\r\n    \"_xlnm.Auto_Activate\",\r\n    \"_xlnm.Auto_Deactivate\",\r\n    \"_xlnm.Sheet_Title\",\r\n    \"_xlnm._FilterDatabase\"\r\n  ];\r\n  function parse_Lbl(blob, length, opts) {\r\n    var target = blob.l + length;\r\n    var flags = blob.read_shift(2);\r\n    var chKey = blob.read_shift(1);\r\n    var cch = blob.read_shift(1);\r\n    var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\r\n    var itab = 0;\r\n    if(!opts || opts.biff >= 5) {\r\n      if(opts.biff != 5) blob.l += 2;\r\n      itab = blob.read_shift(2);\r\n      if(opts.biff == 5) blob.l += 2;\r\n      blob.l += 4;\r\n    }\r\n    var name = parse_XLUnicodeStringNoCch(blob, cch, opts);\r\n    if(flags & 0x20) name = XLSLblBuiltIn[name.charCodeAt(0)];\r\n    var npflen = target - blob.l; if(opts && opts.biff == 2) --npflen;\r\n    var rgce = target == blob.l || cce === 0 ? [] : parse_NameParsedFormula(blob, npflen, opts, cce);\r\n    return {\r\n      chKey: chKey,\r\n      Name: name,\r\n      itab: itab,\r\n      rgce: rgce\r\n    };\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.106 TODO: verify filename encoding */\r\n  function parse_ExternSheet(blob, length, opts) {\r\n    if(opts.biff < 8) return parse_BIFF5ExternSheet(blob, length, opts);\r\n    var o = [], target = blob.l + length, len = blob.read_shift(opts.biff > 8 ? 4 : 2);\r\n    while(len-- !== 0) o.push(parse_XTI(blob, opts.biff > 8 ? 12 : 6, opts));\r\n    // [iSupBook, itabFirst, itabLast];\r\n    if(blob.l != target) throw new Error(\"Bad ExternSheet: \" + blob.l + \" != \" + target);\r\n    return o;\r\n  }\r\n  function parse_BIFF5ExternSheet(blob, length, opts) {\r\n    if(blob[blob.l + 1] == 0x03) blob[blob.l]++;\r\n    var o = parse_ShortXLUnicodeString(blob, length, opts);\r\n    return o.charCodeAt(0) == 0x03 ? o.slice(1) : o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.176 TODO: check older biff */\r\n  function parse_NameCmt(blob, length, opts) {\r\n    if(opts.biff < 8) { blob.l += length; return; }\r\n    var cchName = blob.read_shift(2);\r\n    var cchComment = blob.read_shift(2);\r\n    var name = parse_XLUnicodeStringNoCch(blob, cchName, opts);\r\n    var comment = parse_XLUnicodeStringNoCch(blob, cchComment, opts);\r\n    return [name, comment];\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.260 */\r\n  function parse_ShrFmla(blob, length, opts) {\r\n    var ref = parse_RefU(blob, 6);\r\n    blob.l++;\r\n    var cUse = blob.read_shift(1);\r\n    length -= 8;\r\n    return [parse_SharedParsedFormula(blob, length, opts), cUse, ref];\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.4 TODO */\r\n  function parse_Array(blob, length, opts) {\r\n    var ref = parse_Ref(blob, 6);\r\n    /* TODO: fAlwaysCalc */\r\n    switch(opts.biff) {\r\n      case 2: blob.l ++; length -= 7; break;\r\n      case 3: case 4: blob.l += 2; length -= 8; break;\r\n      default: blob.l += 6; length -= 12;\r\n    }\r\n    return [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.173 */\r\n  function parse_MTRSettings(blob) {\r\n    var fMTREnabled = blob.read_shift(4) !== 0x00;\r\n    var fUserSetThreadCount = blob.read_shift(4) !== 0x00;\r\n    var cUserThreadCount = blob.read_shift(4);\r\n    return [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.186 TODO: BIFF5 */\r\n  function parse_NoteSh(blob, length, opts) {\r\n    if(opts.biff < 8) return;\r\n    var row = blob.read_shift(2), col = blob.read_shift(2);\r\n    var flags = blob.read_shift(2), idObj = blob.read_shift(2);\r\n    var stAuthor = parse_XLUnicodeString2(blob, 0, opts);\r\n    if(opts.biff < 8) blob.read_shift(1);\r\n    return [{r:row,c:col}, stAuthor, idObj, flags];\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.179 */\r\n  function parse_Note(blob, length, opts) {\r\n    /* TODO: Support revisions */\r\n    return parse_NoteSh(blob, length, opts);\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.168 */\r\n  function parse_MergeCells(blob, length) {\r\n    var merges = [];\r\n    var cmcs = blob.read_shift(2);\r\n    while (cmcs--) merges.push(parse_Ref8U(blob,length));\r\n    return merges;\r\n  }\r\n  function write_MergeCells(merges) {\r\n    var o = new_buf(2 + merges.length * 8);\r\n    o.write_shift(2, merges.length);\r\n    for(var i = 0; i < merges.length; ++i) write_Ref8U(merges[i], o);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.181 TODO: parse all the things! */\r\n  function parse_Obj(blob, length, opts) {\r\n    if(opts && opts.biff < 8) return parse_BIFF5Obj(blob, length, opts);\r\n    var cmo = parse_FtCmo(blob, 22); // id, ot, flags\r\n    var fts = parse_FtArray(blob, length-22, cmo[1]);\r\n    return { cmo: cmo, ft:fts };\r\n  }\r\n  /* from older spec */\r\n  var parse_BIFF5OT = [];\r\n  parse_BIFF5OT[0x08] = function(blob, length) {\r\n    var tgt = blob.l + length;\r\n    blob.l += 10; // todo\r\n    var cf = blob.read_shift(2);\r\n    blob.l += 4;\r\n    blob.l += 2; //var cbPictFmla = blob.read_shift(2);\r\n    blob.l += 2;\r\n    blob.l += 2; //var grbit = blob.read_shift(2);\r\n    blob.l += 4;\r\n    var cchName = blob.read_shift(1);\r\n    blob.l += cchName; // TODO: stName\r\n    blob.l = tgt; // TODO: fmla\r\n    return { fmt:cf };\r\n  };\r\n\r\n  function parse_BIFF5Obj(blob, length, opts) {\r\n    blob.l += 4; //var cnt = blob.read_shift(4);\r\n    var ot = blob.read_shift(2);\r\n    var id = blob.read_shift(2);\r\n    var grbit = blob.read_shift(2);\r\n    blob.l += 2; //var colL = blob.read_shift(2);\r\n    blob.l += 2; //var dxL = blob.read_shift(2);\r\n    blob.l += 2; //var rwT = blob.read_shift(2);\r\n    blob.l += 2; //var dyT = blob.read_shift(2);\r\n    blob.l += 2; //var colR = blob.read_shift(2);\r\n    blob.l += 2; //var dxR = blob.read_shift(2);\r\n    blob.l += 2; //var rwB = blob.read_shift(2);\r\n    blob.l += 2; //var dyB = blob.read_shift(2);\r\n    blob.l += 2; //var cbMacro = blob.read_shift(2);\r\n    blob.l += 6;\r\n    length -= 36;\r\n    var fts = [];\r\n    fts.push((parse_BIFF5OT[ot]||parsenoop)(blob, length, opts));\r\n    return { cmo: [id, ot, grbit], ft:fts };\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.329 TODO: parse properly */\r\n  function parse_TxO(blob, length, opts) {\r\n    var s = blob.l;\r\n    var texts = \"\";\r\n    try {\r\n      blob.l += 4;\r\n      var ot = (opts.lastobj||{cmo:[0,0]}).cmo[1];\r\n      var controlInfo; // eslint-disable-line no-unused-vars\r\n      if([0,5,7,11,12,14].indexOf(ot) == -1) blob.l += 6;\r\n      else controlInfo = parse_ControlInfo(blob, 6, opts);\r\n      var cchText = blob.read_shift(2);\r\n      /*var cbRuns = */blob.read_shift(2);\r\n      /*var ifntEmpty = */parseuint16(blob, 2);\r\n      var len = blob.read_shift(2);\r\n      blob.l += len;\r\n      //var fmla = parse_ObjFmla(blob, s + length - blob.l);\r\n\r\n      for(var i = 1; i < blob.lens.length-1; ++i) {\r\n        if(blob.l-s != blob.lens[i]) throw new Error(\"TxO: bad continue record\");\r\n        var hdr = blob[blob.l];\r\n        var t = parse_XLUnicodeStringNoCch(blob, blob.lens[i+1]-blob.lens[i]-1);\r\n        texts += t;\r\n        if(texts.length >= (hdr ? cchText : 2*cchText)) break;\r\n      }\r\n      if(texts.length !== cchText && texts.length !== cchText*2) {\r\n        throw new Error(\"cchText: \" + cchText + \" != \" + texts.length);\r\n      }\r\n\r\n      blob.l = s + length;\r\n      /* [MS-XLS] 2.5.272 TxORuns */\r\n//\tvar rgTxoRuns = [];\r\n//\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\r\n//\tvar cchText2 = blob.read_shift(2);\r\n//\tif(cchText2 !== cchText) throw new Error(\"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText);\r\n//\tblob.l += 6;\r\n//\tif(s + length != blob.l) throw new Error(\"TxO \" + (s + length) + \", at \" + blob.l);\r\n      return { t: texts };\r\n    } catch(e) { blob.l = s + length; return { t: texts }; }\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.140 */\r\n  function parse_HLink(blob, length) {\r\n    var ref = parse_Ref8U(blob, 8);\r\n    blob.l += 16; /* CLSID */\r\n    var hlink = parse_Hyperlink(blob, length-24);\r\n    return [ref, hlink];\r\n  }\r\n  function write_HLink(hl) {\r\n    var O = new_buf(24);\r\n    var ref = decode_cell(hl[0]);\r\n    O.write_shift(2, ref.r); O.write_shift(2, ref.r);\r\n    O.write_shift(2, ref.c); O.write_shift(2, ref.c);\r\n    var clsid = \"d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");\r\n    for(var i = 0; i < 16; ++i) O.write_shift(1, parseInt(clsid[i], 16));\r\n    return bconcat([O, write_Hyperlink(hl[1])]);\r\n  }\r\n\r\n\r\n  /* [MS-XLS] 2.4.141 */\r\n  function parse_HLinkTooltip(blob, length) {\r\n    blob.read_shift(2);\r\n    var ref = parse_Ref8U(blob, 8);\r\n    var wzTooltip = blob.read_shift((length-10)/2, 'dbcs-cont');\r\n    wzTooltip = wzTooltip.replace(chr0,\"\");\r\n    return [ref, wzTooltip];\r\n  }\r\n  function write_HLinkTooltip(hl) {\r\n    var TT = hl[1].Tooltip;\r\n    var O = new_buf(10 + 2 * (TT.length + 1));\r\n    O.write_shift(2, 0x0800);\r\n    var ref = decode_cell(hl[0]);\r\n    O.write_shift(2, ref.r); O.write_shift(2, ref.r);\r\n    O.write_shift(2, ref.c); O.write_shift(2, ref.c);\r\n    for(var i = 0; i < TT.length; ++i) O.write_shift(2, TT.charCodeAt(i));\r\n    O.write_shift(2, 0);\r\n    return O;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.63 */\r\n  function parse_Country(blob) {\r\n    var o = [0,0], d;\r\n    d = blob.read_shift(2); o[0] = CountryEnum[d] || d;\r\n    d = blob.read_shift(2); o[1] = CountryEnum[d] || d;\r\n    return o;\r\n  }\r\n  function write_Country(o) {\r\n    if(!o) o = new_buf(4);\r\n    o.write_shift(2, 0x01);\r\n    o.write_shift(2, 0x01);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.50 ClrtClient */\r\n  function parse_ClrtClient(blob) {\r\n    var ccv = blob.read_shift(2);\r\n    var o = [];\r\n    while(ccv-->0) o.push(parse_LongRGB(blob, 8));\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.188 */\r\n  function parse_Palette(blob) {\r\n    var ccv = blob.read_shift(2);\r\n    var o = [];\r\n    while(ccv-->0) o.push(parse_LongRGB(blob, 8));\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.354 */\r\n  function parse_XFCRC(blob) {\r\n    blob.l += 2;\r\n    var o = {cxfs:0, crc:0};\r\n    o.cxfs = blob.read_shift(2);\r\n    o.crc = blob.read_shift(4);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.53 TODO: parse flags */\r\n  /* [MS-XLSB] 2.4.323 TODO: parse flags */\r\n  function parse_ColInfo(blob, length, opts) {\r\n    if(!opts.cellStyles) return parsenoop(blob, length);\r\n    var w = opts && opts.biff >= 12 ? 4 : 2;\r\n    var colFirst = blob.read_shift(w);\r\n    var colLast = blob.read_shift(w);\r\n    var coldx = blob.read_shift(w);\r\n    var ixfe = blob.read_shift(w);\r\n    var flags = blob.read_shift(2);\r\n    if(w == 2) blob.l += 2;\r\n    return {s:colFirst, e:colLast, w:coldx, ixfe:ixfe, flags:flags};\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.257 */\r\n  function parse_Setup(blob, length) {\r\n    var o = {};\r\n    if(length < 32) return o;\r\n    blob.l += 16;\r\n    o.header = parse_Xnum(blob, 8);\r\n    o.footer = parse_Xnum(blob, 8);\r\n    blob.l += 2;\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.261 */\r\n  function parse_ShtProps(blob, length, opts) {\r\n    var def = {area:false};\r\n    if(opts.biff != 5) { blob.l += length; return def; }\r\n    var d = blob.read_shift(1); blob.l += 3;\r\n    if((d & 0x10)) def.area = true;\r\n    return def;\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.241 */\r\n  function write_RRTabId(n) {\r\n    var out = new_buf(2 * n);\r\n    for(var i = 0; i < n; ++i) out.write_shift(2, i+1);\r\n    return out;\r\n  }\r\n\r\n  var parse_Blank = parse_XLSCell; /* [MS-XLS] 2.4.20 Just the cell */\r\n  var parse_Scl = parseuint16a; /* [MS-XLS] 2.4.247 num, den */\r\n  var parse_String = parse_XLUnicodeString; /* [MS-XLS] 2.4.268 */\r\n\r\n  /* --- Specific to versions before BIFF8 --- */\r\n  function parse_ImData(blob) {\r\n    var cf = blob.read_shift(2);\r\n    var env = blob.read_shift(2);\r\n    var lcb = blob.read_shift(4);\r\n    var o = {fmt:cf, env:env, len:lcb, data:blob.slice(blob.l,blob.l+lcb)};\r\n    blob.l += lcb;\r\n    return o;\r\n  }\r\n\r\n  /* BIFF2_??? where ??? is the name from [XLS] */\r\n  function parse_BIFF2STR(blob, length, opts) {\r\n    var cell = parse_XLSCell(blob, 6);\r\n    ++blob.l;\r\n    var str = parse_XLUnicodeString2(blob, length-7, opts);\r\n    cell.t = 'str';\r\n    cell.val = str;\r\n    return cell;\r\n  }\r\n\r\n  function parse_BIFF2NUM(blob) {\r\n    var cell = parse_XLSCell(blob, 6);\r\n    ++blob.l;\r\n    var num = parse_Xnum(blob, 8);\r\n    cell.t = 'n';\r\n    cell.val = num;\r\n    return cell;\r\n  }\r\n  function write_BIFF2NUM(r, c, val) {\r\n    var out = new_buf(15);\r\n    write_BIFF2Cell(out, r, c);\r\n    out.write_shift(8, val, 'f');\r\n    return out;\r\n  }\r\n\r\n  function parse_BIFF2INT(blob) {\r\n    var cell = parse_XLSCell(blob, 6);\r\n    ++blob.l;\r\n    var num = blob.read_shift(2);\r\n    cell.t = 'n';\r\n    cell.val = num;\r\n    return cell;\r\n  }\r\n  function write_BIFF2INT(r, c, val) {\r\n    var out = new_buf(9);\r\n    write_BIFF2Cell(out, r, c);\r\n    out.write_shift(2, val);\r\n    return out;\r\n  }\r\n\r\n  function parse_BIFF2STRING(blob) {\r\n    var cch = blob.read_shift(1);\r\n    if(cch === 0) { blob.l++; return \"\"; }\r\n    return blob.read_shift(cch, 'sbcs-cont');\r\n  }\r\n\r\n  /* TODO: convert to BIFF8 font struct */\r\n  function parse_BIFF2FONTXTRA(blob, length) {\r\n    blob.l += 6; // unknown\r\n    blob.l += 2; // font weight \"bls\"\r\n    blob.l += 1; // charset\r\n    blob.l += 3; // unknown\r\n    blob.l += 1; // font family\r\n    blob.l += length - 13;\r\n  }\r\n\r\n  /* TODO: parse rich text runs */\r\n  function parse_RString(blob, length, opts) {\r\n    var end = blob.l + length;\r\n    var cell = parse_XLSCell(blob, 6);\r\n    var cch = blob.read_shift(2);\r\n    var str = parse_XLUnicodeStringNoCch(blob, cch, opts);\r\n    blob.l = end;\r\n    cell.t = 'str';\r\n    cell.val = str;\r\n    return cell;\r\n  }\r\n  /* from js-harb (C) 2014-present  SheetJS */\r\n  var DBF = (function() {\r\n    var dbf_codepage_map = {\r\n      /* Code Pages Supported by Visual FoxPro */\r\n      0x01:   437,           0x02:   850,\r\n      0x03:  1252,           0x04: 10000,\r\n      0x64:   852,           0x65:   866,\r\n      0x66:   865,           0x67:   861,\r\n      0x68:   895,           0x69:   620,\r\n      0x6A:   737,           0x6B:   857,\r\n      0x78:   950,           0x79:   949,\r\n      0x7A:   936,           0x7B:   932,\r\n      0x7C:   874,           0x7D:  1255,\r\n      0x7E:  1256,           0x96: 10007,\r\n      0x97: 10029,           0x98: 10006,\r\n      0xC8:  1250,           0xC9:  1251,\r\n      0xCA:  1254,           0xCB:  1253,\r\n\r\n      /* shapefile DBF extension */\r\n      0x00: 20127,           0x08:   865,\r\n      0x09:   437,           0x0A:   850,\r\n      0x0B:   437,           0x0D:   437,\r\n      0x0E:   850,           0x0F:   437,\r\n      0x10:   850,           0x11:   437,\r\n      0x12:   850,           0x13:   932,\r\n      0x14:   850,           0x15:   437,\r\n      0x16:   850,           0x17:   865,\r\n      0x18:   437,           0x19:   437,\r\n      0x1A:   850,           0x1B:   437,\r\n      0x1C:   863,           0x1D:   850,\r\n      0x1F:   852,           0x22:   852,\r\n      0x23:   852,           0x24:   860,\r\n      0x25:   850,           0x26:   866,\r\n      0x37:   850,           0x40:   852,\r\n      0x4D:   936,           0x4E:   949,\r\n      0x4F:   950,           0x50:   874,\r\n      0x57:  1252,           0x58:  1252,\r\n      0x59:  1252,\r\n\r\n      0xFF: 16969\r\n    };\r\n\r\n    /* TODO: find an actual specification */\r\n    function dbf_to_aoa(buf, opts) {\r\n      var out = [];\r\n      /* TODO: browser based */\r\n      var d = (new_raw_buf(1));\r\n      switch(opts.type) {\r\n        case 'base64': d = s2a(Base64.decode(buf)); break;\r\n        case 'binary': d = s2a(buf); break;\r\n        case 'buffer':\r\n        case 'array': d = buf; break;\r\n      }\r\n      prep_blob(d, 0);\r\n      /* header */\r\n      var ft = d.read_shift(1);\r\n      var memo = false;\r\n      var vfp = false, l7 = false;\r\n      switch(ft) {\r\n        case 0x02: case 0x03: break;\r\n        case 0x30: vfp = true; memo = true; break;\r\n        case 0x31: vfp = true; break;\r\n        case 0x83: memo = true; break;\r\n        case 0x8B: memo = true; break;\r\n        case 0x8C: memo = true; l7 = true; break;\r\n        case 0xF5: memo = true; break;\r\n        default: throw new Error(\"DBF Unsupported Version: \" + ft.toString(16));\r\n      }\r\n      var /*filedate = new Date(),*/ nrow = 0, fpos = 0;\r\n      if(ft == 0x02) nrow = d.read_shift(2);\r\n      /*filedate = new Date(d.read_shift(1) + 1900, d.read_shift(1) - 1, d.read_shift(1));*/d.l += 3;\r\n      if(ft != 0x02) nrow = d.read_shift(4);\r\n      if(ft != 0x02) fpos = d.read_shift(2);\r\n      var rlen = d.read_shift(2);\r\n\r\n      var /*flags = 0,*/ current_cp = 1252;\r\n      if(ft != 0x02) {\r\n        d.l+=16;\r\n        /*flags = */d.read_shift(1);\r\n        //if(memo && ((flags & 0x02) === 0)) throw new Error(\"DBF Flags \" + flags.toString(16) + \" ft \" + ft.toString(16));\r\n\r\n        /* codepage present in FoxPro */\r\n        if(d[d.l] !== 0) current_cp = dbf_codepage_map[d[d.l]];\r\n        d.l+=1;\r\n\r\n        d.l+=2;\r\n      }\r\n      if(l7) d.l += 36;\r\n      var fields = [], field = ({});\r\n      var hend = fpos - 10 - (vfp ? 264 : 0), ww = l7 ? 32 : 11;\r\n      while(ft == 0x02 ? d.l < d.length && d[d.l] != 0x0d: d.l < hend) {\r\n        field = ({});\r\n        field.name = cptable.utils.decode(current_cp, d.slice(d.l, d.l+ww)).replace(/[\\u0000\\r\\n].*$/g,\"\");\r\n        d.l += ww;\r\n        field.type = String.fromCharCode(d.read_shift(1));\r\n        if(ft != 0x02 && !l7) field.offset = d.read_shift(4);\r\n        field.len = d.read_shift(1);\r\n        if(ft == 0x02) field.offset = d.read_shift(2);\r\n        field.dec = d.read_shift(1);\r\n        if(field.name.length) fields.push(field);\r\n        if(ft != 0x02) d.l += l7 ? 13 : 14;\r\n        switch(field.type) {\r\n          case 'B': // VFP Double\r\n            if((!vfp || field.len != 8) && opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\r\n            break;\r\n          case 'G': // General\r\n          case 'P': // Picture\r\n            if(opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\r\n            break;\r\n          case 'C': // character\r\n          case 'D': // date\r\n          case 'F': // floating point\r\n          case 'I': // long\r\n          case 'L': // boolean\r\n          case 'M': // memo\r\n          case 'N': // number\r\n          case 'O': // double\r\n          case 'T': // datetime\r\n          case 'Y': // currency\r\n          case '0': // VFP _NullFlags\r\n          case '@': // timestamp\r\n          case '+': // autoincrement\r\n            break;\r\n          default: throw new Error('Unknown Field Type: ' + field.type);\r\n        }\r\n      }\r\n      if(d[d.l] !== 0x0D) d.l = fpos-1;\r\n      else if(ft == 0x02) d.l = 0x209;\r\n      if(ft != 0x02) {\r\n        if(d.read_shift(1) !== 0x0D) throw new Error(\"DBF Terminator not found \" + d.l + \" \" + d[d.l]);\r\n        d.l = fpos;\r\n      }\r\n      /* data */\r\n      var R = 0, C = 0;\r\n      out[0] = [];\r\n      for(C = 0; C != fields.length; ++C) out[0][C] = fields[C].name;\r\n      while(nrow-- > 0) {\r\n        if(d[d.l] === 0x2A) { d.l+=rlen; continue; }\r\n        ++d.l;\r\n        out[++R] = []; C = 0;\r\n        for(C = 0; C != fields.length; ++C) {\r\n          var dd = d.slice(d.l, d.l+fields[C].len); d.l+=fields[C].len;\r\n          prep_blob(dd, 0);\r\n          var s = cptable.utils.decode(current_cp, dd);\r\n          switch(fields[C].type) {\r\n            case 'C':\r\n              out[R][C] = cptable.utils.decode(current_cp, dd);\r\n              out[R][C] = out[R][C].trim();\r\n              break;\r\n            case 'D':\r\n              if(s.length === 8) out[R][C] = new Date(+s.slice(0,4), +s.slice(4,6)-1, +s.slice(6,8));\r\n              else out[R][C] = s;\r\n              break;\r\n            case 'F': out[R][C] = parseFloat(s.trim()); break;\r\n            case '+': case 'I': out[R][C] = l7 ? dd.read_shift(-4, 'i') ^ 0x80000000 : dd.read_shift(4, 'i'); break;\r\n            case 'L': switch(s.toUpperCase()) {\r\n              case 'Y': case 'T': out[R][C] = true; break;\r\n              case 'N': case 'F': out[R][C] = false; break;\r\n              case ' ': case '?': out[R][C] = false; break; /* NOTE: technically uninitialized */\r\n              default: throw new Error(\"DBF Unrecognized L:|\" + s + \"|\");\r\n            } break;\r\n            case 'M': /* TODO: handle memo files */\r\n              if(!memo) throw new Error(\"DBF Unexpected MEMO for type \" + ft.toString(16));\r\n              out[R][C] = \"##MEMO##\" + (l7 ? parseInt(s.trim(), 10): dd.read_shift(4));\r\n              break;\r\n            case 'N': out[R][C] = +s.replace(/\\u0000/g,\"\").trim(); break;\r\n            case '@': out[R][C] = new Date(dd.read_shift(-8, 'f') - 0x388317533400); break;\r\n            case 'T': out[R][C] = new Date((dd.read_shift(4) - 0x253D8C) * 0x5265C00 + dd.read_shift(4)); break;\r\n            case 'Y': out[R][C] = dd.read_shift(4,'i')/1e4; break;\r\n            case 'O': out[R][C] = -dd.read_shift(-8, 'f'); break;\r\n            case 'B': if(vfp && fields[C].len == 8) { out[R][C] = dd.read_shift(8,'f'); break; }\r\n            /* falls through */\r\n            case 'G': case 'P': dd.l += fields[C].len; break;\r\n            case '0':\r\n              if(fields[C].name === '_NullFlags') break;\r\n            /* falls through */\r\n            default: throw new Error(\"DBF Unsupported data type \" + fields[C].type);\r\n          }\r\n        }\r\n      }\r\n      if(ft != 0x02) if(d.l < d.length && d[d.l++] != 0x1A) throw new Error(\"DBF EOF Marker missing \" + (d.l-1) + \" of \" + d.length + \" \" + d[d.l-1].toString(16));\r\n      if(opts && opts.sheetRows) out = out.slice(0, opts.sheetRows);\r\n      return out;\r\n    }\r\n\r\n    function dbf_to_sheet(buf, opts) {\r\n      var o = opts || {};\r\n      if(!o.dateNF) o.dateNF = \"yyyymmdd\";\r\n      return aoa_to_sheet(dbf_to_aoa(buf, o), o);\r\n    }\r\n\r\n    function dbf_to_workbook(buf, opts) {\r\n      try { return sheet_to_workbook(dbf_to_sheet(buf, opts), opts); }\r\n      catch(e) { if(opts && opts.WTF) throw e; }\r\n      return ({SheetNames:[],Sheets:{}});\r\n    }\r\n\r\n    var _RLEN = { 'B': 8, 'C': 250, 'L': 1, 'D': 8, '?': 0, '': 0 };\r\n    function sheet_to_dbf(ws, opts) {\r\n      var o = opts || {};\r\n      if(o.type == \"string\") throw new Error(\"Cannot write DBF to JS string\");\r\n      var ba = buf_array();\r\n      var aoa = sheet_to_json(ws, {header:1, cellDates:true});\r\n      var headers = aoa[0], data = aoa.slice(1);\r\n      var i = 0, j = 0, hcnt = 0, rlen = 1;\r\n      for(i = 0; i < headers.length; ++i) {\r\n        if(i == null) continue;\r\n        ++hcnt;\r\n        if(typeof headers[i] === 'number') headers[i] = headers[i].toString(10);\r\n        if(typeof headers[i] !== 'string') throw new Error(\"DBF Invalid column name \" + headers[i] + \" |\" + (typeof headers[i]) + \"|\");\r\n        if(headers.indexOf(headers[i]) !== i) for(j=0; j<1024;++j)\r\n          if(headers.indexOf(headers[i] + \"_\" + j) == -1) { headers[i] += \"_\" + j; break; }\r\n      }\r\n      var range = safe_decode_range(ws['!ref']);\r\n      var coltypes = [];\r\n      for(i = 0; i <= range.e.c - range.s.c; ++i) {\r\n        var col = [];\r\n        for(j=0; j < data.length; ++j) {\r\n          if(data[j][i] != null) col.push(data[j][i]);\r\n        }\r\n        if(col.length == 0 || headers[i] == null) { coltypes[i] = '?'; continue; }\r\n        var guess = '', _guess = '';\r\n        for(j = 0; j < col.length; ++j) {\r\n          switch(typeof col[j]) {\r\n            /* TODO: check if L2 compat is desired */\r\n            case 'number': _guess = 'B'; break;\r\n            case 'string': _guess = 'C'; break;\r\n            case 'boolean': _guess = 'L'; break;\r\n            case 'object': _guess = col[j] instanceof Date ? 'D' : 'C'; break;\r\n            default: _guess = 'C';\r\n          }\r\n          guess = guess && guess != _guess ? 'C' : _guess;\r\n          if(guess == 'C') break;\r\n        }\r\n        rlen += _RLEN[guess] || 0;\r\n        coltypes[i] = guess;\r\n      }\r\n\r\n      var h = ba.next(32);\r\n      h.write_shift(4, 0x13021130);\r\n      h.write_shift(4, data.length);\r\n      h.write_shift(2, 296 + 32 * hcnt);\r\n      h.write_shift(2, rlen);\r\n      for(i=0; i < 4; ++i) h.write_shift(4, 0);\r\n      h.write_shift(4, 0x00000300); // TODO: CP\r\n\r\n      for(i = 0, j = 0; i < headers.length; ++i) {\r\n        if(headers[i] == null) continue;\r\n        var hf = ba.next(32);\r\n        var _f = (headers[i].slice(-10) + \"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\").slice(0, 11);\r\n        hf.write_shift(1, _f, \"sbcs\");\r\n        hf.write_shift(1, coltypes[i] == '?' ? 'C' : coltypes[i], \"sbcs\");\r\n        hf.write_shift(4, j);\r\n        hf.write_shift(1, _RLEN[coltypes[i]] || 0);\r\n        hf.write_shift(1, 0);\r\n        hf.write_shift(1, 0x02);\r\n        hf.write_shift(4, 0);\r\n        hf.write_shift(1, 0);\r\n        hf.write_shift(4, 0);\r\n        hf.write_shift(4, 0);\r\n        j += _RLEN[coltypes[i]] || 0;\r\n      }\r\n\r\n      var hb = ba.next(264);\r\n      hb.write_shift(4, 0x0000000D);\r\n      for(i=0; i < 65;++i) hb.write_shift(4, 0x00000000);\r\n      for(i=0; i < data.length; ++i) {\r\n        var rout = ba.next(rlen);\r\n        rout.write_shift(1, 0);\r\n        for(j=0; j<headers.length; ++j) {\r\n          if(headers[j] == null) continue;\r\n          switch(coltypes[j]) {\r\n            case 'L': rout.write_shift(1, data[i][j] == null ? 0x3F : data[i][j] ? 0x54 : 0x46); break;\r\n            case 'B': rout.write_shift(8, data[i][j]||0, 'f'); break;\r\n            case 'D':\r\n              if(!data[i][j]) rout.write_shift(8, \"00000000\", \"sbcs\");\r\n              else {\r\n                rout.write_shift(4, (\"0000\"+data[i][j].getFullYear()).slice(-4), \"sbcs\");\r\n                rout.write_shift(2, (\"00\"+(data[i][j].getMonth()+1)).slice(-2), \"sbcs\");\r\n                rout.write_shift(2, (\"00\"+data[i][j].getDate()).slice(-2), \"sbcs\");\r\n              } break;\r\n            case 'C':\r\n              var _s = String(data[i][j]||\"\");\r\n              rout.write_shift(1, _s, \"sbcs\");\r\n              for(hcnt=0; hcnt < 250-_s.length; ++hcnt) rout.write_shift(1, 0x20); break;\r\n          }\r\n        }\r\n        // data\r\n      }\r\n      ba.next(1).write_shift(1, 0x1A);\r\n      return ba.end();\r\n    }\r\n    return {\r\n      to_workbook: dbf_to_workbook,\r\n      to_sheet: dbf_to_sheet,\r\n      from_sheet: sheet_to_dbf\r\n    };\r\n  })();\r\n\r\n  var SYLK = (function() {\r\n    /* TODO: find an actual specification */\r\n    function sylk_to_aoa(d, opts) {\r\n      switch(opts.type) {\r\n        case 'base64': return sylk_to_aoa_str(Base64.decode(d), opts);\r\n        case 'binary': return sylk_to_aoa_str(d, opts);\r\n        case 'buffer': return sylk_to_aoa_str(d.toString('binary'), opts);\r\n        case 'array': return sylk_to_aoa_str(cc2str(d), opts);\r\n      }\r\n      throw new Error(\"Unrecognized type \" + opts.type);\r\n    }\r\n    function sylk_to_aoa_str(str, opts) {\r\n      var records = str.split(/[\\n\\r]+/), R = -1, C = -1, ri = 0, rj = 0, arr = [];\r\n      var formats = [];\r\n      var next_cell_format = null;\r\n      var sht = {}, rowinfo = [], colinfo = [], cw = [];\r\n      var Mval = 0, j;\r\n      for (; ri !== records.length; ++ri) {\r\n        Mval = 0;\r\n        var rstr=records[ri].trim();\r\n        var record=rstr.replace(/;;/g, \"\\u0001\").split(\";\").map(function(x) { return x.replace(/\\u0001/g, \";\"); });\r\n        var RT=record[0], val;\r\n        if(rstr.length > 0) switch(RT) {\r\n          case 'ID': break; /* header */\r\n          case 'E': break; /* EOF */\r\n          case 'B': break; /* dimensions */\r\n          case 'O': break; /* options? */\r\n          case 'P':\r\n            if(record[1].charAt(0) == 'P')\r\n              formats.push(rstr.slice(3).replace(/;;/g, \";\"));\r\n            break;\r\n          case 'C':\r\n            var C_seen_K = false, C_seen_X = false;\r\n            for(rj=1; rj<record.length; ++rj) switch(record[rj].charAt(0)) {\r\n              case 'X': C = parseInt(record[rj].slice(1))-1; C_seen_X = true; break;\r\n              case 'Y':\r\n                R = parseInt(record[rj].slice(1))-1; if(!C_seen_X) C = 0;\r\n                for(j = arr.length; j <= R; ++j) arr[j] = [];\r\n                break;\r\n              case 'K':\r\n                val = record[rj].slice(1);\r\n                if(val.charAt(0) === '\"') val = val.slice(1,val.length - 1);\r\n                else if(val === 'TRUE') val = true;\r\n                else if(val === 'FALSE') val = false;\r\n                else if(!isNaN(fuzzynum(val))) {\r\n                  val = fuzzynum(val);\r\n                  if(next_cell_format !== null && SSF.is_date(next_cell_format)) val = numdate(val);\r\n                } else if(!isNaN(fuzzydate(val).getDate())) {\r\n                  val = parseDate(val);\r\n                }\r\n                if(typeof cptable !== 'undefined' && typeof val == \"string\" && ((opts||{}).type != \"string\") && (opts||{}).codepage) val = cptable.utils.decode(opts.codepage, val);\r\n                C_seen_K = true;\r\n                break;\r\n              case 'E':\r\n                var formula = rc_to_a1(record[rj].slice(1), {r:R,c:C});\r\n                arr[R][C] = [arr[R][C], formula];\r\n                break;\r\n              default: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\r\n            }\r\n            if(C_seen_K) { arr[R][C] = val; next_cell_format = null; }\r\n            break;\r\n          case 'F':\r\n            var F_seen = 0;\r\n            for(rj=1; rj<record.length; ++rj) switch(record[rj].charAt(0)) {\r\n              case 'X': C = parseInt(record[rj].slice(1))-1; ++F_seen; break;\r\n              case 'Y':\r\n                R = parseInt(record[rj].slice(1))-1; /*C = 0;*/\r\n                for(j = arr.length; j <= R; ++j) arr[j] = [];\r\n                break;\r\n              case 'M': Mval = parseInt(record[rj].slice(1)) / 20; break;\r\n              case 'F': break; /* ??? */\r\n              case 'G': break; /* hide grid */\r\n              case 'P':\r\n                next_cell_format = formats[parseInt(record[rj].slice(1))];\r\n                break;\r\n              case 'S': break; /* cell style */\r\n              case 'D': break; /* column */\r\n              case 'N': break; /* font */\r\n              case 'W':\r\n                cw = record[rj].slice(1).split(\" \");\r\n                for(j = parseInt(cw[0], 10); j <= parseInt(cw[1], 10); ++j) {\r\n                  Mval = parseInt(cw[2], 10);\r\n                  colinfo[j-1] = Mval === 0 ? {hidden:true}: {wch:Mval}; process_col(colinfo[j-1]);\r\n                } break;\r\n              case 'C': /* default column format */\r\n                C = parseInt(record[rj].slice(1))-1;\r\n                if(!colinfo[C]) colinfo[C] = {};\r\n                break;\r\n              case 'R': /* row properties */\r\n                R = parseInt(record[rj].slice(1))-1;\r\n                if(!rowinfo[R]) rowinfo[R] = {};\r\n                if(Mval > 0) { rowinfo[R].hpt = Mval; rowinfo[R].hpx = pt2px(Mval); }\r\n                else if(Mval === 0) rowinfo[R].hidden = true;\r\n                break;\r\n              default: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\r\n            }\r\n            if(F_seen < 1) next_cell_format = null; break;\r\n          default: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\r\n        }\r\n      }\r\n      if(rowinfo.length > 0) sht['!rows'] = rowinfo;\r\n      if(colinfo.length > 0) sht['!cols'] = colinfo;\r\n      if(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\r\n      return [arr, sht];\r\n    }\r\n\r\n    function sylk_to_sheet(d, opts) {\r\n      var aoasht = sylk_to_aoa(d, opts);\r\n      var aoa = aoasht[0], ws = aoasht[1];\r\n      var o = aoa_to_sheet(aoa, opts);\r\n      keys(ws).forEach(function(k) { o[k] = ws[k]; });\r\n      return o;\r\n    }\r\n\r\n    function sylk_to_workbook(d, opts) { return sheet_to_workbook(sylk_to_sheet(d, opts), opts); }\r\n\r\n    function write_ws_cell_sylk(cell, ws, R, C) {\r\n      var o = \"C;Y\" + (R+1) + \";X\" + (C+1) + \";K\";\r\n      switch(cell.t) {\r\n        case 'n':\r\n          o += (cell.v||0);\r\n          if(cell.f && !cell.F) o += \";E\" + a1_to_rc(cell.f, {r:R, c:C}); break;\r\n        case 'b': o += cell.v ? \"TRUE\" : \"FALSE\"; break;\r\n        case 'e': o += cell.w || cell.v; break;\r\n        case 'd': o += '\"' + (cell.w || cell.v) + '\"'; break;\r\n        case 's': o += '\"' + cell.v.replace(/\"/g,\"\") + '\"'; break;\r\n      }\r\n      return o;\r\n    }\r\n\r\n    function write_ws_cols_sylk(out, cols) {\r\n      cols.forEach(function(col, i) {\r\n        var rec = \"F;W\" + (i+1) + \" \" + (i+1) + \" \";\r\n        if(col.hidden) rec += \"0\";\r\n        else {\r\n          if(typeof col.width == 'number') col.wpx = width2px(col.width);\r\n          if(typeof col.wpx == 'number') col.wch = px2char(col.wpx);\r\n          if(typeof col.wch == 'number') rec += Math.round(col.wch);\r\n        }\r\n        if(rec.charAt(rec.length - 1) != \" \") out.push(rec);\r\n      });\r\n    }\r\n\r\n    function write_ws_rows_sylk(out, rows) {\r\n      rows.forEach(function(row, i) {\r\n        var rec = \"F;\";\r\n        if(row.hidden) rec += \"M0;\";\r\n        else if(row.hpt) rec += \"M\" + 20 * row.hpt + \";\";\r\n        else if(row.hpx) rec += \"M\" + 20 * px2pt(row.hpx) + \";\";\r\n        if(rec.length > 2) out.push(rec + \"R\" + (i+1));\r\n      });\r\n    }\r\n\r\n    function sheet_to_sylk(ws, opts) {\r\n      var preamble = [\"ID;PWXL;N;E\"], o = [];\r\n      var r = safe_decode_range(ws['!ref']), cell;\r\n      var dense = Array.isArray(ws);\r\n      var RS = \"\\r\\n\";\r\n\r\n      preamble.push(\"P;PGeneral\");\r\n      preamble.push(\"F;P0;DG0G8;M255\");\r\n      if(ws['!cols']) write_ws_cols_sylk(preamble, ws['!cols']);\r\n      if(ws['!rows']) write_ws_rows_sylk(preamble, ws['!rows']);\r\n\r\n      preamble.push(\"B;Y\" + (r.e.r - r.s.r + 1) + \";X\" + (r.e.c - r.s.c + 1) + \";D\" + [r.s.c,r.s.r,r.e.c,r.e.r].join(\" \"));\r\n      for(var R = r.s.r; R <= r.e.r; ++R) {\r\n        for(var C = r.s.c; C <= r.e.c; ++C) {\r\n          var coord = encode_cell({r:R,c:C});\r\n          cell = dense ? (ws[R]||[])[C]: ws[coord];\r\n          if(!cell || (cell.v == null && (!cell.f || cell.F))) continue;\r\n          o.push(write_ws_cell_sylk(cell, ws, R, C, opts));\r\n        }\r\n      }\r\n      return preamble.join(RS) + RS + o.join(RS) + RS + \"E\" + RS;\r\n    }\r\n\r\n    return {\r\n      to_workbook: sylk_to_workbook,\r\n      to_sheet: sylk_to_sheet,\r\n      from_sheet: sheet_to_sylk\r\n    };\r\n  })();\r\n\r\n  var DIF = (function() {\r\n    function dif_to_aoa(d, opts) {\r\n      switch(opts.type) {\r\n        case 'base64': return dif_to_aoa_str(Base64.decode(d), opts);\r\n        case 'binary': return dif_to_aoa_str(d, opts);\r\n        case 'buffer': return dif_to_aoa_str(d.toString('binary'), opts);\r\n        case 'array': return dif_to_aoa_str(cc2str(d), opts);\r\n      }\r\n      throw new Error(\"Unrecognized type \" + opts.type);\r\n    }\r\n    function dif_to_aoa_str(str, opts) {\r\n      var records = str.split('\\n'), R = -1, C = -1, ri = 0, arr = [];\r\n      for (; ri !== records.length; ++ri) {\r\n        if (records[ri].trim() === 'BOT') { arr[++R] = []; C = 0; continue; }\r\n        if (R < 0) continue;\r\n        var metadata = records[ri].trim().split(\",\");\r\n        var type = metadata[0], value = metadata[1];\r\n        ++ri;\r\n        var data = records[ri].trim();\r\n        switch (+type) {\r\n          case -1:\r\n            if (data === 'BOT') { arr[++R] = []; C = 0; continue; }\r\n            else if (data !== 'EOD') throw new Error(\"Unrecognized DIF special command \" + data);\r\n            break;\r\n          case 0:\r\n            if(data === 'TRUE') arr[R][C] = true;\r\n            else if(data === 'FALSE') arr[R][C] = false;\r\n            else if(!isNaN(fuzzynum(value))) arr[R][C] = fuzzynum(value);\r\n            else if(!isNaN(fuzzydate(value).getDate())) arr[R][C] = parseDate(value);\r\n            else arr[R][C] = value;\r\n            ++C; break;\r\n          case 1:\r\n            data = data.slice(1,data.length-1);\r\n            arr[R][C++] = data !== '' ? data : null;\r\n            break;\r\n        }\r\n        if (data === 'EOD') break;\r\n      }\r\n      if(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\r\n      return arr;\r\n    }\r\n\r\n    function dif_to_sheet(str, opts) { return aoa_to_sheet(dif_to_aoa(str, opts), opts); }\r\n    function dif_to_workbook(str, opts) { return sheet_to_workbook(dif_to_sheet(str, opts), opts); }\r\n\r\n    var sheet_to_dif = (function() {\r\n      var push_field = function pf(o, topic, v, n, s) {\r\n        o.push(topic);\r\n        o.push(v + \",\" + n);\r\n        o.push('\"' + s.replace(/\"/g,'\"\"') + '\"');\r\n      };\r\n      var push_value = function po(o, type, v, s) {\r\n        o.push(type + \",\" + v);\r\n        o.push(type == 1 ? '\"' + s.replace(/\"/g,'\"\"') + '\"' : s);\r\n      };\r\n      return function sheet_to_dif(ws) {\r\n        var o = [];\r\n        var r = safe_decode_range(ws['!ref']), cell;\r\n        var dense = Array.isArray(ws);\r\n        push_field(o, \"TABLE\", 0, 1, \"sheetjs\");\r\n        push_field(o, \"VECTORS\", 0, r.e.r - r.s.r + 1,\"\");\r\n        push_field(o, \"TUPLES\", 0, r.e.c - r.s.c + 1,\"\");\r\n        push_field(o, \"DATA\", 0, 0,\"\");\r\n        for(var R = r.s.r; R <= r.e.r; ++R) {\r\n          push_value(o, -1, 0, \"BOT\");\r\n          for(var C = r.s.c; C <= r.e.c; ++C) {\r\n            var coord = encode_cell({r:R,c:C});\r\n            cell = dense ? (ws[R]||[])[C] : ws[coord];\r\n            if(!cell) { push_value(o, 1, 0, \"\"); continue;}\r\n            switch(cell.t) {\r\n              case 'n':\r\n                var val = DIF_XL ? cell.w : cell.v;\r\n                if(!val && cell.v != null) val = cell.v;\r\n                if(val == null) {\r\n                  if(DIF_XL && cell.f && !cell.F) push_value(o, 1, 0, \"=\" + cell.f);\r\n                  else push_value(o, 1, 0, \"\");\r\n                }\r\n                else push_value(o, 0, val, \"V\");\r\n                break;\r\n              case 'b':\r\n                push_value(o, 0, cell.v ? 1 : 0, cell.v ? \"TRUE\" : \"FALSE\");\r\n                break;\r\n              case 's':\r\n                push_value(o, 1, 0, (!DIF_XL || isNaN(cell.v)) ? cell.v : '=\"' + cell.v + '\"');\r\n                break;\r\n              case 'd':\r\n                if(!cell.w) cell.w = SSF.format(cell.z || SSF._table[14], datenum(parseDate(cell.v)));\r\n                if(DIF_XL) push_value(o, 0, cell.w, \"V\");\r\n                else push_value(o, 1, 0, cell.w);\r\n                break;\r\n              default: push_value(o, 1, 0, \"\");\r\n            }\r\n          }\r\n        }\r\n        push_value(o, -1, 0, \"EOD\");\r\n        var RS = \"\\r\\n\";\r\n        var oo = o.join(RS);\r\n        //while((oo.length & 0x7F) != 0) oo += \"\\0\";\r\n        return oo;\r\n      };\r\n    })();\r\n    return {\r\n      to_workbook: dif_to_workbook,\r\n      to_sheet: dif_to_sheet,\r\n      from_sheet: sheet_to_dif\r\n    };\r\n  })();\r\n\r\n  var ETH = (function() {\r\n    function decode(s) { return s.replace(/\\\\b/g,\"\\\\\").replace(/\\\\c/g,\":\").replace(/\\\\n/g,\"\\n\"); }\r\n    function encode(s) { return s.replace(/\\\\/g, \"\\\\b\").replace(/:/g, \"\\\\c\").replace(/\\n/g,\"\\\\n\"); }\r\n\r\n    function eth_to_aoa(str, opts) {\r\n      var records = str.split('\\n'), R = -1, C = -1, ri = 0, arr = [];\r\n      for (; ri !== records.length; ++ri) {\r\n        var record = records[ri].trim().split(\":\");\r\n        if(record[0] !== 'cell') continue;\r\n        var addr = decode_cell(record[1]);\r\n        if(arr.length <= addr.r) for(R = arr.length; R <= addr.r; ++R) if(!arr[R]) arr[R] = [];\r\n        R = addr.r; C = addr.c;\r\n        switch(record[2]) {\r\n          case 't': arr[R][C] = decode(record[3]); break;\r\n          case 'v': arr[R][C] = +record[3]; break;\r\n          case 'vtf': var _f = record[record.length - 1];\r\n          /* falls through */\r\n          case 'vtc':\r\n            switch(record[3]) {\r\n              case 'nl': arr[R][C] = +record[4] ? true : false; break;\r\n              default: arr[R][C] = +record[4]; break;\r\n            }\r\n            if(record[2] == 'vtf') arr[R][C] = [arr[R][C], _f];\r\n        }\r\n      }\r\n      if(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\r\n      return arr;\r\n    }\r\n\r\n    function eth_to_sheet(d, opts) { return aoa_to_sheet(eth_to_aoa(d, opts), opts); }\r\n    function eth_to_workbook(d, opts) { return sheet_to_workbook(eth_to_sheet(d, opts), opts); }\r\n\r\n    var header = [\r\n      \"socialcalc:version:1.5\",\r\n      \"MIME-Version: 1.0\",\r\n      \"Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave\"\r\n    ].join(\"\\n\");\r\n\r\n    var sep = [\r\n      \"--SocialCalcSpreadsheetControlSave\",\r\n      \"Content-type: text/plain; charset=UTF-8\"\r\n    ].join(\"\\n\") + \"\\n\";\r\n\r\n    /* TODO: the other parts */\r\n    var meta = [\r\n      \"# SocialCalc Spreadsheet Control Save\",\r\n      \"part:sheet\"\r\n    ].join(\"\\n\");\r\n\r\n    var end = \"--SocialCalcSpreadsheetControlSave--\";\r\n\r\n    function sheet_to_eth_data(ws) {\r\n      if(!ws || !ws['!ref']) return \"\";\r\n      var o = [], oo = [], cell, coord = \"\";\r\n      var r = decode_range(ws['!ref']);\r\n      var dense = Array.isArray(ws);\r\n      for(var R = r.s.r; R <= r.e.r; ++R) {\r\n        for(var C = r.s.c; C <= r.e.c; ++C) {\r\n          coord = encode_cell({r:R,c:C});\r\n          cell = dense ? (ws[R]||[])[C] : ws[coord];\r\n          if(!cell || cell.v == null || cell.t === 'z') continue;\r\n          oo = [\"cell\", coord, 't'];\r\n          switch(cell.t) {\r\n            case 's': case 'str': oo.push(encode(cell.v)); break;\r\n            case 'n':\r\n              if(!cell.f) { oo[2]='v'; oo[3]=cell.v; }\r\n              else { oo[2]='vtf'; oo[3]='n'; oo[4]=cell.v; oo[5]=encode(cell.f); }\r\n              break;\r\n            case 'b':\r\n              oo[2] = 'vt'+(cell.f?'f':'c'); oo[3]='nl'; oo[4]=cell.v?\"1\":\"0\";\r\n              oo[5] = encode(cell.f||(cell.v?'TRUE':'FALSE'));\r\n              break;\r\n            case 'd':\r\n              var t = datenum(parseDate(cell.v));\r\n              oo[2] = 'vtc'; oo[3] = 'nd'; oo[4] = \"\"+t;\r\n              oo[5] = cell.w || SSF.format(cell.z || SSF._table[14], t);\r\n              break;\r\n            case 'e': continue;\r\n          }\r\n          o.push(oo.join(\":\"));\r\n        }\r\n      }\r\n      o.push(\"sheet:c:\" + (r.e.c-r.s.c+1) + \":r:\" + (r.e.r-r.s.r+1) + \":tvf:1\");\r\n      o.push(\"valueformat:1:text-wiki\");\r\n      //o.push(\"copiedfrom:\" + ws['!ref']); // clipboard only\r\n      return o.join(\"\\n\");\r\n    }\r\n\r\n    function sheet_to_eth(ws) {\r\n      return [header, sep, meta, sep, sheet_to_eth_data(ws), end].join(\"\\n\");\r\n      // return [\"version:1.5\", sheet_to_eth_data(ws)].join(\"\\n\"); // clipboard form\r\n    }\r\n\r\n    return {\r\n      to_workbook: eth_to_workbook,\r\n      to_sheet: eth_to_sheet,\r\n      from_sheet: sheet_to_eth\r\n    };\r\n  })();\r\n\r\n  var PRN = (function() {\r\n    function set_text_arr(data, arr, R, C, o) {\r\n      if(o.raw) arr[R][C] = data;\r\n      else if(data === 'TRUE') arr[R][C] = true;\r\n      else if(data === 'FALSE') arr[R][C] = false;\r\n      else if(data === \"\"){/* empty */}\r\n      else if(!isNaN(fuzzynum(data))) arr[R][C] = fuzzynum(data);\r\n      else if(!isNaN(fuzzydate(data).getDate())) arr[R][C] = parseDate(data);\r\n      else arr[R][C] = data;\r\n    }\r\n\r\n    function prn_to_aoa_str(f, opts) {\r\n      var o = opts || {};\r\n      var arr = ([]);\r\n      if(!f || f.length === 0) return arr;\r\n      var lines = f.split(/[\\r\\n]/);\r\n      var L = lines.length - 1;\r\n      while(L >= 0 && lines[L].length === 0) --L;\r\n      var start = 10, idx = 0;\r\n      var R = 0;\r\n      for(; R <= L; ++R) {\r\n        idx = lines[R].indexOf(\" \");\r\n        if(idx == -1) idx = lines[R].length; else idx++;\r\n        start = Math.max(start, idx);\r\n      }\r\n      for(R = 0; R <= L; ++R) {\r\n        arr[R] = [];\r\n        /* TODO: confirm that widths are always 10 */\r\n        var C = 0;\r\n        set_text_arr(lines[R].slice(0, start).trim(), arr, R, C, o);\r\n        for(C = 1; C <= (lines[R].length - start)/10 + 1; ++C)\r\n          set_text_arr(lines[R].slice(start+(C-1)*10,start+C*10).trim(),arr,R,C,o);\r\n      }\r\n      if(o.sheetRows) arr = arr.slice(0, o.sheetRows);\r\n      return arr;\r\n    }\r\n\r\n    // List of accepted CSV separators\r\n    var guess_seps = {\r\n      0x2C: ',',\r\n      0x09: \"\\t\",\r\n      0x3B: ';'\r\n    };\r\n\r\n    // CSV separator weights to be used in case of equal numbers\r\n    var guess_sep_weights = {\r\n      0x2C: 3,\r\n      0x09: 2,\r\n      0x3B: 1\r\n    };\r\n\r\n    function guess_sep(str) {\r\n      var cnt = {}, instr = false, end = 0, cc = 0;\r\n      for(;end < str.length;++end) {\r\n        if((cc=str.charCodeAt(end)) == 0x22) instr = !instr;\r\n        else if(!instr && cc in guess_seps) cnt[cc] = (cnt[cc]||0)+1;\r\n      }\r\n\r\n      cc = [];\r\n      for(end in cnt) if ( cnt.hasOwnProperty(end) ) {\r\n        cc.push([ cnt[end], end ]);\r\n      }\r\n\r\n      if ( !cc.length ) {\r\n        cnt = guess_sep_weights;\r\n        for(end in cnt) if ( cnt.hasOwnProperty(end) ) {\r\n          cc.push([ cnt[end], end ]);\r\n        }\r\n      }\r\n\r\n      cc.sort(function(a, b) { return a[0] - b[0] || guess_sep_weights[a[1]] - guess_sep_weights[b[1]]; });\r\n\r\n      return guess_seps[cc.pop()[1]];\r\n    }\r\n\r\n    function dsv_to_sheet_str(str, opts) {\r\n      var o = opts || {};\r\n      var sep = \"\";\r\n      if(DENSE != null && o.dense == null) o.dense = DENSE;\r\n      var ws = o.dense ? ([]) : ({});\r\n      var range = ({s: {c:0, r:0}, e: {c:0, r:0}});\r\n\r\n      if(str.slice(0,4) == \"sep=\" && str.charCodeAt(5) == 10) { sep = str.charAt(4); str = str.slice(6); }\r\n      else sep = guess_sep(str.slice(0,1024));\r\n      var R = 0, C = 0, v = 0;\r\n      var start = 0, end = 0, sepcc = sep.charCodeAt(0), instr = false, cc=0;\r\n      str = str.replace(/\\r\\n/mg, \"\\n\");\r\n      var _re = o.dateNF != null ? dateNF_regex(o.dateNF) : null;\r\n      function finish_cell() {\r\n        var s = str.slice(start, end);\r\n        var cell = ({});\r\n        if(s.charAt(0) == '\"' && s.charAt(s.length - 1) == '\"') s = s.slice(1,-1).replace(/\"\"/g,'\"');\r\n        if(s.length === 0) cell.t = 'z';\r\n        else if(o.raw) { cell.t = 's'; cell.v = s; }\r\n        else if(s.trim().length === 0) { cell.t = 's'; cell.v = s; }\r\n        else if(s.charCodeAt(0) == 0x3D) {\r\n          if(s.charCodeAt(1) == 0x22 && s.charCodeAt(s.length - 1) == 0x22) { cell.t = 's'; cell.v = s.slice(2,-1).replace(/\"\"/g,'\"'); }\r\n          else if(fuzzyfmla(s)) { cell.t = 'n'; cell.f = s.slice(1); }\r\n          else { cell.t = 's'; cell.v = s; } }\r\n        else if(s == \"TRUE\") { cell.t = 'b'; cell.v = true; }\r\n        else if(s == \"FALSE\") { cell.t = 'b'; cell.v = false; }\r\n        else if(!isNaN(v = fuzzynum(s))) { cell.t = 'n'; if(o.cellText !== false) cell.w = s; cell.v = v; }\r\n        else if(!isNaN(fuzzydate(s).getDate()) || _re && s.match(_re)) {\r\n          cell.z = o.dateNF || SSF._table[14];\r\n          var k = 0;\r\n          if(_re && s.match(_re)){ s=dateNF_fix(s, o.dateNF, (s.match(_re)||[])); k=1; }\r\n          if(o.cellDates) { cell.t = 'd'; cell.v = parseDate(s, k); }\r\n          else { cell.t = 'n'; cell.v = datenum(parseDate(s, k)); }\r\n          if(o.cellText !== false) cell.w = SSF.format(cell.z, cell.v instanceof Date ? datenum(cell.v):cell.v);\r\n          if(!o.cellNF) delete cell.z;\r\n        } else {\r\n          cell.t = 's';\r\n          cell.v = s;\r\n        }\r\n        if(cell.t == 'z'){}\r\n        else if(o.dense) { if(!ws[R]) ws[R] = []; ws[R][C] = cell; }\r\n        else ws[encode_cell({c:C,r:R})] = cell;\r\n        start = end+1;\r\n        if(range.e.c < C) range.e.c = C;\r\n        if(range.e.r < R) range.e.r = R;\r\n        if(cc == sepcc) ++C; else { C = 0; ++R; if(o.sheetRows && o.sheetRows <= R) return true; }\r\n      }\r\n      outer: for(;end < str.length;++end) switch((cc=str.charCodeAt(end))) {\r\n        case 0x22: instr = !instr; break;\r\n        case sepcc: case 0x0a: case 0x0d: if(!instr && finish_cell()) break outer; break;\r\n        default: break;\r\n      }\r\n      if(end - start > 0) finish_cell();\r\n\r\n      ws['!ref'] = encode_range(range);\r\n      return ws;\r\n    }\r\n\r\n    function prn_to_sheet_str(str, opts) {\r\n      if(str.slice(0,4) == \"sep=\") return dsv_to_sheet_str(str, opts);\r\n      if(str.indexOf(\"\\t\") >= 0 || str.indexOf(\",\") >= 0 || str.indexOf(\";\") >= 0) return dsv_to_sheet_str(str, opts);\r\n      return aoa_to_sheet(prn_to_aoa_str(str, opts), opts);\r\n    }\r\n\r\n    function prn_to_sheet(d, opts) {\r\n      var str = \"\", bytes = opts.type == 'string' ? [0,0,0,0] : firstbyte(d, opts);\r\n      switch(opts.type) {\r\n        case 'base64': str = Base64.decode(d); break;\r\n        case 'binary': str = d; break;\r\n        case 'buffer':\r\n          if(opts.codepage == 65001) str = d.toString('utf8');\r\n          else if(opts.codepage && typeof cptable !== 'undefined') str = cptable.utils.decode(opts.codepage, d);\r\n          else str = d.toString('binary');\r\n          break;\r\n        case 'array': str = cc2str(d); break;\r\n        case 'string': str = d; break;\r\n        default: throw new Error(\"Unrecognized type \" + opts.type);\r\n      }\r\n      if(bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str.slice(3));\r\n      else if((opts.type == 'binary') && typeof cptable !== 'undefined' && opts.codepage)  str = cptable.utils.decode(opts.codepage, cptable.utils.encode(1252,str));\r\n      if(str.slice(0,19) == \"socialcalc:version:\") return ETH.to_sheet(opts.type == 'string' ? str : utf8read(str), opts);\r\n      return prn_to_sheet_str(str, opts);\r\n    }\r\n\r\n    function prn_to_workbook(d, opts) { return sheet_to_workbook(prn_to_sheet(d, opts), opts); }\r\n\r\n    function sheet_to_prn(ws) {\r\n      var o = [];\r\n      var r = safe_decode_range(ws['!ref']), cell;\r\n      var dense = Array.isArray(ws);\r\n      for(var R = r.s.r; R <= r.e.r; ++R) {\r\n        var oo = [];\r\n        for(var C = r.s.c; C <= r.e.c; ++C) {\r\n          var coord = encode_cell({r:R,c:C});\r\n          cell = dense ? (ws[R]||[])[C] : ws[coord];\r\n          if(!cell || cell.v == null) { oo.push(\"          \"); continue; }\r\n          var w = (cell.w || (format_cell(cell), cell.w) || \"\").slice(0,10);\r\n          while(w.length < 10) w += \" \";\r\n          oo.push(w + (C === 0 ? \" \" : \"\"));\r\n        }\r\n        o.push(oo.join(\"\"));\r\n      }\r\n      return o.join(\"\\n\");\r\n    }\r\n\r\n    return {\r\n      to_workbook: prn_to_workbook,\r\n      to_sheet: prn_to_sheet,\r\n      from_sheet: sheet_to_prn\r\n    };\r\n  })();\r\n\r\n  /* Excel defaults to SYLK but warns if data is not valid */\r\n  function read_wb_ID(d, opts) {\r\n    var o = opts || {}, OLD_WTF = !!o.WTF; o.WTF = true;\r\n    try {\r\n      var out = SYLK.to_workbook(d, o);\r\n      o.WTF = OLD_WTF;\r\n      return out;\r\n    } catch(e) {\r\n      o.WTF = OLD_WTF;\r\n      if(!e.message.match(/SYLK bad record ID/) && OLD_WTF) throw e;\r\n      return PRN.to_workbook(d, opts);\r\n    }\r\n  }\r\n  var WK_ = (function() {\r\n    function lotushopper(data, cb, opts) {\r\n      if(!data) return;\r\n      prep_blob(data, data.l || 0);\r\n      var Enum = opts.Enum || WK1Enum;\r\n      while(data.l < data.length) {\r\n        var RT = data.read_shift(2);\r\n        var R = Enum[RT] || Enum[0xFF];\r\n        var length = data.read_shift(2);\r\n        var tgt = data.l + length;\r\n        var d = (R.f||parsenoop)(data, length, opts);\r\n        data.l = tgt;\r\n        if(cb(d, R.n, RT)) return;\r\n      }\r\n    }\r\n\r\n    function lotus_to_workbook(d, opts) {\r\n      switch(opts.type) {\r\n        case 'base64': return lotus_to_workbook_buf(s2a(Base64.decode(d)), opts);\r\n        case 'binary': return lotus_to_workbook_buf(s2a(d), opts);\r\n        case 'buffer':\r\n        case 'array': return lotus_to_workbook_buf(d, opts);\r\n      }\r\n      throw \"Unsupported type \" + opts.type;\r\n    }\r\n\r\n    function lotus_to_workbook_buf(d, opts) {\r\n      if(!d) return d;\r\n      var o = opts || {};\r\n      if(DENSE != null && o.dense == null) o.dense = DENSE;\r\n      var s = ((o.dense ? [] : {})), n = \"Sheet1\", sidx = 0;\r\n      var sheets = {}, snames = [n];\r\n\r\n      var refguess = {s: {r:0, c:0}, e: {r:0, c:0} };\r\n      var sheetRows = o.sheetRows || 0;\r\n\r\n      if(d[2] == 0x02) o.Enum = WK1Enum;\r\n      else if(d[2] == 0x1a) o.Enum = WK3Enum;\r\n      else if(d[2] == 0x0e) { o.Enum = WK3Enum; o.qpro = true; d.l = 0; }\r\n      else throw new Error(\"Unrecognized LOTUS BOF \" + d[2]);\r\n      lotushopper(d, function(val, Rn, RT) {\r\n        if(d[2] == 0x02) switch(RT) {\r\n          case 0x00:\r\n            o.vers = val;\r\n            if(val >= 0x1000) o.qpro = true;\r\n            break;\r\n          case 0x06: refguess = val; break; /* RANGE */\r\n          case 0x0F: /* LABEL */\r\n            if(!o.qpro) val[1].v = val[1].v.slice(1);\r\n          /* falls through */\r\n          case 0x0D: /* INTEGER */\r\n          case 0x0E: /* NUMBER */\r\n          case 0x10: /* FORMULA */\r\n          case 0x33: /* STRING */\r\n            /* TODO: actual translation of the format code */\r\n            if(RT == 0x0E && (val[2] & 0x70) == 0x70 && (val[2] & 0x0F) > 1 && (val[2] & 0x0F) < 15) {\r\n              val[1].z = o.dateNF || SSF._table[14];\r\n              if(o.cellDates) { val[1].t = 'd'; val[1].v = numdate(val[1].v); }\r\n            }\r\n            if(o.dense) {\r\n              if(!s[val[0].r]) s[val[0].r] = [];\r\n              s[val[0].r][val[0].c] = val[1];\r\n            } else s[encode_cell(val[0])] = val[1];\r\n            break;\r\n        } else switch(RT) {\r\n          case 0x16: /* LABEL16 */\r\n            val[1].v = val[1].v.slice(1);\r\n          /* falls through */\r\n          case 0x17: /* NUMBER17 */\r\n          case 0x18: /* NUMBER18 */\r\n          case 0x19: /* FORMULA19 */\r\n          case 0x25: /* NUMBER25 */\r\n          case 0x27: /* NUMBER27 */\r\n          case 0x28: /* FORMULA28 */\r\n            if(val[3] > sidx) {\r\n              s[\"!ref\"] = encode_range(refguess);\r\n              sheets[n] = s;\r\n              s = (o.dense ? [] : {});\r\n              refguess = {s: {r:0, c:0}, e: {r:0, c:0} };\r\n              sidx = val[3]; n = \"Sheet\" + (sidx + 1);\r\n              snames.push(n);\r\n            }\r\n            if(sheetRows > 0 && val[0].r >= sheetRows) break;\r\n            if(o.dense) {\r\n              if(!s[val[0].r]) s[val[0].r] = [];\r\n              s[val[0].r][val[0].c] = val[1];\r\n            } else s[encode_cell(val[0])] = val[1];\r\n            if(refguess.e.c < val[0].c) refguess.e.c = val[0].c;\r\n            if(refguess.e.r < val[0].r) refguess.e.r = val[0].r;\r\n            break;\r\n          default: break;\r\n        }\r\n      }, o);\r\n\r\n      s[\"!ref\"] = encode_range(refguess);\r\n      sheets[n] = s;\r\n      return { SheetNames: snames, Sheets:sheets };\r\n    }\r\n\r\n    function parse_RANGE(blob) {\r\n      var o = {s:{c:0,r:0},e:{c:0,r:0}};\r\n      o.s.c = blob.read_shift(2);\r\n      o.s.r = blob.read_shift(2);\r\n      o.e.c = blob.read_shift(2);\r\n      o.e.r = blob.read_shift(2);\r\n      if(o.s.c == 0xFFFF) o.s.c = o.e.c = o.s.r = o.e.r = 0;\r\n      return o;\r\n    }\r\n\r\n    function parse_cell(blob, length, opts) {\r\n      var o = [{c:0,r:0}, {t:'n',v:0}, 0];\r\n      if(opts.qpro && opts.vers != 0x5120) {\r\n        o[0].c = blob.read_shift(1);\r\n        blob.l++;\r\n        o[0].r = blob.read_shift(2);\r\n        blob.l+=2;\r\n      } else {\r\n        o[2] = blob.read_shift(1);\r\n        o[0].c = blob.read_shift(2); o[0].r = blob.read_shift(2);\r\n      }\r\n      return o;\r\n    }\r\n\r\n    function parse_LABEL(blob, length, opts) {\r\n      var tgt = blob.l + length;\r\n      var o = parse_cell(blob, length, opts);\r\n      o[1].t = 's';\r\n      if(opts.vers == 0x5120) {\r\n        blob.l++;\r\n        var len = blob.read_shift(1);\r\n        o[1].v = blob.read_shift(len, 'utf8');\r\n        return o;\r\n      }\r\n      if(opts.qpro) blob.l++;\r\n      o[1].v = blob.read_shift(tgt - blob.l, 'cstr');\r\n      return o;\r\n    }\r\n\r\n    function parse_INTEGER(blob, length, opts) {\r\n      var o = parse_cell(blob, length, opts);\r\n      o[1].v = blob.read_shift(2, 'i');\r\n      return o;\r\n    }\r\n\r\n    function parse_NUMBER(blob, length, opts) {\r\n      var o = parse_cell(blob, length, opts);\r\n      o[1].v = blob.read_shift(8, 'f');\r\n      return o;\r\n    }\r\n\r\n    function parse_FORMULA(blob, length, opts) {\r\n      var tgt = blob.l + length;\r\n      var o = parse_cell(blob, length, opts);\r\n      /* TODO: formula */\r\n      o[1].v = blob.read_shift(8, 'f');\r\n      if(opts.qpro) blob.l = tgt;\r\n      else {\r\n        var flen = blob.read_shift(2);\r\n        blob.l += flen;\r\n      }\r\n      return o;\r\n    }\r\n\r\n    function parse_cell_3(blob) {\r\n      var o = [{c:0,r:0}, {t:'n',v:0}, 0];\r\n      o[0].r = blob.read_shift(2); o[3] = blob[blob.l++]; o[0].c = blob[blob.l++];\r\n      return o;\r\n    }\r\n\r\n    function parse_LABEL_16(blob, length) {\r\n      var o = parse_cell_3(blob, length);\r\n      o[1].t = 's';\r\n      o[1].v = blob.read_shift(length - 4, 'cstr');\r\n      return o;\r\n    }\r\n\r\n    function parse_NUMBER_18(blob, length) {\r\n      var o = parse_cell_3(blob, length);\r\n      o[1].v = blob.read_shift(2);\r\n      var v = o[1].v >> 1;\r\n      /* TODO: figure out all of the corner cases */\r\n      if(o[1].v & 0x1) {\r\n        switch(v & 0x07) {\r\n          case 1: v = (v >> 3) * 500; break;\r\n          case 2: v = (v >> 3) / 20; break;\r\n          case 4: v = (v >> 3) / 2000; break;\r\n          case 6: v = (v >> 3) / 16; break;\r\n          case 7: v = (v >> 3) / 64; break;\r\n          default: throw \"unknown NUMBER_18 encoding \" + (v & 0x07);\r\n        }\r\n      }\r\n      o[1].v = v;\r\n      return o;\r\n    }\r\n\r\n    function parse_NUMBER_17(blob, length) {\r\n      var o = parse_cell_3(blob, length);\r\n      var v1 = blob.read_shift(4);\r\n      var v2 = blob.read_shift(4);\r\n      var e = blob.read_shift(2);\r\n      if(e == 0xFFFF) { o[1].v = 0; return o; }\r\n      var s = e & 0x8000; e = (e&0x7FFF) - 16446;\r\n      o[1].v = (s*2 - 1) * ((e > 0 ? (v2 << e) : (v2 >>> -e)) + (e > -32 ? (v1 << (e + 32)) : (v1 >>> -(e + 32))));\r\n      return o;\r\n    }\r\n\r\n    function parse_FORMULA_19(blob, length) {\r\n      var o = parse_NUMBER_17(blob, 14);\r\n      blob.l += length - 14; /* TODO: formula */\r\n      return o;\r\n    }\r\n\r\n    function parse_NUMBER_25(blob, length) {\r\n      var o = parse_cell_3(blob, length);\r\n      var v1 = blob.read_shift(4);\r\n      o[1].v = v1 >> 6;\r\n      return o;\r\n    }\r\n\r\n    function parse_NUMBER_27(blob, length) {\r\n      var o = parse_cell_3(blob, length);\r\n      var v1 = blob.read_shift(8,'f');\r\n      o[1].v = v1;\r\n      return o;\r\n    }\r\n\r\n    function parse_FORMULA_28(blob, length) {\r\n      var o = parse_NUMBER_27(blob, 14);\r\n      blob.l += length - 10; /* TODO: formula */\r\n      return o;\r\n    }\r\n\r\n    var WK1Enum = {\r\n      0x0000: { n:\"BOF\", f:parseuint16 },\r\n      0x0001: { n:\"EOF\" },\r\n      0x0002: { n:\"CALCMODE\" },\r\n      0x0003: { n:\"CALCORDER\" },\r\n      0x0004: { n:\"SPLIT\" },\r\n      0x0005: { n:\"SYNC\" },\r\n      0x0006: { n:\"RANGE\", f:parse_RANGE },\r\n      0x0007: { n:\"WINDOW1\" },\r\n      0x0008: { n:\"COLW1\" },\r\n      0x0009: { n:\"WINTWO\" },\r\n      0x000A: { n:\"COLW2\" },\r\n      0x000B: { n:\"NAME\" },\r\n      0x000C: { n:\"BLANK\" },\r\n      0x000D: { n:\"INTEGER\", f:parse_INTEGER },\r\n      0x000E: { n:\"NUMBER\", f:parse_NUMBER },\r\n      0x000F: { n:\"LABEL\", f:parse_LABEL },\r\n      0x0010: { n:\"FORMULA\", f:parse_FORMULA },\r\n      0x0018: { n:\"TABLE\" },\r\n      0x0019: { n:\"ORANGE\" },\r\n      0x001A: { n:\"PRANGE\" },\r\n      0x001B: { n:\"SRANGE\" },\r\n      0x001C: { n:\"FRANGE\" },\r\n      0x001D: { n:\"KRANGE1\" },\r\n      0x0020: { n:\"HRANGE\" },\r\n      0x0023: { n:\"KRANGE2\" },\r\n      0x0024: { n:\"PROTEC\" },\r\n      0x0025: { n:\"FOOTER\" },\r\n      0x0026: { n:\"HEADER\" },\r\n      0x0027: { n:\"SETUP\" },\r\n      0x0028: { n:\"MARGINS\" },\r\n      0x0029: { n:\"LABELFMT\" },\r\n      0x002A: { n:\"TITLES\" },\r\n      0x002B: { n:\"SHEETJS\" },\r\n      0x002D: { n:\"GRAPH\" },\r\n      0x002E: { n:\"NGRAPH\" },\r\n      0x002F: { n:\"CALCCOUNT\" },\r\n      0x0030: { n:\"UNFORMATTED\" },\r\n      0x0031: { n:\"CURSORW12\" },\r\n      0x0032: { n:\"WINDOW\" },\r\n      0x0033: { n:\"STRING\", f:parse_LABEL },\r\n      0x0037: { n:\"PASSWORD\" },\r\n      0x0038: { n:\"LOCKED\" },\r\n      0x003C: { n:\"QUERY\" },\r\n      0x003D: { n:\"QUERYNAME\" },\r\n      0x003E: { n:\"PRINT\" },\r\n      0x003F: { n:\"PRINTNAME\" },\r\n      0x0040: { n:\"GRAPH2\" },\r\n      0x0041: { n:\"GRAPHNAME\" },\r\n      0x0042: { n:\"ZOOM\" },\r\n      0x0043: { n:\"SYMSPLIT\" },\r\n      0x0044: { n:\"NSROWS\" },\r\n      0x0045: { n:\"NSCOLS\" },\r\n      0x0046: { n:\"RULER\" },\r\n      0x0047: { n:\"NNAME\" },\r\n      0x0048: { n:\"ACOMM\" },\r\n      0x0049: { n:\"AMACRO\" },\r\n      0x004A: { n:\"PARSE\" },\r\n      0x00FF: { n:\"\", f:parsenoop }\r\n    };\r\n\r\n    var WK3Enum = {\r\n      0x0000: { n:\"BOF\" },\r\n      0x0001: { n:\"EOF\" },\r\n      0x0003: { n:\"??\" },\r\n      0x0004: { n:\"??\" },\r\n      0x0005: { n:\"??\" },\r\n      0x0006: { n:\"??\" },\r\n      0x0007: { n:\"??\" },\r\n      0x0009: { n:\"??\" },\r\n      0x000a: { n:\"??\" },\r\n      0x000b: { n:\"??\" },\r\n      0x000c: { n:\"??\" },\r\n      0x000e: { n:\"??\" },\r\n      0x000f: { n:\"??\" },\r\n      0x0010: { n:\"??\" },\r\n      0x0011: { n:\"??\" },\r\n      0x0012: { n:\"??\" },\r\n      0x0013: { n:\"??\" },\r\n      0x0015: { n:\"??\" },\r\n      0x0016: { n:\"LABEL16\", f:parse_LABEL_16},\r\n      0x0017: { n:\"NUMBER17\", f:parse_NUMBER_17 },\r\n      0x0018: { n:\"NUMBER18\", f:parse_NUMBER_18 },\r\n      0x0019: { n:\"FORMULA19\", f:parse_FORMULA_19},\r\n      0x001a: { n:\"??\" },\r\n      0x001b: { n:\"??\" },\r\n      0x001c: { n:\"??\" },\r\n      0x001d: { n:\"??\" },\r\n      0x001e: { n:\"??\" },\r\n      0x001f: { n:\"??\" },\r\n      0x0021: { n:\"??\" },\r\n      0x0025: { n:\"NUMBER25\", f:parse_NUMBER_25 },\r\n      0x0027: { n:\"NUMBER27\", f:parse_NUMBER_27 },\r\n      0x0028: { n:\"FORMULA28\", f:parse_FORMULA_28 },\r\n      0x00FF: { n:\"\", f:parsenoop }\r\n    };\r\n    return {\r\n      to_workbook: lotus_to_workbook\r\n    };\r\n  })();\r\n  /* Parse a list of <r> tags */\r\n  var parse_rs = (function parse_rs_factory() {\r\n    var tregex = matchtag(\"t\"), rpregex = matchtag(\"rPr\"), rregex = /<(?:\\w+:)?r>/g, rend = /<\\/(?:\\w+:)?r>/, nlregex = /\\r\\n/g;\r\n    /* 18.4.7 rPr CT_RPrElt */\r\n    var parse_rpr = function parse_rpr(rpr, intro, outro) {\r\n      var font = {}, cp = 65001, align = \"\";\r\n      var pass = false;\r\n      var m = rpr.match(tagregex), i = 0;\r\n      if(m) for(;i!=m.length; ++i) {\r\n        var y = parsexmltag(m[i]);\r\n        switch(y[0].replace(/\\w*:/g,\"\")) {\r\n          /* 18.8.12 condense CT_BooleanProperty */\r\n          /* ** not required . */\r\n          case '<condense': break;\r\n          /* 18.8.17 extend CT_BooleanProperty */\r\n          /* ** not required . */\r\n          case '<extend': break;\r\n          /* 18.8.36 shadow CT_BooleanProperty */\r\n          /* ** not required . */\r\n          case '<shadow':\r\n            if(!y.val) break;\r\n          /* falls through */\r\n          case '<shadow>':\r\n          case '<shadow/>': font.shadow = 1; break;\r\n          case '</shadow>': break;\r\n\r\n          /* 18.4.1 charset CT_IntProperty TODO */\r\n          case '<charset':\r\n            if(y.val == '1') break;\r\n            cp = CS2CP[parseInt(y.val, 10)];\r\n            break;\r\n\r\n          /* 18.4.2 outline CT_BooleanProperty TODO */\r\n          case '<outline':\r\n            if(!y.val) break;\r\n          /* falls through */\r\n          case '<outline>':\r\n          case '<outline/>': font.outline = 1; break;\r\n          case '</outline>': break;\r\n\r\n          /* 18.4.5 rFont CT_FontName */\r\n          case '<rFont': font.name = y.val; break;\r\n\r\n          /* 18.4.11 sz CT_FontSize */\r\n          case '<sz': font.sz = y.val; break;\r\n\r\n          /* 18.4.10 strike CT_BooleanProperty */\r\n          case '<strike':\r\n            if(!y.val) break;\r\n          /* falls through */\r\n          case '<strike>':\r\n          case '<strike/>': font.strike = 1; break;\r\n          case '</strike>': break;\r\n\r\n          /* 18.4.13 u CT_UnderlineProperty */\r\n          case '<u':\r\n            if(!y.val) break;\r\n            switch(y.val) {\r\n              case 'double': font.uval = \"double\"; break;\r\n              case 'singleAccounting': font.uval = \"single-accounting\"; break;\r\n              case 'doubleAccounting': font.uval = \"double-accounting\"; break;\r\n            }\r\n          /* falls through */\r\n          case '<u>':\r\n          case '<u/>': font.u = 1; break;\r\n          case '</u>': break;\r\n\r\n          /* 18.8.2 b */\r\n          case '<b':\r\n            if(y.val == '0') break;\r\n          /* falls through */\r\n          case '<b>':\r\n          case '<b/>': font.b = 1; break;\r\n          case '</b>': break;\r\n\r\n          /* 18.8.26 i */\r\n          case '<i':\r\n            if(y.val == '0') break;\r\n          /* falls through */\r\n          case '<i>':\r\n          case '<i/>': font.i = 1; break;\r\n          case '</i>': break;\r\n\r\n          /* 18.3.1.15 color CT_Color TODO: tint, theme, auto, indexed */\r\n          case '<color':\r\n            if(y.rgb) font.color = y.rgb.slice(2,8);\r\n            break;\r\n\r\n          /* 18.8.18 family ST_FontFamily */\r\n          case '<family': font.family = y.val; break;\r\n\r\n          /* 18.4.14 vertAlign CT_VerticalAlignFontProperty TODO */\r\n          case '<vertAlign': align = y.val; break;\r\n\r\n          /* 18.8.35 scheme CT_FontScheme TODO */\r\n          case '<scheme': break;\r\n\r\n          /* 18.2.10 extLst CT_ExtensionList ? */\r\n          case '<extLst': case '<extLst>': case '</extLst>': break;\r\n          case '<ext': pass = true; break;\r\n          case '</ext>': pass = false; break;\r\n          default:\r\n            if(y[0].charCodeAt(1) !== 47 && !pass) throw new Error('Unrecognized rich format ' + y[0]);\r\n        }\r\n      }\r\n      var style = [];\r\n\r\n      if(font.u) style.push(\"text-decoration: underline;\");\r\n      if(font.uval) style.push(\"text-underline-style:\" + font.uval + \";\");\r\n      if(font.sz) style.push(\"font-size:\" + font.sz + \"pt;\");\r\n      if(font.outline) style.push(\"text-effect: outline;\");\r\n      if(font.shadow) style.push(\"text-shadow: auto;\");\r\n      intro.push('<span style=\"' + style.join(\"\") + '\">');\r\n\r\n      if(font.b) { intro.push(\"<b>\"); outro.push(\"</b>\"); }\r\n      if(font.i) { intro.push(\"<i>\"); outro.push(\"</i>\"); }\r\n      if(font.strike) { intro.push(\"<s>\"); outro.push(\"</s>\"); }\r\n\r\n      if(align == \"superscript\") align = \"sup\";\r\n      else if(align == \"subscript\") align = \"sub\";\r\n      if(align != \"\") { intro.push(\"<\" + align + \">\"); outro.push(\"</\" + align + \">\"); }\r\n\r\n      outro.push(\"</span>\");\r\n      return cp;\r\n    };\r\n\r\n    /* 18.4.4 r CT_RElt */\r\n    function parse_r(r) {\r\n      var terms = [[],\"\",[]];\r\n      /* 18.4.12 t ST_Xstring */\r\n      var t = r.match(tregex)/*, cp = 65001*/;\r\n      if(!t) return \"\";\r\n      terms[1] = t[1];\r\n\r\n      var rpr = r.match(rpregex);\r\n      if(rpr) /*cp = */parse_rpr(rpr[1], terms[0], terms[2]);\r\n\r\n      return terms[0].join(\"\") + terms[1].replace(nlregex,'<br/>') + terms[2].join(\"\");\r\n    }\r\n    return function parse_rs(rs) {\r\n      return rs.replace(rregex,\"\").split(rend).map(parse_r).join(\"\");\r\n    };\r\n  })();\r\n\r\n  /* 18.4.8 si CT_Rst */\r\n  var sitregex = /<(?:\\w+:)?t[^>]*>([^<]*)<\\/(?:\\w+:)?t>/g, sirregex = /<(?:\\w+:)?r>/;\r\n  var sirphregex = /<(?:\\w+:)?rPh.*?>([\\s\\S]*?)<\\/(?:\\w+:)?rPh>/g;\r\n  function parse_si(x, opts) {\r\n    var html = opts ? opts.cellHTML : true;\r\n    var z = {};\r\n    if(!x) return null;\r\n    //var y;\r\n    /* 18.4.12 t ST_Xstring (Plaintext String) */\r\n    // TODO: is whitespace actually valid here?\r\n    if(x.match(/^\\s*<(?:\\w+:)?t[^>]*>/)) {\r\n      z.t = unescapexml(utf8read(x.slice(x.indexOf(\">\")+1).split(/<\\/(?:\\w+:)?t>/)[0]||\"\"));\r\n      z.r = utf8read(x);\r\n      if(html) z.h = escapehtml(z.t);\r\n    }\r\n    /* 18.4.4 r CT_RElt (Rich Text Run) */\r\n    else if((/*y = */x.match(sirregex))) {\r\n      z.r = utf8read(x);\r\n      z.t = unescapexml(utf8read((x.replace(sirphregex, '').match(sitregex)||[]).join(\"\").replace(tagregex,\"\")));\r\n      if(html) z.h = parse_rs(z.r);\r\n    }\r\n    /* 18.4.3 phoneticPr CT_PhoneticPr (TODO: needed for Asian support) */\r\n    /* 18.4.6 rPh CT_PhoneticRun (TODO: needed for Asian support) */\r\n    return z;\r\n  }\r\n\r\n  /* 18.4 Shared String Table */\r\n  var sstr0 = /<(?:\\w+:)?sst([^>]*)>([\\s\\S]*)<\\/(?:\\w+:)?sst>/;\r\n  var sstr1 = /<(?:\\w+:)?(?:si|sstItem)>/g;\r\n  var sstr2 = /<\\/(?:\\w+:)?(?:si|sstItem)>/;\r\n  function parse_sst_xml(data, opts) {\r\n    var s = ([]), ss = \"\";\r\n    if(!data) return s;\r\n    /* 18.4.9 sst CT_Sst */\r\n    var sst = data.match(sstr0);\r\n    if(sst) {\r\n      ss = sst[2].replace(sstr1,\"\").split(sstr2);\r\n      for(var i = 0; i != ss.length; ++i) {\r\n        var o = parse_si(ss[i].trim(), opts);\r\n        if(o != null) s[s.length] = o;\r\n      }\r\n      sst = parsexmltag(sst[1]); s.Count = sst.count; s.Unique = sst.uniqueCount;\r\n    }\r\n    return s;\r\n  }\r\n\r\n  RELS.SST = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\";\r\n  var straywsregex = /^\\s|\\s$|[\\t\\n\\r]/;\r\n  function write_sst_xml(sst, opts) {\r\n    if(!opts.bookSST) return \"\";\r\n    var o = [XML_HEADER];\r\n    o[o.length] = (writextag('sst', null, {\r\n      xmlns: XMLNS.main[0],\r\n      count: sst.Count,\r\n      uniqueCount: sst.Unique\r\n    }));\r\n    for(var i = 0; i != sst.length; ++i) { if(sst[i] == null) continue;\r\n      var s = sst[i];\r\n      var sitag = \"<si>\";\r\n      if(s.r) sitag += s.r;\r\n      else {\r\n        sitag += \"<t\";\r\n        if(!s.t) s.t = \"\";\r\n        if(s.t.match(straywsregex)) sitag += ' xml:space=\"preserve\"';\r\n        sitag += \">\" + escapexml(s.t) + \"</t>\";\r\n      }\r\n      sitag += \"</si>\";\r\n      o[o.length] = (sitag);\r\n    }\r\n    if(o.length>2){ o[o.length] = ('</sst>'); o[1]=o[1].replace(\"/>\",\">\"); }\r\n    return o.join(\"\");\r\n  }\r\n  /* [MS-XLSB] 2.4.221 BrtBeginSst */\r\n  function parse_BrtBeginSst(data) {\r\n    return [data.read_shift(4), data.read_shift(4)];\r\n  }\r\n\r\n  /* [MS-XLSB] 2.1.7.45 Shared Strings */\r\n  function parse_sst_bin(data, opts) {\r\n    var s = ([]);\r\n    var pass = false;\r\n    recordhopper(data, function hopper_sst(val, R_n, RT) {\r\n      switch(RT) {\r\n        case 0x009F: /* 'BrtBeginSst' */\r\n          s.Count = val[0]; s.Unique = val[1]; break;\r\n        case 0x0013: /* 'BrtSSTItem' */\r\n          s.push(val); break;\r\n        case 0x00A0: /* 'BrtEndSst' */\r\n          return true;\r\n\r\n        case 0x0023: /* 'BrtFRTBegin' */\r\n          pass = true; break;\r\n        case 0x0024: /* 'BrtFRTEnd' */\r\n          pass = false; break;\r\n\r\n        default:\r\n          if(R_n.indexOf(\"Begin\") > 0){/* empty */}\r\n          else if(R_n.indexOf(\"End\") > 0){/* empty */}\r\n          if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R_n);\r\n      }\r\n    });\r\n    return s;\r\n  }\r\n\r\n  function write_BrtBeginSst(sst, o) {\r\n    if(!o) o = new_buf(8);\r\n    o.write_shift(4, sst.Count);\r\n    o.write_shift(4, sst.Unique);\r\n    return o;\r\n  }\r\n\r\n  var write_BrtSSTItem = write_RichStr;\r\n\r\n  function write_sst_bin(sst) {\r\n    var ba = buf_array();\r\n    write_record(ba, \"BrtBeginSst\", write_BrtBeginSst(sst));\r\n    for(var i = 0; i < sst.length; ++i) write_record(ba, \"BrtSSTItem\", write_BrtSSTItem(sst[i]));\r\n    /* FRTSST */\r\n    write_record(ba, \"BrtEndSst\");\r\n    return ba.end();\r\n  }\r\n  function _JS2ANSI(str) {\r\n    if(typeof cptable !== 'undefined') return cptable.utils.encode(current_ansi, str);\r\n    var o = [], oo = str.split(\"\");\r\n    for(var i = 0; i < oo.length; ++i) o[i] = oo[i].charCodeAt(0);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-OFFCRYPTO] 2.1.4 Version */\r\n  function parse_CRYPTOVersion(blob, length) {\r\n    var o = {};\r\n    o.Major = blob.read_shift(2);\r\n    o.Minor = blob.read_shift(2);\r\n    if(length >= 4) blob.l += length - 4;\r\n    return o;\r\n  }\r\n\r\n  /* [MS-OFFCRYPTO] 2.1.5 DataSpaceVersionInfo */\r\n  function parse_DataSpaceVersionInfo(blob) {\r\n    var o = {};\r\n    o.id = blob.read_shift(0, 'lpp4');\r\n    o.R = parse_CRYPTOVersion(blob, 4);\r\n    o.U = parse_CRYPTOVersion(blob, 4);\r\n    o.W = parse_CRYPTOVersion(blob, 4);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-OFFCRYPTO] 2.1.6.1 DataSpaceMapEntry Structure */\r\n  function parse_DataSpaceMapEntry(blob) {\r\n    var len = blob.read_shift(4);\r\n    var end = blob.l + len - 4;\r\n    var o = {};\r\n    var cnt = blob.read_shift(4);\r\n    var comps = [];\r\n    /* [MS-OFFCRYPTO] 2.1.6.2 DataSpaceReferenceComponent Structure */\r\n    while(cnt-- > 0) comps.push({ t: blob.read_shift(4), v: blob.read_shift(0, 'lpp4') });\r\n    o.name = blob.read_shift(0, 'lpp4');\r\n    o.comps = comps;\r\n    if(blob.l != end) throw new Error(\"Bad DataSpaceMapEntry: \" + blob.l + \" != \" + end);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-OFFCRYPTO] 2.1.6 DataSpaceMap */\r\n  function parse_DataSpaceMap(blob) {\r\n    var o = [];\r\n    blob.l += 4; // must be 0x8\r\n    var cnt = blob.read_shift(4);\r\n    while(cnt-- > 0) o.push(parse_DataSpaceMapEntry(blob));\r\n    return o;\r\n  }\r\n\r\n  /* [MS-OFFCRYPTO] 2.1.7 DataSpaceDefinition */\r\n  function parse_DataSpaceDefinition(blob) {\r\n    var o = [];\r\n    blob.l += 4; // must be 0x8\r\n    var cnt = blob.read_shift(4);\r\n    while(cnt-- > 0) o.push(blob.read_shift(0, 'lpp4'));\r\n    return o;\r\n  }\r\n\r\n  /* [MS-OFFCRYPTO] 2.1.8 DataSpaceDefinition */\r\n  function parse_TransformInfoHeader(blob) {\r\n    var o = {};\r\n    /*var len = */blob.read_shift(4);\r\n    blob.l += 4; // must be 0x1\r\n    o.id = blob.read_shift(0, 'lpp4');\r\n    o.name = blob.read_shift(0, 'lpp4');\r\n    o.R = parse_CRYPTOVersion(blob, 4);\r\n    o.U = parse_CRYPTOVersion(blob, 4);\r\n    o.W = parse_CRYPTOVersion(blob, 4);\r\n    return o;\r\n  }\r\n\r\n  function parse_Primary(blob) {\r\n    /* [MS-OFFCRYPTO] 2.2.6 IRMDSTransformInfo */\r\n    var hdr = parse_TransformInfoHeader(blob);\r\n    /* [MS-OFFCRYPTO] 2.1.9 EncryptionTransformInfo */\r\n    hdr.ename = blob.read_shift(0, '8lpp4');\r\n    hdr.blksz = blob.read_shift(4);\r\n    hdr.cmode = blob.read_shift(4);\r\n    if(blob.read_shift(4) != 0x04) throw new Error(\"Bad !Primary record\");\r\n    return hdr;\r\n  }\r\n\r\n  /* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\r\n  function parse_EncryptionHeader(blob, length) {\r\n    var tgt = blob.l + length;\r\n    var o = {};\r\n    o.Flags = (blob.read_shift(4) & 0x3F);\r\n    blob.l += 4;\r\n    o.AlgID = blob.read_shift(4);\r\n    var valid = false;\r\n    switch(o.AlgID) {\r\n      case 0x660E: case 0x660F: case 0x6610: valid = (o.Flags == 0x24); break;\r\n      case 0x6801: valid = (o.Flags == 0x04); break;\r\n      case 0: valid = (o.Flags == 0x10 || o.Flags == 0x04 || o.Flags == 0x24); break;\r\n      default: throw 'Unrecognized encryption algorithm: ' + o.AlgID;\r\n    }\r\n    if(!valid) throw new Error(\"Encryption Flags/AlgID mismatch\");\r\n    o.AlgIDHash = blob.read_shift(4);\r\n    o.KeySize = blob.read_shift(4);\r\n    o.ProviderType = blob.read_shift(4);\r\n    blob.l += 8;\r\n    o.CSPName = blob.read_shift((tgt-blob.l)>>1, 'utf16le');\r\n    blob.l = tgt;\r\n    return o;\r\n  }\r\n\r\n  /* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\r\n  function parse_EncryptionVerifier(blob, length) {\r\n    var o = {}, tgt = blob.l + length;\r\n    blob.l += 4; // SaltSize must be 0x10\r\n    o.Salt = blob.slice(blob.l, blob.l+16); blob.l += 16;\r\n    o.Verifier = blob.slice(blob.l, blob.l+16); blob.l += 16;\r\n    /*var sz = */blob.read_shift(4);\r\n    o.VerifierHash = blob.slice(blob.l, tgt); blob.l = tgt;\r\n    return o;\r\n  }\r\n\r\n  /* [MS-OFFCRYPTO] 2.3.4.* EncryptionInfo Stream */\r\n  function parse_EncryptionInfo(blob) {\r\n    var vers = parse_CRYPTOVersion(blob);\r\n    switch(vers.Minor) {\r\n      case 0x02: return [vers.Minor, parse_EncInfoStd(blob, vers)];\r\n      case 0x03: return [vers.Minor, parse_EncInfoExt(blob, vers)];\r\n      case 0x04: return [vers.Minor, parse_EncInfoAgl(blob, vers)];\r\n    }\r\n    throw new Error(\"ECMA-376 Encrypted file unrecognized Version: \" + vers.Minor);\r\n  }\r\n\r\n  /* [MS-OFFCRYPTO] 2.3.4.5  EncryptionInfo Stream (Standard Encryption) */\r\n  function parse_EncInfoStd(blob) {\r\n    var flags = blob.read_shift(4);\r\n    if((flags & 0x3F) != 0x24) throw new Error(\"EncryptionInfo mismatch\");\r\n    var sz = blob.read_shift(4);\r\n    //var tgt = blob.l + sz;\r\n    var hdr = parse_EncryptionHeader(blob, sz);\r\n    var verifier = parse_EncryptionVerifier(blob, blob.length - blob.l);\r\n    return { t:\"Std\", h:hdr, v:verifier };\r\n  }\r\n  /* [MS-OFFCRYPTO] 2.3.4.6  EncryptionInfo Stream (Extensible Encryption) */\r\n  function parse_EncInfoExt() { throw new Error(\"File is password-protected: ECMA-376 Extensible\"); }\r\n  /* [MS-OFFCRYPTO] 2.3.4.10 EncryptionInfo Stream (Agile Encryption) */\r\n  function parse_EncInfoAgl(blob) {\r\n    var KeyData = [\"saltSize\",\"blockSize\",\"keyBits\",\"hashSize\",\"cipherAlgorithm\",\"cipherChaining\",\"hashAlgorithm\",\"saltValue\"];\r\n    blob.l+=4;\r\n    var xml = blob.read_shift(blob.length - blob.l, 'utf8');\r\n    var o = {};\r\n    xml.replace(tagregex, function xml_agile(x) {\r\n      var y = parsexmltag(x);\r\n      switch(strip_ns(y[0])) {\r\n        case '<?xml': break;\r\n        case '<encryption': case '</encryption>': break;\r\n        case '<keyData': KeyData.forEach(function(k) { o[k] = y[k]; }); break;\r\n        case '<dataIntegrity': o.encryptedHmacKey = y.encryptedHmacKey; o.encryptedHmacValue = y.encryptedHmacValue; break;\r\n        case '<keyEncryptors>': case '<keyEncryptors': o.encs = []; break;\r\n        case '</keyEncryptors>': break;\r\n\r\n        case '<keyEncryptor': o.uri = y.uri; break;\r\n        case '</keyEncryptor>': break;\r\n        case '<encryptedKey': o.encs.push(y); break;\r\n        default: throw y[0];\r\n      }\r\n    });\r\n    return o;\r\n  }\r\n\r\n  /* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\r\n  function parse_RC4CryptoHeader(blob, length) {\r\n    var o = {};\r\n    var vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4); length -= 4;\r\n    if(vers.Minor != 2) throw new Error('unrecognized minor version code: ' + vers.Minor);\r\n    if(vers.Major > 4 || vers.Major < 2) throw new Error('unrecognized major version code: ' + vers.Major);\r\n    o.Flags = blob.read_shift(4); length -= 4;\r\n    var sz = blob.read_shift(4); length -= 4;\r\n    o.EncryptionHeader = parse_EncryptionHeader(blob, sz); length -= sz;\r\n    o.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\r\n    return o;\r\n  }\r\n  /* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\r\n  function parse_RC4Header(blob) {\r\n    var o = {};\r\n    var vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4);\r\n    if(vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\r\n    o.Salt = blob.read_shift(16);\r\n    o.EncryptedVerifier = blob.read_shift(16);\r\n    o.EncryptedVerifierHash = blob.read_shift(16);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\r\n  function crypto_CreatePasswordVerifier_Method1(Password) {\r\n    var Verifier = 0x0000, PasswordArray;\r\n    var PasswordDecoded = _JS2ANSI(Password);\r\n    var len = PasswordDecoded.length + 1, i, PasswordByte;\r\n    var Intermediate1, Intermediate2, Intermediate3;\r\n    PasswordArray = new_raw_buf(len);\r\n    PasswordArray[0] = PasswordDecoded.length;\r\n    for(i = 1; i != len; ++i) PasswordArray[i] = PasswordDecoded[i-1];\r\n    for(i = len-1; i >= 0; --i) {\r\n      PasswordByte = PasswordArray[i];\r\n      Intermediate1 = ((Verifier & 0x4000) === 0x0000) ? 0 : 1;\r\n      Intermediate2 = (Verifier << 1) & 0x7FFF;\r\n      Intermediate3 = Intermediate1 | Intermediate2;\r\n      Verifier = Intermediate3 ^ PasswordByte;\r\n    }\r\n    return Verifier ^ 0xCE4B;\r\n  }\r\n\r\n  /* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\r\n  var crypto_CreateXorArray_Method1 = (function() {\r\n    var PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\r\n    var InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\r\n    var XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\r\n    var Ror = function(Byte) { return ((Byte/2) | (Byte*128)) & 0xFF; };\r\n    var XorRor = function(byte1, byte2) { return Ror(byte1 ^ byte2); };\r\n    var CreateXorKey_Method1 = function(Password) {\r\n      var XorKey = InitialCode[Password.length - 1];\r\n      var CurrentElement = 0x68;\r\n      for(var i = Password.length-1; i >= 0; --i) {\r\n        var Char = Password[i];\r\n        for(var j = 0; j != 7; ++j) {\r\n          if(Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\r\n          Char *= 2; --CurrentElement;\r\n        }\r\n      }\r\n      return XorKey;\r\n    };\r\n    return function(password) {\r\n      var Password = _JS2ANSI(password);\r\n      var XorKey = CreateXorKey_Method1(Password);\r\n      var Index = Password.length;\r\n      var ObfuscationArray = new_raw_buf(16);\r\n      for(var i = 0; i != 16; ++i) ObfuscationArray[i] = 0x00;\r\n      var Temp, PasswordLastChar, PadIndex;\r\n      if((Index & 1) === 1) {\r\n        Temp = XorKey >> 8;\r\n        ObfuscationArray[Index] = XorRor(PadArray[0], Temp);\r\n        --Index;\r\n        Temp = XorKey & 0xFF;\r\n        PasswordLastChar = Password[Password.length - 1];\r\n        ObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\r\n      }\r\n      while(Index > 0) {\r\n        --Index;\r\n        Temp = XorKey >> 8;\r\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\r\n        --Index;\r\n        Temp = XorKey & 0xFF;\r\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\r\n      }\r\n      Index = 15;\r\n      PadIndex = 15 - Password.length;\r\n      while(PadIndex > 0) {\r\n        Temp = XorKey >> 8;\r\n        ObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\r\n        --Index;\r\n        --PadIndex;\r\n        Temp = XorKey & 0xFF;\r\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\r\n        --Index;\r\n        --PadIndex;\r\n      }\r\n      return ObfuscationArray;\r\n    };\r\n  })();\r\n\r\n  /* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\r\n  var crypto_DecryptData_Method1 = function(password, Data, XorArrayIndex, XorArray, O) {\r\n    /* If XorArray is set, use it; if O is not set, make changes in-place */\r\n    if(!O) O = Data;\r\n    if(!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\r\n    var Index, Value;\r\n    for(Index = 0; Index != Data.length; ++Index) {\r\n      Value = Data[Index];\r\n      Value ^= XorArray[XorArrayIndex];\r\n      Value = ((Value>>5) | (Value<<3)) & 0xFF;\r\n      O[Index] = Value;\r\n      ++XorArrayIndex;\r\n    }\r\n    return [O, XorArrayIndex, XorArray];\r\n  };\r\n\r\n  var crypto_MakeXorDecryptor = function(password) {\r\n    var XorArrayIndex = 0, XorArray = crypto_CreateXorArray_Method1(password);\r\n    return function(Data) {\r\n      var O = crypto_DecryptData_Method1(\"\", Data, XorArrayIndex, XorArray);\r\n      XorArrayIndex = O[1];\r\n      return O[0];\r\n    };\r\n  };\r\n\r\n  /* 2.5.343 */\r\n  function parse_XORObfuscation(blob, length, opts, out) {\r\n    var o = ({ key: parseuint16(blob), verificationBytes: parseuint16(blob) });\r\n    if(opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\r\n    out.valid = o.verificationBytes === o.verifier;\r\n    if(out.valid) out.insitu = crypto_MakeXorDecryptor(opts.password);\r\n    return o;\r\n  }\r\n\r\n  /* 2.4.117 */\r\n  function parse_FilePassHeader(blob, length, oo) {\r\n    var o = oo || {}; o.Info = blob.read_shift(2); blob.l -= 2;\r\n    if(o.Info === 1) o.Data = parse_RC4Header(blob, length);\r\n    else o.Data = parse_RC4CryptoHeader(blob, length);\r\n    return o;\r\n  }\r\n  function parse_FilePass(blob, length, opts) {\r\n    var o = ({ Type: opts.biff >= 8 ? blob.read_shift(2) : 0 }); /* wEncryptionType */\r\n    if(o.Type) parse_FilePassHeader(blob, length-2, o);\r\n    else parse_XORObfuscation(blob, opts.biff >= 8 ? length : length - 2, opts, o);\r\n    return o;\r\n  }\r\n\r\n\r\n  var RTF = (function() {\r\n    function rtf_to_sheet(d, opts) {\r\n      switch(opts.type) {\r\n        case 'base64': return rtf_to_sheet_str(Base64.decode(d), opts);\r\n        case 'binary': return rtf_to_sheet_str(d, opts);\r\n        case 'buffer': return rtf_to_sheet_str(d.toString('binary'), opts);\r\n        case 'array':  return rtf_to_sheet_str(cc2str(d), opts);\r\n      }\r\n      throw new Error(\"Unrecognized type \" + opts.type);\r\n    }\r\n\r\n    function rtf_to_sheet_str(str, opts) {\r\n      var o = opts || {};\r\n      var ws = o.dense ? ([]) : ({});\r\n      var range = ({s: {c:0, r:0}, e: {c:0, r:0}});\r\n\r\n      // TODO: parse\r\n      if(!str.match(/\\\\trowd/)) throw new Error(\"RTF missing table\");\r\n\r\n      ws['!ref'] = encode_range(range);\r\n      return ws;\r\n    }\r\n\r\n    function rtf_to_workbook(d, opts) { return sheet_to_workbook(rtf_to_sheet(d, opts), opts); }\r\n\r\n    /* TODO: this is a stub */\r\n    function sheet_to_rtf(ws) {\r\n      var o = [\"{\\\\rtf1\\\\ansi\"];\r\n      var r = safe_decode_range(ws['!ref']), cell;\r\n      var dense = Array.isArray(ws);\r\n      for(var R = r.s.r; R <= r.e.r; ++R) {\r\n        o.push(\"\\\\trowd\\\\trautofit1\");\r\n        for(var C = r.s.c; C <= r.e.c; ++C) o.push(\"\\\\cellx\" + (C+1));\r\n        o.push(\"\\\\pard\\\\intbl\");\r\n        for(C = r.s.c; C <= r.e.c; ++C) {\r\n          var coord = encode_cell({r:R,c:C});\r\n          cell = dense ? (ws[R]||[])[C]: ws[coord];\r\n          if(!cell || cell.v == null && (!cell.f || cell.F)) continue;\r\n          o.push(\" \" + (cell.w || (format_cell(cell), cell.w)));\r\n          o.push(\"\\\\cell\");\r\n        }\r\n        o.push(\"\\\\pard\\\\intbl\\\\row\");\r\n      }\r\n      return o.join(\"\") + \"}\";\r\n    }\r\n\r\n    return {\r\n      to_workbook: rtf_to_workbook,\r\n      to_sheet: rtf_to_sheet,\r\n      from_sheet: sheet_to_rtf\r\n    };\r\n  })();\r\n  function hex2RGB(h) {\r\n    var o = h.slice(h[0]===\"#\"?1:0).slice(0,6);\r\n    return [parseInt(o.slice(0,2),16),parseInt(o.slice(2,4),16),parseInt(o.slice(4,6),16)];\r\n  }\r\n  function rgb2Hex(rgb) {\r\n    for(var i=0,o=1; i!=3; ++i) o = o*256 + (rgb[i]>255?255:rgb[i]<0?0:rgb[i]);\r\n    return o.toString(16).toUpperCase().slice(1);\r\n  }\r\n\r\n  function rgb2HSL(rgb) {\r\n    var R = rgb[0]/255, G = rgb[1]/255, B=rgb[2]/255;\r\n    var M = Math.max(R, G, B), m = Math.min(R, G, B), C = M - m;\r\n    if(C === 0) return [0, 0, R];\r\n\r\n    var H6 = 0, S = 0, L2 = (M + m);\r\n    S = C / (L2 > 1 ? 2 - L2 : L2);\r\n    switch(M){\r\n      case R: H6 = ((G - B) / C + 6)%6; break;\r\n      case G: H6 = ((B - R) / C + 2); break;\r\n      case B: H6 = ((R - G) / C + 4); break;\r\n    }\r\n    return [H6 / 6, S, L2 / 2];\r\n  }\r\n\r\n  function hsl2RGB(hsl){\r\n    var H = hsl[0], S = hsl[1], L = hsl[2];\r\n    var C = S * 2 * (L < 0.5 ? L : 1 - L), m = L - C/2;\r\n    var rgb = [m,m,m], h6 = 6*H;\r\n\r\n    var X;\r\n    if(S !== 0) switch(h6|0) {\r\n      case 0: case 6: X = C * h6; rgb[0] += C; rgb[1] += X; break;\r\n      case 1: X = C * (2 - h6);   rgb[0] += X; rgb[1] += C; break;\r\n      case 2: X = C * (h6 - 2);   rgb[1] += C; rgb[2] += X; break;\r\n      case 3: X = C * (4 - h6);   rgb[1] += X; rgb[2] += C; break;\r\n      case 4: X = C * (h6 - 4);   rgb[2] += C; rgb[0] += X; break;\r\n      case 5: X = C * (6 - h6);   rgb[2] += X; rgb[0] += C; break;\r\n    }\r\n    for(var i = 0; i != 3; ++i) rgb[i] = Math.round(rgb[i]*255);\r\n    return rgb;\r\n  }\r\n\r\n  /* 18.8.3 bgColor tint algorithm */\r\n  function rgb_tint(hex, tint) {\r\n    if(tint === 0) return hex;\r\n    var hsl = rgb2HSL(hex2RGB(hex));\r\n    if (tint < 0) hsl[2] = hsl[2] * (1 + tint);\r\n    else hsl[2] = 1 - (1 - hsl[2]) * (1 - tint);\r\n    return rgb2Hex(hsl2RGB(hsl));\r\n  }\r\n\r\n  /* 18.3.1.13 width calculations */\r\n  /* [MS-OI29500] 2.1.595 Column Width & Formatting */\r\n  var DEF_MDW = 6, MAX_MDW = 15, MIN_MDW = 1, MDW = DEF_MDW;\r\n  function width2px(width) { return Math.floor(( width + (Math.round(128/MDW))/256 )* MDW ); }\r\n  function px2char(px) { return (Math.floor((px - 5)/MDW * 100 + 0.5))/100; }\r\n  function char2width(chr) { return (Math.round((chr * MDW + 5)/MDW*256))/256; }\r\n//function px2char_(px) { return (((px - 5)/MDW * 100 + 0.5))/100; }\r\n//function char2width_(chr) { return (((chr * MDW + 5)/MDW*256))/256; }\r\n  function cycle_width(collw) { return char2width(px2char(width2px(collw))); }\r\n  /* XLSX/XLSB/XLS specify width in units of MDW */\r\n  function find_mdw_colw(collw) {\r\n    var delta = Math.abs(collw - cycle_width(collw)), _MDW = MDW;\r\n    if(delta > 0.005) for(MDW=MIN_MDW; MDW<MAX_MDW; ++MDW) if(Math.abs(collw - cycle_width(collw)) <= delta) { delta = Math.abs(collw - cycle_width(collw)); _MDW = MDW; }\r\n    MDW = _MDW;\r\n  }\r\n  /* XLML specifies width in terms of pixels */\r\n  /*function find_mdw_wpx(wpx) {\r\n\tvar delta = Infinity, guess = 0, _MDW = MIN_MDW;\r\n\tfor(MDW=MIN_MDW; MDW<MAX_MDW; ++MDW) {\r\n\t\tguess = char2width_(px2char_(wpx))*256;\r\n\t\tguess = (guess) % 1;\r\n\t\tif(guess > 0.5) guess--;\r\n\t\tif(Math.abs(guess) < delta) { delta = Math.abs(guess); _MDW = MDW; }\r\n\t}\r\n\tMDW = _MDW;\r\n}*/\r\n\r\n  function process_col(coll) {\r\n    if(coll.width) {\r\n      coll.wpx = width2px(coll.width);\r\n      coll.wch = px2char(coll.wpx);\r\n      coll.MDW = MDW;\r\n    } else if(coll.wpx) {\r\n      coll.wch = px2char(coll.wpx);\r\n      coll.width = char2width(coll.wch);\r\n      coll.MDW = MDW;\r\n    } else if(typeof coll.wch == 'number') {\r\n      coll.width = char2width(coll.wch);\r\n      coll.wpx = width2px(coll.width);\r\n      coll.MDW = MDW;\r\n    }\r\n    if(coll.customWidth) delete coll.customWidth;\r\n  }\r\n\r\n  var DEF_PPI = 96, PPI = DEF_PPI;\r\n  function px2pt(px) { return px * 96 / PPI; }\r\n  function pt2px(pt) { return pt * PPI / 96; }\r\n\r\n  /* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\r\n  var XLMLPatternTypeMap = {\r\n    \"None\": \"none\",\r\n    \"Solid\": \"solid\",\r\n    \"Gray50\": \"mediumGray\",\r\n    \"Gray75\": \"darkGray\",\r\n    \"Gray25\": \"lightGray\",\r\n    \"HorzStripe\": \"darkHorizontal\",\r\n    \"VertStripe\": \"darkVertical\",\r\n    \"ReverseDiagStripe\": \"darkDown\",\r\n    \"DiagStripe\": \"darkUp\",\r\n    \"DiagCross\": \"darkGrid\",\r\n    \"ThickDiagCross\": \"darkTrellis\",\r\n    \"ThinHorzStripe\": \"lightHorizontal\",\r\n    \"ThinVertStripe\": \"lightVertical\",\r\n    \"ThinReverseDiagStripe\": \"lightDown\",\r\n    \"ThinHorzCross\": \"lightGrid\"\r\n  };\r\n\r\n  /* 18.8.5 borders CT_Borders */\r\n  function parse_borders(t, styles, themes, opts) {\r\n    styles.Borders = [];\r\n    var border = {}/*, sub_border = {}*/;\r\n    var pass = false;\r\n    t[0].match(tagregex).forEach(function(x) {\r\n      var y = parsexmltag(x);\r\n      switch(strip_ns(y[0])) {\r\n        case '<borders': case '<borders>': case '</borders>': break;\r\n\r\n        /* 18.8.4 border CT_Border */\r\n        case '<border': case '<border>': case '<border/>':\r\n          border = {};\r\n          if (y.diagonalUp) { border.diagonalUp = y.diagonalUp; }\r\n          if (y.diagonalDown) { border.diagonalDown = y.diagonalDown; }\r\n          styles.Borders.push(border);\r\n          break;\r\n        case '</border>': break;\r\n\r\n        /* note: not in spec, appears to be CT_BorderPr */\r\n        case '<left/>': break;\r\n        case '<left': case '<left>': break;\r\n        case '</left>': break;\r\n\r\n        /* note: not in spec, appears to be CT_BorderPr */\r\n        case '<right/>': break;\r\n        case '<right': case '<right>': break;\r\n        case '</right>': break;\r\n\r\n        /* 18.8.43 top CT_BorderPr */\r\n        case '<top/>': break;\r\n        case '<top': case '<top>': break;\r\n        case '</top>': break;\r\n\r\n        /* 18.8.6 bottom CT_BorderPr */\r\n        case '<bottom/>': break;\r\n        case '<bottom': case '<bottom>': break;\r\n        case '</bottom>': break;\r\n\r\n        /* 18.8.13 diagonal CT_BorderPr */\r\n        case '<diagonal': case '<diagonal>': case '<diagonal/>': break;\r\n        case '</diagonal>': break;\r\n\r\n        /* 18.8.25 horizontal CT_BorderPr */\r\n        case '<horizontal': case '<horizontal>': case '<horizontal/>': break;\r\n        case '</horizontal>': break;\r\n\r\n        /* 18.8.44 vertical CT_BorderPr */\r\n        case '<vertical': case '<vertical>': case '<vertical/>': break;\r\n        case '</vertical>': break;\r\n\r\n        /* 18.8.37 start CT_BorderPr */\r\n        case '<start': case '<start>': case '<start/>': break;\r\n        case '</start>': break;\r\n\r\n        /* 18.8.16 end CT_BorderPr */\r\n        case '<end': case '<end>': case '<end/>': break;\r\n        case '</end>': break;\r\n\r\n        /* 18.8.? color CT_Color */\r\n        case '<color': case '<color>': break;\r\n        case '<color/>': case '</color>': break;\r\n\r\n        /* 18.2.10 extLst CT_ExtensionList ? */\r\n        case '<extLst': case '<extLst>': case '</extLst>': break;\r\n        case '<ext': pass = true; break;\r\n        case '</ext>': pass = false; break;\r\n        default: if(opts && opts.WTF) {\r\n          if(!pass) throw new Error('unrecognized ' + y[0] + ' in borders');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /* 18.8.21 fills CT_Fills */\r\n  function parse_fills(t, styles, themes, opts) {\r\n    styles.Fills = [];\r\n    var fill = {};\r\n    var pass = false;\r\n    t[0].match(tagregex).forEach(function(x) {\r\n      var y = parsexmltag(x);\r\n      switch(strip_ns(y[0])) {\r\n        case '<fills': case '<fills>': case '</fills>': break;\r\n\r\n        /* 18.8.20 fill CT_Fill */\r\n        case '<fill>': case '<fill': case '<fill/>':\r\n          fill = {}; styles.Fills.push(fill); break;\r\n        case '</fill>': break;\r\n\r\n        /* 18.8.24 gradientFill CT_GradientFill */\r\n        case '<gradientFill>': break;\r\n        case '<gradientFill':\r\n        case '</gradientFill>': styles.Fills.push(fill); fill = {}; break;\r\n\r\n        /* 18.8.32 patternFill CT_PatternFill */\r\n        case '<patternFill': case '<patternFill>':\r\n          if(y.patternType) fill.patternType = y.patternType;\r\n          break;\r\n        case '<patternFill/>': case '</patternFill>': break;\r\n\r\n        /* 18.8.3 bgColor CT_Color */\r\n        case '<bgColor':\r\n          if(!fill.bgColor) fill.bgColor = {};\r\n          if(y.indexed) fill.bgColor.indexed = parseInt(y.indexed, 10);\r\n          if(y.theme) fill.bgColor.theme = parseInt(y.theme, 10);\r\n          if(y.tint) fill.bgColor.tint = parseFloat(y.tint);\r\n          /* Excel uses ARGB strings */\r\n          if(y.rgb) fill.bgColor.rgb = y.rgb.slice(-6);\r\n          break;\r\n        case '<bgColor/>': case '</bgColor>': break;\r\n\r\n        /* 18.8.19 fgColor CT_Color */\r\n        case '<fgColor':\r\n          if(!fill.fgColor) fill.fgColor = {};\r\n          if(y.theme) fill.fgColor.theme = parseInt(y.theme, 10);\r\n          if(y.tint) fill.fgColor.tint = parseFloat(y.tint);\r\n          /* Excel uses ARGB strings */\r\n          if(y.rgb) fill.fgColor.rgb = y.rgb.slice(-6);\r\n          break;\r\n        case '<fgColor/>': case '</fgColor>': break;\r\n\r\n        /* 18.8.38 stop CT_GradientStop */\r\n        case '<stop': case '<stop/>': break;\r\n        case '</stop>': break;\r\n\r\n        /* 18.8.? color CT_Color */\r\n        case '<color': case '<color/>': break;\r\n        case '</color>': break;\r\n\r\n        /* 18.2.10 extLst CT_ExtensionList ? */\r\n        case '<extLst': case '<extLst>': case '</extLst>': break;\r\n        case '<ext': pass = true; break;\r\n        case '</ext>': pass = false; break;\r\n        default: if(opts && opts.WTF) {\r\n          if(!pass) throw new Error('unrecognized ' + y[0] + ' in fills');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /* 18.8.23 fonts CT_Fonts */\r\n  function parse_fonts(t, styles, themes, opts) {\r\n    styles.Fonts = [];\r\n    var font = {};\r\n    var pass = false;\r\n    t[0].match(tagregex).forEach(function(x) {\r\n      var y = parsexmltag(x);\r\n      switch(strip_ns(y[0])) {\r\n        case '<fonts': case '<fonts>': case '</fonts>': break;\r\n\r\n        /* 18.8.22 font CT_Font */\r\n        case '<font': case '<font>': break;\r\n        case '</font>': case '<font/>':\r\n          styles.Fonts.push(font);\r\n          font = {};\r\n          break;\r\n\r\n        /* 18.8.29 name CT_FontName */\r\n        case '<name': if(y.val) font.name = y.val; break;\r\n        case '<name/>': case '</name>': break;\r\n\r\n        /* 18.8.2  b CT_BooleanProperty */\r\n        case '<b': font.bold = y.val ? parsexmlbool(y.val) : 1; break;\r\n        case '<b/>': font.bold = 1; break;\r\n\r\n        /* 18.8.26 i CT_BooleanProperty */\r\n        case '<i': font.italic = y.val ? parsexmlbool(y.val) : 1; break;\r\n        case '<i/>': font.italic = 1; break;\r\n\r\n        /* 18.4.13 u CT_UnderlineProperty */\r\n        case '<u':\r\n          switch(y.val) {\r\n            case \"none\": font.underline = 0x00; break;\r\n            case \"single\": font.underline = 0x01; break;\r\n            case \"double\": font.underline = 0x02; break;\r\n            case \"singleAccounting\": font.underline = 0x21; break;\r\n            case \"doubleAccounting\": font.underline = 0x22; break;\r\n          } break;\r\n        case '<u/>': font.underline = 1; break;\r\n\r\n        /* 18.4.10 strike CT_BooleanProperty */\r\n        case '<strike': font.strike = y.val ? parsexmlbool(y.val) : 1; break;\r\n        case '<strike/>': font.strike = 1; break;\r\n\r\n        /* 18.4.2  outline CT_BooleanProperty */\r\n        case '<outline': font.outline = y.val ? parsexmlbool(y.val) : 1; break;\r\n        case '<outline/>': font.outline = 1; break;\r\n\r\n        /* 18.8.36 shadow CT_BooleanProperty */\r\n        case '<shadow': font.shadow = y.val ? parsexmlbool(y.val) : 1; break;\r\n        case '<shadow/>': font.shadow = 1; break;\r\n\r\n        /* 18.8.12 condense CT_BooleanProperty */\r\n        case '<condense': font.condense = y.val ? parsexmlbool(y.val) : 1; break;\r\n        case '<condense/>': font.condense = 1; break;\r\n\r\n        /* 18.8.17 extend CT_BooleanProperty */\r\n        case '<extend': font.extend = y.val ? parsexmlbool(y.val) : 1; break;\r\n        case '<extend/>': font.extend = 1; break;\r\n\r\n        /* 18.4.11 sz CT_FontSize */\r\n        case '<sz': if(y.val) font.sz = +y.val; break;\r\n        case '<sz/>': case '</sz>': break;\r\n\r\n        /* 18.4.14 vertAlign CT_VerticalAlignFontProperty */\r\n        case '<vertAlign': if(y.val) font.vertAlign = y.val; break;\r\n        case '<vertAlign/>': case '</vertAlign>': break;\r\n\r\n        /* 18.8.18 family CT_FontFamily */\r\n        case '<family': if(y.val) font.family = parseInt(y.val,10); break;\r\n        case '<family/>': case '</family>': break;\r\n\r\n        /* 18.8.35 scheme CT_FontScheme */\r\n        case '<scheme': if(y.val) font.scheme = y.val; break;\r\n        case '<scheme/>': case '</scheme>': break;\r\n\r\n        /* 18.4.1 charset CT_IntProperty */\r\n        case '<charset':\r\n          if(y.val == '1') break;\r\n          y.codepage = CS2CP[parseInt(y.val, 10)];\r\n          break;\r\n\r\n        /* 18.?.? color CT_Color */\r\n        case '<color':\r\n          if(!font.color) font.color = {};\r\n          if(y.auto) font.color.auto = parsexmlbool(y.auto);\r\n\r\n          if(y.rgb) font.color.rgb = y.rgb.slice(-6);\r\n          else if(y.indexed) {\r\n            font.color.index = parseInt(y.indexed, 10);\r\n            var icv = XLSIcv[font.color.index];\r\n            if(font.color.index == 81) icv = XLSIcv[1];\r\n            if(!icv) throw new Error(x);\r\n            font.color.rgb = icv[0].toString(16) + icv[1].toString(16) + icv[2].toString(16);\r\n          } else if(y.theme) {\r\n            font.color.theme = parseInt(y.theme, 10);\r\n            if(y.tint) font.color.tint = parseFloat(y.tint);\r\n            if(y.theme && themes.themeElements && themes.themeElements.clrScheme) {\r\n              font.color.rgb = rgb_tint(themes.themeElements.clrScheme[font.color.theme].rgb, font.color.tint || 0);\r\n            }\r\n          }\r\n\r\n          break;\r\n        case '<color/>': case '</color>': break;\r\n\r\n        /* 18.2.10 extLst CT_ExtensionList ? */\r\n        case '<extLst': case '<extLst>': case '</extLst>': break;\r\n        case '<ext': pass = true; break;\r\n        case '</ext>': pass = false; break;\r\n        default: if(opts && opts.WTF) {\r\n          if(!pass) throw new Error('unrecognized ' + y[0] + ' in fonts');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /* 18.8.31 numFmts CT_NumFmts */\r\n  function parse_numFmts(t, styles, opts) {\r\n    styles.NumberFmt = [];\r\n    var k/*Array<number>*/ = (keys(SSF._table));\r\n    for(var i=0; i < k.length; ++i) styles.NumberFmt[k[i]] = SSF._table[k[i]];\r\n    var m = t[0].match(tagregex);\r\n    if(!m) return;\r\n    for(i=0; i < m.length; ++i) {\r\n      var y = parsexmltag(m[i]);\r\n      switch(strip_ns(y[0])) {\r\n        case '<numFmts': case '</numFmts>': case '<numFmts/>': case '<numFmts>': break;\r\n        case '<numFmt': {\r\n          var f=unescapexml(utf8read(y.formatCode)), j=parseInt(y.numFmtId,10);\r\n          styles.NumberFmt[j] = f;\r\n          if(j>0) {\r\n            if(j > 0x188) {\r\n              for(j = 0x188; j > 0x3c; --j) if(styles.NumberFmt[j] == null) break;\r\n              styles.NumberFmt[j] = f;\r\n            }\r\n            SSF.load(f,j);\r\n          }\r\n        } break;\r\n        case '</numFmt>': break;\r\n        default: if(opts.WTF) throw new Error('unrecognized ' + y[0] + ' in numFmts');\r\n      }\r\n    }\r\n  }\r\n\r\n  function write_numFmts(NF) {\r\n    var o = [\"<numFmts>\"];\r\n    [[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\r\n      for(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) o[o.length] = (writextag('numFmt',null,{numFmtId:i,formatCode:escapexml(NF[i])}));\r\n    });\r\n    if(o.length === 1) return \"\";\r\n    o[o.length] = (\"</numFmts>\");\r\n    o[0] = writextag('numFmts', null, { count:o.length-2 }).replace(\"/>\", \">\");\r\n    return o.join(\"\");\r\n  }\r\n\r\n  /* 18.8.10 cellXfs CT_CellXfs */\r\n  var cellXF_uint = [ \"numFmtId\", \"fillId\", \"fontId\", \"borderId\", \"xfId\" ];\r\n  var cellXF_bool = [ \"applyAlignment\", \"applyBorder\", \"applyFill\", \"applyFont\", \"applyNumberFormat\", \"applyProtection\", \"pivotButton\", \"quotePrefix\" ];\r\n  function parse_cellXfs(t, styles, opts) {\r\n    styles.CellXf = [];\r\n    var xf;\r\n    var pass = false;\r\n    t[0].match(tagregex).forEach(function(x) {\r\n      var y = parsexmltag(x), i = 0;\r\n      switch(strip_ns(y[0])) {\r\n        case '<cellXfs': case '<cellXfs>': case '<cellXfs/>': case '</cellXfs>': break;\r\n\r\n        /* 18.8.45 xf CT_Xf */\r\n        case '<xf': case '<xf/>':\r\n          xf = y;\r\n          delete xf[0];\r\n          for(i = 0; i < cellXF_uint.length; ++i) if(xf[cellXF_uint[i]])\r\n            xf[cellXF_uint[i]] = parseInt(xf[cellXF_uint[i]], 10);\r\n          for(i = 0; i < cellXF_bool.length; ++i) if(xf[cellXF_bool[i]])\r\n            xf[cellXF_bool[i]] = parsexmlbool(xf[cellXF_bool[i]]);\r\n          if(xf.numFmtId > 0x188) {\r\n            for(i = 0x188; i > 0x3c; --i) if(styles.NumberFmt[xf.numFmtId] == styles.NumberFmt[i]) { xf.numFmtId = i; break; }\r\n          }\r\n          styles.CellXf.push(xf); break;\r\n        case '</xf>': break;\r\n\r\n        /* 18.8.1 alignment CT_CellAlignment */\r\n        case '<alignment': case '<alignment/>':\r\n          var alignment = {};\r\n          if(y.vertical) alignment.vertical = y.vertical;\r\n          if(y.horizontal) alignment.horizontal = y.horizontal;\r\n          if(y.textRotation != null) alignment.textRotation = y.textRotation;\r\n          if(y.indent) alignment.indent = y.indent;\r\n          if(y.wrapText) alignment.wrapText = y.wrapText;\r\n          xf.alignment = alignment;\r\n          break;\r\n        case '</alignment>': break;\r\n\r\n        /* 18.8.33 protection CT_CellProtection */\r\n        case '<protection': case '</protection>': case '<protection/>': break;\r\n\r\n        /* 18.2.10 extLst CT_ExtensionList ? */\r\n        case '<extLst': case '<extLst>': case '</extLst>': break;\r\n        case '<ext': pass = true; break;\r\n        case '</ext>': pass = false; break;\r\n        default: if(opts && opts.WTF) {\r\n          if(!pass) throw new Error('unrecognized ' + y[0] + ' in cellXfs');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  function write_cellXfs(cellXfs) {\r\n    var o = [];\r\n    o[o.length] = (writextag('cellXfs',null));\r\n    cellXfs.forEach(function(c) { o[o.length] = (writextag('xf', null, c)); });\r\n    o[o.length] = (\"</cellXfs>\");\r\n    if(o.length === 2) return \"\";\r\n    o[0] = writextag('cellXfs',null, {count:o.length-2}).replace(\"/>\",\">\");\r\n    return o.join(\"\");\r\n  }\r\n\r\n  /* 18.8 Styles CT_Stylesheet*/\r\n  var parse_sty_xml= (function make_pstyx() {\r\n    var numFmtRegex = /<(?:\\w+:)?numFmts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?numFmts>/;\r\n    var cellXfRegex = /<(?:\\w+:)?cellXfs([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?cellXfs>/;\r\n    var fillsRegex = /<(?:\\w+:)?fills([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fills>/;\r\n    var fontsRegex = /<(?:\\w+:)?fonts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fonts>/;\r\n    var bordersRegex = /<(?:\\w+:)?borders([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?borders>/;\r\n\r\n    return function parse_sty_xml(data, themes, opts) {\r\n      var styles = {};\r\n      if(!data) return styles;\r\n      data = data.replace(/<!--([\\s\\S]*?)-->/mg,\"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm,\"\");\r\n      /* 18.8.39 styleSheet CT_Stylesheet */\r\n      var t;\r\n\r\n      /* 18.8.31 numFmts CT_NumFmts ? */\r\n      if((t=data.match(numFmtRegex))) parse_numFmts(t, styles, opts);\r\n\r\n      /* 18.8.23 fonts CT_Fonts ? */\r\n      if((t=data.match(fontsRegex))) parse_fonts(t, styles, themes, opts);\r\n\r\n      /* 18.8.21 fills CT_Fills ? */\r\n      if((t=data.match(fillsRegex))) parse_fills(t, styles, themes, opts);\r\n\r\n      /* 18.8.5  borders CT_Borders ? */\r\n      if((t=data.match(bordersRegex))) parse_borders(t, styles, themes, opts);\r\n\r\n      /* 18.8.9  cellStyleXfs CT_CellStyleXfs ? */\r\n\r\n      /* 18.8.10 cellXfs CT_CellXfs ? */\r\n      if((t=data.match(cellXfRegex))) parse_cellXfs(t, styles, opts);\r\n\r\n      /* 18.8.8  cellStyles CT_CellStyles ? */\r\n      /* 18.8.15 dxfs CT_Dxfs ? */\r\n      /* 18.8.42 tableStyles CT_TableStyles ? */\r\n      /* 18.8.11 colors CT_Colors ? */\r\n      /* 18.2.10 extLst CT_ExtensionList ? */\r\n\r\n      return styles;\r\n    };\r\n  })();\r\n\r\n  var STYLES_XML_ROOT = writextag('styleSheet', null, {\r\n    'xmlns': XMLNS.main[0],\r\n    'xmlns:vt': XMLNS.vt\r\n  });\r\n\r\n  RELS.STY = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\";\r\n\r\n  function write_sty_xml(wb, opts) {\r\n    if (typeof style_builder != 'undefined' && typeof 'require' != 'undefined') {\r\n      return style_builder.toXml();\r\n    }\r\n    var o = [XML_HEADER, STYLES_XML_ROOT], w;\r\n    if(wb.SSF && (w = write_numFmts(wb.SSF)) != null) o[o.length] = w;\r\n    o[o.length] = ('<fonts count=\"1\"><font><sz val=\"12\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts>');\r\n    o[o.length] = ('<fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills>');\r\n    o[o.length] = ('<borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders>');\r\n    o[o.length] = ('<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>');\r\n    if((w = write_cellXfs(opts.cellXfs))) o[o.length] = (w);\r\n    o[o.length] = ('<cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles>');\r\n    o[o.length] = ('<dxfs count=\"0\"/>');\r\n    o[o.length] = ('<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\"/>');\r\n\r\n    if(o.length>2){ o[o.length] = ('</styleSheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\r\n    return o.join(\"\");\r\n  }\r\n  /* [MS-XLSB] 2.4.657 BrtFmt */\r\n  function parse_BrtFmt(data, length) {\r\n    var numFmtId = data.read_shift(2);\r\n    var stFmtCode = parse_XLWideString(data,length-2);\r\n    return [numFmtId, stFmtCode];\r\n  }\r\n  function write_BrtFmt(i, f, o) {\r\n    if(!o) o = new_buf(6 + 4 * f.length);\r\n    o.write_shift(2, i);\r\n    write_XLWideString(f, o);\r\n    var out = (o.length > o.l) ? o.slice(0, o.l) : o;\r\n    if(o.l == null) o.l = o.length;\r\n    return out;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.659 BrtFont TODO */\r\n  function parse_BrtFont(data, length, opts) {\r\n    var out = ({});\r\n\r\n    out.sz = data.read_shift(2) / 20;\r\n\r\n    var grbit = parse_FontFlags(data, 2, opts);\r\n    if(grbit.fCondense) out.condense = 1;\r\n    if(grbit.fExtend) out.extend = 1;\r\n    if(grbit.fShadow) out.shadow = 1;\r\n    if(grbit.fOutline) out.outline = 1;\r\n    if(grbit.fStrikeout) out.strike = 1;\r\n    if(grbit.fItalic) out.italic = 1;\r\n\r\n    var bls = data.read_shift(2);\r\n    if(bls === 0x02BC) out.bold = 1;\r\n\r\n    switch(data.read_shift(2)) {\r\n      /* case 0: out.vertAlign = \"baseline\"; break; */\r\n      case 1: out.vertAlign = \"superscript\"; break;\r\n      case 2: out.vertAlign = \"subscript\"; break;\r\n    }\r\n\r\n    var underline = data.read_shift(1);\r\n    if(underline != 0) out.underline = underline;\r\n\r\n    var family = data.read_shift(1);\r\n    if(family > 0) out.family = family;\r\n\r\n    var bCharSet = data.read_shift(1);\r\n    if(bCharSet > 0) out.charset = bCharSet;\r\n\r\n    data.l++;\r\n    out.color = parse_BrtColor(data, 8);\r\n\r\n    switch(data.read_shift(1)) {\r\n      /* case 0: out.scheme = \"none\": break; */\r\n      case 1: out.scheme = \"major\"; break;\r\n      case 2: out.scheme = \"minor\"; break;\r\n    }\r\n\r\n    out.name = parse_XLWideString(data, length - 21);\r\n\r\n    return out;\r\n  }\r\n  function write_BrtFont(font, o) {\r\n    if(!o) o = new_buf(25+4*32);\r\n    o.write_shift(2, font.sz * 20);\r\n    write_FontFlags(font, o);\r\n    o.write_shift(2, font.bold ? 0x02BC : 0x0190);\r\n    var sss = 0;\r\n    if(font.vertAlign == \"superscript\") sss = 1;\r\n    else if(font.vertAlign == \"subscript\") sss = 2;\r\n    o.write_shift(2, sss);\r\n    o.write_shift(1, font.underline || 0);\r\n    o.write_shift(1, font.family || 0);\r\n    o.write_shift(1, font.charset || 0);\r\n    o.write_shift(1, 0);\r\n    write_BrtColor(font.color, o);\r\n    var scheme = 0;\r\n    if(font.scheme == \"major\") scheme = 1;\r\n    if(font.scheme == \"minor\") scheme = 2;\r\n    o.write_shift(1, scheme);\r\n    write_XLWideString(font.name, o);\r\n    return o.length > o.l ? o.slice(0, o.l) : o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.650 BrtFill */\r\n  var XLSBFillPTNames = [\r\n    \"none\",\r\n    \"solid\",\r\n    \"mediumGray\",\r\n    \"darkGray\",\r\n    \"lightGray\",\r\n    \"darkHorizontal\",\r\n    \"darkVertical\",\r\n    \"darkDown\",\r\n    \"darkUp\",\r\n    \"darkGrid\",\r\n    \"darkTrellis\",\r\n    \"lightHorizontal\",\r\n    \"lightVertical\",\r\n    \"lightDown\",\r\n    \"lightUp\",\r\n    \"lightGrid\",\r\n    \"lightTrellis\",\r\n    \"gray125\",\r\n    \"gray0625\"\r\n  ];\r\n  var rev_XLSBFillPTNames = (evert(XLSBFillPTNames));\r\n  /* TODO: gradient fill representation */\r\n  var parse_BrtFill = parsenoop;\r\n  function write_BrtFill(fill, o) {\r\n    if(!o) o = new_buf(4*3 + 8*7 + 16*1);\r\n    var fls = rev_XLSBFillPTNames[fill.patternType];\r\n    if(fls == null) fls = 0x28;\r\n    o.write_shift(4, fls);\r\n    var j = 0;\r\n    if(fls != 0x28) {\r\n      /* TODO: custom FG Color */\r\n      write_BrtColor({auto:1}, o);\r\n      /* TODO: custom BG Color */\r\n      write_BrtColor({auto:1}, o);\r\n\r\n      for(; j < 12; ++j) o.write_shift(4, 0);\r\n    } else {\r\n      for(; j < 4; ++j) o.write_shift(4, 0);\r\n\r\n      for(; j < 12; ++j) o.write_shift(4, 0); /* TODO */\r\n      /* iGradientType */\r\n      /* xnumDegree */\r\n      /* xnumFillToLeft */\r\n      /* xnumFillToRight */\r\n      /* xnumFillToTop */\r\n      /* xnumFillToBottom */\r\n      /* cNumStop */\r\n      /* xfillGradientStop */\r\n    }\r\n    return o.length > o.l ? o.slice(0, o.l) : o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.824 BrtXF */\r\n  function parse_BrtXF(data, length) {\r\n    var tgt = data.l + length;\r\n    var ixfeParent = data.read_shift(2);\r\n    var ifmt = data.read_shift(2);\r\n    data.l = tgt;\r\n    return {ixfe:ixfeParent, numFmtId:ifmt };\r\n  }\r\n  function write_BrtXF(data, ixfeP, o) {\r\n    if(!o) o = new_buf(16);\r\n    o.write_shift(2, ixfeP||0);\r\n    o.write_shift(2, data.numFmtId||0);\r\n    o.write_shift(2, 0); /* iFont */\r\n    o.write_shift(2, 0); /* iFill */\r\n    o.write_shift(2, 0); /* ixBorder */\r\n    o.write_shift(1, 0); /* trot */\r\n    o.write_shift(1, 0); /* indent */\r\n    o.write_shift(1, 0); /* flags */\r\n    o.write_shift(1, 0); /* flags */\r\n    o.write_shift(1, 0); /* xfGrbitAtr */\r\n    o.write_shift(1, 0);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.5.4 Blxf TODO */\r\n  function write_Blxf(data, o) {\r\n    if(!o) o = new_buf(10);\r\n    o.write_shift(1, 0); /* dg */\r\n    o.write_shift(1, 0);\r\n    o.write_shift(4, 0); /* color */\r\n    o.write_shift(4, 0); /* color */\r\n    return o;\r\n  }\r\n  /* [MS-XLSB] 2.4.302 BrtBorder TODO */\r\n  var parse_BrtBorder = parsenoop;\r\n  function write_BrtBorder(border, o) {\r\n    if(!o) o = new_buf(51);\r\n    o.write_shift(1, 0); /* diagonal */\r\n    write_Blxf(null, o); /* top */\r\n    write_Blxf(null, o); /* bottom */\r\n    write_Blxf(null, o); /* left */\r\n    write_Blxf(null, o); /* right */\r\n    write_Blxf(null, o); /* diag */\r\n    return o.length > o.l ? o.slice(0, o.l) : o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.763 BrtStyle TODO */\r\n  function write_BrtStyle(style, o) {\r\n    if(!o) o = new_buf(12+4*10);\r\n    o.write_shift(4, style.xfId);\r\n    o.write_shift(2, 1);\r\n    o.write_shift(1, +style.builtinId);\r\n    o.write_shift(1, 0); /* iLevel */\r\n    write_XLNullableWideString(style.name || \"\", o);\r\n    return o.length > o.l ? o.slice(0, o.l) : o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.272 BrtBeginTableStyles */\r\n  function write_BrtBeginTableStyles(cnt, defTableStyle, defPivotStyle) {\r\n    var o = new_buf(4+256*2*4);\r\n    o.write_shift(4, cnt);\r\n    write_XLNullableWideString(defTableStyle, o);\r\n    write_XLNullableWideString(defPivotStyle, o);\r\n    return o.length > o.l ? o.slice(0, o.l) : o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.1.7.50 Styles */\r\n  function parse_sty_bin(data, themes, opts) {\r\n    var styles = {};\r\n    styles.NumberFmt = ([]);\r\n    for(var y in SSF._table) styles.NumberFmt[y] = SSF._table[y];\r\n\r\n    styles.CellXf = [];\r\n    styles.Fonts = [];\r\n    var state = [];\r\n    var pass = false;\r\n    recordhopper(data, function hopper_sty(val, R_n, RT) {\r\n      switch(RT) {\r\n        case 0x002C: /* 'BrtFmt' */\r\n          styles.NumberFmt[val[0]] = val[1]; SSF.load(val[1], val[0]);\r\n          break;\r\n        case 0x002B: /* 'BrtFont' */\r\n          styles.Fonts.push(val);\r\n          if(val.color.theme != null && themes && themes.themeElements && themes.themeElements.clrScheme) {\r\n            val.color.rgb = rgb_tint(themes.themeElements.clrScheme[val.color.theme].rgb, val.color.tint || 0);\r\n          }\r\n          break;\r\n        case 0x0401: /* 'BrtKnownFonts' */ break;\r\n        case 0x002D: /* 'BrtFill' */ break;\r\n        case 0x002E: /* 'BrtBorder' */ break;\r\n        case 0x002F: /* 'BrtXF' */\r\n          if(state[state.length - 1] == \"BrtBeginCellXFs\") {\r\n            styles.CellXf.push(val);\r\n          }\r\n          break;\r\n        case 0x0030: /* 'BrtStyle' */\r\n        case 0x01FB: /* 'BrtDXF' */\r\n        case 0x023C: /* 'BrtMRUColor' */\r\n        case 0x01DB: /* 'BrtIndexedColor': */\r\n          break;\r\n\r\n        case 0x0493: /* 'BrtDXF14' */\r\n        case 0x0836: /* 'BrtDXF15' */\r\n        case 0x046A: /* 'BrtSlicerStyleElement' */\r\n        case 0x0200: /* 'BrtTableStyleElement' */\r\n        case 0x082F: /* 'BrtTimelineStyleElement' */\r\n        case 0x0C00: /* 'BrtUid' */\r\n          break;\r\n\r\n        case 0x0023: /* 'BrtFRTBegin' */\r\n          pass = true; break;\r\n        case 0x0024: /* 'BrtFRTEnd' */\r\n          pass = false; break;\r\n        case 0x0025: /* 'BrtACBegin' */\r\n          state.push(R_n); break;\r\n        case 0x0026: /* 'BrtACEnd' */\r\n          state.pop(); break;\r\n\r\n        default:\r\n          if((R_n||\"\").indexOf(\"Begin\") > 0) state.push(R_n);\r\n          else if((R_n||\"\").indexOf(\"End\") > 0) state.pop();\r\n          else if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R_n);\r\n      }\r\n    });\r\n    return styles;\r\n  }\r\n\r\n  function write_FMTS_bin(ba, NF) {\r\n    if(!NF) return;\r\n    var cnt = 0;\r\n    [[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\r\n      for(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) ++cnt;\r\n    });\r\n\r\n    if(cnt == 0) return;\r\n    write_record(ba, \"BrtBeginFmts\", write_UInt32LE(cnt));\r\n    [[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\r\n      for(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) write_record(ba, \"BrtFmt\", write_BrtFmt(i, NF[i]));\r\n    });\r\n    write_record(ba, \"BrtEndFmts\");\r\n  }\r\n\r\n  function write_FONTS_bin(ba) {\r\n    var cnt = 1;\r\n\r\n    if(cnt == 0) return;\r\n    write_record(ba, \"BrtBeginFonts\", write_UInt32LE(cnt));\r\n    write_record(ba, \"BrtFont\", write_BrtFont({\r\n      sz:12,\r\n      color: {theme:1},\r\n      name: \"Calibri\",\r\n      family: 2,\r\n      scheme: \"minor\"\r\n    }));\r\n    /* 1*65491BrtFont [ACFONTS] */\r\n    write_record(ba, \"BrtEndFonts\");\r\n  }\r\n\r\n  function write_FILLS_bin(ba) {\r\n    var cnt = 2;\r\n\r\n    if(cnt == 0) return;\r\n    write_record(ba, \"BrtBeginFills\", write_UInt32LE(cnt));\r\n    write_record(ba, \"BrtFill\", write_BrtFill({patternType:\"none\"}));\r\n    write_record(ba, \"BrtFill\", write_BrtFill({patternType:\"gray125\"}));\r\n    /* 1*65431BrtFill */\r\n    write_record(ba, \"BrtEndFills\");\r\n  }\r\n\r\n  function write_BORDERS_bin(ba) {\r\n    var cnt = 1;\r\n\r\n    if(cnt == 0) return;\r\n    write_record(ba, \"BrtBeginBorders\", write_UInt32LE(cnt));\r\n    write_record(ba, \"BrtBorder\", write_BrtBorder({}));\r\n    /* 1*65430BrtBorder */\r\n    write_record(ba, \"BrtEndBorders\");\r\n  }\r\n\r\n  function write_CELLSTYLEXFS_bin(ba) {\r\n    var cnt = 1;\r\n    write_record(ba, \"BrtBeginCellStyleXFs\", write_UInt32LE(cnt));\r\n    write_record(ba, \"BrtXF\", write_BrtXF({\r\n      numFmtId:0,\r\n      fontId:0,\r\n      fillId:0,\r\n      borderId:0\r\n    }, 0xFFFF));\r\n    /* 1*65430(BrtXF *FRT) */\r\n    write_record(ba, \"BrtEndCellStyleXFs\");\r\n  }\r\n\r\n  function write_CELLXFS_bin(ba, data) {\r\n    write_record(ba, \"BrtBeginCellXFs\", write_UInt32LE(data.length));\r\n    data.forEach(function(c) { write_record(ba, \"BrtXF\", write_BrtXF(c,0)); });\r\n    /* 1*65430(BrtXF *FRT) */\r\n    write_record(ba, \"BrtEndCellXFs\");\r\n  }\r\n\r\n  function write_STYLES_bin(ba) {\r\n    var cnt = 1;\r\n\r\n    write_record(ba, \"BrtBeginStyles\", write_UInt32LE(cnt));\r\n    write_record(ba, \"BrtStyle\", write_BrtStyle({\r\n      xfId:0,\r\n      builtinId:0,\r\n      name:\"Normal\"\r\n    }));\r\n    /* 1*65430(BrtStyle *FRT) */\r\n    write_record(ba, \"BrtEndStyles\");\r\n  }\r\n\r\n  function write_DXFS_bin(ba) {\r\n    var cnt = 0;\r\n\r\n    write_record(ba, \"BrtBeginDXFs\", write_UInt32LE(cnt));\r\n    /* *2147483647(BrtDXF *FRT) */\r\n    write_record(ba, \"BrtEndDXFs\");\r\n  }\r\n\r\n  function write_TABLESTYLES_bin(ba) {\r\n    var cnt = 0;\r\n\r\n    write_record(ba, \"BrtBeginTableStyles\", write_BrtBeginTableStyles(cnt, \"TableStyleMedium9\", \"PivotStyleMedium4\"));\r\n    /* *TABLESTYLE */\r\n    write_record(ba, \"BrtEndTableStyles\");\r\n  }\r\n\r\n  function write_COLORPALETTE_bin() {\r\n    return;\r\n    /* BrtBeginColorPalette [INDEXEDCOLORS] [MRUCOLORS] BrtEndColorPalette */\r\n  }\r\n\r\n  /* [MS-XLSB] 2.1.7.50 Styles */\r\n  function write_sty_bin(wb, opts) {\r\n    var ba = buf_array();\r\n    write_record(ba, \"BrtBeginStyleSheet\");\r\n    write_FMTS_bin(ba, wb.SSF);\r\n    write_FONTS_bin(ba, wb);\r\n    write_FILLS_bin(ba, wb);\r\n    write_BORDERS_bin(ba, wb);\r\n    write_CELLSTYLEXFS_bin(ba, wb);\r\n    write_CELLXFS_bin(ba, opts.cellXfs);\r\n    write_STYLES_bin(ba, wb);\r\n    write_DXFS_bin(ba, wb);\r\n    write_TABLESTYLES_bin(ba, wb);\r\n    write_COLORPALETTE_bin(ba, wb);\r\n    /* FRTSTYLESHEET*/\r\n    write_record(ba, \"BrtEndStyleSheet\");\r\n    return ba.end();\r\n  }\r\n  RELS.THEME = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\";\r\n\r\n  /* 20.1.6.2 clrScheme CT_ColorScheme */\r\n  function parse_clrScheme(t, themes, opts) {\r\n    themes.themeElements.clrScheme = [];\r\n    var color = {};\r\n    (t[0].match(tagregex)||[]).forEach(function(x) {\r\n      var y = parsexmltag(x);\r\n      switch(y[0]) {\r\n        /* 20.1.6.2 clrScheme (Color Scheme) CT_ColorScheme */\r\n        case '<a:clrScheme': case '</a:clrScheme>': break;\r\n\r\n        /* 20.1.2.3.32 srgbClr CT_SRgbColor */\r\n        case '<a:srgbClr':\r\n          color.rgb = y.val; break;\r\n\r\n        /* 20.1.2.3.33 sysClr CT_SystemColor */\r\n        case '<a:sysClr':\r\n          color.rgb = y.lastClr; break;\r\n\r\n        /* 20.1.4.1.1 accent1 (Accent 1) */\r\n        /* 20.1.4.1.2 accent2 (Accent 2) */\r\n        /* 20.1.4.1.3 accent3 (Accent 3) */\r\n        /* 20.1.4.1.4 accent4 (Accent 4) */\r\n        /* 20.1.4.1.5 accent5 (Accent 5) */\r\n        /* 20.1.4.1.6 accent6 (Accent 6) */\r\n        /* 20.1.4.1.9 dk1 (Dark 1) */\r\n        /* 20.1.4.1.10 dk2 (Dark 2) */\r\n        /* 20.1.4.1.15 folHlink (Followed Hyperlink) */\r\n        /* 20.1.4.1.19 hlink (Hyperlink) */\r\n        /* 20.1.4.1.22 lt1 (Light 1) */\r\n        /* 20.1.4.1.23 lt2 (Light 2) */\r\n        case '<a:dk1>': case '</a:dk1>':\r\n        case '<a:lt1>': case '</a:lt1>':\r\n        case '<a:dk2>': case '</a:dk2>':\r\n        case '<a:lt2>': case '</a:lt2>':\r\n        case '<a:accent1>': case '</a:accent1>':\r\n        case '<a:accent2>': case '</a:accent2>':\r\n        case '<a:accent3>': case '</a:accent3>':\r\n        case '<a:accent4>': case '</a:accent4>':\r\n        case '<a:accent5>': case '</a:accent5>':\r\n        case '<a:accent6>': case '</a:accent6>':\r\n        case '<a:hlink>': case '</a:hlink>':\r\n        case '<a:folHlink>': case '</a:folHlink>':\r\n          if (y[0].charAt(1) === '/') {\r\n            themes.themeElements.clrScheme.push(color);\r\n            color = {};\r\n          } else {\r\n            color.name = y[0].slice(3, y[0].length - 1);\r\n          }\r\n          break;\r\n\r\n        default: if(opts && opts.WTF) throw new Error('Unrecognized ' + y[0] + ' in clrScheme');\r\n      }\r\n    });\r\n  }\r\n\r\n  /* 20.1.4.1.18 fontScheme CT_FontScheme */\r\n  function parse_fontScheme() { }\r\n\r\n  /* 20.1.4.1.15 fmtScheme CT_StyleMatrix */\r\n  function parse_fmtScheme() { }\r\n\r\n  var clrsregex = /<a:clrScheme([^>]*)>[\\s\\S]*<\\/a:clrScheme>/;\r\n  var fntsregex = /<a:fontScheme([^>]*)>[\\s\\S]*<\\/a:fontScheme>/;\r\n  var fmtsregex = /<a:fmtScheme([^>]*)>[\\s\\S]*<\\/a:fmtScheme>/;\r\n\r\n  /* 20.1.6.10 themeElements CT_BaseStyles */\r\n  function parse_themeElements(data, themes, opts) {\r\n    themes.themeElements = {};\r\n\r\n    var t;\r\n\r\n    [\r\n      /* clrScheme CT_ColorScheme */\r\n      ['clrScheme', clrsregex, parse_clrScheme],\r\n      /* fontScheme CT_FontScheme */\r\n      ['fontScheme', fntsregex, parse_fontScheme],\r\n      /* fmtScheme CT_StyleMatrix */\r\n      ['fmtScheme', fmtsregex, parse_fmtScheme]\r\n    ].forEach(function(m) {\r\n      if(!(t=data.match(m[1]))) throw new Error(m[0] + ' not found in themeElements');\r\n      m[2](t, themes, opts);\r\n    });\r\n  }\r\n\r\n  var themeltregex = /<a:themeElements([^>]*)>[\\s\\S]*<\\/a:themeElements>/;\r\n\r\n  /* 14.2.7 Theme Part */\r\n  function parse_theme_xml(data, opts) {\r\n    /* 20.1.6.9 theme CT_OfficeStyleSheet */\r\n    if(!data || data.length === 0) return parse_theme_xml(write_theme());\r\n\r\n    var t;\r\n    var themes = {};\r\n\r\n    /* themeElements CT_BaseStyles */\r\n    if(!(t=data.match(themeltregex))) throw new Error('themeElements not found in theme');\r\n    parse_themeElements(t[0], themes, opts);\r\n\r\n    return themes;\r\n  }\r\n\r\n  function write_theme(Themes, opts) {\r\n    if(opts && opts.themeXLSX) return opts.themeXLSX;\r\n    var o = [XML_HEADER];\r\n    o[o.length] = '<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\">';\r\n    o[o.length] =  '<a:themeElements>';\r\n\r\n    o[o.length] =   '<a:clrScheme name=\"Office\">';\r\n    o[o.length] =    '<a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1>';\r\n    o[o.length] =    '<a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1>';\r\n    o[o.length] =    '<a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2>';\r\n    o[o.length] =    '<a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2>';\r\n    o[o.length] =    '<a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1>';\r\n    o[o.length] =    '<a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2>';\r\n    o[o.length] =    '<a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3>';\r\n    o[o.length] =    '<a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4>';\r\n    o[o.length] =    '<a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5>';\r\n    o[o.length] =    '<a:accent6><a:srgbClr val=\"F79646\"/></a:accent6>';\r\n    o[o.length] =    '<a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink>';\r\n    o[o.length] =    '<a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink>';\r\n    o[o.length] =   '</a:clrScheme>';\r\n\r\n    o[o.length] =   '<a:fontScheme name=\"Office\">';\r\n    o[o.length] =    '<a:majorFont>';\r\n    o[o.length] =     '<a:latin typeface=\"Cambria\"/>';\r\n    o[o.length] =     '<a:ea typeface=\"\"/>';\r\n    o[o.length] =     '<a:cs typeface=\"\"/>';\r\n    o[o.length] =     '<a:font script=\"Jpan\" typeface=\" \"/>';\r\n    o[o.length] =     '<a:font script=\"Hang\" typeface=\" \"/>';\r\n    o[o.length] =     '<a:font script=\"Hans\" typeface=\"\"/>';\r\n    o[o.length] =     '<a:font script=\"Hant\" typeface=\"\"/>';\r\n    o[o.length] =     '<a:font script=\"Arab\" typeface=\"Times New Roman\"/>';\r\n    o[o.length] =     '<a:font script=\"Hebr\" typeface=\"Times New Roman\"/>';\r\n    o[o.length] =     '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\r\n    o[o.length] =     '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\r\n    o[o.length] =     '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\r\n    o[o.length] =     '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\r\n    o[o.length] =     '<a:font script=\"Khmr\" typeface=\"MoolBoran\"/>';\r\n    o[o.length] =     '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\r\n    o[o.length] =     '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\r\n    o[o.length] =     '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\r\n    o[o.length] =     '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\r\n    o[o.length] =     '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\r\n    o[o.length] =     '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\r\n    o[o.length] =     '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\r\n    o[o.length] =     '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\r\n    o[o.length] =     '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\r\n    o[o.length] =     '<a:font script=\"Taml\" typeface=\"Latha\"/>';\r\n    o[o.length] =     '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\r\n    o[o.length] =     '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\r\n    o[o.length] =     '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\r\n    o[o.length] =     '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\r\n    o[o.length] =     '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\r\n    o[o.length] =     '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\r\n    o[o.length] =     '<a:font script=\"Viet\" typeface=\"Times New Roman\"/>';\r\n    o[o.length] =     '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\r\n    o[o.length] =     '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\r\n    o[o.length] =    '</a:majorFont>';\r\n    o[o.length] =    '<a:minorFont>';\r\n    o[o.length] =     '<a:latin typeface=\"Calibri\"/>';\r\n    o[o.length] =     '<a:ea typeface=\"\"/>';\r\n    o[o.length] =     '<a:cs typeface=\"\"/>';\r\n    o[o.length] =     '<a:font script=\"Jpan\" typeface=\" \"/>';\r\n    o[o.length] =     '<a:font script=\"Hang\" typeface=\" \"/>';\r\n    o[o.length] =     '<a:font script=\"Hans\" typeface=\"\"/>';\r\n    o[o.length] =     '<a:font script=\"Hant\" typeface=\"\"/>';\r\n    o[o.length] =     '<a:font script=\"Arab\" typeface=\"Arial\"/>';\r\n    o[o.length] =     '<a:font script=\"Hebr\" typeface=\"Arial\"/>';\r\n    o[o.length] =     '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\r\n    o[o.length] =     '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\r\n    o[o.length] =     '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\r\n    o[o.length] =     '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\r\n    o[o.length] =     '<a:font script=\"Khmr\" typeface=\"DaunPenh\"/>';\r\n    o[o.length] =     '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\r\n    o[o.length] =     '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\r\n    o[o.length] =     '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\r\n    o[o.length] =     '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\r\n    o[o.length] =     '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\r\n    o[o.length] =     '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\r\n    o[o.length] =     '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\r\n    o[o.length] =     '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\r\n    o[o.length] =     '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\r\n    o[o.length] =     '<a:font script=\"Taml\" typeface=\"Latha\"/>';\r\n    o[o.length] =     '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\r\n    o[o.length] =     '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\r\n    o[o.length] =     '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\r\n    o[o.length] =     '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\r\n    o[o.length] =     '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\r\n    o[o.length] =     '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\r\n    o[o.length] =     '<a:font script=\"Viet\" typeface=\"Arial\"/>';\r\n    o[o.length] =     '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\r\n    o[o.length] =     '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\r\n    o[o.length] =    '</a:minorFont>';\r\n    o[o.length] =   '</a:fontScheme>';\r\n\r\n    o[o.length] =   '<a:fmtScheme name=\"Office\">';\r\n    o[o.length] =    '<a:fillStyleLst>';\r\n    o[o.length] =     '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\r\n    o[o.length] =     '<a:gradFill rotWithShape=\"1\">';\r\n    o[o.length] =      '<a:gsLst>';\r\n    o[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\r\n    o[o.length] =       '<a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\r\n    o[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\r\n    o[o.length] =      '</a:gsLst>';\r\n    o[o.length] =      '<a:lin ang=\"16200000\" scaled=\"1\"/>';\r\n    o[o.length] =     '</a:gradFill>';\r\n    o[o.length] =     '<a:gradFill rotWithShape=\"1\">';\r\n    o[o.length] =      '<a:gsLst>';\r\n    o[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs>';\r\n    o[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\r\n    o[o.length] =      '</a:gsLst>';\r\n    o[o.length] =      '<a:lin ang=\"16200000\" scaled=\"0\"/>';\r\n    o[o.length] =     '</a:gradFill>';\r\n    o[o.length] =    '</a:fillStyleLst>';\r\n    o[o.length] =    '<a:lnStyleLst>';\r\n    o[o.length] =     '<a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\r\n    o[o.length] =     '<a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\r\n    o[o.length] =     '<a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\r\n    o[o.length] =    '</a:lnStyleLst>';\r\n    o[o.length] =    '<a:effectStyleLst>';\r\n    o[o.length] =     '<a:effectStyle>';\r\n    o[o.length] =      '<a:effectLst>';\r\n    o[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw>';\r\n    o[o.length] =      '</a:effectLst>';\r\n    o[o.length] =     '</a:effectStyle>';\r\n    o[o.length] =     '<a:effectStyle>';\r\n    o[o.length] =      '<a:effectLst>';\r\n    o[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\r\n    o[o.length] =      '</a:effectLst>';\r\n    o[o.length] =     '</a:effectStyle>';\r\n    o[o.length] =     '<a:effectStyle>';\r\n    o[o.length] =      '<a:effectLst>';\r\n    o[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\r\n    o[o.length] =      '</a:effectLst>';\r\n    o[o.length] =      '<a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d>';\r\n    o[o.length] =      '<a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d>';\r\n    o[o.length] =     '</a:effectStyle>';\r\n    o[o.length] =    '</a:effectStyleLst>';\r\n    o[o.length] =    '<a:bgFillStyleLst>';\r\n    o[o.length] =     '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\r\n    o[o.length] =     '<a:gradFill rotWithShape=\"1\">';\r\n    o[o.length] =      '<a:gsLst>';\r\n    o[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\r\n    o[o.length] =       '<a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\r\n    o[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs>';\r\n    o[o.length] =      '</a:gsLst>';\r\n    o[o.length] =      '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path>';\r\n    o[o.length] =     '</a:gradFill>';\r\n    o[o.length] =     '<a:gradFill rotWithShape=\"1\">';\r\n    o[o.length] =      '<a:gsLst>';\r\n    o[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\r\n    o[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs>';\r\n    o[o.length] =      '</a:gsLst>';\r\n    o[o.length] =      '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path>';\r\n    o[o.length] =     '</a:gradFill>';\r\n    o[o.length] =    '</a:bgFillStyleLst>';\r\n    o[o.length] =   '</a:fmtScheme>';\r\n    o[o.length] =  '</a:themeElements>';\r\n\r\n    o[o.length] =  '<a:objectDefaults>';\r\n    o[o.length] =   '<a:spDef>';\r\n    o[o.length] =    '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style>';\r\n    o[o.length] =   '</a:spDef>';\r\n    o[o.length] =   '<a:lnDef>';\r\n    o[o.length] =    '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style>';\r\n    o[o.length] =   '</a:lnDef>';\r\n    o[o.length] =  '</a:objectDefaults>';\r\n    o[o.length] =  '<a:extraClrSchemeLst/>';\r\n    o[o.length] = '</a:theme>';\r\n    return o.join(\"\");\r\n  }\r\n  /* [MS-XLS] 2.4.326 TODO: payload is a zip file */\r\n  function parse_Theme(blob, length, opts) {\r\n    var end = blob.l + length;\r\n    var dwThemeVersion = blob.read_shift(4);\r\n    if(dwThemeVersion === 124226) return;\r\n    if(!opts.cellStyles || !jszip) { blob.l = end; return; }\r\n    var data = blob.slice(blob.l);\r\n    blob.l = end;\r\n    var zip; try { zip = new jszip(data); } catch(e) { return; }\r\n    var themeXML = getzipstr(zip, \"theme/theme/theme1.xml\", true);\r\n    if(!themeXML) return;\r\n    return parse_theme_xml(themeXML, opts);\r\n  }\r\n\r\n  /* 2.5.49 */\r\n  function parse_ColorTheme(blob) { return blob.read_shift(4); }\r\n\r\n  /* 2.5.155 */\r\n  function parse_FullColorExt(blob) {\r\n    var o = {};\r\n    o.xclrType = blob.read_shift(2);\r\n    o.nTintShade = blob.read_shift(2);\r\n    switch(o.xclrType) {\r\n      case 0: blob.l += 4; break;\r\n      case 1: o.xclrValue = parse_IcvXF(blob, 4); break;\r\n      case 2: o.xclrValue = parse_LongRGBA(blob, 4); break;\r\n      case 3: o.xclrValue = parse_ColorTheme(blob, 4); break;\r\n      case 4: blob.l += 4; break;\r\n    }\r\n    blob.l += 8;\r\n    return o;\r\n  }\r\n\r\n  /* 2.5.164 TODO: read 7 bits*/\r\n  function parse_IcvXF(blob, length) {\r\n    return parsenoop(blob, length);\r\n  }\r\n\r\n  /* 2.5.280 */\r\n  function parse_XFExtGradient(blob, length) {\r\n    return parsenoop(blob, length);\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.108 */\r\n  function parse_ExtProp(blob) {\r\n    var extType = blob.read_shift(2);\r\n    var cb = blob.read_shift(2) - 4;\r\n    var o = [extType];\r\n    switch(extType) {\r\n      case 0x04: case 0x05: case 0x07: case 0x08:\r\n      case 0x09: case 0x0A: case 0x0B: case 0x0D:\r\n        o[1] = parse_FullColorExt(blob, cb); break;\r\n      case 0x06: o[1] = parse_XFExtGradient(blob, cb); break;\r\n      case 0x0E: case 0x0F: o[1] = blob.read_shift(cb === 1 ? 1 : 2); break;\r\n      default: throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\r\n    }\r\n    return o;\r\n  }\r\n\r\n  /* 2.4.355 */\r\n  function parse_XFExt(blob, length) {\r\n    var end = blob.l + length;\r\n    blob.l += 2;\r\n    var ixfe = blob.read_shift(2);\r\n    blob.l += 2;\r\n    var cexts = blob.read_shift(2);\r\n    var ext = [];\r\n    while(cexts-- > 0) ext.push(parse_ExtProp(blob, end-blob.l));\r\n    return {ixfe:ixfe, ext:ext};\r\n  }\r\n\r\n  /* xf is an XF, see parse_XFExt for xfext */\r\n  function update_xfext(xf, xfext) {\r\n    xfext.forEach(function(xfe) {\r\n      switch(xfe[0]) { /* 2.5.108 extPropData */\r\n        case 0x04: break; /* foreground color */\r\n        case 0x05: break; /* background color */\r\n        case 0x06: break; /* gradient fill */\r\n        case 0x07: break; /* top cell border color */\r\n        case 0x08: break; /* bottom cell border color */\r\n        case 0x09: break; /* left cell border color */\r\n        case 0x0a: break; /* right cell border color */\r\n        case 0x0b: break; /* diagonal cell border color */\r\n        case 0x0d: break; /* text color */\r\n        case 0x0e: break; /* font scheme */\r\n        case 0x0f: break; /* indentation level */\r\n      }\r\n    });\r\n  }\r\n\r\n  /* 18.6 Calculation Chain */\r\n  function parse_cc_xml(data) {\r\n    var d = [];\r\n    if(!data) return d;\r\n    var i = 1;\r\n    (data.match(tagregex)||[]).forEach(function(x) {\r\n      var y = parsexmltag(x);\r\n      switch(y[0]) {\r\n        case '<?xml': break;\r\n        /* 18.6.2  calcChain CT_CalcChain 1 */\r\n        case '<calcChain': case '<calcChain>': case '</calcChain>': break;\r\n        /* 18.6.1  c CT_CalcCell 1 */\r\n        case '<c': delete y[0]; if(y.i) i = y.i; else y.i = i; d.push(y); break;\r\n      }\r\n    });\r\n    return d;\r\n  }\r\n\r\n//function write_cc_xml(data, opts) { }\r\n\r\n  /* [MS-XLSB] 2.6.4.1 */\r\n  function parse_BrtCalcChainItem$(data) {\r\n    var out = {};\r\n    out.i = data.read_shift(4);\r\n    var cell = {};\r\n    cell.r = data.read_shift(4);\r\n    cell.c = data.read_shift(4);\r\n    out.r = encode_cell(cell);\r\n    var flags = data.read_shift(1);\r\n    if(flags & 0x2) out.l = '1';\r\n    if(flags & 0x8) out.a = '1';\r\n    return out;\r\n  }\r\n\r\n  /* 18.6 Calculation Chain */\r\n  function parse_cc_bin(data, name, opts) {\r\n    var out = [];\r\n    var pass = false;\r\n    recordhopper(data, function hopper_cc(val, R_n, RT) {\r\n      switch(RT) {\r\n        case 0x003F: /* 'BrtCalcChainItem$' */\r\n          out.push(val); break;\r\n\r\n        default:\r\n          if((R_n||\"\").indexOf(\"Begin\") > 0){/* empty */}\r\n          else if((R_n||\"\").indexOf(\"End\") > 0){/* empty */}\r\n          else if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R_n);\r\n      }\r\n    });\r\n    return out;\r\n  }\r\n\r\n//function write_cc_bin(data, opts) { }\r\n  /* 18.14 Supplementary Workbook Data */\r\n  function parse_xlink_xml() {\r\n    //var opts = _opts || {};\r\n    //if(opts.WTF) throw \"XLSX External Link\";\r\n  }\r\n\r\n  /* [MS-XLSB] 2.1.7.25 External Link */\r\n  function parse_xlink_bin(data, name, _opts) {\r\n    if(!data) return data;\r\n    var opts = _opts || {};\r\n\r\n    var pass = false, end = false;\r\n\r\n    recordhopper(data, function xlink_parse(val, R_n, RT) {\r\n      if(end) return;\r\n      switch(RT) {\r\n        case 0x0167: /* 'BrtSupTabs' */\r\n        case 0x016B: /* 'BrtExternTableStart' */\r\n        case 0x016C: /* 'BrtExternTableEnd' */\r\n        case 0x016E: /* 'BrtExternRowHdr' */\r\n        case 0x016F: /* 'BrtExternCellBlank' */\r\n        case 0x0170: /* 'BrtExternCellReal' */\r\n        case 0x0171: /* 'BrtExternCellBool' */\r\n        case 0x0172: /* 'BrtExternCellError' */\r\n        case 0x0173: /* 'BrtExternCellString' */\r\n        case 0x01D8: /* 'BrtExternValueMeta' */\r\n        case 0x0241: /* 'BrtSupNameStart' */\r\n        case 0x0242: /* 'BrtSupNameValueStart' */\r\n        case 0x0243: /* 'BrtSupNameValueEnd' */\r\n        case 0x0244: /* 'BrtSupNameNum' */\r\n        case 0x0245: /* 'BrtSupNameErr' */\r\n        case 0x0246: /* 'BrtSupNameSt' */\r\n        case 0x0247: /* 'BrtSupNameNil' */\r\n        case 0x0248: /* 'BrtSupNameBool' */\r\n        case 0x0249: /* 'BrtSupNameFmla' */\r\n        case 0x024A: /* 'BrtSupNameBits' */\r\n        case 0x024B: /* 'BrtSupNameEnd' */\r\n          break;\r\n\r\n        case 0x0023: /* 'BrtFRTBegin' */\r\n          pass = true; break;\r\n        case 0x0024: /* 'BrtFRTEnd' */\r\n          pass = false; break;\r\n\r\n        default:\r\n          if((R_n||\"\").indexOf(\"Begin\") > 0){/* empty */}\r\n          else if((R_n||\"\").indexOf(\"End\") > 0){/* empty */}\r\n          else if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT.toString(16) + \" \" + R_n);\r\n      }\r\n    }, opts);\r\n  }\r\n  RELS.IMG = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\";\r\n  RELS.DRAW = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\";\r\n  /* 20.5 DrawingML - SpreadsheetML Drawing */\r\n  function parse_drawing(data, rels) {\r\n    if(!data) return \"??\";\r\n    /*\r\n\t  Chartsheet Drawing:\r\n\t   - 20.5.2.35 wsDr CT_Drawing\r\n\t    - 20.5.2.1  absoluteAnchor CT_AbsoluteAnchor\r\n\t     - 20.5.2.16 graphicFrame CT_GraphicalObjectFrame\r\n\t      - 20.1.2.2.16 graphic CT_GraphicalObject\r\n\t       - 20.1.2.2.17 graphicData CT_GraphicalObjectData\r\n          - chart reference\r\n\t   the actual type is based on the URI of the graphicData\r\n\t\tTODO: handle embedded charts and other types of graphics\r\n\t*/\r\n    var id = (data.match(/<c:chart [^>]*r:id=\"([^\"]*)\"/)||[\"\",\"\"])[1];\r\n\r\n    return rels['!id'][id].Target;\r\n  }\r\n\r\n  /* L.5.5.2 SpreadsheetML Comments + VML Schema */\r\n  var _shapeid = 1024;\r\n  function write_comments_vml(rId, comments) {\r\n    var csize = [21600, 21600];\r\n    /* L.5.2.1.2 Path Attribute */\r\n    var bbox = [\"m0,0l0\",csize[1],csize[0],csize[1],csize[0],\"0xe\"].join(\",\");\r\n    var o = [\r\n      writextag(\"xml\", null, { 'xmlns:v': XLMLNS.v, 'xmlns:o': XLMLNS.o, 'xmlns:x': XLMLNS.x, 'xmlns:mv': XLMLNS.mv }).replace(/\\/>/,\">\"),\r\n      writextag(\"o:shapelayout\", writextag(\"o:idmap\", null, {'v:ext':\"edit\", 'data':rId}), {'v:ext':\"edit\"}),\r\n      writextag(\"v:shapetype\", [\r\n        writextag(\"v:stroke\", null, {joinstyle:\"miter\"}),\r\n        writextag(\"v:path\", null, {gradientshapeok:\"t\", 'o:connecttype':\"rect\"})\r\n      ].join(\"\"), {id:\"_x0000_t202\", 'o:spt':202, coordsize:csize.join(\",\"),path:bbox})\r\n    ];\r\n    while(_shapeid < rId * 1000) _shapeid += 1000;\r\n\r\n    comments.forEach(function(x) { var c = decode_cell(x[0]);\r\n      o = o.concat([\r\n        '<v:shape' + wxt_helper({\r\n          id:'_x0000_s' + (++_shapeid),\r\n          type:\"#_x0000_t202\",\r\n          style:\"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10\" + (x[1].hidden ? \";visibility:hidden\" : \"\") ,\r\n          fillcolor:\"#ECFAD4\",\r\n          strokecolor:\"#edeaa1\"\r\n        }) + '>',\r\n        writextag('v:fill', writextag(\"o:fill\", null, {type:\"gradientUnscaled\", 'v:ext':\"view\"}), {'color2':\"#BEFF82\", 'angle':\"-180\", 'type':\"gradient\"}),\r\n        writextag(\"v:shadow\", null, {on:\"t\", 'obscured':\"t\"}),\r\n        writextag(\"v:path\", null, {'o:connecttype':\"none\"}),\r\n        '<v:textbox><div style=\"text-align:left\"></div></v:textbox>',\r\n        '<x:ClientData ObjectType=\"Note\">',\r\n        '<x:MoveWithCells/>',\r\n        '<x:SizeWithCells/>',\r\n        /* Part 4 19.4.2.3 Anchor (Anchor) */\r\n        writetag('x:Anchor', [c.c, 0, c.r, 0, c.c+3, 100, c.r+5, 100].join(\",\")),\r\n        writetag('x:AutoFill', \"False\"),\r\n        writetag('x:Row', String(c.r)),\r\n        writetag('x:Column', String(c.c)),\r\n        x[1].hidden ? '' : '<x:Visible/>',\r\n        '</x:ClientData>',\r\n        '</v:shape>'\r\n      ]); });\r\n    o.push('</xml>');\r\n    return o.join(\"\");\r\n  }\r\n\r\n  RELS.CMNT = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\";\r\n\r\n  function parse_comments(zip, dirComments, sheets, sheetRels, opts) {\r\n    for(var i = 0; i != dirComments.length; ++i) {\r\n      var canonicalpath=dirComments[i];\r\n      var comments=parse_cmnt(getzipdata(zip, canonicalpath.replace(/^\\//,''), true), canonicalpath, opts);\r\n      if(!comments || !comments.length) continue;\r\n      // find the sheets targeted by these comments\r\n      var sheetNames = keys(sheets);\r\n      for(var j = 0; j != sheetNames.length; ++j) {\r\n        var sheetName = sheetNames[j];\r\n        var rels = sheetRels[sheetName];\r\n        if(rels) {\r\n          var rel = rels[canonicalpath];\r\n          if(rel) insertCommentsIntoSheet(sheetName, sheets[sheetName], comments);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function insertCommentsIntoSheet(sheetName, sheet, comments) {\r\n    var dense = Array.isArray(sheet);\r\n    var cell;\r\n    comments.forEach(function(comment) {\r\n      var r = decode_cell(comment.ref);\r\n      if(dense) {\r\n        if(!sheet[r.r]) sheet[r.r] = [];\r\n        cell = sheet[r.r][r.c];\r\n      } else cell = sheet[comment.ref];\r\n      if (!cell) {\r\n        cell = {};\r\n        if(dense) sheet[r.r][r.c] = cell;\r\n        else sheet[comment.ref] = cell;\r\n        var range = safe_decode_range(sheet[\"!ref\"]||\"BDWGO1000001:A1\");\r\n        if(range.s.r > r.r) range.s.r = r.r;\r\n        if(range.e.r < r.r) range.e.r = r.r;\r\n        if(range.s.c > r.c) range.s.c = r.c;\r\n        if(range.e.c < r.c) range.e.c = r.c;\r\n        var encoded = encode_range(range);\r\n        if (encoded !== sheet[\"!ref\"]) sheet[\"!ref\"] = encoded;\r\n      }\r\n\r\n      if (!cell.c) cell.c = [];\r\n      var o = ({a: comment.author, t: comment.t, r: comment.r});\r\n      if(comment.h) o.h = comment.h;\r\n      cell.c.push(o);\r\n    });\r\n  }\r\n\r\n  /* 18.7 Comments */\r\n  function parse_comments_xml(data, opts) {\r\n    /* 18.7.6 CT_Comments */\r\n    if(data.match(/<(?:\\w+:)?comments *\\/>/)) return [];\r\n    var authors = [];\r\n    var commentList = [];\r\n    var authtag = data.match(/<(?:\\w+:)?authors>([\\s\\S]*)<\\/(?:\\w+:)?authors>/);\r\n    if(authtag && authtag[1]) authtag[1].split(/<\\/\\w*:?author>/).forEach(function(x) {\r\n      if(x === \"\" || x.trim() === \"\") return;\r\n      var a = x.match(/<(?:\\w+:)?author[^>]*>(.*)/);\r\n      if(a) authors.push(a[1]);\r\n    });\r\n    var cmnttag = data.match(/<(?:\\w+:)?commentList>([\\s\\S]*)<\\/(?:\\w+:)?commentList>/);\r\n    if(cmnttag && cmnttag[1]) cmnttag[1].split(/<\\/\\w*:?comment>/).forEach(function(x) {\r\n      if(x === \"\" || x.trim() === \"\") return;\r\n      var cm = x.match(/<(?:\\w+:)?comment[^>]*>/);\r\n      if(!cm) return;\r\n      var y = parsexmltag(cm[0]);\r\n      var comment = ({ author: y.authorId && authors[y.authorId] || \"sheetjsghost\", ref: y.ref, guid: y.guid });\r\n      var cell = decode_cell(y.ref);\r\n      if(opts.sheetRows && opts.sheetRows <= cell.r) return;\r\n      var textMatch = x.match(/<(?:\\w+:)?text>([\\s\\S]*)<\\/(?:\\w+:)?text>/);\r\n      var rt = !!textMatch && !!textMatch[1] && parse_si(textMatch[1]) || {r:\"\",t:\"\",h:\"\"};\r\n      comment.r = rt.r;\r\n      if(rt.r == \"<t></t>\") rt.t = rt.h = \"\";\r\n      comment.t = rt.t.replace(/\\r\\n/g,\"\\n\").replace(/\\r/g,\"\\n\");\r\n      if(opts.cellHTML) comment.h = rt.h;\r\n      commentList.push(comment);\r\n    });\r\n    return commentList;\r\n  }\r\n\r\n  var CMNT_XML_ROOT = writextag('comments', null, { 'xmlns': XMLNS.main[0] });\r\n  function write_comments_xml(data) {\r\n    var o = [XML_HEADER, CMNT_XML_ROOT];\r\n\r\n    var iauthor = [];\r\n    o.push(\"<authors>\");\r\n    data.forEach(function(x) { x[1].forEach(function(w) { var a = escapexml(w.a);\r\n      if(iauthor.indexOf(a) > -1) return;\r\n      iauthor.push(a);\r\n      o.push(\"<author>\" + a + \"</author>\");\r\n    }); });\r\n    o.push(\"</authors>\");\r\n    o.push(\"<commentList>\");\r\n    data.forEach(function(d) {\r\n      d[1].forEach(function(c) {\r\n        /* 18.7.3 CT_Comment */\r\n        o.push('<comment ref=\"' + d[0] + '\" authorId=\"' + iauthor.indexOf(escapexml(c.a)) + '\"><text>');\r\n        o.push(writetag(\"t\", c.t == null ? \"\" : escapexml(c.t)));\r\n        o.push('</text></comment>');\r\n      });\r\n    });\r\n    o.push(\"</commentList>\");\r\n    if(o.length>2) { o[o.length] = ('</comments>'); o[1]=o[1].replace(\"/>\",\">\"); }\r\n    return o.join(\"\");\r\n  }\r\n  /* [MS-XLSB] 2.4.28 BrtBeginComment */\r\n  function parse_BrtBeginComment(data) {\r\n    var out = {};\r\n    out.iauthor = data.read_shift(4);\r\n    var rfx = parse_UncheckedRfX(data, 16);\r\n    out.rfx = rfx.s;\r\n    out.ref = encode_cell(rfx.s);\r\n    data.l += 16; /*var guid = parse_GUID(data); */\r\n    return out;\r\n  }\r\n  function write_BrtBeginComment(data, o) {\r\n    if(o == null) o = new_buf(36);\r\n    o.write_shift(4, data[1].iauthor);\r\n    write_UncheckedRfX((data[0]), o);\r\n    o.write_shift(4, 0);\r\n    o.write_shift(4, 0);\r\n    o.write_shift(4, 0);\r\n    o.write_shift(4, 0);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.327 BrtCommentAuthor */\r\n  var parse_BrtCommentAuthor = parse_XLWideString;\r\n  function write_BrtCommentAuthor(data) { return write_XLWideString(data.slice(0, 54)); }\r\n\r\n  /* [MS-XLSB] 2.1.7.8 Comments */\r\n  function parse_comments_bin(data, opts) {\r\n    var out = [];\r\n    var authors = [];\r\n    var c = {};\r\n    var pass = false;\r\n    recordhopper(data, function hopper_cmnt(val, R_n, RT) {\r\n      switch(RT) {\r\n        case 0x0278: /* 'BrtCommentAuthor' */\r\n          authors.push(val); break;\r\n        case 0x027B: /* 'BrtBeginComment' */\r\n          c = val; break;\r\n        case 0x027D: /* 'BrtCommentText' */\r\n          c.t = val.t; c.h = val.h; c.r = val.r; break;\r\n        case 0x027C: /* 'BrtEndComment' */\r\n          c.author = authors[c.iauthor];\r\n          delete c.iauthor;\r\n          if(opts.sheetRows && opts.sheetRows <= c.rfx.r) break;\r\n          if(!c.t) c.t = \"\";\r\n          delete c.rfx; out.push(c); break;\r\n\r\n        case 0x0C00: /* 'BrtUid' */\r\n          break;\r\n\r\n        case 0x0023: /* 'BrtFRTBegin' */\r\n          pass = true; break;\r\n        case 0x0024: /* 'BrtFRTEnd' */\r\n          pass = false; break;\r\n        case 0x0025: /* 'BrtACBegin' */ break;\r\n        case 0x0026: /* 'BrtACEnd' */ break;\r\n\r\n\r\n        default:\r\n          if((R_n||\"\").indexOf(\"Begin\") > 0){/* empty */}\r\n          else if((R_n||\"\").indexOf(\"End\") > 0){/* empty */}\r\n          else if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R_n);\r\n      }\r\n    });\r\n    return out;\r\n  }\r\n\r\n  function write_comments_bin(data) {\r\n    var ba = buf_array();\r\n    var iauthor = [];\r\n    write_record(ba, \"BrtBeginComments\");\r\n\r\n    write_record(ba, \"BrtBeginCommentAuthors\");\r\n    data.forEach(function(comment) {\r\n      comment[1].forEach(function(c) {\r\n        if(iauthor.indexOf(c.a) > -1) return;\r\n        iauthor.push(c.a.slice(0,54));\r\n        write_record(ba, \"BrtCommentAuthor\", write_BrtCommentAuthor(c.a));\r\n      });\r\n    });\r\n    write_record(ba, \"BrtEndCommentAuthors\");\r\n\r\n    write_record(ba, \"BrtBeginCommentList\");\r\n    data.forEach(function(comment) {\r\n      comment[1].forEach(function(c) {\r\n        c.iauthor = iauthor.indexOf(c.a);\r\n        var range = {s:decode_cell(comment[0]),e:decode_cell(comment[0])};\r\n        write_record(ba, \"BrtBeginComment\", write_BrtBeginComment([range, c]));\r\n        if(c.t && c.t.length > 0) write_record(ba, \"BrtCommentText\", write_BrtCommentText(c));\r\n        write_record(ba, \"BrtEndComment\");\r\n        delete c.iauthor;\r\n      });\r\n    });\r\n    write_record(ba, \"BrtEndCommentList\");\r\n\r\n    write_record(ba, \"BrtEndComments\");\r\n    return ba.end();\r\n  }\r\n  var CT_VBA = \"application/vnd.ms-office.vbaProject\";\r\n  function make_vba_xls(cfb) {\r\n    var newcfb = CFB.utils.cfb_new({root:\"R\"});\r\n    cfb.FullPaths.forEach(function(p, i) {\r\n      if(p.slice(-1) === \"/\" || !p.match(/_VBA_PROJECT_CUR/)) return;\r\n      var newpath = p.replace(/^[^\\/]*/,\"R\").replace(/\\/_VBA_PROJECT_CUR\\u0000*/, \"\");\r\n      CFB.utils.cfb_add(newcfb, newpath, cfb.FileIndex[i].content);\r\n    });\r\n    return CFB.write(newcfb);\r\n  }\r\n\r\n  function fill_vba_xls(cfb, vba) {\r\n    vba.FullPaths.forEach(function(p, i) {\r\n      if(i == 0) return;\r\n      var newpath = p.replace(/[^\\/]*[\\/]/, \"/_VBA_PROJECT_CUR/\");\r\n      if(newpath.slice(-1) !== \"/\") CFB.utils.cfb_add(cfb, newpath, vba.FileIndex[i].content);\r\n    });\r\n  }\r\n\r\n  var VBAFMTS = [ \"xlsb\", \"xlsm\", \"xlam\", \"biff8\", \"xla\" ];\r\n\r\n  RELS.DS = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet\";\r\n  RELS.MS = \"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet\";\r\n\r\n  /* macro and dialog sheet stubs */\r\n  function parse_ds_bin() { return {'!type':'dialog'}; }\r\n  function parse_ds_xml() { return {'!type':'dialog'}; }\r\n  function parse_ms_bin() { return {'!type':'macro'}; }\r\n  function parse_ms_xml() { return {'!type':'macro'}; }\r\n  /* TODO: it will be useful to parse the function str */\r\n  var rc_to_a1 = (function(){\r\n    var rcregex = /(^|[^A-Za-z])R(\\[?)(-?\\d+|)\\]?C(\\[?)(-?\\d+|)\\]?/g;\r\n    var rcbase = ({r:0,c:0});\r\n    function rcfunc($$,$1,$2,$3,$4,$5) {\r\n      var R = $3.length>0?parseInt($3,10)|0:0, C = $5.length>0?parseInt($5,10)|0:0;\r\n      if(C<0 && $4.length === 0) C=0;\r\n      var cRel = false, rRel = false;\r\n      if($4.length > 0 || $5.length == 0) cRel = true; if(cRel) C += rcbase.c; else --C;\r\n      if($2.length > 0 || $3.length == 0) rRel = true; if(rRel) R += rcbase.r; else --R;\r\n      return $1 + (cRel ? \"\" : \"$\") + encode_col(C) + (rRel ? \"\" : \"$\") + encode_row(R);\r\n    }\r\n    return function rc_to_a1(fstr, base) {\r\n      rcbase = base;\r\n      return fstr.replace(rcregex, rcfunc);\r\n    };\r\n  })();\r\n\r\n  var crefregex = /(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)([1-9]\\d{0,5}|10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6])(?![_.\\(A-Za-z0-9])/g;\r\n  var a1_to_rc =(function(){\r\n    return function a1_to_rc(fstr, base) {\r\n      return fstr.replace(crefregex, function($0, $1, $2, $3, $4, $5) {\r\n        var c = decode_col($3) - ($2 ? 0 : base.c);\r\n        var r = decode_row($5) - ($4 ? 0 : base.r);\r\n        var R = (r == 0 ? \"\" : !$4 ? \"[\" + r + \"]\" : (r+1));\r\n        var C = (c == 0 ? \"\" : !$2 ? \"[\" + c + \"]\" : (c+1));\r\n        return $1 + \"R\" + R + \"C\" + C;\r\n      });\r\n    };\r\n  })();\r\n\r\n  /* no defined name can collide with a valid cell address A1:XFD1048576 ... except LOG10! */\r\n  function shift_formula_str(f, delta) {\r\n    return f.replace(crefregex, function($0, $1, $2, $3, $4, $5) {\r\n      return $1+($2==\"$\" ? $2+$3 : encode_col(decode_col($3)+delta.c))+($4==\"$\" ? $4+$5 : encode_row(decode_row($5) + delta.r));\r\n    });\r\n  }\r\n\r\n  function shift_formula_xlsx(f, range, cell) {\r\n    var r = decode_range(range), s = r.s, c = decode_cell(cell);\r\n    var delta = {r:c.r - s.r, c:c.c - s.c};\r\n    return shift_formula_str(f, delta);\r\n  }\r\n\r\n  /* TODO: parse formula */\r\n  function fuzzyfmla(f) {\r\n    if(f.length == 1) return false;\r\n    return true;\r\n  }\r\n\r\n  function _xlfn(f) {\r\n    return f.replace(/_xlfn\\./g,\"\");\r\n  }\r\n  function parseread1(blob) { blob.l+=1; return; }\r\n\r\n  /* [MS-XLS] 2.5.51 */\r\n  function parse_ColRelU(blob, length) {\r\n    var c = blob.read_shift(length == 1 ? 1 : 2);\r\n    return [c & 0x3FFF, (c >> 14) & 1, (c >> 15) & 1];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.89 */\r\n  function parse_RgceArea(blob, length, opts) {\r\n    var w = 2;\r\n    if(opts) {\r\n      if(opts.biff >= 2 && opts.biff <= 5) return parse_RgceArea_BIFF2(blob, length, opts);\r\n      else if(opts.biff == 12) w = 4;\r\n    }\r\n    var r=blob.read_shift(w), R=blob.read_shift(w);\r\n    var c=parse_ColRelU(blob, 2);\r\n    var C=parse_ColRelU(blob, 2);\r\n    return { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\r\n  }\r\n  /* BIFF 2-5 encodes flags in the row field */\r\n  function parse_RgceArea_BIFF2(blob) {\r\n    var r=parse_ColRelU(blob, 2), R=parse_ColRelU(blob, 2);\r\n    var c=blob.read_shift(1);\r\n    var C=blob.read_shift(1);\r\n    return { s:{r:r[0], c:c, cRel:r[1], rRel:r[2]}, e:{r:R[0], c:C, cRel:R[1], rRel:R[2]} };\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.90 */\r\n  function parse_RgceAreaRel(blob, length, opts) {\r\n    if(opts.biff < 8) return parse_RgceArea_BIFF2(blob, length, opts);\r\n    var r=blob.read_shift(opts.biff == 12 ? 4 : 2), R=blob.read_shift(opts.biff == 12 ? 4 : 2);\r\n    var c=parse_ColRelU(blob, 2);\r\n    var C=parse_ColRelU(blob, 2);\r\n    return { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.109 ; [MS-XLSB] 2.5.97.91 */\r\n  function parse_RgceLoc(blob, length, opts) {\r\n    if(opts && opts.biff >= 2 && opts.biff <= 5) return parse_RgceLoc_BIFF2(blob, length, opts);\r\n    var r = blob.read_shift(opts && opts.biff == 12 ? 4 : 2);\r\n    var c = parse_ColRelU(blob, 2);\r\n    return {r:r, c:c[0], cRel:c[1], rRel:c[2]};\r\n  }\r\n  function parse_RgceLoc_BIFF2(blob) {\r\n    var r = parse_ColRelU(blob, 2);\r\n    var c = blob.read_shift(1);\r\n    return {r:r[0], c:c, cRel:r[1], rRel:r[2]};\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.107, 2.5.47 */\r\n  function parse_RgceElfLoc(blob) {\r\n    var r = blob.read_shift(2);\r\n    var c = blob.read_shift(2);\r\n    return {r:r, c:c & 0xFF, fQuoted:!!(c & 0x4000), cRel:c>>15, rRel:c>>15 };\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.111 ; [MS-XLSB] 2.5.97.92 TODO */\r\n  function parse_RgceLocRel(blob, length, opts) {\r\n    var biff = opts && opts.biff ? opts.biff : 8;\r\n    if(biff >= 2 && biff <= 5) return parse_RgceLocRel_BIFF2(blob, length, opts);\r\n    var r = blob.read_shift(biff >= 12 ? 4 : 2);\r\n    var cl = blob.read_shift(2);\r\n    var cRel = (cl & 0x4000) >> 14, rRel = (cl & 0x8000) >> 15;\r\n    cl &= 0x3FFF;\r\n    if(rRel == 1) while(r > 0x7FFFF) r -= 0x100000;\r\n    if(cRel == 1) while(cl > 0x1FFF) cl = cl - 0x4000;\r\n    return {r:r,c:cl,cRel:cRel,rRel:rRel};\r\n  }\r\n  function parse_RgceLocRel_BIFF2(blob) {\r\n    var rl = blob.read_shift(2);\r\n    var c = blob.read_shift(1);\r\n    var rRel = (rl & 0x8000) >> 15, cRel = (rl & 0x4000) >> 14;\r\n    rl &= 0x3FFF;\r\n    if(rRel == 1 && rl >= 0x2000) rl = rl - 0x4000;\r\n    if(cRel == 1 && c >= 0x80) c = c - 0x100;\r\n    return {r:rl,c:c,cRel:cRel,rRel:rRel};\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.27 ; [MS-XLSB] 2.5.97.18 */\r\n  function parse_PtgArea(blob, length, opts) {\r\n    var type = (blob[blob.l++] & 0x60) >> 5;\r\n    var area = parse_RgceArea(blob, opts.biff >= 2 && opts.biff <= 5 ? 6 : 8, opts);\r\n    return [type, area];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.28 ; [MS-XLSB] 2.5.97.19 */\r\n  function parse_PtgArea3d(blob, length, opts) {\r\n    var type = (blob[blob.l++] & 0x60) >> 5;\r\n    var ixti = blob.read_shift(2, 'i');\r\n    var w = 8;\r\n    if(opts) switch(opts.biff) {\r\n      case 5: blob.l += 12; w = 6; break;\r\n      case 12: w = 12; break;\r\n    }\r\n    var area = parse_RgceArea(blob, w, opts);\r\n    return [type, ixti, area];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.29 ; [MS-XLSB] 2.5.97.20 */\r\n  function parse_PtgAreaErr(blob, length, opts) {\r\n    var type = (blob[blob.l++] & 0x60) >> 5;\r\n    blob.l += opts && (opts.biff > 8) ? 12 : (opts.biff < 8 ? 6 : 8);\r\n    return [type];\r\n  }\r\n  /* [MS-XLS] 2.5.198.30 ; [MS-XLSB] 2.5.97.21 */\r\n  function parse_PtgAreaErr3d(blob, length, opts) {\r\n    var type = (blob[blob.l++] & 0x60) >> 5;\r\n    var ixti = blob.read_shift(2);\r\n    var w = 8;\r\n    if(opts) switch(opts.biff) {\r\n      case 5: blob.l += 12; w = 6; break;\r\n      case 12: w = 12; break;\r\n    }\r\n    blob.l += w;\r\n    return [type, ixti];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.31 ; [MS-XLSB] 2.5.97.22 */\r\n  function parse_PtgAreaN(blob, length, opts) {\r\n    var type = (blob[blob.l++] & 0x60) >> 5;\r\n    var area = parse_RgceAreaRel(blob, length - 1, opts);\r\n    return [type, area];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.32 ; [MS-XLSB] 2.5.97.23 */\r\n  function parse_PtgArray(blob, length, opts) {\r\n    var type = (blob[blob.l++] & 0x60) >> 5;\r\n    blob.l += opts.biff == 2 ? 6 : opts.biff == 12 ? 14 : 7;\r\n    return [type];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.33 ; [MS-XLSB] 2.5.97.24 */\r\n  function parse_PtgAttrBaxcel(blob) {\r\n    var bitSemi = blob[blob.l+1] & 0x01; /* 1 = volatile */\r\n    var bitBaxcel = 1;\r\n    blob.l += 4;\r\n    return [bitSemi, bitBaxcel];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.34 ; [MS-XLSB] 2.5.97.25 */\r\n  function parse_PtgAttrChoose(blob, length, opts) {\r\n    blob.l +=2;\r\n    var offset = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\r\n    var o = [];\r\n    /* offset is 1 less than the number of elements */\r\n    for(var i = 0; i <= offset; ++i) o.push(blob.read_shift(opts && opts.biff == 2 ? 1 : 2));\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.35 ; [MS-XLSB] 2.5.97.26 */\r\n  function parse_PtgAttrGoto(blob, length, opts) {\r\n    var bitGoto = (blob[blob.l+1] & 0xFF) ? 1 : 0;\r\n    blob.l += 2;\r\n    return [bitGoto, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.36 ; [MS-XLSB] 2.5.97.27 */\r\n  function parse_PtgAttrIf(blob, length, opts) {\r\n    var bitIf = (blob[blob.l+1] & 0xFF) ? 1 : 0;\r\n    blob.l += 2;\r\n    return [bitIf, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\r\n  }\r\n\r\n  /* [MS-XLSB] 2.5.97.28 */\r\n  function parse_PtgAttrIfError(blob) {\r\n    var bitIf = (blob[blob.l+1] & 0xFF) ? 1 : 0;\r\n    blob.l += 2;\r\n    return [bitIf, blob.read_shift(2)];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.37 ; [MS-XLSB] 2.5.97.29 */\r\n  function parse_PtgAttrSemi(blob, length, opts) {\r\n    var bitSemi = (blob[blob.l+1] & 0xFF) ? 1 : 0;\r\n    blob.l += opts && opts.biff == 2 ? 3 : 4;\r\n    return [bitSemi];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.40 ; [MS-XLSB] 2.5.97.32 */\r\n  function parse_PtgAttrSpaceType(blob) {\r\n    var type = blob.read_shift(1), cch = blob.read_shift(1);\r\n    return [type, cch];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.38 ; [MS-XLSB] 2.5.97.30 */\r\n  function parse_PtgAttrSpace(blob) {\r\n    blob.read_shift(2);\r\n    return parse_PtgAttrSpaceType(blob, 2);\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.39 ; [MS-XLSB] 2.5.97.31 */\r\n  function parse_PtgAttrSpaceSemi(blob) {\r\n    blob.read_shift(2);\r\n    return parse_PtgAttrSpaceType(blob, 2);\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.84 ; [MS-XLSB] 2.5.97.68 TODO */\r\n  function parse_PtgRef(blob, length, opts) {\r\n    //var ptg = blob[blob.l] & 0x1F;\r\n    var type = (blob[blob.l] & 0x60)>>5;\r\n    blob.l += 1;\r\n    var loc = parse_RgceLoc(blob, 0, opts);\r\n    return [type, loc];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.88 ; [MS-XLSB] 2.5.97.72 TODO */\r\n  function parse_PtgRefN(blob, length, opts) {\r\n    var type = (blob[blob.l] & 0x60)>>5;\r\n    blob.l += 1;\r\n    var loc = parse_RgceLocRel(blob, 0, opts);\r\n    return [type, loc];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.85 ; [MS-XLSB] 2.5.97.69 TODO */\r\n  function parse_PtgRef3d(blob, length, opts) {\r\n    var type = (blob[blob.l] & 0x60)>>5;\r\n    blob.l += 1;\r\n    var ixti = blob.read_shift(2); // XtiIndex\r\n    if(opts && opts.biff == 5) blob.l += 12;\r\n    var loc = parse_RgceLoc(blob, 0, opts); // TODO: or RgceLocRel\r\n    return [type, ixti, loc];\r\n  }\r\n\r\n\r\n  /* [MS-XLS] 2.5.198.62 ; [MS-XLSB] 2.5.97.45 TODO */\r\n  function parse_PtgFunc(blob, length, opts) {\r\n    //var ptg = blob[blob.l] & 0x1F;\r\n    var type = (blob[blob.l] & 0x60)>>5;\r\n    blob.l += 1;\r\n    var iftab = blob.read_shift(opts && opts.biff <= 3 ? 1 : 2);\r\n    return [FtabArgc[iftab], Ftab[iftab], type];\r\n  }\r\n  /* [MS-XLS] 2.5.198.63 ; [MS-XLSB] 2.5.97.46 TODO */\r\n  function parse_PtgFuncVar(blob, length, opts) {\r\n    var type = blob[blob.l++];\r\n    var cparams = blob.read_shift(1), tab = opts && opts.biff <= 3 ? [(type == 0x58 ? -1 : 0), blob.read_shift(1)]: parsetab(blob);\r\n    return [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\r\n  }\r\n\r\n  function parsetab(blob) {\r\n    return [blob[blob.l+1]>>7, blob.read_shift(2) & 0x7FFF];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.41 ; [MS-XLSB] 2.5.97.33 */\r\n  function parse_PtgAttrSum(blob, length, opts) {\r\n    blob.l += opts && opts.biff == 2 ? 3 : 4; return;\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.58 ; [MS-XLSB] 2.5.97.40 */\r\n  function parse_PtgExp(blob, length, opts) {\r\n    blob.l++;\r\n    if(opts && opts.biff == 12) return [blob.read_shift(4, 'i'), 0];\r\n    var row = blob.read_shift(2);\r\n    var col = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\r\n    return [row, col];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.57 ; [MS-XLSB] 2.5.97.39 */\r\n  function parse_PtgErr(blob) { blob.l++; return BErr[blob.read_shift(1)]; }\r\n\r\n  /* [MS-XLS] 2.5.198.66 ; [MS-XLSB] 2.5.97.49 */\r\n  function parse_PtgInt(blob) { blob.l++; return blob.read_shift(2); }\r\n\r\n  /* [MS-XLS] 2.5.198.42 ; [MS-XLSB] 2.5.97.34 */\r\n  function parse_PtgBool(blob) { blob.l++; return blob.read_shift(1)!==0;}\r\n\r\n  /* [MS-XLS] 2.5.198.79 ; [MS-XLSB] 2.5.97.63 */\r\n  function parse_PtgNum(blob) { blob.l++; return parse_Xnum(blob, 8); }\r\n\r\n  /* [MS-XLS] 2.5.198.89 ; [MS-XLSB] 2.5.97.74 */\r\n  function parse_PtgStr(blob, length, opts) { blob.l++; return parse_ShortXLUnicodeString(blob, length-1, opts); }\r\n\r\n  /* [MS-XLS] 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\r\n  /* [MS-XLSB] 2.5.97.93 + 2.5.97.9{4,5,6,7} */\r\n  function parse_SerAr(blob, biff) {\r\n    var val = [blob.read_shift(1)];\r\n    if(biff == 12) switch(val[0]) {\r\n      case 0x02: val[0] = 0x04; break; /* SerBool */\r\n      case 0x04: val[0] = 0x10; break; /* SerErr */\r\n      case 0x00: val[0] = 0x01; break; /* SerNum */\r\n      case 0x01: val[0] = 0x02; break; /* SerStr */\r\n    }\r\n    switch(val[0]) {\r\n      case 0x04: /* SerBool -- boolean */\r\n        val[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\r\n        if(biff != 12) blob.l += 7; break;\r\n      case 0x25: /* appears to be an alias */\r\n      case 0x10: /* SerErr -- error */\r\n        val[1] = BErr[blob[blob.l]];\r\n        blob.l += ((biff == 12) ? 4 : 8); break;\r\n      case 0x00: /* SerNil -- honestly, I'm not sure how to reproduce this */\r\n        blob.l += 8; break;\r\n      case 0x01: /* SerNum -- Xnum */\r\n        val[1] = parse_Xnum(blob, 8); break;\r\n      case 0x02: /* SerStr -- XLUnicodeString (<256 chars) */\r\n        val[1] = parse_XLUnicodeString2(blob, 0, {biff:biff > 0 && biff < 8 ? 2 : biff}); break;\r\n      default: throw new Error(\"Bad SerAr: \" + val[0]); /* Unreachable */\r\n    }\r\n    return val;\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.61 ; [MS-XLSB] 2.5.97.44 */\r\n  function parse_PtgExtraMem(blob, cce, opts) {\r\n    var count = blob.read_shift((opts.biff == 12) ? 4 : 2);\r\n    var out = [];\r\n    for(var i = 0; i != count; ++i) out.push(((opts.biff == 12) ? parse_UncheckedRfX : parse_Ref8U)(blob, 8));\r\n    return out;\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.59 ; [MS-XLSB] 2.5.97.41 */\r\n  function parse_PtgExtraArray(blob, length, opts) {\r\n    var rows = 0, cols = 0;\r\n    if(opts.biff == 12) {\r\n      rows = blob.read_shift(4); // DRw\r\n      cols = blob.read_shift(4); // DCol\r\n    } else {\r\n      cols = 1 + blob.read_shift(1); //DColByteU\r\n      rows = 1 + blob.read_shift(2); //DRw\r\n    }\r\n    if(opts.biff >= 2 && opts.biff < 8) { --rows; if(--cols == 0) cols = 0x100; }\r\n    // $FlowIgnore\r\n    for(var i = 0, o = []; i != rows && (o[i] = []); ++i)\r\n      for(var j = 0; j != cols; ++j) o[i][j] = parse_SerAr(blob, opts.biff);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 */\r\n  function parse_PtgName(blob, length, opts) {\r\n    var type = (blob.read_shift(1) >>> 5) & 0x03;\r\n    var w = (!opts || (opts.biff >= 8)) ? 4 : 2;\r\n    var nameindex = blob.read_shift(w);\r\n    switch(opts.biff) {\r\n      case 2: blob.l += 5; break;\r\n      case 3: case 4: blob.l += 8; break;\r\n      case 5: blob.l += 12; break;\r\n    }\r\n    return [type, 0, nameindex];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 */\r\n  function parse_PtgNameX(blob, length, opts) {\r\n    if(opts.biff == 5) return parse_PtgNameX_BIFF5(blob, length, opts);\r\n    var type = (blob.read_shift(1) >>> 5) & 0x03;\r\n    var ixti = blob.read_shift(2); // XtiIndex\r\n    var nameindex = blob.read_shift(4);\r\n    return [type, ixti, nameindex];\r\n  }\r\n  function parse_PtgNameX_BIFF5(blob) {\r\n    var type = (blob.read_shift(1) >>> 5) & 0x03;\r\n    var ixti = blob.read_shift(2, 'i'); // XtiIndex\r\n    blob.l += 8;\r\n    var nameindex = blob.read_shift(2);\r\n    blob.l += 12;\r\n    return [type, ixti, nameindex];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.70 ; [MS-XLSB] 2.5.97.54 */\r\n  function parse_PtgMemArea(blob, length, opts) {\r\n    var type = (blob.read_shift(1) >>> 5) & 0x03;\r\n    blob.l += (opts && opts.biff == 2 ? 3 : 4);\r\n    var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\r\n    return [type, cce];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.72 ; [MS-XLSB] 2.5.97.56 */\r\n  function parse_PtgMemFunc(blob, length, opts) {\r\n    var type = (blob.read_shift(1) >>> 5) & 0x03;\r\n    var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\r\n    return [type, cce];\r\n  }\r\n\r\n\r\n  /* [MS-XLS] 2.5.198.86 ; [MS-XLSB] 2.5.97.69 */\r\n  function parse_PtgRefErr(blob, length, opts) {\r\n    var type = (blob.read_shift(1) >>> 5) & 0x03;\r\n    blob.l += 4;\r\n    if(opts.biff < 8) blob.l--;\r\n    if(opts.biff == 12) blob.l += 2;\r\n    return [type];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.87 ; [MS-XLSB] 2.5.97.71 */\r\n  function parse_PtgRefErr3d(blob, length, opts) {\r\n    var type = (blob[blob.l++] & 0x60) >> 5;\r\n    var ixti = blob.read_shift(2);\r\n    var w = 4;\r\n    if(opts) switch(opts.biff) {\r\n      case 5: w = 15; break;\r\n      case 12: w = 6; break;\r\n    }\r\n    blob.l += w;\r\n    return [type, ixti];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.71 ; [MS-XLSB] 2.5.97.55 */\r\n  var parse_PtgMemErr = parsenoop;\r\n  /* [MS-XLS] 2.5.198.73  ; [MS-XLSB] 2.5.97.57 */\r\n  var parse_PtgMemNoMem = parsenoop;\r\n  /* [MS-XLS] 2.5.198.92 */\r\n  var parse_PtgTbl = parsenoop;\r\n\r\n  function parse_PtgElfLoc(blob, length, opts) {\r\n    blob.l += 2;\r\n    return [parse_RgceElfLoc(blob, 4, opts)];\r\n  }\r\n  function parse_PtgElfNoop(blob) {\r\n    blob.l += 6;\r\n    return [];\r\n  }\r\n  /* [MS-XLS] 2.5.198.46 */\r\n  var parse_PtgElfCol = parse_PtgElfLoc;\r\n  /* [MS-XLS] 2.5.198.47 */\r\n  var parse_PtgElfColS = parse_PtgElfNoop;\r\n  /* [MS-XLS] 2.5.198.48 */\r\n  var parse_PtgElfColSV = parse_PtgElfNoop;\r\n  /* [MS-XLS] 2.5.198.49 */\r\n  var parse_PtgElfColV = parse_PtgElfLoc;\r\n  /* [MS-XLS] 2.5.198.50 */\r\n  function parse_PtgElfLel(blob) {\r\n    blob.l += 2;\r\n    return [parseuint16(blob), blob.read_shift(2) & 0x01];\r\n  }\r\n  /* [MS-XLS] 2.5.198.51 */\r\n  var parse_PtgElfRadical = parse_PtgElfLoc;\r\n  /* [MS-XLS] 2.5.198.52 */\r\n  var parse_PtgElfRadicalLel = parse_PtgElfLel;\r\n  /* [MS-XLS] 2.5.198.53 */\r\n  var parse_PtgElfRadicalS = parse_PtgElfNoop;\r\n  /* [MS-XLS] 2.5.198.54 */\r\n  var parse_PtgElfRw = parse_PtgElfLoc;\r\n  /* [MS-XLS] 2.5.198.55 */\r\n  var parse_PtgElfRwV = parse_PtgElfLoc;\r\n\r\n  /* [MS-XLSB] 2.5.97.52 TODO */\r\n  var PtgListRT = [\r\n    \"Data\",\r\n    \"All\",\r\n    \"Headers\",\r\n    \"??\",\r\n    \"?Data2\",\r\n    \"??\",\r\n    \"?DataHeaders\",\r\n    \"??\",\r\n    \"Totals\",\r\n    \"??\",\r\n    \"??\",\r\n    \"??\",\r\n    \"?DataTotals\",\r\n    \"??\",\r\n    \"??\",\r\n    \"??\",\r\n    \"?Current\"\r\n  ];\r\n  function parse_PtgList(blob) {\r\n    blob.l += 2;\r\n    var ixti = blob.read_shift(2);\r\n    var flags = blob.read_shift(2);\r\n    var idx = blob.read_shift(4);\r\n    var c = blob.read_shift(2);\r\n    var C = blob.read_shift(2);\r\n    var rt = PtgListRT[(flags >> 2) & 0x1F];\r\n    return {ixti: ixti, coltype:(flags&0x3), rt:rt, idx:idx, c:c, C:C};\r\n  }\r\n  /* [MS-XLS] 2.5.198.91 ; [MS-XLSB] 2.5.97.76 */\r\n  function parse_PtgSxName(blob) {\r\n    blob.l += 2;\r\n    return [blob.read_shift(4)];\r\n  }\r\n\r\n  /* [XLS] old spec */\r\n  function parse_PtgSheet(blob, length, opts) {\r\n    blob.l += 5;\r\n    blob.l += 2;\r\n    blob.l += (opts.biff == 2 ? 1 : 4);\r\n    return [\"PTGSHEET\"];\r\n  }\r\n  function parse_PtgEndSheet(blob, length, opts) {\r\n    blob.l += (opts.biff == 2 ? 4 : 5);\r\n    return [\"PTGENDSHEET\"];\r\n  }\r\n  function parse_PtgMemAreaN(blob) {\r\n    var type = (blob.read_shift(1) >>> 5) & 0x03;\r\n    var cce = blob.read_shift(2);\r\n    return [type, cce];\r\n  }\r\n  function parse_PtgMemNoMemN(blob) {\r\n    var type = (blob.read_shift(1) >>> 5) & 0x03;\r\n    var cce = blob.read_shift(2);\r\n    return [type, cce];\r\n  }\r\n  function parse_PtgAttrNoop(blob) {\r\n    blob.l += 4;\r\n    return [0, 0];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.25 ; [MS-XLSB] 2.5.97.16 */\r\n  var PtgTypes = {\r\n    0x01: { n:'PtgExp', f:parse_PtgExp },\r\n    0x02: { n:'PtgTbl', f:parse_PtgTbl },\r\n    0x03: { n:'PtgAdd', f:parseread1 },\r\n    0x04: { n:'PtgSub', f:parseread1 },\r\n    0x05: { n:'PtgMul', f:parseread1 },\r\n    0x06: { n:'PtgDiv', f:parseread1 },\r\n    0x07: { n:'PtgPower', f:parseread1 },\r\n    0x08: { n:'PtgConcat', f:parseread1 },\r\n    0x09: { n:'PtgLt', f:parseread1 },\r\n    0x0A: { n:'PtgLe', f:parseread1 },\r\n    0x0B: { n:'PtgEq', f:parseread1 },\r\n    0x0C: { n:'PtgGe', f:parseread1 },\r\n    0x0D: { n:'PtgGt', f:parseread1 },\r\n    0x0E: { n:'PtgNe', f:parseread1 },\r\n    0x0F: { n:'PtgIsect', f:parseread1 },\r\n    0x10: { n:'PtgUnion', f:parseread1 },\r\n    0x11: { n:'PtgRange', f:parseread1 },\r\n    0x12: { n:'PtgUplus', f:parseread1 },\r\n    0x13: { n:'PtgUminus', f:parseread1 },\r\n    0x14: { n:'PtgPercent', f:parseread1 },\r\n    0x15: { n:'PtgParen', f:parseread1 },\r\n    0x16: { n:'PtgMissArg', f:parseread1 },\r\n    0x17: { n:'PtgStr', f:parse_PtgStr },\r\n    0x1A: { n:'PtgSheet', f:parse_PtgSheet },\r\n    0x1B: { n:'PtgEndSheet', f:parse_PtgEndSheet },\r\n    0x1C: { n:'PtgErr', f:parse_PtgErr },\r\n    0x1D: { n:'PtgBool', f:parse_PtgBool },\r\n    0x1E: { n:'PtgInt', f:parse_PtgInt },\r\n    0x1F: { n:'PtgNum', f:parse_PtgNum },\r\n    0x20: { n:'PtgArray', f:parse_PtgArray },\r\n    0x21: { n:'PtgFunc', f:parse_PtgFunc },\r\n    0x22: { n:'PtgFuncVar', f:parse_PtgFuncVar },\r\n    0x23: { n:'PtgName', f:parse_PtgName },\r\n    0x24: { n:'PtgRef', f:parse_PtgRef },\r\n    0x25: { n:'PtgArea', f:parse_PtgArea },\r\n    0x26: { n:'PtgMemArea', f:parse_PtgMemArea },\r\n    0x27: { n:'PtgMemErr', f:parse_PtgMemErr },\r\n    0x28: { n:'PtgMemNoMem', f:parse_PtgMemNoMem },\r\n    0x29: { n:'PtgMemFunc', f:parse_PtgMemFunc },\r\n    0x2A: { n:'PtgRefErr', f:parse_PtgRefErr },\r\n    0x2B: { n:'PtgAreaErr', f:parse_PtgAreaErr },\r\n    0x2C: { n:'PtgRefN', f:parse_PtgRefN },\r\n    0x2D: { n:'PtgAreaN', f:parse_PtgAreaN },\r\n    0x2E: { n:'PtgMemAreaN', f:parse_PtgMemAreaN },\r\n    0x2F: { n:'PtgMemNoMemN', f:parse_PtgMemNoMemN },\r\n    0x39: { n:'PtgNameX', f:parse_PtgNameX },\r\n    0x3A: { n:'PtgRef3d', f:parse_PtgRef3d },\r\n    0x3B: { n:'PtgArea3d', f:parse_PtgArea3d },\r\n    0x3C: { n:'PtgRefErr3d', f:parse_PtgRefErr3d },\r\n    0x3D: { n:'PtgAreaErr3d', f:parse_PtgAreaErr3d },\r\n    0xFF: {}\r\n  };\r\n  /* These are duplicated in the PtgTypes table */\r\n  var PtgDupes = {\r\n    0x40: 0x20, 0x60: 0x20,\r\n    0x41: 0x21, 0x61: 0x21,\r\n    0x42: 0x22, 0x62: 0x22,\r\n    0x43: 0x23, 0x63: 0x23,\r\n    0x44: 0x24, 0x64: 0x24,\r\n    0x45: 0x25, 0x65: 0x25,\r\n    0x46: 0x26, 0x66: 0x26,\r\n    0x47: 0x27, 0x67: 0x27,\r\n    0x48: 0x28, 0x68: 0x28,\r\n    0x49: 0x29, 0x69: 0x29,\r\n    0x4A: 0x2A, 0x6A: 0x2A,\r\n    0x4B: 0x2B, 0x6B: 0x2B,\r\n    0x4C: 0x2C, 0x6C: 0x2C,\r\n    0x4D: 0x2D, 0x6D: 0x2D,\r\n    0x4E: 0x2E, 0x6E: 0x2E,\r\n    0x4F: 0x2F, 0x6F: 0x2F,\r\n    0x58: 0x22, 0x78: 0x22,\r\n    0x59: 0x39, 0x79: 0x39,\r\n    0x5A: 0x3A, 0x7A: 0x3A,\r\n    0x5B: 0x3B, 0x7B: 0x3B,\r\n    0x5C: 0x3C, 0x7C: 0x3C,\r\n    0x5D: 0x3D, 0x7D: 0x3D\r\n  };\r\n  (function(){for(var y in PtgDupes) PtgTypes[y] = PtgTypes[PtgDupes[y]];})();\r\n\r\n  var Ptg18 = {\r\n    0x01: { n:'PtgElfLel', f:parse_PtgElfLel },\r\n    0x02: { n:'PtgElfRw', f:parse_PtgElfRw },\r\n    0x03: { n:'PtgElfCol', f:parse_PtgElfCol },\r\n    0x06: { n:'PtgElfRwV', f:parse_PtgElfRwV },\r\n    0x07: { n:'PtgElfColV', f:parse_PtgElfColV },\r\n    0x0A: { n:'PtgElfRadical', f:parse_PtgElfRadical },\r\n    0x0B: { n:'PtgElfRadicalS', f:parse_PtgElfRadicalS },\r\n    0x0D: { n:'PtgElfColS', f:parse_PtgElfColS },\r\n    0x0F: { n:'PtgElfColSV', f:parse_PtgElfColSV },\r\n    0x10: { n:'PtgElfRadicalLel', f:parse_PtgElfRadicalLel },\r\n    0x19: { n:'PtgList', f:parse_PtgList },\r\n    0x1D: { n:'PtgSxName', f:parse_PtgSxName },\r\n    0xFF: {}\r\n  };\r\n  var Ptg19 = {\r\n    0x00: { n:'PtgAttrNoop', f:parse_PtgAttrNoop },\r\n    0x01: { n:'PtgAttrSemi', f:parse_PtgAttrSemi },\r\n    0x02: { n:'PtgAttrIf', f:parse_PtgAttrIf },\r\n    0x04: { n:'PtgAttrChoose', f:parse_PtgAttrChoose },\r\n    0x08: { n:'PtgAttrGoto', f:parse_PtgAttrGoto },\r\n    0x10: { n:'PtgAttrSum', f:parse_PtgAttrSum },\r\n    0x20: { n:'PtgAttrBaxcel', f:parse_PtgAttrBaxcel },\r\n    0x40: { n:'PtgAttrSpace', f:parse_PtgAttrSpace },\r\n    0x41: { n:'PtgAttrSpaceSemi', f:parse_PtgAttrSpaceSemi },\r\n    0x80: { n:'PtgAttrIfError', f:parse_PtgAttrIfError },\r\n    0xFF: {}\r\n  };\r\n  Ptg19[0x21] = Ptg19[0x20];\r\n\r\n  /* [MS-XLS] 2.5.198.103 ; [MS-XLSB] 2.5.97.87 */\r\n  function parse_RgbExtra(blob, length, rgce, opts) {\r\n    if(opts.biff < 8) return parsenoop(blob, length);\r\n    var target = blob.l + length;\r\n    var o = [];\r\n    for(var i = 0; i !== rgce.length; ++i) {\r\n      switch(rgce[i][0]) {\r\n        case 'PtgArray': /* PtgArray -> PtgExtraArray */\r\n          rgce[i][1] = parse_PtgExtraArray(blob, 0, opts);\r\n          o.push(rgce[i][1]);\r\n          break;\r\n        case 'PtgMemArea': /* PtgMemArea -> PtgExtraMem */\r\n          rgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1], opts);\r\n          o.push(rgce[i][2]);\r\n          break;\r\n        case 'PtgExp': /* PtgExp -> PtgExtraCol */\r\n          if(opts && opts.biff == 12) {\r\n            rgce[i][1][1] = blob.read_shift(4);\r\n            o.push(rgce[i][1]);\r\n          } break;\r\n        case 'PtgList': /* TODO: PtgList -> PtgExtraList */\r\n        case 'PtgElfRadicalS': /* TODO: PtgElfRadicalS -> PtgExtraElf */\r\n        case 'PtgElfColS': /* TODO: PtgElfColS -> PtgExtraElf */\r\n        case 'PtgElfColSV': /* TODO: PtgElfColSV -> PtgExtraElf */\r\n          throw \"Unsupported \" + rgce[i][0];\r\n        default: break;\r\n      }\r\n    }\r\n    length = target - blob.l;\r\n    /* note: this is technically an error but Excel disregards */\r\n    //if(target !== blob.l && blob.l !== target - length) throw new Error(target + \" != \" + blob.l);\r\n    if(length !== 0) o.push(parsenoop(blob, length));\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.104 ; [MS-XLSB] 2.5.97.88 */\r\n  function parse_Rgce(blob, length, opts) {\r\n    var target = blob.l + length;\r\n    var R, id, ptgs = [];\r\n    while(target != blob.l) {\r\n      length = target - blob.l;\r\n      id = blob[blob.l];\r\n      R = PtgTypes[id];\r\n      if(id === 0x18 || id === 0x19) R = (id === 0x18 ? Ptg18 : Ptg19)[blob[blob.l + 1]];\r\n      if(!R || !R.f) { /*ptgs.push*/(parsenoop(blob, length)); }\r\n      else { ptgs.push([R.n, R.f(blob, length, opts)]); }\r\n    }\r\n    return ptgs;\r\n  }\r\n\r\n  function stringify_array(f) {\r\n    var o = [];\r\n    for(var i = 0; i < f.length; ++i) {\r\n      var x = f[i], r = [];\r\n      for(var j = 0; j < x.length; ++j) {\r\n        var y = x[j];\r\n        if(y) switch(y[0]) {\r\n          // TODO: handle embedded quotes\r\n          case 0x02:\r\n            r.push('\"' + y[1].replace(/\"/g,'\"\"') + '\"'); break;\r\n          default: r.push(y[1]);\r\n        } else r.push(\"\");\r\n      }\r\n      o.push(r.join(\",\"));\r\n    }\r\n    return o.join(\";\");\r\n  }\r\n\r\n  /* [MS-XLS] 2.2.2 ; [MS-XLSB] 2.2.2 TODO */\r\n  var PtgBinOp = {\r\n    PtgAdd: \"+\",\r\n    PtgConcat: \"&\",\r\n    PtgDiv: \"/\",\r\n    PtgEq: \"=\",\r\n    PtgGe: \">=\",\r\n    PtgGt: \">\",\r\n    PtgLe: \"<=\",\r\n    PtgLt: \"<\",\r\n    PtgMul: \"*\",\r\n    PtgNe: \"<>\",\r\n    PtgPower: \"^\",\r\n    PtgSub: \"-\"\r\n  };\r\n  function formula_quote_sheet_name(sname, opts) {\r\n    if(!sname && !(opts && opts.biff <= 5 && opts.biff >= 2)) throw new Error(\"empty sheet name\");\r\n    if(sname.indexOf(\" \") > -1) return \"'\" + sname + \"'\";\r\n    return sname;\r\n  }\r\n  function get_ixti_raw(supbooks, ixti, opts) {\r\n    if(!supbooks) return \"SH33TJSERR0\";\r\n    if(opts.biff > 8 && (!supbooks.XTI || !supbooks.XTI[ixti])) return supbooks.SheetNames[ixti];\r\n    if(!supbooks.XTI) return \"SH33TJSERR6\";\r\n    var XTI = supbooks.XTI[ixti];\r\n    if(opts.biff < 8) {\r\n      if(ixti > 10000) ixti-= 65536;\r\n      if(ixti < 0) ixti = -ixti;\r\n      return ixti == 0 ? \"\" : supbooks.XTI[ixti - 1];\r\n    }\r\n    if(!XTI) return \"SH33TJSERR1\";\r\n    var o = \"\";\r\n    if(opts.biff > 8) switch(supbooks[XTI[0]][0]) {\r\n      case 0x0165: /* 'BrtSupSelf' */\r\n        o = XTI[1] == -1 ? \"#REF\" : supbooks.SheetNames[XTI[1]];\r\n        return XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\r\n      case 0x0166: /* 'BrtSupSame' */\r\n        if(opts.SID != null) return supbooks.SheetNames[opts.SID];\r\n        return \"SH33TJSSAME\" + supbooks[XTI[0]][0];\r\n      case 0x0163: /* 'BrtSupBookSrc' */\r\n      /* falls through */\r\n      default: return \"SH33TJSSRC\" + supbooks[XTI[0]][0];\r\n    }\r\n    switch(supbooks[XTI[0]][0][0]) {\r\n      case 0x0401:\r\n        o = XTI[1] == -1 ? \"#REF\" : (supbooks.SheetNames[XTI[1]] || \"SH33TJSERR3\");\r\n        return XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\r\n      case 0x3A01: return \"SH33TJSERR8\";\r\n      default:\r\n        if(!supbooks[XTI[0]][0][3]) return \"SH33TJSERR2\";\r\n        o = XTI[1] == -1 ? \"#REF\" : (supbooks[XTI[0]][0][3][XTI[1]] || \"SH33TJSERR4\");\r\n        return XTI[1] == XTI[2] ? o : o + \":\" + supbooks[XTI[0]][0][3][XTI[2]];\r\n    }\r\n  }\r\n  function get_ixti(supbooks, ixti, opts) {\r\n    return formula_quote_sheet_name(get_ixti_raw(supbooks, ixti, opts), opts);\r\n  }\r\n  function stringify_formula(formula/*Array<any>*/, range, cell, supbooks, opts) {\r\n    var biff = (opts && opts.biff) || 8;\r\n    var _range = /*range != null ? range :*/ {s:{c:0, r:0},e:{c:0, r:0}};\r\n    var stack = [], e1, e2,  c, ixti=0, nameidx=0, r, sname=\"\";\r\n    if(!formula[0] || !formula[0][0]) return \"\";\r\n    var last_sp = -1, sp = \"\";\r\n    for(var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\r\n      var f = formula[0][ff];\r\n      switch(f[0]) {\r\n        case 'PtgUminus': /* [MS-XLS] 2.5.198.93 */\r\n          stack.push(\"-\" + stack.pop()); break;\r\n        case 'PtgUplus': /* [MS-XLS] 2.5.198.95 */\r\n          stack.push(\"+\" + stack.pop()); break;\r\n        case 'PtgPercent': /* [MS-XLS] 2.5.198.81 */\r\n          stack.push(stack.pop() + \"%\"); break;\r\n\r\n        case 'PtgAdd':    /* [MS-XLS] 2.5.198.26 */\r\n        case 'PtgConcat': /* [MS-XLS] 2.5.198.43 */\r\n        case 'PtgDiv':    /* [MS-XLS] 2.5.198.45 */\r\n        case 'PtgEq':     /* [MS-XLS] 2.5.198.56 */\r\n        case 'PtgGe':     /* [MS-XLS] 2.5.198.64 */\r\n        case 'PtgGt':     /* [MS-XLS] 2.5.198.65 */\r\n        case 'PtgLe':     /* [MS-XLS] 2.5.198.68 */\r\n        case 'PtgLt':     /* [MS-XLS] 2.5.198.69 */\r\n        case 'PtgMul':    /* [MS-XLS] 2.5.198.75 */\r\n        case 'PtgNe':     /* [MS-XLS] 2.5.198.78 */\r\n        case 'PtgPower':  /* [MS-XLS] 2.5.198.82 */\r\n        case 'PtgSub':    /* [MS-XLS] 2.5.198.90 */\r\n          e1 = stack.pop(); e2 = stack.pop();\r\n          if(last_sp >= 0) {\r\n            switch(formula[0][last_sp][1][0]) {\r\n              case 0:\r\n                // $FlowIgnore\r\n                sp = fill(\" \", formula[0][last_sp][1][1]); break;\r\n              case 1:\r\n                // $FlowIgnore\r\n                sp = fill(\"\\r\", formula[0][last_sp][1][1]); break;\r\n              default:\r\n                sp = \"\";\r\n                // $FlowIgnore\r\n                if(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\r\n            }\r\n            e2 = e2 + sp;\r\n            last_sp = -1;\r\n          }\r\n          stack.push(e2+PtgBinOp[f[0]]+e1);\r\n          break;\r\n\r\n        case 'PtgIsect': /* [MS-XLS] 2.5.198.67 */\r\n          e1 = stack.pop(); e2 = stack.pop();\r\n          stack.push(e2+\" \"+e1);\r\n          break;\r\n        case 'PtgUnion': /* [MS-XLS] 2.5.198.94 */\r\n          e1 = stack.pop(); e2 = stack.pop();\r\n          stack.push(e2+\",\"+e1);\r\n          break;\r\n        case 'PtgRange': /* [MS-XLS] 2.5.198.83 */\r\n          e1 = stack.pop(); e2 = stack.pop();\r\n          stack.push(e2+\":\"+e1);\r\n          break;\r\n\r\n        case 'PtgAttrChoose': /* [MS-XLS] 2.5.198.34 */\r\n          break;\r\n        case 'PtgAttrGoto': /* [MS-XLS] 2.5.198.35 */\r\n          break;\r\n        case 'PtgAttrIf': /* [MS-XLS] 2.5.198.36 */\r\n          break;\r\n        case 'PtgAttrIfError': /* [MS-XLSB] 2.5.97.28 */\r\n          break;\r\n\r\n\r\n        case 'PtgRef': /* [MS-XLS] 2.5.198.84 */\r\n          c = shift_cell_xls((f[1][1]), _range, opts);\r\n          stack.push(encode_cell_xls(c, biff));\r\n          break;\r\n        case 'PtgRefN': /* [MS-XLS] 2.5.198.88 */\r\n          c = cell ? shift_cell_xls((f[1][1]), cell, opts) : (f[1][1]);\r\n          stack.push(encode_cell_xls(c, biff));\r\n          break;\r\n        case 'PtgRef3d': /* [MS-XLS] 2.5.198.85 */\r\n          ixti = f[1][1]; c = shift_cell_xls((f[1][2]), _range, opts);\r\n          sname = get_ixti(supbooks, ixti, opts);\r\n          var w = sname; /* IE9 fails on defined names */ // eslint-disable-line no-unused-vars\r\n          stack.push(sname + \"!\" + encode_cell_xls(c, biff));\r\n          break;\r\n\r\n        case 'PtgFunc': /* [MS-XLS] 2.5.198.62 */\r\n        case 'PtgFuncVar': /* [MS-XLS] 2.5.198.63 */\r\n          /* f[1] = [argc, func, type] */\r\n          var argc = (f[1][0]), func = (f[1][1]);\r\n          if(!argc) argc = 0;\r\n          argc &= 0x7F;\r\n          var args = argc == 0 ? [] : stack.slice(-argc);\r\n          stack.length -= argc;\r\n          if(func === 'User') func = args.shift();\r\n          stack.push(func + \"(\" + args.join(\",\") + \")\");\r\n          break;\r\n\r\n        case 'PtgBool': /* [MS-XLS] 2.5.198.42 */\r\n          stack.push(f[1] ? \"TRUE\" : \"FALSE\"); break;\r\n        case 'PtgInt': /* [MS-XLS] 2.5.198.66 */\r\n          stack.push(f[1]); break;\r\n        case 'PtgNum': /* [MS-XLS] 2.5.198.79 TODO: precision? */\r\n          stack.push(String(f[1])); break;\r\n        case 'PtgStr': /* [MS-XLS] 2.5.198.89 */\r\n          // $FlowIgnore\r\n          stack.push('\"' + f[1] + '\"'); break;\r\n        case 'PtgErr': /* [MS-XLS] 2.5.198.57 */\r\n          stack.push(f[1]); break;\r\n        case 'PtgAreaN': /* [MS-XLS] 2.5.198.31 TODO */\r\n          r = shift_range_xls(f[1][1], cell ? {s:cell} : _range, opts);\r\n          stack.push(encode_range_xls((r), opts));\r\n          break;\r\n        case 'PtgArea': /* [MS-XLS] 2.5.198.27 TODO: fixed points */\r\n          r = shift_range_xls(f[1][1], _range, opts);\r\n          stack.push(encode_range_xls((r), opts));\r\n          break;\r\n        case 'PtgArea3d': /* [MS-XLS] 2.5.198.28 TODO */\r\n          ixti = f[1][1]; r = f[1][2];\r\n          sname = get_ixti(supbooks, ixti, opts);\r\n          stack.push(sname + \"!\" + encode_range_xls((r), opts));\r\n          break;\r\n        case 'PtgAttrSum': /* [MS-XLS] 2.5.198.41 */\r\n          stack.push(\"SUM(\" + stack.pop() + \")\");\r\n          break;\r\n\r\n        case 'PtgAttrBaxcel': /* [MS-XLS] 2.5.198.33 */\r\n        case 'PtgAttrSemi': /* [MS-XLS] 2.5.198.37 */\r\n          break;\r\n\r\n        case 'PtgName': /* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 TODO: revisions */\r\n          /* f[1] = type, 0, nameindex */\r\n          nameidx = (f[1][2]);\r\n          var lbl = (supbooks.names||[])[nameidx-1] || (supbooks[0]||[])[nameidx];\r\n          var name = lbl ? lbl.Name : \"SH33TJSNAME\" + String(nameidx);\r\n          if(name in XLSXFutureFunctions) name = XLSXFutureFunctions[name];\r\n          stack.push(name);\r\n          break;\r\n\r\n        case 'PtgNameX': /* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 TODO: revisions */\r\n          /* f[1] = type, ixti, nameindex */\r\n          var bookidx = (f[1][1]); nameidx = (f[1][2]); var externbook;\r\n          /* TODO: Properly handle missing values */\r\n          if(opts.biff <= 5) {\r\n            if(bookidx < 0) bookidx = -bookidx;\r\n            if(supbooks[bookidx]) externbook = supbooks[bookidx][nameidx];\r\n          } else {\r\n            var o = \"\";\r\n            if(((supbooks[bookidx]||[])[0]||[])[0] == 0x3A01){/* empty */}\r\n            else if(((supbooks[bookidx]||[])[0]||[])[0] == 0x0401){\r\n              if(supbooks[bookidx][nameidx] && supbooks[bookidx][nameidx].itab > 0) {\r\n                o = supbooks.SheetNames[supbooks[bookidx][nameidx].itab-1] + \"!\";\r\n              }\r\n            }\r\n            else o = supbooks.SheetNames[nameidx-1]+ \"!\";\r\n            if(supbooks[bookidx] && supbooks[bookidx][nameidx]) o += supbooks[bookidx][nameidx].Name;\r\n            else if(supbooks[0] && supbooks[0][nameidx]) o += supbooks[0][nameidx].Name;\r\n            else o += \"SH33TJSERRX\";\r\n            stack.push(o);\r\n            break;\r\n          }\r\n          if(!externbook) externbook = {Name: \"SH33TJSERRY\"};\r\n          stack.push(externbook.Name);\r\n          break;\r\n\r\n        case 'PtgParen': /* [MS-XLS] 2.5.198.80 */\r\n          var lp = '(', rp = ')';\r\n          if(last_sp >= 0) {\r\n            sp = \"\";\r\n            switch(formula[0][last_sp][1][0]) {\r\n              // $FlowIgnore\r\n              case 2: lp = fill(\" \", formula[0][last_sp][1][1]) + lp; break;\r\n              // $FlowIgnore\r\n              case 3: lp = fill(\"\\r\", formula[0][last_sp][1][1]) + lp; break;\r\n              // $FlowIgnore\r\n              case 4: rp = fill(\" \", formula[0][last_sp][1][1]) + rp; break;\r\n              // $FlowIgnore\r\n              case 5: rp = fill(\"\\r\", formula[0][last_sp][1][1]) + rp; break;\r\n              default:\r\n                // $FlowIgnore\r\n                if(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\r\n            }\r\n            last_sp = -1;\r\n          }\r\n          stack.push(lp + stack.pop() + rp); break;\r\n\r\n        case 'PtgRefErr': /* [MS-XLS] 2.5.198.86 */\r\n          stack.push('#REF!'); break;\r\n\r\n        case 'PtgRefErr3d': /* [MS-XLS] 2.5.198.87 */\r\n          stack.push('#REF!'); break;\r\n\r\n        case 'PtgExp': /* [MS-XLS] 2.5.198.58 TODO */\r\n          c = {c:(f[1][1]),r:(f[1][0])};\r\n          var q = ({c: cell.c, r:cell.r});\r\n          if(supbooks.sharedf[encode_cell(c)]) {\r\n            var parsedf = (supbooks.sharedf[encode_cell(c)]);\r\n            stack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\r\n          }\r\n          else {\r\n            var fnd = false;\r\n            for(e1=0;e1!=supbooks.arrayf.length; ++e1) {\r\n              /* TODO: should be something like range_has */\r\n              e2 = supbooks.arrayf[e1];\r\n              if(c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\r\n              if(c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\r\n              stack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\r\n              fnd = true;\r\n              break;\r\n            }\r\n            if(!fnd) stack.push(f[1]);\r\n          }\r\n          break;\r\n\r\n        case 'PtgArray': /* [MS-XLS] 2.5.198.32 TODO */\r\n          stack.push(\"{\" + stringify_array(f[1]) + \"}\");\r\n          break;\r\n\r\n        case 'PtgMemArea': /* [MS-XLS] 2.5.198.70 TODO: confirm this is a non-display */\r\n          //stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\r\n          break;\r\n\r\n        case 'PtgAttrSpace': /* [MS-XLS] 2.5.198.38 */\r\n        case 'PtgAttrSpaceSemi': /* [MS-XLS] 2.5.198.39 */\r\n          last_sp = ff;\r\n          break;\r\n\r\n        case 'PtgTbl': /* [MS-XLS] 2.5.198.92 TODO */\r\n          break;\r\n\r\n        case 'PtgMemErr': /* [MS-XLS] 2.5.198.71 */\r\n          break;\r\n\r\n        case 'PtgMissArg': /* [MS-XLS] 2.5.198.74 */\r\n          stack.push(\"\");\r\n          break;\r\n\r\n        case 'PtgAreaErr': /* [MS-XLS] 2.5.198.29 */\r\n          stack.push(\"#REF!\"); break;\r\n\r\n        case 'PtgAreaErr3d': /* [MS-XLS] 2.5.198.30 */\r\n          stack.push(\"#REF!\"); break;\r\n\r\n        case 'PtgList': /* [MS-XLSB] 2.5.97.52 */\r\n          // $FlowIgnore\r\n          stack.push(\"Table\" + f[1].idx + \"[#\" + f[1].rt + \"]\");\r\n          break;\r\n\r\n        case 'PtgMemAreaN':\r\n        case 'PtgMemNoMemN':\r\n        case 'PtgAttrNoop':\r\n        case 'PtgSheet':\r\n        case 'PtgEndSheet':\r\n          break;\r\n\r\n        case 'PtgMemFunc': /* [MS-XLS] 2.5.198.72 TODO */\r\n          break;\r\n        case 'PtgMemNoMem': /* [MS-XLS] 2.5.198.73 TODO */\r\n          break;\r\n\r\n        case 'PtgElfCol': /* [MS-XLS] 2.5.198.46 */\r\n        case 'PtgElfColS': /* [MS-XLS] 2.5.198.47 */\r\n        case 'PtgElfColSV': /* [MS-XLS] 2.5.198.48 */\r\n        case 'PtgElfColV': /* [MS-XLS] 2.5.198.49 */\r\n        case 'PtgElfLel': /* [MS-XLS] 2.5.198.50 */\r\n        case 'PtgElfRadical': /* [MS-XLS] 2.5.198.51 */\r\n        case 'PtgElfRadicalLel': /* [MS-XLS] 2.5.198.52 */\r\n        case 'PtgElfRadicalS': /* [MS-XLS] 2.5.198.53 */\r\n        case 'PtgElfRw': /* [MS-XLS] 2.5.198.54 */\r\n        case 'PtgElfRwV': /* [MS-XLS] 2.5.198.55 */\r\n          throw new Error(\"Unsupported ELFs\");\r\n\r\n        case 'PtgSxName': /* [MS-XLS] 2.5.198.91 TODO -- find a test case */\r\n          throw new Error('Unrecognized Formula Token: ' + String(f));\r\n        default: throw new Error('Unrecognized Formula Token: ' + String(f));\r\n      }\r\n      var PtgNonDisp = ['PtgAttrSpace', 'PtgAttrSpaceSemi', 'PtgAttrGoto'];\r\n      if(opts.biff != 3) if(last_sp >= 0 && PtgNonDisp.indexOf(formula[0][ff][0]) == -1) {\r\n        f = formula[0][last_sp];\r\n        var _left = true;\r\n        switch(f[1][0]) {\r\n          /* note: some bad XLSB files omit the PtgParen */\r\n          case 4: _left = false;\r\n          /* falls through */\r\n          case 0:\r\n            // $FlowIgnore\r\n            sp = fill(\" \", f[1][1]); break;\r\n          case 5: _left = false;\r\n          /* falls through */\r\n          case 1:\r\n            // $FlowIgnore\r\n            sp = fill(\"\\r\", f[1][1]); break;\r\n          default:\r\n            sp = \"\";\r\n            // $FlowIgnore\r\n            if(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + f[1][0]);\r\n        }\r\n        stack.push((_left ? sp : \"\") + stack.pop() + (_left ? \"\" : sp));\r\n        last_sp = -1;\r\n      }\r\n    }\r\n    if(stack.length > 1 && opts.WTF) throw new Error(\"bad formula stack\");\r\n    return stack[0];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.1 TODO */\r\n  function parse_ArrayParsedFormula(blob, length, opts) {\r\n    var target = blob.l + length, len = opts.biff == 2 ? 1 : 2;\r\n    var rgcb, cce = blob.read_shift(len); // length of rgce\r\n    if(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\r\n    var rgce = parse_Rgce(blob, cce, opts);\r\n    if(length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\r\n    blob.l = target;\r\n    return [rgce, rgcb];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.3 TODO */\r\n  function parse_XLSCellParsedFormula(blob, length, opts) {\r\n    var target = blob.l + length, len = opts.biff == 2 ? 1 : 2;\r\n    var rgcb, cce = blob.read_shift(len); // length of rgce\r\n    if(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\r\n    var rgce = parse_Rgce(blob, cce, opts);\r\n    if(length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\r\n    blob.l = target;\r\n    return [rgce, rgcb];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.21 */\r\n  function parse_NameParsedFormula(blob, length, opts, cce) {\r\n    var target = blob.l + length;\r\n    var rgce = parse_Rgce(blob, cce, opts);\r\n    var rgcb;\r\n    if(target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\r\n    return [rgce, rgcb];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.198.118 TODO */\r\n  function parse_SharedParsedFormula(blob, length, opts) {\r\n    var target = blob.l + length;\r\n    var rgcb, cce = blob.read_shift(2); // length of rgce\r\n    var rgce = parse_Rgce(blob, cce, opts);\r\n    if(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\r\n    if(length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\r\n    return [rgce, rgcb];\r\n  }\r\n\r\n  /* [MS-XLS] 2.5.133 TODO: how to emit empty strings? */\r\n  function parse_FormulaValue(blob) {\r\n    var b;\r\n    if(__readUInt16LE(blob,blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob),'n'];\r\n    switch(blob[blob.l]) {\r\n      case 0x00: blob.l += 8; return [\"String\", 's'];\r\n      case 0x01: b = blob[blob.l+2] === 0x1; blob.l += 8; return [b,'b'];\r\n      case 0x02: b = blob[blob.l+2]; blob.l += 8; return [b,'e'];\r\n      case 0x03: blob.l += 8; return [\"\",'s'];\r\n    }\r\n    return [];\r\n  }\r\n\r\n  /* [MS-XLS] 2.4.127 TODO */\r\n  function parse_Formula(blob, length, opts) {\r\n    var end = blob.l + length;\r\n    var cell = parse_XLSCell(blob, 6);\r\n    if(opts.biff == 2) ++blob.l;\r\n    var val = parse_FormulaValue(blob,8);\r\n    var flags = blob.read_shift(1);\r\n    if(opts.biff != 2) {\r\n      blob.read_shift(1);\r\n      if(opts.biff >= 5) {\r\n        /*var chn = */blob.read_shift(4);\r\n      }\r\n    }\r\n    var cbf = parse_XLSCellParsedFormula(blob, end - blob.l, opts);\r\n    return {cell:cell, val:val[0], formula:cbf, shared: (flags >> 3) & 1, tt:val[1]};\r\n  }\r\n\r\n  /* XLSB Parsed Formula records have the same shape */\r\n  function parse_XLSBParsedFormula(data, length, opts) {\r\n    var cce = data.read_shift(4);\r\n    var rgce = parse_Rgce(data, cce, opts);\r\n    var cb = data.read_shift(4);\r\n    var rgcb = cb > 0 ? parse_RgbExtra(data, cb, rgce, opts) : null;\r\n    return [rgce, rgcb];\r\n  }\r\n\r\n  /* [MS-XLSB] 2.5.97.1 ArrayParsedFormula */\r\n  var parse_XLSBArrayParsedFormula = parse_XLSBParsedFormula;\r\n  /* [MS-XLSB] 2.5.97.4 CellParsedFormula */\r\n  var parse_XLSBCellParsedFormula = parse_XLSBParsedFormula;\r\n  /* [MS-XLSB] 2.5.97.12 NameParsedFormula */\r\n  var parse_XLSBNameParsedFormula = parse_XLSBParsedFormula;\r\n  /* [MS-XLSB] 2.5.97.98 SharedParsedFormula */\r\n  var parse_XLSBSharedParsedFormula = parse_XLSBParsedFormula;\r\n  /* [MS-XLS] 2.5.198.4 */\r\n  var Cetab = {\r\n    0x0000: 'BEEP',\r\n    0x0001: 'OPEN',\r\n    0x0002: 'OPEN.LINKS',\r\n    0x0003: 'CLOSE.ALL',\r\n    0x0004: 'SAVE',\r\n    0x0005: 'SAVE.AS',\r\n    0x0006: 'FILE.DELETE',\r\n    0x0007: 'PAGE.SETUP',\r\n    0x0008: 'PRINT',\r\n    0x0009: 'PRINTER.SETUP',\r\n    0x000A: 'QUIT',\r\n    0x000B: 'NEW.WINDOW',\r\n    0x000C: 'ARRANGE.ALL',\r\n    0x000D: 'WINDOW.SIZE',\r\n    0x000E: 'WINDOW.MOVE',\r\n    0x000F: 'FULL',\r\n    0x0010: 'CLOSE',\r\n    0x0011: 'RUN',\r\n    0x0016: 'SET.PRINT.AREA',\r\n    0x0017: 'SET.PRINT.TITLES',\r\n    0x0018: 'SET.PAGE.BREAK',\r\n    0x0019: 'REMOVE.PAGE.BREAK',\r\n    0x001A: 'FONT',\r\n    0x001B: 'DISPLAY',\r\n    0x001C: 'PROTECT.DOCUMENT',\r\n    0x001D: 'PRECISION',\r\n    0x001E: 'A1.R1C1',\r\n    0x001F: 'CALCULATE.NOW',\r\n    0x0020: 'CALCULATION',\r\n    0x0022: 'DATA.FIND',\r\n    0x0023: 'EXTRACT',\r\n    0x0024: 'DATA.DELETE',\r\n    0x0025: 'SET.DATABASE',\r\n    0x0026: 'SET.CRITERIA',\r\n    0x0027: 'SORT',\r\n    0x0028: 'DATA.SERIES',\r\n    0x0029: 'TABLE',\r\n    0x002A: 'FORMAT.NUMBER',\r\n    0x002B: 'ALIGNMENT',\r\n    0x002C: 'STYLE',\r\n    0x002D: 'BORDER',\r\n    0x002E: 'CELL.PROTECTION',\r\n    0x002F: 'COLUMN.WIDTH',\r\n    0x0030: 'UNDO',\r\n    0x0031: 'CUT',\r\n    0x0032: 'COPY',\r\n    0x0033: 'PASTE',\r\n    0x0034: 'CLEAR',\r\n    0x0035: 'PASTE.SPECIAL',\r\n    0x0036: 'EDIT.DELETE',\r\n    0x0037: 'INSERT',\r\n    0x0038: 'FILL.RIGHT',\r\n    0x0039: 'FILL.DOWN',\r\n    0x003D: 'DEFINE.NAME',\r\n    0x003E: 'CREATE.NAMES',\r\n    0x003F: 'FORMULA.GOTO',\r\n    0x0040: 'FORMULA.FIND',\r\n    0x0041: 'SELECT.LAST.CELL',\r\n    0x0042: 'SHOW.ACTIVE.CELL',\r\n    0x0043: 'GALLERY.AREA',\r\n    0x0044: 'GALLERY.BAR',\r\n    0x0045: 'GALLERY.COLUMN',\r\n    0x0046: 'GALLERY.LINE',\r\n    0x0047: 'GALLERY.PIE',\r\n    0x0048: 'GALLERY.SCATTER',\r\n    0x0049: 'COMBINATION',\r\n    0x004A: 'PREFERRED',\r\n    0x004B: 'ADD.OVERLAY',\r\n    0x004C: 'GRIDLINES',\r\n    0x004D: 'SET.PREFERRED',\r\n    0x004E: 'AXES',\r\n    0x004F: 'LEGEND',\r\n    0x0050: 'ATTACH.TEXT',\r\n    0x0051: 'ADD.ARROW',\r\n    0x0052: 'SELECT.CHART',\r\n    0x0053: 'SELECT.PLOT.AREA',\r\n    0x0054: 'PATTERNS',\r\n    0x0055: 'MAIN.CHART',\r\n    0x0056: 'OVERLAY',\r\n    0x0057: 'SCALE',\r\n    0x0058: 'FORMAT.LEGEND',\r\n    0x0059: 'FORMAT.TEXT',\r\n    0x005A: 'EDIT.REPEAT',\r\n    0x005B: 'PARSE',\r\n    0x005C: 'JUSTIFY',\r\n    0x005D: 'HIDE',\r\n    0x005E: 'UNHIDE',\r\n    0x005F: 'WORKSPACE',\r\n    0x0060: 'FORMULA',\r\n    0x0061: 'FORMULA.FILL',\r\n    0x0062: 'FORMULA.ARRAY',\r\n    0x0063: 'DATA.FIND.NEXT',\r\n    0x0064: 'DATA.FIND.PREV',\r\n    0x0065: 'FORMULA.FIND.NEXT',\r\n    0x0066: 'FORMULA.FIND.PREV',\r\n    0x0067: 'ACTIVATE',\r\n    0x0068: 'ACTIVATE.NEXT',\r\n    0x0069: 'ACTIVATE.PREV',\r\n    0x006A: 'UNLOCKED.NEXT',\r\n    0x006B: 'UNLOCKED.PREV',\r\n    0x006C: 'COPY.PICTURE',\r\n    0x006D: 'SELECT',\r\n    0x006E: 'DELETE.NAME',\r\n    0x006F: 'DELETE.FORMAT',\r\n    0x0070: 'VLINE',\r\n    0x0071: 'HLINE',\r\n    0x0072: 'VPAGE',\r\n    0x0073: 'HPAGE',\r\n    0x0074: 'VSCROLL',\r\n    0x0075: 'HSCROLL',\r\n    0x0076: 'ALERT',\r\n    0x0077: 'NEW',\r\n    0x0078: 'CANCEL.COPY',\r\n    0x0079: 'SHOW.CLIPBOARD',\r\n    0x007A: 'MESSAGE',\r\n    0x007C: 'PASTE.LINK',\r\n    0x007D: 'APP.ACTIVATE',\r\n    0x007E: 'DELETE.ARROW',\r\n    0x007F: 'ROW.HEIGHT',\r\n    0x0080: 'FORMAT.MOVE',\r\n    0x0081: 'FORMAT.SIZE',\r\n    0x0082: 'FORMULA.REPLACE',\r\n    0x0083: 'SEND.KEYS',\r\n    0x0084: 'SELECT.SPECIAL',\r\n    0x0085: 'APPLY.NAMES',\r\n    0x0086: 'REPLACE.FONT',\r\n    0x0087: 'FREEZE.PANES',\r\n    0x0088: 'SHOW.INFO',\r\n    0x0089: 'SPLIT',\r\n    0x008A: 'ON.WINDOW',\r\n    0x008B: 'ON.DATA',\r\n    0x008C: 'DISABLE.INPUT',\r\n    0x008E: 'OUTLINE',\r\n    0x008F: 'LIST.NAMES',\r\n    0x0090: 'FILE.CLOSE',\r\n    0x0091: 'SAVE.WORKBOOK',\r\n    0x0092: 'DATA.FORM',\r\n    0x0093: 'COPY.CHART',\r\n    0x0094: 'ON.TIME',\r\n    0x0095: 'WAIT',\r\n    0x0096: 'FORMAT.FONT',\r\n    0x0097: 'FILL.UP',\r\n    0x0098: 'FILL.LEFT',\r\n    0x0099: 'DELETE.OVERLAY',\r\n    0x009B: 'SHORT.MENUS',\r\n    0x009F: 'SET.UPDATE.STATUS',\r\n    0x00A1: 'COLOR.PALETTE',\r\n    0x00A2: 'DELETE.STYLE',\r\n    0x00A3: 'WINDOW.RESTORE',\r\n    0x00A4: 'WINDOW.MAXIMIZE',\r\n    0x00A6: 'CHANGE.LINK',\r\n    0x00A7: 'CALCULATE.DOCUMENT',\r\n    0x00A8: 'ON.KEY',\r\n    0x00A9: 'APP.RESTORE',\r\n    0x00AA: 'APP.MOVE',\r\n    0x00AB: 'APP.SIZE',\r\n    0x00AC: 'APP.MINIMIZE',\r\n    0x00AD: 'APP.MAXIMIZE',\r\n    0x00AE: 'BRING.TO.FRONT',\r\n    0x00AF: 'SEND.TO.BACK',\r\n    0x00B9: 'MAIN.CHART.TYPE',\r\n    0x00BA: 'OVERLAY.CHART.TYPE',\r\n    0x00BB: 'SELECT.END',\r\n    0x00BC: 'OPEN.MAIL',\r\n    0x00BD: 'SEND.MAIL',\r\n    0x00BE: 'STANDARD.FONT',\r\n    0x00BF: 'CONSOLIDATE',\r\n    0x00C0: 'SORT.SPECIAL',\r\n    0x00C1: 'GALLERY.3D.AREA',\r\n    0x00C2: 'GALLERY.3D.COLUMN',\r\n    0x00C3: 'GALLERY.3D.LINE',\r\n    0x00C4: 'GALLERY.3D.PIE',\r\n    0x00C5: 'VIEW.3D',\r\n    0x00C6: 'GOAL.SEEK',\r\n    0x00C7: 'WORKGROUP',\r\n    0x00C8: 'FILL.GROUP',\r\n    0x00C9: 'UPDATE.LINK',\r\n    0x00CA: 'PROMOTE',\r\n    0x00CB: 'DEMOTE',\r\n    0x00CC: 'SHOW.DETAIL',\r\n    0x00CE: 'UNGROUP',\r\n    0x00CF: 'OBJECT.PROPERTIES',\r\n    0x00D0: 'SAVE.NEW.OBJECT',\r\n    0x00D1: 'SHARE',\r\n    0x00D2: 'SHARE.NAME',\r\n    0x00D3: 'DUPLICATE',\r\n    0x00D4: 'APPLY.STYLE',\r\n    0x00D5: 'ASSIGN.TO.OBJECT',\r\n    0x00D6: 'OBJECT.PROTECTION',\r\n    0x00D7: 'HIDE.OBJECT',\r\n    0x00D8: 'SET.EXTRACT',\r\n    0x00D9: 'CREATE.PUBLISHER',\r\n    0x00DA: 'SUBSCRIBE.TO',\r\n    0x00DB: 'ATTRIBUTES',\r\n    0x00DC: 'SHOW.TOOLBAR',\r\n    0x00DE: 'PRINT.PREVIEW',\r\n    0x00DF: 'EDIT.COLOR',\r\n    0x00E0: 'SHOW.LEVELS',\r\n    0x00E1: 'FORMAT.MAIN',\r\n    0x00E2: 'FORMAT.OVERLAY',\r\n    0x00E3: 'ON.RECALC',\r\n    0x00E4: 'EDIT.SERIES',\r\n    0x00E5: 'DEFINE.STYLE',\r\n    0x00F0: 'LINE.PRINT',\r\n    0x00F3: 'ENTER.DATA',\r\n    0x00F9: 'GALLERY.RADAR',\r\n    0x00FA: 'MERGE.STYLES',\r\n    0x00FB: 'EDITION.OPTIONS',\r\n    0x00FC: 'PASTE.PICTURE',\r\n    0x00FD: 'PASTE.PICTURE.LINK',\r\n    0x00FE: 'SPELLING',\r\n    0x0100: 'ZOOM',\r\n    0x0103: 'INSERT.OBJECT',\r\n    0x0104: 'WINDOW.MINIMIZE',\r\n    0x0109: 'SOUND.NOTE',\r\n    0x010A: 'SOUND.PLAY',\r\n    0x010B: 'FORMAT.SHAPE',\r\n    0x010C: 'EXTEND.POLYGON',\r\n    0x010D: 'FORMAT.AUTO',\r\n    0x0110: 'GALLERY.3D.BAR',\r\n    0x0111: 'GALLERY.3D.SURFACE',\r\n    0x0112: 'FILL.AUTO',\r\n    0x0114: 'CUSTOMIZE.TOOLBAR',\r\n    0x0115: 'ADD.TOOL',\r\n    0x0116: 'EDIT.OBJECT',\r\n    0x0117: 'ON.DOUBLECLICK',\r\n    0x0118: 'ON.ENTRY',\r\n    0x0119: 'WORKBOOK.ADD',\r\n    0x011A: 'WORKBOOK.MOVE',\r\n    0x011B: 'WORKBOOK.COPY',\r\n    0x011C: 'WORKBOOK.OPTIONS',\r\n    0x011D: 'SAVE.WORKSPACE',\r\n    0x0120: 'CHART.WIZARD',\r\n    0x0121: 'DELETE.TOOL',\r\n    0x0122: 'MOVE.TOOL',\r\n    0x0123: 'WORKBOOK.SELECT',\r\n    0x0124: 'WORKBOOK.ACTIVATE',\r\n    0x0125: 'ASSIGN.TO.TOOL',\r\n    0x0127: 'COPY.TOOL',\r\n    0x0128: 'RESET.TOOL',\r\n    0x0129: 'CONSTRAIN.NUMERIC',\r\n    0x012A: 'PASTE.TOOL',\r\n    0x012E: 'WORKBOOK.NEW',\r\n    0x0131: 'SCENARIO.CELLS',\r\n    0x0132: 'SCENARIO.DELETE',\r\n    0x0133: 'SCENARIO.ADD',\r\n    0x0134: 'SCENARIO.EDIT',\r\n    0x0135: 'SCENARIO.SHOW',\r\n    0x0136: 'SCENARIO.SHOW.NEXT',\r\n    0x0137: 'SCENARIO.SUMMARY',\r\n    0x0138: 'PIVOT.TABLE.WIZARD',\r\n    0x0139: 'PIVOT.FIELD.PROPERTIES',\r\n    0x013A: 'PIVOT.FIELD',\r\n    0x013B: 'PIVOT.ITEM',\r\n    0x013C: 'PIVOT.ADD.FIELDS',\r\n    0x013E: 'OPTIONS.CALCULATION',\r\n    0x013F: 'OPTIONS.EDIT',\r\n    0x0140: 'OPTIONS.VIEW',\r\n    0x0141: 'ADDIN.MANAGER',\r\n    0x0142: 'MENU.EDITOR',\r\n    0x0143: 'ATTACH.TOOLBARS',\r\n    0x0144: 'VBAActivate',\r\n    0x0145: 'OPTIONS.CHART',\r\n    0x0148: 'VBA.INSERT.FILE',\r\n    0x014A: 'VBA.PROCEDURE.DEFINITION',\r\n    0x0150: 'ROUTING.SLIP',\r\n    0x0152: 'ROUTE.DOCUMENT',\r\n    0x0153: 'MAIL.LOGON',\r\n    0x0156: 'INSERT.PICTURE',\r\n    0x0157: 'EDIT.TOOL',\r\n    0x0158: 'GALLERY.DOUGHNUT',\r\n    0x015E: 'CHART.TREND',\r\n    0x0160: 'PIVOT.ITEM.PROPERTIES',\r\n    0x0162: 'WORKBOOK.INSERT',\r\n    0x0163: 'OPTIONS.TRANSITION',\r\n    0x0164: 'OPTIONS.GENERAL',\r\n    0x0172: 'FILTER.ADVANCED',\r\n    0x0175: 'MAIL.ADD.MAILER',\r\n    0x0176: 'MAIL.DELETE.MAILER',\r\n    0x0177: 'MAIL.REPLY',\r\n    0x0178: 'MAIL.REPLY.ALL',\r\n    0x0179: 'MAIL.FORWARD',\r\n    0x017A: 'MAIL.NEXT.LETTER',\r\n    0x017B: 'DATA.LABEL',\r\n    0x017C: 'INSERT.TITLE',\r\n    0x017D: 'FONT.PROPERTIES',\r\n    0x017E: 'MACRO.OPTIONS',\r\n    0x017F: 'WORKBOOK.HIDE',\r\n    0x0180: 'WORKBOOK.UNHIDE',\r\n    0x0181: 'WORKBOOK.DELETE',\r\n    0x0182: 'WORKBOOK.NAME',\r\n    0x0184: 'GALLERY.CUSTOM',\r\n    0x0186: 'ADD.CHART.AUTOFORMAT',\r\n    0x0187: 'DELETE.CHART.AUTOFORMAT',\r\n    0x0188: 'CHART.ADD.DATA',\r\n    0x0189: 'AUTO.OUTLINE',\r\n    0x018A: 'TAB.ORDER',\r\n    0x018B: 'SHOW.DIALOG',\r\n    0x018C: 'SELECT.ALL',\r\n    0x018D: 'UNGROUP.SHEETS',\r\n    0x018E: 'SUBTOTAL.CREATE',\r\n    0x018F: 'SUBTOTAL.REMOVE',\r\n    0x0190: 'RENAME.OBJECT',\r\n    0x019C: 'WORKBOOK.SCROLL',\r\n    0x019D: 'WORKBOOK.NEXT',\r\n    0x019E: 'WORKBOOK.PREV',\r\n    0x019F: 'WORKBOOK.TAB.SPLIT',\r\n    0x01A0: 'FULL.SCREEN',\r\n    0x01A1: 'WORKBOOK.PROTECT',\r\n    0x01A4: 'SCROLLBAR.PROPERTIES',\r\n    0x01A5: 'PIVOT.SHOW.PAGES',\r\n    0x01A6: 'TEXT.TO.COLUMNS',\r\n    0x01A7: 'FORMAT.CHARTTYPE',\r\n    0x01A8: 'LINK.FORMAT',\r\n    0x01A9: 'TRACER.DISPLAY',\r\n    0x01AE: 'TRACER.NAVIGATE',\r\n    0x01AF: 'TRACER.CLEAR',\r\n    0x01B0: 'TRACER.ERROR',\r\n    0x01B1: 'PIVOT.FIELD.GROUP',\r\n    0x01B2: 'PIVOT.FIELD.UNGROUP',\r\n    0x01B3: 'CHECKBOX.PROPERTIES',\r\n    0x01B4: 'LABEL.PROPERTIES',\r\n    0x01B5: 'LISTBOX.PROPERTIES',\r\n    0x01B6: 'EDITBOX.PROPERTIES',\r\n    0x01B7: 'PIVOT.REFRESH',\r\n    0x01B8: 'LINK.COMBO',\r\n    0x01B9: 'OPEN.TEXT',\r\n    0x01BA: 'HIDE.DIALOG',\r\n    0x01BB: 'SET.DIALOG.FOCUS',\r\n    0x01BC: 'ENABLE.OBJECT',\r\n    0x01BD: 'PUSHBUTTON.PROPERTIES',\r\n    0x01BE: 'SET.DIALOG.DEFAULT',\r\n    0x01BF: 'FILTER',\r\n    0x01C0: 'FILTER.SHOW.ALL',\r\n    0x01C1: 'CLEAR.OUTLINE',\r\n    0x01C2: 'FUNCTION.WIZARD',\r\n    0x01C3: 'ADD.LIST.ITEM',\r\n    0x01C4: 'SET.LIST.ITEM',\r\n    0x01C5: 'REMOVE.LIST.ITEM',\r\n    0x01C6: 'SELECT.LIST.ITEM',\r\n    0x01C7: 'SET.CONTROL.VALUE',\r\n    0x01C8: 'SAVE.COPY.AS',\r\n    0x01CA: 'OPTIONS.LISTS.ADD',\r\n    0x01CB: 'OPTIONS.LISTS.DELETE',\r\n    0x01CC: 'SERIES.AXES',\r\n    0x01CD: 'SERIES.X',\r\n    0x01CE: 'SERIES.Y',\r\n    0x01CF: 'ERRORBAR.X',\r\n    0x01D0: 'ERRORBAR.Y',\r\n    0x01D1: 'FORMAT.CHART',\r\n    0x01D2: 'SERIES.ORDER',\r\n    0x01D3: 'MAIL.LOGOFF',\r\n    0x01D4: 'CLEAR.ROUTING.SLIP',\r\n    0x01D5: 'APP.ACTIVATE.MICROSOFT',\r\n    0x01D6: 'MAIL.EDIT.MAILER',\r\n    0x01D7: 'ON.SHEET',\r\n    0x01D8: 'STANDARD.WIDTH',\r\n    0x01D9: 'SCENARIO.MERGE',\r\n    0x01DA: 'SUMMARY.INFO',\r\n    0x01DB: 'FIND.FILE',\r\n    0x01DC: 'ACTIVE.CELL.FONT',\r\n    0x01DD: 'ENABLE.TIPWIZARD',\r\n    0x01DE: 'VBA.MAKE.ADDIN',\r\n    0x01E0: 'INSERTDATATABLE',\r\n    0x01E1: 'WORKGROUP.OPTIONS',\r\n    0x01E2: 'MAIL.SEND.MAILER',\r\n    0x01E5: 'AUTOCORRECT',\r\n    0x01E9: 'POST.DOCUMENT',\r\n    0x01EB: 'PICKLIST',\r\n    0x01ED: 'VIEW.SHOW',\r\n    0x01EE: 'VIEW.DEFINE',\r\n    0x01EF: 'VIEW.DELETE',\r\n    0x01FD: 'SHEET.BACKGROUND',\r\n    0x01FE: 'INSERT.MAP.OBJECT',\r\n    0x01FF: 'OPTIONS.MENONO',\r\n    0x0205: 'MSOCHECKS',\r\n    0x0206: 'NORMAL',\r\n    0x0207: 'LAYOUT',\r\n    0x0208: 'RM.PRINT.AREA',\r\n    0x0209: 'CLEAR.PRINT.AREA',\r\n    0x020A: 'ADD.PRINT.AREA',\r\n    0x020B: 'MOVE.BRK',\r\n    0x0221: 'HIDECURR.NOTE',\r\n    0x0222: 'HIDEALL.NOTES',\r\n    0x0223: 'DELETE.NOTE',\r\n    0x0224: 'TRAVERSE.NOTES',\r\n    0x0225: 'ACTIVATE.NOTES',\r\n    0x026C: 'PROTECT.REVISIONS',\r\n    0x026D: 'UNPROTECT.REVISIONS',\r\n    0x0287: 'OPTIONS.ME',\r\n    0x028D: 'WEB.PUBLISH',\r\n    0x029B: 'NEWWEBQUERY',\r\n    0x02A1: 'PIVOT.TABLE.CHART',\r\n    0x02F1: 'OPTIONS.SAVE',\r\n    0x02F3: 'OPTIONS.SPELL',\r\n    0x0328: 'HIDEALL.INKANNOTS'\r\n  };\r\n\r\n  /* [MS-XLS] 2.5.198.17 */\r\n  /* [MS-XLSB] 2.5.97.10 */\r\n  var Ftab = {\r\n    0x0000: 'COUNT',\r\n    0x0001: 'IF',\r\n    0x0002: 'ISNA',\r\n    0x0003: 'ISERROR',\r\n    0x0004: 'SUM',\r\n    0x0005: 'AVERAGE',\r\n    0x0006: 'MIN',\r\n    0x0007: 'MAX',\r\n    0x0008: 'ROW',\r\n    0x0009: 'COLUMN',\r\n    0x000A: 'NA',\r\n    0x000B: 'NPV',\r\n    0x000C: 'STDEV',\r\n    0x000D: 'DOLLAR',\r\n    0x000E: 'FIXED',\r\n    0x000F: 'SIN',\r\n    0x0010: 'COS',\r\n    0x0011: 'TAN',\r\n    0x0012: 'ATAN',\r\n    0x0013: 'PI',\r\n    0x0014: 'SQRT',\r\n    0x0015: 'EXP',\r\n    0x0016: 'LN',\r\n    0x0017: 'LOG10',\r\n    0x0018: 'ABS',\r\n    0x0019: 'INT',\r\n    0x001A: 'SIGN',\r\n    0x001B: 'ROUND',\r\n    0x001C: 'LOOKUP',\r\n    0x001D: 'INDEX',\r\n    0x001E: 'REPT',\r\n    0x001F: 'MID',\r\n    0x0020: 'LEN',\r\n    0x0021: 'VALUE',\r\n    0x0022: 'TRUE',\r\n    0x0023: 'FALSE',\r\n    0x0024: 'AND',\r\n    0x0025: 'OR',\r\n    0x0026: 'NOT',\r\n    0x0027: 'MOD',\r\n    0x0028: 'DCOUNT',\r\n    0x0029: 'DSUM',\r\n    0x002A: 'DAVERAGE',\r\n    0x002B: 'DMIN',\r\n    0x002C: 'DMAX',\r\n    0x002D: 'DSTDEV',\r\n    0x002E: 'VAR',\r\n    0x002F: 'DVAR',\r\n    0x0030: 'TEXT',\r\n    0x0031: 'LINEST',\r\n    0x0032: 'TREND',\r\n    0x0033: 'LOGEST',\r\n    0x0034: 'GROWTH',\r\n    0x0035: 'GOTO',\r\n    0x0036: 'HALT',\r\n    0x0037: 'RETURN',\r\n    0x0038: 'PV',\r\n    0x0039: 'FV',\r\n    0x003A: 'NPER',\r\n    0x003B: 'PMT',\r\n    0x003C: 'RATE',\r\n    0x003D: 'MIRR',\r\n    0x003E: 'IRR',\r\n    0x003F: 'RAND',\r\n    0x0040: 'MATCH',\r\n    0x0041: 'DATE',\r\n    0x0042: 'TIME',\r\n    0x0043: 'DAY',\r\n    0x0044: 'MONTH',\r\n    0x0045: 'YEAR',\r\n    0x0046: 'WEEKDAY',\r\n    0x0047: 'HOUR',\r\n    0x0048: 'MINUTE',\r\n    0x0049: 'SECOND',\r\n    0x004A: 'NOW',\r\n    0x004B: 'AREAS',\r\n    0x004C: 'ROWS',\r\n    0x004D: 'COLUMNS',\r\n    0x004E: 'OFFSET',\r\n    0x004F: 'ABSREF',\r\n    0x0050: 'RELREF',\r\n    0x0051: 'ARGUMENT',\r\n    0x0052: 'SEARCH',\r\n    0x0053: 'TRANSPOSE',\r\n    0x0054: 'ERROR',\r\n    0x0055: 'STEP',\r\n    0x0056: 'TYPE',\r\n    0x0057: 'ECHO',\r\n    0x0058: 'SET.NAME',\r\n    0x0059: 'CALLER',\r\n    0x005A: 'DEREF',\r\n    0x005B: 'WINDOWS',\r\n    0x005C: 'SERIES',\r\n    0x005D: 'DOCUMENTS',\r\n    0x005E: 'ACTIVE.CELL',\r\n    0x005F: 'SELECTION',\r\n    0x0060: 'RESULT',\r\n    0x0061: 'ATAN2',\r\n    0x0062: 'ASIN',\r\n    0x0063: 'ACOS',\r\n    0x0064: 'CHOOSE',\r\n    0x0065: 'HLOOKUP',\r\n    0x0066: 'VLOOKUP',\r\n    0x0067: 'LINKS',\r\n    0x0068: 'INPUT',\r\n    0x0069: 'ISREF',\r\n    0x006A: 'GET.FORMULA',\r\n    0x006B: 'GET.NAME',\r\n    0x006C: 'SET.VALUE',\r\n    0x006D: 'LOG',\r\n    0x006E: 'EXEC',\r\n    0x006F: 'CHAR',\r\n    0x0070: 'LOWER',\r\n    0x0071: 'UPPER',\r\n    0x0072: 'PROPER',\r\n    0x0073: 'LEFT',\r\n    0x0074: 'RIGHT',\r\n    0x0075: 'EXACT',\r\n    0x0076: 'TRIM',\r\n    0x0077: 'REPLACE',\r\n    0x0078: 'SUBSTITUTE',\r\n    0x0079: 'CODE',\r\n    0x007A: 'NAMES',\r\n    0x007B: 'DIRECTORY',\r\n    0x007C: 'FIND',\r\n    0x007D: 'CELL',\r\n    0x007E: 'ISERR',\r\n    0x007F: 'ISTEXT',\r\n    0x0080: 'ISNUMBER',\r\n    0x0081: 'ISBLANK',\r\n    0x0082: 'T',\r\n    0x0083: 'N',\r\n    0x0084: 'FOPEN',\r\n    0x0085: 'FCLOSE',\r\n    0x0086: 'FSIZE',\r\n    0x0087: 'FREADLN',\r\n    0x0088: 'FREAD',\r\n    0x0089: 'FWRITELN',\r\n    0x008A: 'FWRITE',\r\n    0x008B: 'FPOS',\r\n    0x008C: 'DATEVALUE',\r\n    0x008D: 'TIMEVALUE',\r\n    0x008E: 'SLN',\r\n    0x008F: 'SYD',\r\n    0x0090: 'DDB',\r\n    0x0091: 'GET.DEF',\r\n    0x0092: 'REFTEXT',\r\n    0x0093: 'TEXTREF',\r\n    0x0094: 'INDIRECT',\r\n    0x0095: 'REGISTER',\r\n    0x0096: 'CALL',\r\n    0x0097: 'ADD.BAR',\r\n    0x0098: 'ADD.MENU',\r\n    0x0099: 'ADD.COMMAND',\r\n    0x009A: 'ENABLE.COMMAND',\r\n    0x009B: 'CHECK.COMMAND',\r\n    0x009C: 'RENAME.COMMAND',\r\n    0x009D: 'SHOW.BAR',\r\n    0x009E: 'DELETE.MENU',\r\n    0x009F: 'DELETE.COMMAND',\r\n    0x00A0: 'GET.CHART.ITEM',\r\n    0x00A1: 'DIALOG.BOX',\r\n    0x00A2: 'CLEAN',\r\n    0x00A3: 'MDETERM',\r\n    0x00A4: 'MINVERSE',\r\n    0x00A5: 'MMULT',\r\n    0x00A6: 'FILES',\r\n    0x00A7: 'IPMT',\r\n    0x00A8: 'PPMT',\r\n    0x00A9: 'COUNTA',\r\n    0x00AA: 'CANCEL.KEY',\r\n    0x00AB: 'FOR',\r\n    0x00AC: 'WHILE',\r\n    0x00AD: 'BREAK',\r\n    0x00AE: 'NEXT',\r\n    0x00AF: 'INITIATE',\r\n    0x00B0: 'REQUEST',\r\n    0x00B1: 'POKE',\r\n    0x00B2: 'EXECUTE',\r\n    0x00B3: 'TERMINATE',\r\n    0x00B4: 'RESTART',\r\n    0x00B5: 'HELP',\r\n    0x00B6: 'GET.BAR',\r\n    0x00B7: 'PRODUCT',\r\n    0x00B8: 'FACT',\r\n    0x00B9: 'GET.CELL',\r\n    0x00BA: 'GET.WORKSPACE',\r\n    0x00BB: 'GET.WINDOW',\r\n    0x00BC: 'GET.DOCUMENT',\r\n    0x00BD: 'DPRODUCT',\r\n    0x00BE: 'ISNONTEXT',\r\n    0x00BF: 'GET.NOTE',\r\n    0x00C0: 'NOTE',\r\n    0x00C1: 'STDEVP',\r\n    0x00C2: 'VARP',\r\n    0x00C3: 'DSTDEVP',\r\n    0x00C4: 'DVARP',\r\n    0x00C5: 'TRUNC',\r\n    0x00C6: 'ISLOGICAL',\r\n    0x00C7: 'DCOUNTA',\r\n    0x00C8: 'DELETE.BAR',\r\n    0x00C9: 'UNREGISTER',\r\n    0x00CC: 'USDOLLAR',\r\n    0x00CD: 'FINDB',\r\n    0x00CE: 'SEARCHB',\r\n    0x00CF: 'REPLACEB',\r\n    0x00D0: 'LEFTB',\r\n    0x00D1: 'RIGHTB',\r\n    0x00D2: 'MIDB',\r\n    0x00D3: 'LENB',\r\n    0x00D4: 'ROUNDUP',\r\n    0x00D5: 'ROUNDDOWN',\r\n    0x00D6: 'ASC',\r\n    0x00D7: 'DBCS',\r\n    0x00D8: 'RANK',\r\n    0x00DB: 'ADDRESS',\r\n    0x00DC: 'DAYS360',\r\n    0x00DD: 'TODAY',\r\n    0x00DE: 'VDB',\r\n    0x00DF: 'ELSE',\r\n    0x00E0: 'ELSE.IF',\r\n    0x00E1: 'END.IF',\r\n    0x00E2: 'FOR.CELL',\r\n    0x00E3: 'MEDIAN',\r\n    0x00E4: 'SUMPRODUCT',\r\n    0x00E5: 'SINH',\r\n    0x00E6: 'COSH',\r\n    0x00E7: 'TANH',\r\n    0x00E8: 'ASINH',\r\n    0x00E9: 'ACOSH',\r\n    0x00EA: 'ATANH',\r\n    0x00EB: 'DGET',\r\n    0x00EC: 'CREATE.OBJECT',\r\n    0x00ED: 'VOLATILE',\r\n    0x00EE: 'LAST.ERROR',\r\n    0x00EF: 'CUSTOM.UNDO',\r\n    0x00F0: 'CUSTOM.REPEAT',\r\n    0x00F1: 'FORMULA.CONVERT',\r\n    0x00F2: 'GET.LINK.INFO',\r\n    0x00F3: 'TEXT.BOX',\r\n    0x00F4: 'INFO',\r\n    0x00F5: 'GROUP',\r\n    0x00F6: 'GET.OBJECT',\r\n    0x00F7: 'DB',\r\n    0x00F8: 'PAUSE',\r\n    0x00FB: 'RESUME',\r\n    0x00FC: 'FREQUENCY',\r\n    0x00FD: 'ADD.TOOLBAR',\r\n    0x00FE: 'DELETE.TOOLBAR',\r\n    0x00FF: 'User',\r\n    0x0100: 'RESET.TOOLBAR',\r\n    0x0101: 'EVALUATE',\r\n    0x0102: 'GET.TOOLBAR',\r\n    0x0103: 'GET.TOOL',\r\n    0x0104: 'SPELLING.CHECK',\r\n    0x0105: 'ERROR.TYPE',\r\n    0x0106: 'APP.TITLE',\r\n    0x0107: 'WINDOW.TITLE',\r\n    0x0108: 'SAVE.TOOLBAR',\r\n    0x0109: 'ENABLE.TOOL',\r\n    0x010A: 'PRESS.TOOL',\r\n    0x010B: 'REGISTER.ID',\r\n    0x010C: 'GET.WORKBOOK',\r\n    0x010D: 'AVEDEV',\r\n    0x010E: 'BETADIST',\r\n    0x010F: 'GAMMALN',\r\n    0x0110: 'BETAINV',\r\n    0x0111: 'BINOMDIST',\r\n    0x0112: 'CHIDIST',\r\n    0x0113: 'CHIINV',\r\n    0x0114: 'COMBIN',\r\n    0x0115: 'CONFIDENCE',\r\n    0x0116: 'CRITBINOM',\r\n    0x0117: 'EVEN',\r\n    0x0118: 'EXPONDIST',\r\n    0x0119: 'FDIST',\r\n    0x011A: 'FINV',\r\n    0x011B: 'FISHER',\r\n    0x011C: 'FISHERINV',\r\n    0x011D: 'FLOOR',\r\n    0x011E: 'GAMMADIST',\r\n    0x011F: 'GAMMAINV',\r\n    0x0120: 'CEILING',\r\n    0x0121: 'HYPGEOMDIST',\r\n    0x0122: 'LOGNORMDIST',\r\n    0x0123: 'LOGINV',\r\n    0x0124: 'NEGBINOMDIST',\r\n    0x0125: 'NORMDIST',\r\n    0x0126: 'NORMSDIST',\r\n    0x0127: 'NORMINV',\r\n    0x0128: 'NORMSINV',\r\n    0x0129: 'STANDARDIZE',\r\n    0x012A: 'ODD',\r\n    0x012B: 'PERMUT',\r\n    0x012C: 'POISSON',\r\n    0x012D: 'TDIST',\r\n    0x012E: 'WEIBULL',\r\n    0x012F: 'SUMXMY2',\r\n    0x0130: 'SUMX2MY2',\r\n    0x0131: 'SUMX2PY2',\r\n    0x0132: 'CHITEST',\r\n    0x0133: 'CORREL',\r\n    0x0134: 'COVAR',\r\n    0x0135: 'FORECAST',\r\n    0x0136: 'FTEST',\r\n    0x0137: 'INTERCEPT',\r\n    0x0138: 'PEARSON',\r\n    0x0139: 'RSQ',\r\n    0x013A: 'STEYX',\r\n    0x013B: 'SLOPE',\r\n    0x013C: 'TTEST',\r\n    0x013D: 'PROB',\r\n    0x013E: 'DEVSQ',\r\n    0x013F: 'GEOMEAN',\r\n    0x0140: 'HARMEAN',\r\n    0x0141: 'SUMSQ',\r\n    0x0142: 'KURT',\r\n    0x0143: 'SKEW',\r\n    0x0144: 'ZTEST',\r\n    0x0145: 'LARGE',\r\n    0x0146: 'SMALL',\r\n    0x0147: 'QUARTILE',\r\n    0x0148: 'PERCENTILE',\r\n    0x0149: 'PERCENTRANK',\r\n    0x014A: 'MODE',\r\n    0x014B: 'TRIMMEAN',\r\n    0x014C: 'TINV',\r\n    0x014E: 'MOVIE.COMMAND',\r\n    0x014F: 'GET.MOVIE',\r\n    0x0150: 'CONCATENATE',\r\n    0x0151: 'POWER',\r\n    0x0152: 'PIVOT.ADD.DATA',\r\n    0x0153: 'GET.PIVOT.TABLE',\r\n    0x0154: 'GET.PIVOT.FIELD',\r\n    0x0155: 'GET.PIVOT.ITEM',\r\n    0x0156: 'RADIANS',\r\n    0x0157: 'DEGREES',\r\n    0x0158: 'SUBTOTAL',\r\n    0x0159: 'SUMIF',\r\n    0x015A: 'COUNTIF',\r\n    0x015B: 'COUNTBLANK',\r\n    0x015C: 'SCENARIO.GET',\r\n    0x015D: 'OPTIONS.LISTS.GET',\r\n    0x015E: 'ISPMT',\r\n    0x015F: 'DATEDIF',\r\n    0x0160: 'DATESTRING',\r\n    0x0161: 'NUMBERSTRING',\r\n    0x0162: 'ROMAN',\r\n    0x0163: 'OPEN.DIALOG',\r\n    0x0164: 'SAVE.DIALOG',\r\n    0x0165: 'VIEW.GET',\r\n    0x0166: 'GETPIVOTDATA',\r\n    0x0167: 'HYPERLINK',\r\n    0x0168: 'PHONETIC',\r\n    0x0169: 'AVERAGEA',\r\n    0x016A: 'MAXA',\r\n    0x016B: 'MINA',\r\n    0x016C: 'STDEVPA',\r\n    0x016D: 'VARPA',\r\n    0x016E: 'STDEVA',\r\n    0x016F: 'VARA',\r\n    0x0170: 'BAHTTEXT',\r\n    0x0171: 'THAIDAYOFWEEK',\r\n    0x0172: 'THAIDIGIT',\r\n    0x0173: 'THAIMONTHOFYEAR',\r\n    0x0174: 'THAINUMSOUND',\r\n    0x0175: 'THAINUMSTRING',\r\n    0x0176: 'THAISTRINGLENGTH',\r\n    0x0177: 'ISTHAIDIGIT',\r\n    0x0178: 'ROUNDBAHTDOWN',\r\n    0x0179: 'ROUNDBAHTUP',\r\n    0x017A: 'THAIYEAR',\r\n    0x017B: 'RTD',\r\n\r\n    0x017C: 'CUBEVALUE',\r\n    0x017D: 'CUBEMEMBER',\r\n    0x017E: 'CUBEMEMBERPROPERTY',\r\n    0x017F: 'CUBERANKEDMEMBER',\r\n    0x0180: 'HEX2BIN',\r\n    0x0181: 'HEX2DEC',\r\n    0x0182: 'HEX2OCT',\r\n    0x0183: 'DEC2BIN',\r\n    0x0184: 'DEC2HEX',\r\n    0x0185: 'DEC2OCT',\r\n    0x0186: 'OCT2BIN',\r\n    0x0187: 'OCT2HEX',\r\n    0x0188: 'OCT2DEC',\r\n    0x0189: 'BIN2DEC',\r\n    0x018A: 'BIN2OCT',\r\n    0x018B: 'BIN2HEX',\r\n    0x018C: 'IMSUB',\r\n    0x018D: 'IMDIV',\r\n    0x018E: 'IMPOWER',\r\n    0x018F: 'IMABS',\r\n    0x0190: 'IMSQRT',\r\n    0x0191: 'IMLN',\r\n    0x0192: 'IMLOG2',\r\n    0x0193: 'IMLOG10',\r\n    0x0194: 'IMSIN',\r\n    0x0195: 'IMCOS',\r\n    0x0196: 'IMEXP',\r\n    0x0197: 'IMARGUMENT',\r\n    0x0198: 'IMCONJUGATE',\r\n    0x0199: 'IMAGINARY',\r\n    0x019A: 'IMREAL',\r\n    0x019B: 'COMPLEX',\r\n    0x019C: 'IMSUM',\r\n    0x019D: 'IMPRODUCT',\r\n    0x019E: 'SERIESSUM',\r\n    0x019F: 'FACTDOUBLE',\r\n    0x01A0: 'SQRTPI',\r\n    0x01A1: 'QUOTIENT',\r\n    0x01A2: 'DELTA',\r\n    0x01A3: 'GESTEP',\r\n    0x01A4: 'ISEVEN',\r\n    0x01A5: 'ISODD',\r\n    0x01A6: 'MROUND',\r\n    0x01A7: 'ERF',\r\n    0x01A8: 'ERFC',\r\n    0x01A9: 'BESSELJ',\r\n    0x01AA: 'BESSELK',\r\n    0x01AB: 'BESSELY',\r\n    0x01AC: 'BESSELI',\r\n    0x01AD: 'XIRR',\r\n    0x01AE: 'XNPV',\r\n    0x01AF: 'PRICEMAT',\r\n    0x01B0: 'YIELDMAT',\r\n    0x01B1: 'INTRATE',\r\n    0x01B2: 'RECEIVED',\r\n    0x01B3: 'DISC',\r\n    0x01B4: 'PRICEDISC',\r\n    0x01B5: 'YIELDDISC',\r\n    0x01B6: 'TBILLEQ',\r\n    0x01B7: 'TBILLPRICE',\r\n    0x01B8: 'TBILLYIELD',\r\n    0x01B9: 'PRICE',\r\n    0x01BA: 'YIELD',\r\n    0x01BB: 'DOLLARDE',\r\n    0x01BC: 'DOLLARFR',\r\n    0x01BD: 'NOMINAL',\r\n    0x01BE: 'EFFECT',\r\n    0x01BF: 'CUMPRINC',\r\n    0x01C0: 'CUMIPMT',\r\n    0x01C1: 'EDATE',\r\n    0x01C2: 'EOMONTH',\r\n    0x01C3: 'YEARFRAC',\r\n    0x01C4: 'COUPDAYBS',\r\n    0x01C5: 'COUPDAYS',\r\n    0x01C6: 'COUPDAYSNC',\r\n    0x01C7: 'COUPNCD',\r\n    0x01C8: 'COUPNUM',\r\n    0x01C9: 'COUPPCD',\r\n    0x01CA: 'DURATION',\r\n    0x01CB: 'MDURATION',\r\n    0x01CC: 'ODDLPRICE',\r\n    0x01CD: 'ODDLYIELD',\r\n    0x01CE: 'ODDFPRICE',\r\n    0x01CF: 'ODDFYIELD',\r\n    0x01D0: 'RANDBETWEEN',\r\n    0x01D1: 'WEEKNUM',\r\n    0x01D2: 'AMORDEGRC',\r\n    0x01D3: 'AMORLINC',\r\n    0x01D4: 'CONVERT',\r\n    0x02D4: 'SHEETJS',\r\n    0x01D5: 'ACCRINT',\r\n    0x01D6: 'ACCRINTM',\r\n    0x01D7: 'WORKDAY',\r\n    0x01D8: 'NETWORKDAYS',\r\n    0x01D9: 'GCD',\r\n    0x01DA: 'MULTINOMIAL',\r\n    0x01DB: 'LCM',\r\n    0x01DC: 'FVSCHEDULE',\r\n    0x01DD: 'CUBEKPIMEMBER',\r\n    0x01DE: 'CUBESET',\r\n    0x01DF: 'CUBESETCOUNT',\r\n    0x01E0: 'IFERROR',\r\n    0x01E1: 'COUNTIFS',\r\n    0x01E2: 'SUMIFS',\r\n    0x01E3: 'AVERAGEIF',\r\n    0x01E4: 'AVERAGEIFS'\r\n  };\r\n  var FtabArgc = {\r\n    0x0002: 1, /* ISNA */\r\n    0x0003: 1, /* ISERROR */\r\n    0x000A: 0, /* NA */\r\n    0x000F: 1, /* SIN */\r\n    0x0010: 1, /* COS */\r\n    0x0011: 1, /* TAN */\r\n    0x0012: 1, /* ATAN */\r\n    0x0013: 0, /* PI */\r\n    0x0014: 1, /* SQRT */\r\n    0x0015: 1, /* EXP */\r\n    0x0016: 1, /* LN */\r\n    0x0017: 1, /* LOG10 */\r\n    0x0018: 1, /* ABS */\r\n    0x0019: 1, /* INT */\r\n    0x001A: 1, /* SIGN */\r\n    0x001B: 2, /* ROUND */\r\n    0x001E: 2, /* REPT */\r\n    0x001F: 3, /* MID */\r\n    0x0020: 1, /* LEN */\r\n    0x0021: 1, /* VALUE */\r\n    0x0022: 0, /* TRUE */\r\n    0x0023: 0, /* FALSE */\r\n    0x0026: 1, /* NOT */\r\n    0x0027: 2, /* MOD */\r\n    0x0028: 3, /* DCOUNT */\r\n    0x0029: 3, /* DSUM */\r\n    0x002A: 3, /* DAVERAGE */\r\n    0x002B: 3, /* DMIN */\r\n    0x002C: 3, /* DMAX */\r\n    0x002D: 3, /* DSTDEV */\r\n    0x002F: 3, /* DVAR */\r\n    0x0030: 2, /* TEXT */\r\n    0x0035: 1, /* GOTO */\r\n    0x003D: 3, /* MIRR */\r\n    0x003F: 0, /* RAND */\r\n    0x0041: 3, /* DATE */\r\n    0x0042: 3, /* TIME */\r\n    0x0043: 1, /* DAY */\r\n    0x0044: 1, /* MONTH */\r\n    0x0045: 1, /* YEAR */\r\n    0x0046: 1, /* WEEKDAY */\r\n    0x0047: 1, /* HOUR */\r\n    0x0048: 1, /* MINUTE */\r\n    0x0049: 1, /* SECOND */\r\n    0x004A: 0, /* NOW */\r\n    0x004B: 1, /* AREAS */\r\n    0x004C: 1, /* ROWS */\r\n    0x004D: 1, /* COLUMNS */\r\n    0x004F: 2, /* ABSREF */\r\n    0x0050: 2, /* RELREF */\r\n    0x0053: 1, /* TRANSPOSE */\r\n    0x0055: 0, /* STEP */\r\n    0x0056: 1, /* TYPE */\r\n    0x0059: 0, /* CALLER */\r\n    0x005A: 1, /* DEREF */\r\n    0x005E: 0, /* ACTIVE.CELL */\r\n    0x005F: 0, /* SELECTION */\r\n    0x0061: 2, /* ATAN2 */\r\n    0x0062: 1, /* ASIN */\r\n    0x0063: 1, /* ACOS */\r\n    0x0065: 3, /* HLOOKUP */\r\n    0x0066: 3, /* VLOOKUP */\r\n    0x0069: 1, /* ISREF */\r\n    0x006A: 1, /* GET.FORMULA */\r\n    0x006C: 2, /* SET.VALUE */\r\n    0x006F: 1, /* CHAR */\r\n    0x0070: 1, /* LOWER */\r\n    0x0071: 1, /* UPPER */\r\n    0x0072: 1, /* PROPER */\r\n    0x0075: 2, /* EXACT */\r\n    0x0076: 1, /* TRIM */\r\n    0x0077: 4, /* REPLACE */\r\n    0x0079: 1, /* CODE */\r\n    0x007E: 1, /* ISERR */\r\n    0x007F: 1, /* ISTEXT */\r\n    0x0080: 1, /* ISNUMBER */\r\n    0x0081: 1, /* ISBLANK */\r\n    0x0082: 1, /* T */\r\n    0x0083: 1, /* N */\r\n    0x0085: 1, /* FCLOSE */\r\n    0x0086: 1, /* FSIZE */\r\n    0x0087: 1, /* FREADLN */\r\n    0x0088: 2, /* FREAD */\r\n    0x0089: 2, /* FWRITELN */\r\n    0x008A: 2, /* FWRITE */\r\n    0x008C: 1, /* DATEVALUE */\r\n    0x008D: 1, /* TIMEVALUE */\r\n    0x008E: 3, /* SLN */\r\n    0x008F: 4, /* SYD */\r\n    0x0090: 4, /* DDB */\r\n    0x00A1: 1, /* DIALOG.BOX */\r\n    0x00A2: 1, /* CLEAN */\r\n    0x00A3: 1, /* MDETERM */\r\n    0x00A4: 1, /* MINVERSE */\r\n    0x00A5: 2, /* MMULT */\r\n    0x00AC: 1, /* WHILE */\r\n    0x00AF: 2, /* INITIATE */\r\n    0x00B0: 2, /* REQUEST */\r\n    0x00B1: 3, /* POKE */\r\n    0x00B2: 2, /* EXECUTE */\r\n    0x00B3: 1, /* TERMINATE */\r\n    0x00B8: 1, /* FACT */\r\n    0x00BA: 1, /* GET.WORKSPACE */\r\n    0x00BD: 3, /* DPRODUCT */\r\n    0x00BE: 1, /* ISNONTEXT */\r\n    0x00C3: 3, /* DSTDEVP */\r\n    0x00C4: 3, /* DVARP */\r\n    0x00C5: 1, /* TRUNC */\r\n    0x00C6: 1, /* ISLOGICAL */\r\n    0x00C7: 3, /* DCOUNTA */\r\n    0x00C9: 1, /* UNREGISTER */\r\n    0x00CF: 4, /* REPLACEB */\r\n    0x00D2: 3, /* MIDB */\r\n    0x00D3: 1, /* LENB */\r\n    0x00D4: 2, /* ROUNDUP */\r\n    0x00D5: 2, /* ROUNDDOWN */\r\n    0x00D6: 1, /* ASC */\r\n    0x00D7: 1, /* DBCS */\r\n    0x00E1: 0, /* END.IF */\r\n    0x00E5: 1, /* SINH */\r\n    0x00E6: 1, /* COSH */\r\n    0x00E7: 1, /* TANH */\r\n    0x00E8: 1, /* ASINH */\r\n    0x00E9: 1, /* ACOSH */\r\n    0x00EA: 1, /* ATANH */\r\n    0x00EB: 3, /* DGET */\r\n    0x00F4: 1, /* INFO */\r\n    0x00F7: 4, /* DB */\r\n    0x00FC: 2, /* FREQUENCY */\r\n    0x0101: 1, /* EVALUATE */\r\n    0x0105: 1, /* ERROR.TYPE */\r\n    0x010F: 1, /* GAMMALN */\r\n    0x0111: 4, /* BINOMDIST */\r\n    0x0112: 2, /* CHIDIST */\r\n    0x0113: 2, /* CHIINV */\r\n    0x0114: 2, /* COMBIN */\r\n    0x0115: 3, /* CONFIDENCE */\r\n    0x0116: 3, /* CRITBINOM */\r\n    0x0117: 1, /* EVEN */\r\n    0x0118: 3, /* EXPONDIST */\r\n    0x0119: 3, /* FDIST */\r\n    0x011A: 3, /* FINV */\r\n    0x011B: 1, /* FISHER */\r\n    0x011C: 1, /* FISHERINV */\r\n    0x011D: 2, /* FLOOR */\r\n    0x011E: 4, /* GAMMADIST */\r\n    0x011F: 3, /* GAMMAINV */\r\n    0x0120: 2, /* CEILING */\r\n    0x0121: 4, /* HYPGEOMDIST */\r\n    0x0122: 3, /* LOGNORMDIST */\r\n    0x0123: 3, /* LOGINV */\r\n    0x0124: 3, /* NEGBINOMDIST */\r\n    0x0125: 4, /* NORMDIST */\r\n    0x0126: 1, /* NORMSDIST */\r\n    0x0127: 3, /* NORMINV */\r\n    0x0128: 1, /* NORMSINV */\r\n    0x0129: 3, /* STANDARDIZE */\r\n    0x012A: 1, /* ODD */\r\n    0x012B: 2, /* PERMUT */\r\n    0x012C: 3, /* POISSON */\r\n    0x012D: 3, /* TDIST */\r\n    0x012E: 4, /* WEIBULL */\r\n    0x012F: 2, /* SUMXMY2 */\r\n    0x0130: 2, /* SUMX2MY2 */\r\n    0x0131: 2, /* SUMX2PY2 */\r\n    0x0132: 2, /* CHITEST */\r\n    0x0133: 2, /* CORREL */\r\n    0x0134: 2, /* COVAR */\r\n    0x0135: 3, /* FORECAST */\r\n    0x0136: 2, /* FTEST */\r\n    0x0137: 2, /* INTERCEPT */\r\n    0x0138: 2, /* PEARSON */\r\n    0x0139: 2, /* RSQ */\r\n    0x013A: 2, /* STEYX */\r\n    0x013B: 2, /* SLOPE */\r\n    0x013C: 4, /* TTEST */\r\n    0x0145: 2, /* LARGE */\r\n    0x0146: 2, /* SMALL */\r\n    0x0147: 2, /* QUARTILE */\r\n    0x0148: 2, /* PERCENTILE */\r\n    0x014B: 2, /* TRIMMEAN */\r\n    0x014C: 2, /* TINV */\r\n    0x0151: 2, /* POWER */\r\n    0x0156: 1, /* RADIANS */\r\n    0x0157: 1, /* DEGREES */\r\n    0x015A: 2, /* COUNTIF */\r\n    0x015B: 1, /* COUNTBLANK */\r\n    0x015E: 4, /* ISPMT */\r\n    0x015F: 3, /* DATEDIF */\r\n    0x0160: 1, /* DATESTRING */\r\n    0x0161: 2, /* NUMBERSTRING */\r\n    0x0168: 1, /* PHONETIC */\r\n    0x0170: 1, /* BAHTTEXT */\r\n    0x0171: 1, /* THAIDAYOFWEEK */\r\n    0x0172: 1, /* THAIDIGIT */\r\n    0x0173: 1, /* THAIMONTHOFYEAR */\r\n    0x0174: 1, /* THAINUMSOUND */\r\n    0x0175: 1, /* THAINUMSTRING */\r\n    0x0176: 1, /* THAISTRINGLENGTH */\r\n    0x0177: 1, /* ISTHAIDIGIT */\r\n    0x0178: 1, /* ROUNDBAHTDOWN */\r\n    0x0179: 1, /* ROUNDBAHTUP */\r\n    0x017A: 1, /* THAIYEAR */\r\n    0x017E: 3, /* CUBEMEMBERPROPERTY */\r\n    0x0181: 1, /* HEX2DEC */\r\n    0x0188: 1, /* OCT2DEC */\r\n    0x0189: 1, /* BIN2DEC */\r\n    0x018C: 2, /* IMSUB */\r\n    0x018D: 2, /* IMDIV */\r\n    0x018E: 2, /* IMPOWER */\r\n    0x018F: 1, /* IMABS */\r\n    0x0190: 1, /* IMSQRT */\r\n    0x0191: 1, /* IMLN */\r\n    0x0192: 1, /* IMLOG2 */\r\n    0x0193: 1, /* IMLOG10 */\r\n    0x0194: 1, /* IMSIN */\r\n    0x0195: 1, /* IMCOS */\r\n    0x0196: 1, /* IMEXP */\r\n    0x0197: 1, /* IMARGUMENT */\r\n    0x0198: 1, /* IMCONJUGATE */\r\n    0x0199: 1, /* IMAGINARY */\r\n    0x019A: 1, /* IMREAL */\r\n    0x019E: 4, /* SERIESSUM */\r\n    0x019F: 1, /* FACTDOUBLE */\r\n    0x01A0: 1, /* SQRTPI */\r\n    0x01A1: 2, /* QUOTIENT */\r\n    0x01A4: 1, /* ISEVEN */\r\n    0x01A5: 1, /* ISODD */\r\n    0x01A6: 2, /* MROUND */\r\n    0x01A8: 1, /* ERFC */\r\n    0x01A9: 2, /* BESSELJ */\r\n    0x01AA: 2, /* BESSELK */\r\n    0x01AB: 2, /* BESSELY */\r\n    0x01AC: 2, /* BESSELI */\r\n    0x01AE: 3, /* XNPV */\r\n    0x01B6: 3, /* TBILLEQ */\r\n    0x01B7: 3, /* TBILLPRICE */\r\n    0x01B8: 3, /* TBILLYIELD */\r\n    0x01BB: 2, /* DOLLARDE */\r\n    0x01BC: 2, /* DOLLARFR */\r\n    0x01BD: 2, /* NOMINAL */\r\n    0x01BE: 2, /* EFFECT */\r\n    0x01BF: 6, /* CUMPRINC */\r\n    0x01C0: 6, /* CUMIPMT */\r\n    0x01C1: 2, /* EDATE */\r\n    0x01C2: 2, /* EOMONTH */\r\n    0x01D0: 2, /* RANDBETWEEN */\r\n    0x01D4: 3, /* CONVERT */\r\n    0x01DC: 2, /* FVSCHEDULE */\r\n    0x01DF: 1, /* CUBESETCOUNT */\r\n    0x01E0: 2, /* IFERROR */\r\n    0xFFFF: 0\r\n  };\r\n  /* [MS-XLSX] 2.2.3 Functions */\r\n  /* [MS-XLSB] 2.5.97.10 Ftab */\r\n  var XLSXFutureFunctions = {\r\n    \"_xlfn.ACOT\": \"ACOT\",\r\n    \"_xlfn.ACOTH\": \"ACOTH\",\r\n    \"_xlfn.AGGREGATE\": \"AGGREGATE\",\r\n    \"_xlfn.ARABIC\": \"ARABIC\",\r\n    \"_xlfn.AVERAGEIF\": \"AVERAGEIF\",\r\n    \"_xlfn.AVERAGEIFS\": \"AVERAGEIFS\",\r\n    \"_xlfn.BASE\": \"BASE\",\r\n    \"_xlfn.BETA.DIST\": \"BETA.DIST\",\r\n    \"_xlfn.BETA.INV\": \"BETA.INV\",\r\n    \"_xlfn.BINOM.DIST\": \"BINOM.DIST\",\r\n    \"_xlfn.BINOM.DIST.RANGE\": \"BINOM.DIST.RANGE\",\r\n    \"_xlfn.BINOM.INV\": \"BINOM.INV\",\r\n    \"_xlfn.BITAND\": \"BITAND\",\r\n    \"_xlfn.BITLSHIFT\": \"BITLSHIFT\",\r\n    \"_xlfn.BITOR\": \"BITOR\",\r\n    \"_xlfn.BITRSHIFT\": \"BITRSHIFT\",\r\n    \"_xlfn.BITXOR\": \"BITXOR\",\r\n    \"_xlfn.CEILING.MATH\": \"CEILING.MATH\",\r\n    \"_xlfn.CEILING.PRECISE\": \"CEILING.PRECISE\",\r\n    \"_xlfn.CHISQ.DIST\": \"CHISQ.DIST\",\r\n    \"_xlfn.CHISQ.DIST.RT\": \"CHISQ.DIST.RT\",\r\n    \"_xlfn.CHISQ.INV\": \"CHISQ.INV\",\r\n    \"_xlfn.CHISQ.INV.RT\": \"CHISQ.INV.RT\",\r\n    \"_xlfn.CHISQ.TEST\": \"CHISQ.TEST\",\r\n    \"_xlfn.COMBINA\": \"COMBINA\",\r\n    \"_xlfn.CONCAT\": \"CONCAT\",\r\n    \"_xlfn.CONFIDENCE.NORM\": \"CONFIDENCE.NORM\",\r\n    \"_xlfn.CONFIDENCE.T\": \"CONFIDENCE.T\",\r\n    \"_xlfn.COT\": \"COT\",\r\n    \"_xlfn.COTH\": \"COTH\",\r\n    \"_xlfn.COUNTIFS\": \"COUNTIFS\",\r\n    \"_xlfn.COVARIANCE.P\": \"COVARIANCE.P\",\r\n    \"_xlfn.COVARIANCE.S\": \"COVARIANCE.S\",\r\n    \"_xlfn.CSC\": \"CSC\",\r\n    \"_xlfn.CSCH\": \"CSCH\",\r\n    \"_xlfn.DAYS\": \"DAYS\",\r\n    \"_xlfn.DECIMAL\": \"DECIMAL\",\r\n    \"_xlfn.ECMA.CEILING\": \"ECMA.CEILING\",\r\n    \"_xlfn.ERF.PRECISE\": \"ERF.PRECISE\",\r\n    \"_xlfn.ERFC.PRECISE\": \"ERFC.PRECISE\",\r\n    \"_xlfn.EXPON.DIST\": \"EXPON.DIST\",\r\n    \"_xlfn.F.DIST\": \"F.DIST\",\r\n    \"_xlfn.F.DIST.RT\": \"F.DIST.RT\",\r\n    \"_xlfn.F.INV\": \"F.INV\",\r\n    \"_xlfn.F.INV.RT\": \"F.INV.RT\",\r\n    \"_xlfn.F.TEST\": \"F.TEST\",\r\n    \"_xlfn.FILTERXML\": \"FILTERXML\",\r\n    \"_xlfn.FLOOR.MATH\": \"FLOOR.MATH\",\r\n    \"_xlfn.FLOOR.PRECISE\": \"FLOOR.PRECISE\",\r\n    \"_xlfn.FORECAST.ETS\": \"FORECAST.ETS\",\r\n    \"_xlfn.FORECAST.ETS.CONFINT\": \"FORECAST.ETS.CONFINT\",\r\n    \"_xlfn.FORECAST.ETS.SEASONALITY\": \"FORECAST.ETS.SEASONALITY\",\r\n    \"_xlfn.FORECAST.ETS.STAT\": \"FORECAST.ETS.STAT\",\r\n    \"_xlfn.FORECAST.LINEAR\": \"FORECAST.LINEAR\",\r\n    \"_xlfn.FORMULATEXT\": \"FORMULATEXT\",\r\n    \"_xlfn.GAMMA\": \"GAMMA\",\r\n    \"_xlfn.GAMMA.DIST\": \"GAMMA.DIST\",\r\n    \"_xlfn.GAMMA.INV\": \"GAMMA.INV\",\r\n    \"_xlfn.GAMMALN.PRECISE\": \"GAMMALN.PRECISE\",\r\n    \"_xlfn.GAUSS\": \"GAUSS\",\r\n    \"_xlfn.HYPGEOM.DIST\": \"HYPGEOM.DIST\",\r\n    \"_xlfn.IFERROR\": \"IFERROR\",\r\n    \"_xlfn.IFNA\": \"IFNA\",\r\n    \"_xlfn.IFS\": \"IFS\",\r\n    \"_xlfn.IMCOSH\": \"IMCOSH\",\r\n    \"_xlfn.IMCOT\": \"IMCOT\",\r\n    \"_xlfn.IMCSC\": \"IMCSC\",\r\n    \"_xlfn.IMCSCH\": \"IMCSCH\",\r\n    \"_xlfn.IMSEC\": \"IMSEC\",\r\n    \"_xlfn.IMSECH\": \"IMSECH\",\r\n    \"_xlfn.IMSINH\": \"IMSINH\",\r\n    \"_xlfn.IMTAN\": \"IMTAN\",\r\n    \"_xlfn.ISFORMULA\": \"ISFORMULA\",\r\n    \"_xlfn.ISO.CEILING\": \"ISO.CEILING\",\r\n    \"_xlfn.ISOWEEKNUM\": \"ISOWEEKNUM\",\r\n    \"_xlfn.LOGNORM.DIST\": \"LOGNORM.DIST\",\r\n    \"_xlfn.LOGNORM.INV\": \"LOGNORM.INV\",\r\n    \"_xlfn.MAXIFS\": \"MAXIFS\",\r\n    \"_xlfn.MINIFS\": \"MINIFS\",\r\n    \"_xlfn.MODE.MULT\": \"MODE.MULT\",\r\n    \"_xlfn.MODE.SNGL\": \"MODE.SNGL\",\r\n    \"_xlfn.MUNIT\": \"MUNIT\",\r\n    \"_xlfn.NEGBINOM.DIST\": \"NEGBINOM.DIST\",\r\n    \"_xlfn.NETWORKDAYS.INTL\": \"NETWORKDAYS.INTL\",\r\n    \"_xlfn.NIGBINOM\": \"NIGBINOM\",\r\n    \"_xlfn.NORM.DIST\": \"NORM.DIST\",\r\n    \"_xlfn.NORM.INV\": \"NORM.INV\",\r\n    \"_xlfn.NORM.S.DIST\": \"NORM.S.DIST\",\r\n    \"_xlfn.NORM.S.INV\": \"NORM.S.INV\",\r\n    \"_xlfn.NUMBERVALUE\": \"NUMBERVALUE\",\r\n    \"_xlfn.PDURATION\": \"PDURATION\",\r\n    \"_xlfn.PERCENTILE.EXC\": \"PERCENTILE.EXC\",\r\n    \"_xlfn.PERCENTILE.INC\": \"PERCENTILE.INC\",\r\n    \"_xlfn.PERCENTRANK.EXC\": \"PERCENTRANK.EXC\",\r\n    \"_xlfn.PERCENTRANK.INC\": \"PERCENTRANK.INC\",\r\n    \"_xlfn.PERMUTATIONA\": \"PERMUTATIONA\",\r\n    \"_xlfn.PHI\": \"PHI\",\r\n    \"_xlfn.POISSON.DIST\": \"POISSON.DIST\",\r\n    \"_xlfn.QUARTILE.EXC\": \"QUARTILE.EXC\",\r\n    \"_xlfn.QUARTILE.INC\": \"QUARTILE.INC\",\r\n    \"_xlfn.QUERYSTRING\": \"QUERYSTRING\",\r\n    \"_xlfn.RANK.AVG\": \"RANK.AVG\",\r\n    \"_xlfn.RANK.EQ\": \"RANK.EQ\",\r\n    \"_xlfn.RRI\": \"RRI\",\r\n    \"_xlfn.SEC\": \"SEC\",\r\n    \"_xlfn.SECH\": \"SECH\",\r\n    \"_xlfn.SHEET\": \"SHEET\",\r\n    \"_xlfn.SHEETS\": \"SHEETS\",\r\n    \"_xlfn.SKEW.P\": \"SKEW.P\",\r\n    \"_xlfn.STDEV.P\": \"STDEV.P\",\r\n    \"_xlfn.STDEV.S\": \"STDEV.S\",\r\n    \"_xlfn.SUMIFS\": \"SUMIFS\",\r\n    \"_xlfn.SWITCH\": \"SWITCH\",\r\n    \"_xlfn.T.DIST\": \"T.DIST\",\r\n    \"_xlfn.T.DIST.2T\": \"T.DIST.2T\",\r\n    \"_xlfn.T.DIST.RT\": \"T.DIST.RT\",\r\n    \"_xlfn.T.INV\": \"T.INV\",\r\n    \"_xlfn.T.INV.2T\": \"T.INV.2T\",\r\n    \"_xlfn.T.TEST\": \"T.TEST\",\r\n    \"_xlfn.TEXTJOIN\": \"TEXTJOIN\",\r\n    \"_xlfn.UNICHAR\": \"UNICHAR\",\r\n    \"_xlfn.UNICODE\": \"UNICODE\",\r\n    \"_xlfn.VAR.P\": \"VAR.P\",\r\n    \"_xlfn.VAR.S\": \"VAR.S\",\r\n    \"_xlfn.WEBSERVICE\": \"WEBSERVICE\",\r\n    \"_xlfn.WEIBULL.DIST\": \"WEIBULL.DIST\",\r\n    \"_xlfn.WORKDAY.INTL\": \"WORKDAY.INTL\",\r\n    \"_xlfn.XOR\": \"XOR\",\r\n    \"_xlfn.Z.TEST\": \"Z.TEST\"\r\n  };\r\n\r\n  /* Part 3 TODO: actually parse formulae */\r\n  function ods_to_csf_formula(f) {\r\n    if(f.slice(0,3) == \"of:\") f = f.slice(3);\r\n    /* 5.2 Basic Expressions */\r\n    if(f.charCodeAt(0) == 61) {\r\n      f = f.slice(1);\r\n      if(f.charCodeAt(0) == 61) f = f.slice(1);\r\n    }\r\n    f = f.replace(/COM\\.MICROSOFT\\./g, \"\");\r\n    /* Part 3 Section 5.8 References */\r\n    f = f.replace(/\\[((?:\\.[A-Z]+[0-9]+)(?::\\.[A-Z]+[0-9]+)?)\\]/g, function($$, $1) { return $1.replace(/\\./g,\"\"); });\r\n    /* TODO: something other than this */\r\n    f = f.replace(/\\[.(#[A-Z]*[?!])\\]/g, \"$1\");\r\n    return f.replace(/[;~]/g,\",\").replace(/\\|/g,\";\");\r\n  }\r\n\r\n  function csf_to_ods_formula(f) {\r\n    var o = \"of:=\" + f.replace(crefregex, \"$1[.$2$3$4$5]\").replace(/\\]:\\[/g,\":\");\r\n    /* TODO: something other than this */\r\n    return o.replace(/;/g, \"|\").replace(/,/g,\";\");\r\n  }\r\n\r\n  function ods_to_csf_3D(r) {\r\n    var a = r.split(\":\");\r\n    var s = a[0].split(\".\")[0];\r\n    return [s, a[0].split(\".\")[1] + (a.length > 1 ? (\":\" + (a[1].split(\".\")[1] || a[1].split(\".\")[0])) : \"\")];\r\n  }\r\n\r\n  function csf_to_ods_3D(r) {\r\n    return r.replace(/\\./,\"!\");\r\n  }\r\n\r\n  var strs = {}; // shared strings\r\n  var _ssfopts = {}; // spreadsheet formatting options\r\n\r\n  RELS.WS = [\r\n    \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\",\r\n    \"http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet\"\r\n  ];\r\n\r\n  /*global Map */\r\n  var browser_has_Map = typeof Map !== 'undefined';\r\n\r\n  function get_sst_id(sst, str, rev) {\r\n    var i = 0, len = sst.length;\r\n    if(rev) {\r\n      if(browser_has_Map ? rev.has(str) : rev.hasOwnProperty(str)) {\r\n        var revarr = browser_has_Map ? rev.get(str) : rev[str];\r\n        for(; i < revarr.length; ++i) {\r\n          if(sst[revarr[i]].t === str) { sst.Count ++; return revarr[i]; }\r\n        }\r\n      }\r\n    } else for(; i < len; ++i) {\r\n      if(sst[i].t === str) { sst.Count ++; return i; }\r\n    }\r\n    sst[len] = ({t:str}); sst.Count ++; sst.Unique ++;\r\n    if(rev) {\r\n      if(browser_has_Map) {\r\n        if(!rev.has(str)) rev.set(str, []);\r\n        rev.get(str).push(len);\r\n      } else {\r\n        if(!rev.hasOwnProperty(str)) rev[str] = [];\r\n        rev[str].push(len);\r\n      }\r\n    }\r\n    return len;\r\n  }\r\n\r\n  function col_obj_w(C, col) {\r\n    var p = ({min:C+1,max:C+1});\r\n    /* wch (chars), wpx (pixels) */\r\n    var wch = -1;\r\n    if(col.MDW) MDW = col.MDW;\r\n    if(col.width != null) p.customWidth = 1;\r\n    else if(col.wpx != null) wch = px2char(col.wpx);\r\n    else if(col.wch != null) wch = col.wch;\r\n    if(wch > -1) { p.width = char2width(wch); p.customWidth = 1; }\r\n    else if(col.width != null) p.width = col.width;\r\n    if(col.hidden) p.hidden = true;\r\n    return p;\r\n  }\r\n\r\n  function default_margins(margins, mode) {\r\n    if(!margins) return;\r\n    var defs = [0.7, 0.7, 0.75, 0.75, 0.3, 0.3];\r\n    if(mode == 'xlml') defs = [1, 1, 1, 1, 0.5, 0.5];\r\n    if(margins.left   == null) margins.left   = defs[0];\r\n    if(margins.right  == null) margins.right  = defs[1];\r\n    if(margins.top    == null) margins.top    = defs[2];\r\n    if(margins.bottom == null) margins.bottom = defs[3];\r\n    if(margins.header == null) margins.header = defs[4];\r\n    if(margins.footer == null) margins.footer = defs[5];\r\n  }\r\n\r\n  function get_cell_style(styles, cell, opts) {\r\n    if (typeof style_builder != 'undefined') {\r\n      if (/^\\d+$/.exec(cell.s)) { return cell.s}  // if its already an integer index, let it be\r\n      if (cell.s && (cell.s == +cell.s)) { return cell.s}  // if its already an integer index, let it be\r\n      var s = cell.s || {};\r\n      if (cell.z) s.numFmt = cell.z;\r\n      return style_builder.addStyle(s);\r\n    }\r\n    else {\r\n      var z = opts.revssf[cell.z != null ? cell.z : \"General\"];\r\n      var i = 0x3c, len = styles.length;\r\n      if (z == null && opts.ssf) {\r\n        for (; i < 0x188; ++i) if (opts.ssf[i] == null) {\r\n          SSF.load(cell.z, i);\r\n          // $FlowIgnore\r\n          opts.ssf[i] = cell.z;\r\n          opts.revssf[cell.z] = z = i;\r\n          break;\r\n        }\r\n      }\r\n      for (i = 0; i != len; ++i) if (styles[i].numFmtId === z) return i;\r\n      styles[len] = {\r\n        numFmtId: z,\r\n        fontId: 0,\r\n        fillId: 0,\r\n        borderId: 0,\r\n        xfId: 0,\r\n        applyNumberFormat: 1\r\n      };\r\n      return len;\r\n    }\r\n  }\r\n\r\n  function safe_format(p, fmtid, fillid, opts, themes, styles) {\r\n    if(p.t === 'z') return;\r\n    if(p.t === 'd' && typeof p.v === 'string') p.v = parseDate(p.v);\r\n    try {\r\n      if(opts.cellNF) p.z = SSF._table[fmtid];\r\n    } catch(e) { if(opts.WTF) throw e; }\r\n    if(!opts || opts.cellText !== false) try {\r\n      if(SSF._table[fmtid] == null) SSF.load(SSFImplicit[fmtid] || \"General\", fmtid);\r\n      if(p.t === 'e') p.w = p.w || BErr[p.v];\r\n      else if(fmtid === 0) {\r\n        if(p.t === 'n') {\r\n          if((p.v|0) === p.v) p.w = SSF._general_int(p.v);\r\n          else p.w = SSF._general_num(p.v);\r\n        }\r\n        else if(p.t === 'd') {\r\n          var dd = datenum(p.v);\r\n          if((dd|0) === dd) p.w = SSF._general_int(dd);\r\n          else p.w = SSF._general_num(dd);\r\n        }\r\n        else if(p.v === undefined) return \"\";\r\n        else p.w = SSF._general(p.v,_ssfopts);\r\n      }\r\n      else if(p.t === 'd') p.w = SSF.format(fmtid,datenum(p.v),_ssfopts);\r\n      else p.w = SSF.format(fmtid,p.v,_ssfopts);\r\n    } catch(e) { if(opts.WTF) throw e; }\r\n    if(!opts.cellStyles) return;\r\n    if(fillid != null) try {\r\n      p.s = styles.Fills[fillid];\r\n      if (p.s.fgColor && p.s.fgColor.theme && !p.s.fgColor.rgb) {\r\n        p.s.fgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.fgColor.theme].rgb, p.s.fgColor.tint || 0);\r\n        if(opts.WTF) p.s.fgColor.raw_rgb = themes.themeElements.clrScheme[p.s.fgColor.theme].rgb;\r\n      }\r\n      if (p.s.bgColor && p.s.bgColor.theme) {\r\n        p.s.bgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.bgColor.theme].rgb, p.s.bgColor.tint || 0);\r\n        if(opts.WTF) p.s.bgColor.raw_rgb = themes.themeElements.clrScheme[p.s.bgColor.theme].rgb;\r\n      }\r\n    } catch(e) { if(opts.WTF && styles.Fills) throw e; }\r\n  }\r\n\r\n  function check_ws(ws, sname, i) {\r\n    if(ws && ws['!ref']) {\r\n      var range = safe_decode_range(ws['!ref']);\r\n      if(range.e.c < range.s.c || range.e.r < range.s.r) throw new Error(\"Bad range (\" + i + \"): \" + ws['!ref']);\r\n    }\r\n  }\r\n  function parse_ws_xml_dim(ws, s) {\r\n    var d = safe_decode_range(s);\r\n    if(d.s.r<=d.e.r && d.s.c<=d.e.c && d.s.r>=0 && d.s.c>=0) ws[\"!ref\"] = encode_range(d);\r\n  }\r\n  var mergecregex = /<(?:\\w:)?mergeCell ref=\"[A-Z0-9:]+\"\\s*[\\/]?>/g;\r\n  var sheetdataregex = /<(?:\\w+:)?sheetData>([\\s\\S]*)<\\/(?:\\w+:)?sheetData>/;\r\n  var hlinkregex = /<(?:\\w:)?hyperlink [^>]*>/mg;\r\n  var dimregex = /\"(\\w*:\\w*)\"/;\r\n  var colregex = /<(?:\\w:)?col\\b[^>]*[\\/]?>/g;\r\n  var afregex = /<(?:\\w:)?autoFilter[^>]*([\\/]|>([\\s\\S]*)<\\/(?:\\w:)?autoFilter)>/g;\r\n  var marginregex= /<(?:\\w:)?pageMargins[^>]*\\/>/g;\r\n  var sheetprregex = /<(?:\\w:)?sheetPr\\b(?:[^>a-z][^>]*)?\\/>/;\r\n  var svsregex = /<(?:\\w:)?sheetViews[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetViews)>/;\r\n  /* 18.3 Worksheets */\r\n  function parse_ws_xml(data, opts, idx, rels, wb, themes, styles) {\r\n    if(!data) return data;\r\n    if(DENSE != null && opts.dense == null) opts.dense = DENSE;\r\n\r\n    /* 18.3.1.99 worksheet CT_Worksheet */\r\n    var s = opts.dense ? ([]) : ({});\r\n    var refguess = ({s: {r:2000000, c:2000000}, e: {r:0, c:0} });\r\n\r\n    var data1 = \"\", data2 = \"\";\r\n    var mtch = data.match(sheetdataregex);\r\n    if(mtch) {\r\n      data1 = data.slice(0, mtch.index);\r\n      data2 = data.slice(mtch.index + mtch[0].length);\r\n    } else data1 = data2 = data;\r\n\r\n    /* 18.3.1.82 sheetPr CT_SheetPr */\r\n    var sheetPr = data1.match(sheetprregex);\r\n    if(sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);\r\n\r\n    /* 18.3.1.35 dimension CT_SheetDimension */\r\n    // $FlowIgnore\r\n    var ridx = (data1.match(/<(?:\\w*:)?dimension/)||{index:-1}).index;\r\n    if(ridx > 0) {\r\n      var ref = data1.slice(ridx,ridx+50).match(dimregex);\r\n      if(ref) parse_ws_xml_dim(s, ref[1]);\r\n    }\r\n\r\n    /* 18.3.1.88 sheetViews CT_SheetViews */\r\n    var svs = data1.match(svsregex);\r\n    if(svs && svs[1]) parse_ws_xml_sheetviews(svs[1], wb);\r\n\r\n    /* 18.3.1.17 cols CT_Cols */\r\n    var columns = [];\r\n    if(opts.cellStyles) {\r\n      /* 18.3.1.13 col CT_Col */\r\n      var cols = data1.match(colregex);\r\n      if(cols) parse_ws_xml_cols(columns, cols);\r\n    }\r\n\r\n    /* 18.3.1.80 sheetData CT_SheetData ? */\r\n    if(mtch) parse_ws_xml_data(mtch[1], s, opts, refguess, themes, styles);\r\n\r\n    /* 18.3.1.2  autoFilter CT_AutoFilter */\r\n    var afilter = data2.match(afregex);\r\n    if(afilter) s['!autofilter'] = parse_ws_xml_autofilter(afilter[0]);\r\n\r\n    /* 18.3.1.55 mergeCells CT_MergeCells */\r\n    var merges = [];\r\n    var _merge = data2.match(mergecregex);\r\n    if(_merge) for(ridx = 0; ridx != _merge.length; ++ridx)\r\n      merges[ridx] = safe_decode_range(_merge[ridx].slice(_merge[ridx].indexOf(\"\\\"\")+1));\r\n\r\n    /* 18.3.1.48 hyperlinks CT_Hyperlinks */\r\n    var hlink = data2.match(hlinkregex);\r\n    if(hlink) parse_ws_xml_hlinks(s, hlink, rels);\r\n\r\n    /* 18.3.1.62 pageMargins CT_PageMargins */\r\n    var margins = data2.match(marginregex);\r\n    if(margins) s['!margins'] = parse_ws_xml_margins(parsexmltag(margins[0]));\r\n\r\n    if(!s[\"!ref\"] && refguess.e.c >= refguess.s.c && refguess.e.r >= refguess.s.r) s[\"!ref\"] = encode_range(refguess);\r\n    if(opts.sheetRows > 0 && s[\"!ref\"]) {\r\n      var tmpref = safe_decode_range(s[\"!ref\"]);\r\n      if(opts.sheetRows <= +tmpref.e.r) {\r\n        tmpref.e.r = opts.sheetRows - 1;\r\n        if(tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\r\n        if(tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\r\n        if(tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\r\n        if(tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\r\n        s[\"!fullref\"] = s[\"!ref\"];\r\n        s[\"!ref\"] = encode_range(tmpref);\r\n      }\r\n    }\r\n    if(columns.length > 0) s[\"!cols\"] = columns;\r\n    if(merges.length > 0) s[\"!merges\"] = merges;\r\n    return s;\r\n  }\r\n\r\n  function write_ws_xml_merges(merges) {\r\n    if(merges.length === 0) return \"\";\r\n    var o = '<mergeCells count=\"' + merges.length + '\">';\r\n    for(var i = 0; i != merges.length; ++i) o += '<mergeCell ref=\"' + encode_range(merges[i]) + '\"/>';\r\n    return o + '</mergeCells>';\r\n  }\r\n\r\n  /* 18.3.1.82-3 sheetPr CT_ChartsheetPr / CT_SheetPr */\r\n  function parse_ws_xml_sheetpr(sheetPr, s, wb, idx) {\r\n    var data = parsexmltag(sheetPr);\r\n    if(!wb.Sheets[idx]) wb.Sheets[idx] = {};\r\n    if(data.codeName) wb.Sheets[idx].CodeName = data.codeName;\r\n  }\r\n\r\n  /* 18.3.1.85 sheetProtection CT_SheetProtection */\r\n  function write_ws_xml_protection(sp) {\r\n    // algorithmName, hashValue, saltValue, spinCountpassword\r\n    var o = ({sheet:1});\r\n    var deffalse = [\"objects\", \"scenarios\", \"selectLockedCells\", \"selectUnlockedCells\"];\r\n    var deftrue = [\r\n      \"formatColumns\", \"formatRows\", \"formatCells\",\r\n      \"insertColumns\", \"insertRows\", \"insertHyperlinks\",\r\n      \"deleteColumns\", \"deleteRows\",\r\n      \"sort\", \"autoFilter\", \"pivotTables\"\r\n    ];\r\n    deffalse.forEach(function(n) { if(sp[n] != null && sp[n]) o[n] = \"1\"; });\r\n    deftrue.forEach(function(n) { if(sp[n] != null && !sp[n]) o[n] = \"0\"; });\r\n    /* TODO: algorithm */\r\n    if(sp.password) o.password = crypto_CreatePasswordVerifier_Method1(sp.password).toString(16).toUpperCase();\r\n    return writextag('sheetProtection', null, o);\r\n  }\r\n\r\n  function parse_ws_xml_hlinks(s, data, rels) {\r\n    var dense = Array.isArray(s);\r\n    for(var i = 0; i != data.length; ++i) {\r\n      var val = parsexmltag(utf8read(data[i]), true);\r\n      if(!val.ref) return;\r\n      var rel = ((rels || {})['!id']||[])[val.id];\r\n      if(rel) {\r\n        val.Target = rel.Target;\r\n        if(val.location) val.Target += \"#\"+val.location;\r\n      } else {\r\n        val.Target = \"#\" + val.location;\r\n        rel = {Target: val.Target, TargetMode: 'Internal'};\r\n      }\r\n      val.Rel = rel;\r\n      if(val.tooltip) { val.Tooltip = val.tooltip; delete val.tooltip; }\r\n      var rng = safe_decode_range(val.ref);\r\n      for(var R=rng.s.r;R<=rng.e.r;++R) for(var C=rng.s.c;C<=rng.e.c;++C) {\r\n        var addr = encode_cell({c:C,r:R});\r\n        if(dense) {\r\n          if(!s[R]) s[R] = [];\r\n          if(!s[R][C]) s[R][C] = {t:\"z\",v:undefined};\r\n          s[R][C].l = val;\r\n        } else {\r\n          if(!s[addr]) s[addr] = {t:\"z\",v:undefined};\r\n          s[addr].l = val;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function parse_ws_xml_margins(margin) {\r\n    var o = {};\r\n    [\"left\", \"right\", \"top\", \"bottom\", \"header\", \"footer\"].forEach(function(k) {\r\n      if(margin[k]) o[k] = parseFloat(margin[k]);\r\n    });\r\n    return o;\r\n  }\r\n  function write_ws_xml_margins(margin) {\r\n    default_margins(margin);\r\n    return writextag('pageMargins', null, margin);\r\n  }\r\n\r\n  function parse_ws_xml_cols(columns, cols) {\r\n    var seencol = false;\r\n    for(var coli = 0; coli != cols.length; ++coli) {\r\n      var coll = parsexmltag(cols[coli], true);\r\n      if(coll.hidden) coll.hidden = parsexmlbool(coll.hidden);\r\n      var colm=parseInt(coll.min, 10)-1, colM=parseInt(coll.max,10)-1;\r\n      delete coll.min; delete coll.max; coll.width = +coll.width;\r\n      if(!seencol && coll.width) { seencol = true; find_mdw_colw(coll.width); }\r\n      process_col(coll);\r\n      while(colm <= colM) columns[colm++] = dup(coll);\r\n    }\r\n  }\r\n\r\n  function write_ws_xml_cols(ws, cols) {\r\n    var o = [\"<cols>\"], col;\r\n    for(var i = 0; i != cols.length; ++i) {\r\n      if(!(col = cols[i])) continue;\r\n      o[o.length] = (writextag('col', null, col_obj_w(i, col)));\r\n    }\r\n    o[o.length] = \"</cols>\";\r\n    return o.join(\"\");\r\n  }\r\n\r\n  function parse_ws_xml_autofilter(data) {\r\n    var o = { ref: (data.match(/ref=\"([^\"]*)\"/)||[])[1]};\r\n    return o;\r\n  }\r\n  function write_ws_xml_autofilter(data, ws, wb, idx) {\r\n    var ref = typeof data.ref == \"string\" ? data.ref : encode_range(data.ref);\r\n    if(!wb.Workbook) wb.Workbook = {};\r\n    if(!wb.Workbook.Names) wb.Workbook.Names = [];\r\n    var names = wb.Workbook.Names;\r\n    var range = decode_range(ref);\r\n    if(range.s.r == range.e.r) { range.e.r = decode_range(ws[\"!ref\"]).e.r; ref = encode_range(range); }\r\n    for(var i = 0; i < names.length; ++i) {\r\n      var name = names[i];\r\n      if(name.Name != '_xlnm._FilterDatabase') continue;\r\n      if(name.Sheet != idx) continue;\r\n      name.Ref = \"'\" + wb.SheetNames[idx] + \"'!\" + ref; break;\r\n    }\r\n    if(i == names.length) names.push({ Name: '_xlnm._FilterDatabase', Sheet: idx, Ref: \"'\" + wb.SheetNames[idx] + \"'!\" + ref  });\r\n    return writextag(\"autoFilter\", null, {ref:ref});\r\n  }\r\n\r\n  /* 18.3.1.88 sheetViews CT_SheetViews */\r\n  /* 18.3.1.87 sheetView CT_SheetView */\r\n  var sviewregex = /<(?:\\w:)?sheetView(?:[^>a-z][^>]*)?\\/>/;\r\n  function parse_ws_xml_sheetviews(data, wb) {\r\n    (data.match(sviewregex)||[]).forEach(function(r) {\r\n      var tag = parsexmltag(r);\r\n      if(parsexmlbool(tag.rightToLeft)) {\r\n        if(!wb.Views) wb.Views = [{}];\r\n        if(!wb.Views[0]) wb.Views[0] = {};\r\n        wb.Views[0].RTL = true;\r\n      }\r\n    });\r\n  }\r\n  function write_ws_xml_sheetviews(ws, opts, idx, wb) {\r\n    var sview = {workbookViewId:\"0\"};\r\n    // $FlowIgnore\r\n    if( (((wb||{}).Workbook||{}).Views||[])[0] ) sview.rightToLeft = wb.Workbook.Views[0].RTL ? \"1\" : \"0\";\r\n    return writextag(\"sheetViews\", writextag(\"sheetView\", null, sview), {});\r\n  }\r\n\r\n  function write_ws_xml_cell(cell, ref, ws, opts) {\r\n    if(cell.v === undefined && cell.f === undefined || cell.t === 'z') return \"\";\r\n    var vv = \"\";\r\n    var oldt = cell.t, oldv = cell.v;\r\n    switch(cell.t) {\r\n      case 'b': vv = cell.v ? \"1\" : \"0\"; break;\r\n      case 'n': vv = ''+cell.v; break;\r\n      case 'e': vv = BErr[cell.v]; break;\r\n      case 'd':\r\n        if(opts.cellDates) vv = parseDate(cell.v, -1).toISOString();\r\n        else {\r\n          cell = dup(cell);\r\n          cell.t = 'n';\r\n          vv = ''+(cell.v = datenum(parseDate(cell.v)));\r\n        }\r\n        if(typeof cell.z === 'undefined') cell.z = SSF._table[14];\r\n        break;\r\n      default: vv = cell.v; break;\r\n    }\r\n    var v = writetag('v', escapexml(vv)), o = ({r:ref});\r\n    /* TODO: cell style */\r\n    var os = get_cell_style(opts.cellXfs, cell, opts);\r\n    if(os !== 0) o.s = os;\r\n    switch(cell.t) {\r\n      case 'n': break;\r\n      case 'd': o.t = \"d\"; break;\r\n      case 'b': o.t = \"b\"; break;\r\n      case 'e': o.t = \"e\"; break;\r\n      default: if(cell.v == null) { delete cell.t; break; }\r\n        if(opts.bookSST) {\r\n          v = writetag('v', ''+get_sst_id(opts.Strings, cell.v, opts.revStrings));\r\n          o.t = \"s\"; break;\r\n        }\r\n        o.t = \"str\"; break;\r\n    }\r\n    if(cell.t != oldt) { cell.t = oldt; cell.v = oldv; }\r\n    if(cell.f) {\r\n      var ff = cell.F && cell.F.slice(0, ref.length) == ref ? {t:\"array\", ref:cell.F} : null;\r\n      v = writextag('f', escapexml(cell.f), ff) + (cell.v != null ? v : \"\");\r\n    }\r\n    if(cell.l) ws['!links'].push([ref, cell.l]);\r\n    if(cell.c) ws['!comments'].push([ref, cell.c]);\r\n    return writextag('c', v, o);\r\n  }\r\n\r\n  var parse_ws_xml_data = (function() {\r\n    var cellregex = /<(?:\\w+:)?c[ >]/, rowregex = /<\\/(?:\\w+:)?row>/;\r\n    var rregex = /r=[\"']([^\"']*)[\"']/, isregex = /<(?:\\w+:)?is>([\\S\\s]*?)<\\/(?:\\w+:)?is>/;\r\n    var refregex = /ref=[\"']([^\"']*)[\"']/;\r\n    var match_v = matchtag(\"v\"), match_f = matchtag(\"f\");\r\n\r\n    return function parse_ws_xml_data(sdata, s, opts, guess, themes, styles) {\r\n      var ri = 0, x = \"\", cells = [], cref = [], idx=0, i=0, cc=0, d=\"\", p;\r\n      var tag, tagr = 0, tagc = 0;\r\n      var sstr, ftag;\r\n      var fmtid = 0, fillid = 0;\r\n      var do_format = Array.isArray(styles.CellXf), cf;\r\n      var arrayf = [];\r\n      var sharedf = [];\r\n      var dense = Array.isArray(s);\r\n      var rows = [], rowobj = {}, rowrite = false;\r\n      for(var marr = sdata.split(rowregex), mt = 0, marrlen = marr.length; mt != marrlen; ++mt) {\r\n        x = marr[mt].trim();\r\n        var xlen = x.length;\r\n        if(xlen === 0) continue;\r\n\r\n        /* 18.3.1.73 row CT_Row */\r\n        for(ri = 0; ri < xlen; ++ri) if(x.charCodeAt(ri) === 62) break; ++ri;\r\n        tag = parsexmltag(x.slice(0,ri), true);\r\n        tagr = tag.r != null ? parseInt(tag.r, 10) : tagr+1; tagc = -1;\r\n        if(opts.sheetRows && opts.sheetRows < tagr) continue;\r\n        if(guess.s.r > tagr - 1) guess.s.r = tagr - 1;\r\n        if(guess.e.r < tagr - 1) guess.e.r = tagr - 1;\r\n\r\n        if(opts && opts.cellStyles) {\r\n          rowobj = {}; rowrite = false;\r\n          if(tag.ht) { rowrite = true; rowobj.hpt = parseFloat(tag.ht); rowobj.hpx = pt2px(rowobj.hpt); }\r\n          if(tag.hidden == \"1\") { rowrite = true; rowobj.hidden = true; }\r\n          if(tag.outlineLevel != null) { rowrite = true; rowobj.level = +tag.outlineLevel; }\r\n          if(rowrite) rows[tagr-1] = rowobj;\r\n        }\r\n\r\n        /* 18.3.1.4 c CT_Cell */\r\n        cells = x.slice(ri).split(cellregex);\r\n        for(ri = 0; ri != cells.length; ++ri) {\r\n          x = cells[ri].trim();\r\n          if(x.length === 0) continue;\r\n          cref = x.match(rregex); idx = ri; i=0; cc=0;\r\n          x = \"<c \" + (x.slice(0,1)==\"<\"?\">\":\"\") + x;\r\n          if(cref != null && cref.length === 2) {\r\n            idx = 0; d=cref[1];\r\n            for(i=0; i != d.length; ++i) {\r\n              if((cc=d.charCodeAt(i)-64) < 1 || cc > 26) break;\r\n              idx = 26*idx + cc;\r\n            }\r\n            --idx;\r\n            tagc = idx;\r\n          } else ++tagc;\r\n          for(i = 0; i != x.length; ++i) if(x.charCodeAt(i) === 62) break; ++i;\r\n          tag = parsexmltag(x.slice(0,i), true);\r\n          if(!tag.r) tag.r = encode_cell({r:tagr-1, c:tagc});\r\n          d = x.slice(i);\r\n          p = ({t:\"\"});\r\n\r\n          if((cref=d.match(match_v))!= null && cref[1] !== '') p.v=unescapexml(cref[1]);\r\n          if(opts.cellFormula) {\r\n            if((cref=d.match(match_f))!= null && cref[1] !== '') {\r\n              /* TODO: match against XLSXFutureFunctions */\r\n              p.f=_xlfn(unescapexml(utf8read(cref[1])));\r\n              if(cref[0].indexOf('t=\"array\"') > -1) {\r\n                p.F = (d.match(refregex)||[])[1];\r\n                if(p.F.indexOf(\":\") > -1) arrayf.push([safe_decode_range(p.F), p.F]);\r\n              } else if(cref[0].indexOf('t=\"shared\"') > -1) {\r\n                // TODO: parse formula\r\n                ftag = parsexmltag(cref[0]);\r\n                sharedf[parseInt(ftag.si, 10)] = [ftag, _xlfn(unescapexml(utf8read(cref[1]))), tag.r];\r\n              }\r\n            } else if((cref=d.match(/<f[^>]*\\/>/))) {\r\n              ftag = parsexmltag(cref[0]);\r\n              if(sharedf[ftag.si]) p.f = shift_formula_xlsx(sharedf[ftag.si][1], sharedf[ftag.si][2]/*[0].ref*/, tag.r);\r\n            }\r\n            /* TODO: factor out contains logic */\r\n            var _tag = decode_cell(tag.r);\r\n            for(i = 0; i < arrayf.length; ++i)\r\n              if(_tag.r >= arrayf[i][0].s.r && _tag.r <= arrayf[i][0].e.r)\r\n                if(_tag.c >= arrayf[i][0].s.c && _tag.c <= arrayf[i][0].e.c)\r\n                  p.F = arrayf[i][1];\r\n          }\r\n\r\n          if(tag.t == null && p.v === undefined) {\r\n            if(p.f || p.F) {\r\n              p.v = 0; p.t = \"n\";\r\n            } else if(!opts.sheetStubs) continue;\r\n            else p.t = \"z\";\r\n          }\r\n          else p.t = tag.t || \"n\";\r\n          if(guess.s.c > tagc) guess.s.c = tagc;\r\n          if(guess.e.c < tagc) guess.e.c = tagc;\r\n          /* 18.18.11 t ST_CellType */\r\n          switch(p.t) {\r\n            case 'n':\r\n              if(p.v == \"\" || p.v == null) {\r\n                if(!opts.sheetStubs) continue;\r\n                p.t = 'z';\r\n              } else p.v = parseFloat(p.v);\r\n              break;\r\n            case 's':\r\n              if(typeof p.v == 'undefined') {\r\n                if(!opts.sheetStubs) continue;\r\n                p.t = 'z';\r\n              } else {\r\n                sstr = strs[parseInt(p.v, 10)];\r\n                p.v = sstr.t;\r\n                p.r = sstr.r;\r\n                if(opts.cellHTML) p.h = sstr.h;\r\n              }\r\n              break;\r\n            case 'str':\r\n              p.t = \"s\";\r\n              p.v = (p.v!=null) ? utf8read(p.v) : '';\r\n              if(opts.cellHTML) p.h = escapehtml(p.v);\r\n              break;\r\n            case 'inlineStr':\r\n              cref = d.match(isregex);\r\n              p.t = 's';\r\n              if(cref != null && (sstr = parse_si(cref[1]))) p.v = sstr.t; else p.v = \"\";\r\n              break;\r\n            case 'b': p.v = parsexmlbool(p.v); break;\r\n            case 'd':\r\n              if(opts.cellDates) p.v = parseDate(p.v, 1);\r\n              else { p.v = datenum(parseDate(p.v, 1)); p.t = 'n'; }\r\n              break;\r\n            /* error string in .w, number in .v */\r\n            case 'e':\r\n              if(!opts || opts.cellText !== false) p.w = p.v;\r\n              p.v = RBErr[p.v]; break;\r\n          }\r\n          /* formatting */\r\n          fmtid = fillid = 0;\r\n          if(do_format && tag.s !== undefined) {\r\n            cf = styles.CellXf[tag.s];\r\n            if(cf != null) {\r\n              if(cf.numFmtId != null) fmtid = cf.numFmtId;\r\n              if(opts.cellStyles) {\r\n                if(cf.fillId != null) fillid = cf.fillId;\r\n              }\r\n            }\r\n          }\r\n          safe_format(p, fmtid, fillid, opts, themes, styles);\r\n          if(opts.cellDates && do_format && p.t == 'n' && SSF.is_date(SSF._table[fmtid])) { p.t = 'd'; p.v = numdate(p.v); }\r\n          if(dense) {\r\n            var _r = decode_cell(tag.r);\r\n            if(!s[_r.r]) s[_r.r] = [];\r\n            s[_r.r][_r.c] = p;\r\n          } else s[tag.r] = p;\r\n        }\r\n      }\r\n      if(rows.length > 0) s['!rows'] = rows;\r\n    }; })();\r\n\r\n  function write_ws_xml_data(ws, opts, idx, wb) {\r\n    var o = [], r = [], range = safe_decode_range(ws['!ref']), cell=\"\", ref, rr = \"\", cols = [], R=0, C=0, rows = ws['!rows'];\r\n    var dense = Array.isArray(ws);\r\n    var params = ({r:rr}), row, height = -1;\r\n    for(C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\r\n    for(R = range.s.r; R <= range.e.r; ++R) {\r\n      r = [];\r\n      rr = encode_row(R);\r\n      for(C = range.s.c; C <= range.e.c; ++C) {\r\n        ref = cols[C] + rr;\r\n        var _cell = dense ? (ws[R]||[])[C]: ws[ref];\r\n        if(_cell === undefined) continue;\r\n        if((cell = write_ws_xml_cell(_cell, ref, ws, opts, idx, wb)) != null) r.push(cell);\r\n      }\r\n      if(r.length > 0 || (rows && rows[R])) {\r\n        params = ({r:rr});\r\n        if(rows && rows[R]) {\r\n          row = rows[R];\r\n          if(row.hidden) params.hidden = 1;\r\n          height = -1;\r\n          if(row.hpx) height = px2pt(row.hpx);\r\n          else if(row.hpt) height = row.hpt;\r\n          if(height > -1) { params.ht = height; params.customHeight = 1; }\r\n          if(row.level) { params.outlineLevel = row.level; }\r\n        }\r\n        o[o.length] = (writextag('row', r.join(\"\"), params));\r\n      }\r\n    }\r\n    if(rows) for(; R < rows.length; ++R) {\r\n      if(rows && rows[R]) {\r\n        params = ({r:R+1});\r\n        row = rows[R];\r\n        if(row.hidden) params.hidden = 1;\r\n        height = -1;\r\n        if (row.hpx) height = px2pt(row.hpx);\r\n        else if (row.hpt) height = row.hpt;\r\n        if (height > -1) { params.ht = height; params.customHeight = 1; }\r\n        if (row.level) { params.outlineLevel = row.level; }\r\n        o[o.length] = (writextag('row', \"\", params));\r\n      }\r\n    }\r\n    return o.join(\"\");\r\n  }\r\n\r\n  var WS_XML_ROOT = writextag('worksheet', null, {\r\n    'xmlns': XMLNS.main[0],\r\n    'xmlns:r': XMLNS.r\r\n  });\r\n\r\n  function write_ws_xml(idx, opts, wb, rels) {\r\n    var o = [XML_HEADER, WS_XML_ROOT];\r\n    var s = wb.SheetNames[idx], sidx = 0, rdata = \"\";\r\n    var ws = wb.Sheets[s];\r\n    if(ws == null) ws = {};\r\n    var ref = ws['!ref'] || 'A1';\r\n    var range = safe_decode_range(ref);\r\n    if(range.e.c > 0x3FFF || range.e.r > 0xFFFFF) {\r\n      if(opts.WTF) throw new Error(\"Range \" + ref + \" exceeds format limit A1:XFD1048576\");\r\n      range.e.c = Math.min(range.e.c, 0x3FFF);\r\n      range.e.r = Math.min(range.e.c, 0xFFFFF);\r\n      ref = encode_range(range);\r\n    }\r\n    if(!rels) rels = {};\r\n    ws['!comments'] = [];\r\n    ws['!drawing'] = [];\r\n\r\n    if(opts.bookType !== 'xlsx' && wb.vbaraw) {\r\n      var cname = wb.SheetNames[idx];\r\n      try { if(wb.Workbook) cname = wb.Workbook.Sheets[idx].CodeName || cname; } catch(e) {}\r\n      o[o.length] = (writextag('sheetPr', null, {'codeName': escapexml(cname)}));\r\n    }\r\n\r\n    o[o.length] = (writextag('dimension', null, {'ref': ref}));\r\n\r\n    o[o.length] = write_ws_xml_sheetviews(ws, opts, idx, wb);\r\n\r\n    /* TODO: store in WB, process styles */\r\n    if(opts.sheetFormat) o[o.length] = (writextag('sheetFormatPr', null, {\r\n      defaultRowHeight:opts.sheetFormat.defaultRowHeight||'16',\r\n      baseColWidth:opts.sheetFormat.baseColWidth||'10',\r\n      outlineLevelRow:opts.sheetFormat.outlineLevelRow||'7'\r\n    }));\r\n\r\n    if(ws['!cols'] != null && ws['!cols'].length > 0) o[o.length] = (write_ws_xml_cols(ws, ws['!cols']));\r\n\r\n    o[sidx = o.length] = '<sheetData/>';\r\n    ws['!links'] = [];\r\n    if(ws['!ref'] != null) {\r\n      rdata = write_ws_xml_data(ws, opts, idx, wb, rels);\r\n      if(rdata.length > 0) o[o.length] = (rdata);\r\n    }\r\n    if(o.length>sidx+1) { o[o.length] = ('</sheetData>'); o[sidx]=o[sidx].replace(\"/>\",\">\"); }\r\n\r\n    /* sheetCalcPr */\r\n\r\n    if(ws['!protect'] != null) o[o.length] = write_ws_xml_protection(ws['!protect']);\r\n\r\n    /* protectedRanges */\r\n    /* scenarios */\r\n\r\n    if(ws['!autofilter'] != null) o[o.length] = write_ws_xml_autofilter(ws['!autofilter'], ws, wb, idx);\r\n\r\n    /* sortState */\r\n    /* dataConsolidate */\r\n    /* customSheetViews */\r\n\r\n    if(ws['!merges'] != null && ws['!merges'].length > 0) o[o.length] = (write_ws_xml_merges(ws['!merges']));\r\n\r\n    /* phoneticPr */\r\n    /* conditionalFormatting */\r\n    /* dataValidations */\r\n\r\n    var relc = -1, rel, rId = -1;\r\n    if(ws['!links'].length > 0) {\r\n      o[o.length] = \"<hyperlinks>\";\r\n      ws['!links'].forEach(function(l) {\r\n        if(!l[1].Target) return;\r\n        rel = ({\"ref\":l[0]});\r\n        if(l[1].Target.charAt(0) != \"#\") {\r\n          rId = add_rels(rels, -1, escapexml(l[1].Target).replace(/#.*$/, \"\"), RELS.HLINK);\r\n          rel[\"r:id\"] = \"rId\"+rId;\r\n        }\r\n        if((relc = l[1].Target.indexOf(\"#\")) > -1) rel.location = escapexml(l[1].Target.slice(relc+1));\r\n        if(l[1].Tooltip) rel.tooltip = escapexml(l[1].Tooltip);\r\n        o[o.length] = writextag(\"hyperlink\",null,rel);\r\n      });\r\n      o[o.length] = \"</hyperlinks>\";\r\n    }\r\n    delete ws['!links'];\r\n\r\n    /* printOptions */\r\n    if (ws['!margins'] != null) o[o.length] =  write_ws_xml_margins(ws['!margins']);\r\n    /* pageSetup */\r\n\r\n    //var hfidx = o.length;\r\n    o[o.length] = \"\";\r\n\r\n    /* rowBreaks */\r\n    /* colBreaks */\r\n    /* customProperties */\r\n    /* cellWatches */\r\n\r\n    if(!opts || opts.ignoreEC || (opts.ignoreEC == (void 0))) o[o.length] = writetag(\"ignoredErrors\", writextag(\"ignoredError\", null, {numberStoredAsText:1, sqref:ref}));\r\n\r\n    /* smartTags */\r\n\r\n    if(ws['!drawing'].length > 0) {\r\n      rId = add_rels(rels, -1, \"../drawings/drawing\" + (idx+1) + \".xml\", RELS.DRAW);\r\n      o[o.length] = writextag(\"drawing\", null, {\"r:id\":\"rId\" + rId});\r\n    }\r\n    else delete ws['!drawing'];\r\n\r\n    if(ws['!comments'].length > 0) {\r\n      rId = add_rels(rels, -1, \"../drawings/vmlDrawing\" + (idx+1) + \".vml\", RELS.VML);\r\n      o[o.length] = writextag(\"legacyDrawing\", null, {\"r:id\":\"rId\" + rId});\r\n      ws['!legacy'] = rId;\r\n    }\r\n\r\n    /* drawingHF */\r\n    /* picture */\r\n    /* oleObjects */\r\n    /* controls */\r\n    /* webPublishItems */\r\n    /* tableParts */\r\n    /* extList */\r\n\r\n    if(o.length>2) { o[o.length] = ('</worksheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\r\n    return o.join(\"\");\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.726 BrtRowHdr */\r\n  function parse_BrtRowHdr(data, length) {\r\n    var z = ({});\r\n    var tgt = data.l + length;\r\n    z.r = data.read_shift(4);\r\n    data.l += 4; // TODO: ixfe\r\n    var miyRw = data.read_shift(2);\r\n    data.l += 1; // TODO: top/bot padding\r\n    var flags = data.read_shift(1);\r\n    data.l = tgt;\r\n    if(flags & 0x07) z.level = flags & 0x07;\r\n    if(flags & 0x10) z.hidden = true;\r\n    if(flags & 0x20) z.hpt = miyRw / 20;\r\n    return z;\r\n  }\r\n  function write_BrtRowHdr(R, range, ws) {\r\n    var o = new_buf(17+8*16);\r\n    var row = (ws['!rows']||[])[R]||{};\r\n    o.write_shift(4, R);\r\n\r\n    o.write_shift(4, 0); /* TODO: ixfe */\r\n\r\n    var miyRw = 0x0140;\r\n    if(row.hpx) miyRw = px2pt(row.hpx) * 20;\r\n    else if(row.hpt) miyRw = row.hpt * 20;\r\n    o.write_shift(2, miyRw);\r\n\r\n    o.write_shift(1, 0); /* top/bot padding */\r\n\r\n    var flags = 0x0;\r\n    if(row.level) flags |= row.level;\r\n    if(row.hidden) flags |= 0x10;\r\n    if(row.hpx || row.hpt) flags |= 0x20;\r\n    o.write_shift(1, flags);\r\n\r\n    o.write_shift(1, 0); /* phonetic guide */\r\n\r\n    /* [MS-XLSB] 2.5.8 BrtColSpan explains the mechanism */\r\n    var ncolspan = 0, lcs = o.l;\r\n    o.l += 4;\r\n\r\n    var caddr = {r:R, c:0};\r\n    for(var i = 0; i < 16; ++i) {\r\n      if((range.s.c > ((i+1) << 10)) || (range.e.c < (i << 10))) continue;\r\n      var first = -1, last = -1;\r\n      for(var j = (i<<10); j < ((i+1)<<10); ++j) {\r\n        caddr.c = j;\r\n        var cell = Array.isArray(ws) ? (ws[caddr.r]||[])[caddr.c] : ws[encode_cell(caddr)];\r\n        if(cell) { if(first < 0) first = j; last = j; }\r\n      }\r\n      if(first < 0) continue;\r\n      ++ncolspan;\r\n      o.write_shift(4, first);\r\n      o.write_shift(4, last);\r\n    }\r\n\r\n    var l = o.l;\r\n    o.l = lcs;\r\n    o.write_shift(4, ncolspan);\r\n    o.l = l;\r\n\r\n    return o.length > o.l ? o.slice(0, o.l) : o;\r\n  }\r\n  function write_row_header(ba, ws, range, R) {\r\n    var o = write_BrtRowHdr(R, range, ws);\r\n    if((o.length > 17) || (ws['!rows']||[])[R]) write_record(ba, 'BrtRowHdr', o);\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.820 BrtWsDim */\r\n  var parse_BrtWsDim = parse_UncheckedRfX;\r\n  var write_BrtWsDim = write_UncheckedRfX;\r\n\r\n  /* [MS-XLSB] 2.4.821 BrtWsFmtInfo */\r\n  function parse_BrtWsFmtInfo() {\r\n  }\r\n//function write_BrtWsFmtInfo(ws, o) { }\r\n\r\n  /* [MS-XLSB] 2.4.823 BrtWsProp */\r\n  function parse_BrtWsProp(data, length) {\r\n    var z = {};\r\n    /* TODO: pull flags */\r\n    data.l += 19;\r\n    z.name = parse_XLSBCodeName(data, length - 19);\r\n    return z;\r\n  }\r\n  function write_BrtWsProp(str, o) {\r\n    if(o == null) o = new_buf(84+4*str.length);\r\n    for(var i = 0; i < 3; ++i) o.write_shift(1,0);\r\n    write_BrtColor({auto:1}, o);\r\n    o.write_shift(-4,-1);\r\n    o.write_shift(-4,-1);\r\n    write_XLSBCodeName(str, o);\r\n    return o.slice(0, o.l);\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.306 BrtCellBlank */\r\n  function parse_BrtCellBlank(data) {\r\n    var cell = parse_XLSBCell(data);\r\n    return [cell];\r\n  }\r\n  function write_BrtCellBlank(cell, ncell, o) {\r\n    if(o == null) o = new_buf(8);\r\n    return write_XLSBCell(ncell, o);\r\n  }\r\n\r\n\r\n  /* [MS-XLSB] 2.4.307 BrtCellBool */\r\n  function parse_BrtCellBool(data) {\r\n    var cell = parse_XLSBCell(data);\r\n    var fBool = data.read_shift(1);\r\n    return [cell, fBool, 'b'];\r\n  }\r\n  function write_BrtCellBool(cell, ncell, o) {\r\n    if(o == null) o = new_buf(9);\r\n    write_XLSBCell(ncell, o);\r\n    o.write_shift(1, cell.v ? 1 : 0);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.308 BrtCellError */\r\n  function parse_BrtCellError(data) {\r\n    var cell = parse_XLSBCell(data);\r\n    var bError = data.read_shift(1);\r\n    return [cell, bError, 'e'];\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.311 BrtCellIsst */\r\n  function parse_BrtCellIsst(data) {\r\n    var cell = parse_XLSBCell(data);\r\n    var isst = data.read_shift(4);\r\n    return [cell, isst, 's'];\r\n  }\r\n  function write_BrtCellIsst(cell, ncell, o) {\r\n    if(o == null) o = new_buf(12);\r\n    write_XLSBCell(ncell, o);\r\n    o.write_shift(4, ncell.v);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.313 BrtCellReal */\r\n  function parse_BrtCellReal(data) {\r\n    var cell = parse_XLSBCell(data);\r\n    var value = parse_Xnum(data);\r\n    return [cell, value, 'n'];\r\n  }\r\n  function write_BrtCellReal(cell, ncell, o) {\r\n    if(o == null) o = new_buf(16);\r\n    write_XLSBCell(ncell, o);\r\n    write_Xnum(cell.v, o);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.314 BrtCellRk */\r\n  function parse_BrtCellRk(data) {\r\n    var cell = parse_XLSBCell(data);\r\n    var value = parse_RkNumber(data);\r\n    return [cell, value, 'n'];\r\n  }\r\n  function write_BrtCellRk(cell, ncell, o) {\r\n    if(o == null) o = new_buf(12);\r\n    write_XLSBCell(ncell, o);\r\n    write_RkNumber(cell.v, o);\r\n    return o;\r\n  }\r\n\r\n\r\n  /* [MS-XLSB] 2.4.317 BrtCellSt */\r\n  function parse_BrtCellSt(data) {\r\n    var cell = parse_XLSBCell(data);\r\n    var value = parse_XLWideString(data);\r\n    return [cell, value, 'str'];\r\n  }\r\n  function write_BrtCellSt(cell, ncell, o) {\r\n    if(o == null) o = new_buf(12 + 4 * cell.v.length);\r\n    write_XLSBCell(ncell, o);\r\n    write_XLWideString(cell.v, o);\r\n    return o.length > o.l ? o.slice(0, o.l) : o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.653 BrtFmlaBool */\r\n  function parse_BrtFmlaBool(data, length, opts) {\r\n    var end = data.l + length;\r\n    var cell = parse_XLSBCell(data);\r\n    cell.r = opts['!row'];\r\n    var value = data.read_shift(1);\r\n    var o = [cell, value, 'b'];\r\n    if(opts.cellFormula) {\r\n      data.l += 2;\r\n      var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\r\n      o[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\r\n    }\r\n    else data.l = end;\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.654 BrtFmlaError */\r\n  function parse_BrtFmlaError(data, length, opts) {\r\n    var end = data.l + length;\r\n    var cell = parse_XLSBCell(data);\r\n    cell.r = opts['!row'];\r\n    var value = data.read_shift(1);\r\n    var o = [cell, value, 'e'];\r\n    if(opts.cellFormula) {\r\n      data.l += 2;\r\n      var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\r\n      o[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\r\n    }\r\n    else data.l = end;\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.655 BrtFmlaNum */\r\n  function parse_BrtFmlaNum(data, length, opts) {\r\n    var end = data.l + length;\r\n    var cell = parse_XLSBCell(data);\r\n    cell.r = opts['!row'];\r\n    var value = parse_Xnum(data);\r\n    var o = [cell, value, 'n'];\r\n    if(opts.cellFormula) {\r\n      data.l += 2;\r\n      var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\r\n      o[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\r\n    }\r\n    else data.l = end;\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.656 BrtFmlaString */\r\n  function parse_BrtFmlaString(data, length, opts) {\r\n    var end = data.l + length;\r\n    var cell = parse_XLSBCell(data);\r\n    cell.r = opts['!row'];\r\n    var value = parse_XLWideString(data);\r\n    var o = [cell, value, 'str'];\r\n    if(opts.cellFormula) {\r\n      data.l += 2;\r\n      var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\r\n      o[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\r\n    }\r\n    else data.l = end;\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.682 BrtMergeCell */\r\n  var parse_BrtMergeCell = parse_UncheckedRfX;\r\n  var write_BrtMergeCell = write_UncheckedRfX;\r\n  /* [MS-XLSB] 2.4.107 BrtBeginMergeCells */\r\n  function write_BrtBeginMergeCells(cnt, o) {\r\n    if(o == null) o = new_buf(4);\r\n    o.write_shift(4, cnt);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.662 BrtHLink */\r\n  function parse_BrtHLink(data, length) {\r\n    var end = data.l + length;\r\n    var rfx = parse_UncheckedRfX(data, 16);\r\n    var relId = parse_XLNullableWideString(data);\r\n    var loc = parse_XLWideString(data);\r\n    var tooltip = parse_XLWideString(data);\r\n    var display = parse_XLWideString(data);\r\n    data.l = end;\r\n    var o = ({rfx:rfx, relId:relId, loc:loc, display:display});\r\n    if(tooltip) o.Tooltip = tooltip;\r\n    return o;\r\n  }\r\n  function write_BrtHLink(l, rId) {\r\n    var o = new_buf(50+4*(l[1].Target.length + (l[1].Tooltip || \"\").length));\r\n    write_UncheckedRfX({s:decode_cell(l[0]), e:decode_cell(l[0])}, o);\r\n    write_RelID(\"rId\" + rId, o);\r\n    var locidx = l[1].Target.indexOf(\"#\");\r\n    var loc = locidx == -1 ? \"\" : l[1].Target.slice(locidx+1);\r\n    write_XLWideString(loc || \"\", o);\r\n    write_XLWideString(l[1].Tooltip || \"\", o);\r\n    write_XLWideString(\"\", o);\r\n    return o.slice(0, o.l);\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.6 BrtArrFmla */\r\n  function parse_BrtArrFmla(data, length, opts) {\r\n    var end = data.l + length;\r\n    var rfx = parse_RfX(data, 16);\r\n    var fAlwaysCalc = data.read_shift(1);\r\n    var o = [rfx]; o[2] = fAlwaysCalc;\r\n    if(opts.cellFormula) {\r\n      var formula = parse_XLSBArrayParsedFormula(data, end - data.l, opts);\r\n      o[1] = formula;\r\n    } else data.l = end;\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.750 BrtShrFmla */\r\n  function parse_BrtShrFmla(data, length, opts) {\r\n    var end = data.l + length;\r\n    var rfx = parse_UncheckedRfX(data, 16);\r\n    var o = [rfx];\r\n    if(opts.cellFormula) {\r\n      var formula = parse_XLSBSharedParsedFormula(data, end - data.l, opts);\r\n      o[1] = formula;\r\n      data.l = end;\r\n    } else data.l = end;\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.323 BrtColInfo */\r\n  /* TODO: once XLS ColInfo is set, combine the functions */\r\n  function write_BrtColInfo(C, col, o) {\r\n    if(o == null) o = new_buf(18);\r\n    var p = col_obj_w(C, col);\r\n    o.write_shift(-4, C);\r\n    o.write_shift(-4, C);\r\n    o.write_shift(4, (p.width || 10) * 256);\r\n    o.write_shift(4, 0/*ixfe*/); // style\r\n    var flags = 0;\r\n    if(col.hidden) flags |= 0x01;\r\n    if(typeof p.width == 'number') flags |= 0x02;\r\n    o.write_shift(1, flags); // bit flag\r\n    o.write_shift(1, 0); // bit flag\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.678 BrtMargins */\r\n  var BrtMarginKeys = [\"left\",\"right\",\"top\",\"bottom\",\"header\",\"footer\"];\r\n  function parse_BrtMargins(data) {\r\n    var margins = ({});\r\n    BrtMarginKeys.forEach(function(k) { margins[k] = parse_Xnum(data, 8); });\r\n    return margins;\r\n  }\r\n  function write_BrtMargins(margins, o) {\r\n    if(o == null) o = new_buf(6*8);\r\n    default_margins(margins);\r\n    BrtMarginKeys.forEach(function(k) { write_Xnum((margins)[k], o); });\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.299 BrtBeginWsView */\r\n  function parse_BrtBeginWsView(data) {\r\n    var f = data.read_shift(2);\r\n    data.l += 28;\r\n    return { RTL: f & 0x20 };\r\n  }\r\n  function write_BrtBeginWsView(ws, Workbook, o) {\r\n    if(o == null) o = new_buf(30);\r\n    var f = 0x39c;\r\n    if((((Workbook||{}).Views||[])[0]||{}).RTL) f |= 0x20;\r\n    o.write_shift(2, f); // bit flag\r\n    o.write_shift(4, 0);\r\n    o.write_shift(4, 0); // view first row\r\n    o.write_shift(4, 0); // view first col\r\n    o.write_shift(1, 0); // gridline color ICV\r\n    o.write_shift(1, 0);\r\n    o.write_shift(2, 0);\r\n    o.write_shift(2, 100); // zoom scale\r\n    o.write_shift(2, 0);\r\n    o.write_shift(2, 0);\r\n    o.write_shift(2, 0);\r\n    o.write_shift(4, 0); // workbook view id\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.309 BrtCellIgnoreEC */\r\n  function write_BrtCellIgnoreEC(ref) {\r\n    var o = new_buf(24);\r\n    o.write_shift(4, 4);\r\n    o.write_shift(4, 1);\r\n    write_UncheckedRfX(ref, o);\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.748 BrtSheetProtection */\r\n  function write_BrtSheetProtection(sp, o) {\r\n    if(o == null) o = new_buf(16*4+2);\r\n    o.write_shift(2, sp.password ? crypto_CreatePasswordVerifier_Method1(sp.password) : 0);\r\n    o.write_shift(4, 1); // this record should not be written if no protection\r\n    [\r\n      [\"objects\",             false], // fObjects\r\n      [\"scenarios\",           false], // fScenarios\r\n      [\"formatCells\",          true], // fFormatCells\r\n      [\"formatColumns\",        true], // fFormatColumns\r\n      [\"formatRows\",           true], // fFormatRows\r\n      [\"insertColumns\",        true], // fInsertColumns\r\n      [\"insertRows\",           true], // fInsertRows\r\n      [\"insertHyperlinks\",     true], // fInsertHyperlinks\r\n      [\"deleteColumns\",        true], // fDeleteColumns\r\n      [\"deleteRows\",           true], // fDeleteRows\r\n      [\"selectLockedCells\",   false], // fSelLockedCells\r\n      [\"sort\",                 true], // fSort\r\n      [\"autoFilter\",           true], // fAutoFilter\r\n      [\"pivotTables\",          true], // fPivotTables\r\n      [\"selectUnlockedCells\", false]  // fSelUnlockedCells\r\n    ].forEach(function(n) {\r\n      if(n[1]) o.write_shift(4, sp[n[0]] != null && !sp[n[0]] ? 1 : 0);\r\n      else      o.write_shift(4, sp[n[0]] != null && sp[n[0]] ? 0 : 1);\r\n    });\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.1.7.61 Worksheet */\r\n  function parse_ws_bin(data, _opts, idx, rels, wb, themes, styles) {\r\n    if(!data) return data;\r\n    var opts = _opts || {};\r\n    if(!rels) rels = {'!id':{}};\r\n    if(DENSE != null && opts.dense == null) opts.dense = DENSE;\r\n    var s = (opts.dense ? [] : {});\r\n\r\n    var ref;\r\n    var refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\r\n\r\n    var pass = false, end = false;\r\n    var row, p, cf, R, C, addr, sstr, rr, cell;\r\n    var merges = [];\r\n    opts.biff = 12;\r\n    opts['!row'] = 0;\r\n\r\n    var ai = 0, af = false;\r\n\r\n    var arrayf = [];\r\n    var sharedf = {};\r\n    var supbooks = opts.supbooks || wb.supbooks || ([[]]);\r\n    supbooks.sharedf = sharedf;\r\n    supbooks.arrayf = arrayf;\r\n    supbooks.SheetNames = wb.SheetNames || wb.Sheets.map(function(x) { return x.name; });\r\n    if(!opts.supbooks) {\r\n      opts.supbooks = supbooks;\r\n      if(wb.Names) for(var i = 0; i < wb.Names.length; ++i) supbooks[0][i+1] = wb.Names[i];\r\n    }\r\n\r\n    var colinfo = [], rowinfo = [];\r\n    var seencol = false;\r\n\r\n    recordhopper(data, function ws_parse(val, R_n, RT) {\r\n      if(end) return;\r\n      switch(RT) {\r\n        case 0x0094: /* 'BrtWsDim' */\r\n          ref = val; break;\r\n        case 0x0000: /* 'BrtRowHdr' */\r\n          row = val;\r\n          if(opts.sheetRows && opts.sheetRows <= row.r) end=true;\r\n          rr = encode_row(R = row.r);\r\n          opts['!row'] = row.r;\r\n          if(val.hidden || val.hpt || val.level != null) {\r\n            if(val.hpt) val.hpx = pt2px(val.hpt);\r\n            rowinfo[val.r] = val;\r\n          }\r\n          break;\r\n\r\n        case 0x0002: /* 'BrtCellRk' */\r\n        case 0x0003: /* 'BrtCellError' */\r\n        case 0x0004: /* 'BrtCellBool' */\r\n        case 0x0005: /* 'BrtCellReal' */\r\n        case 0x0006: /* 'BrtCellSt' */\r\n        case 0x0007: /* 'BrtCellIsst' */\r\n        case 0x0008: /* 'BrtFmlaString' */\r\n        case 0x0009: /* 'BrtFmlaNum' */\r\n        case 0x000A: /* 'BrtFmlaBool' */\r\n        case 0x000B: /* 'BrtFmlaError' */\r\n          p = ({t:val[2]});\r\n          switch(val[2]) {\r\n            case 'n': p.v = val[1]; break;\r\n            case 's': sstr = strs[val[1]]; p.v = sstr.t; p.r = sstr.r; break;\r\n            case 'b': p.v = val[1] ? true : false; break;\r\n            case 'e': p.v = val[1]; if(opts.cellText !== false) p.w = BErr[p.v]; break;\r\n            case 'str': p.t = 's'; p.v = val[1]; break;\r\n          }\r\n          if((cf = styles.CellXf[val[0].iStyleRef])) safe_format(p,cf.numFmtId,null,opts, themes, styles);\r\n          C = val[0].c;\r\n          if(opts.dense) { if(!s[R]) s[R] = []; s[R][C] = p; }\r\n          else s[encode_col(C) + rr] = p;\r\n          if(opts.cellFormula) {\r\n            af = false;\r\n            for(ai = 0; ai < arrayf.length; ++ai) {\r\n              var aii = arrayf[ai];\r\n              if(row.r >= aii[0].s.r && row.r <= aii[0].e.r)\r\n                if(C >= aii[0].s.c && C <= aii[0].e.c) {\r\n                  p.F = encode_range(aii[0]); af = true;\r\n                }\r\n            }\r\n            if(!af && val.length > 3) p.f = val[3];\r\n          }\r\n          if(refguess.s.r > row.r) refguess.s.r = row.r;\r\n          if(refguess.s.c > C) refguess.s.c = C;\r\n          if(refguess.e.r < row.r) refguess.e.r = row.r;\r\n          if(refguess.e.c < C) refguess.e.c = C;\r\n          if(opts.cellDates && cf && p.t == 'n' && SSF.is_date(SSF._table[cf.numFmtId])) {\r\n            var _d = SSF.parse_date_code(p.v); if(_d) { p.t = 'd'; p.v = new Date(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u); }\r\n          }\r\n          break;\r\n\r\n        case 0x0001: /* 'BrtCellBlank' */\r\n          if(!opts.sheetStubs || pass) break;\r\n          p = ({t:'z',v:undefined});\r\n          C = val[0].c;\r\n          if(opts.dense) { if(!s[R]) s[R] = []; s[R][C] = p; }\r\n          else s[encode_col(C) + rr] = p;\r\n          if(refguess.s.r > row.r) refguess.s.r = row.r;\r\n          if(refguess.s.c > C) refguess.s.c = C;\r\n          if(refguess.e.r < row.r) refguess.e.r = row.r;\r\n          if(refguess.e.c < C) refguess.e.c = C;\r\n          break;\r\n\r\n        case 0x00B0: /* 'BrtMergeCell' */\r\n          merges.push(val); break;\r\n\r\n        case 0x01EE: /* 'BrtHLink' */\r\n          var rel = rels['!id'][val.relId];\r\n          if(rel) {\r\n            val.Target = rel.Target;\r\n            if(val.loc) val.Target += \"#\"+val.loc;\r\n            val.Rel = rel;\r\n          } else if(val.relId == '') {\r\n            val.Target = \"#\" + val.loc;\r\n          }\r\n          for(R=val.rfx.s.r;R<=val.rfx.e.r;++R) for(C=val.rfx.s.c;C<=val.rfx.e.c;++C) {\r\n            if(opts.dense) {\r\n              if(!s[R]) s[R] = [];\r\n              if(!s[R][C]) s[R][C] = {t:'z',v:undefined};\r\n              s[R][C].l = val;\r\n            } else {\r\n              addr = encode_cell({c:C,r:R});\r\n              if(!s[addr]) s[addr] = {t:'z',v:undefined};\r\n              s[addr].l = val;\r\n            }\r\n          }\r\n          break;\r\n\r\n        case 0x01AA: /* 'BrtArrFmla' */\r\n          if(!opts.cellFormula) break;\r\n          arrayf.push(val);\r\n          cell = ((opts.dense ? s[R][C] : s[encode_col(C) + rr]));\r\n          cell.f = stringify_formula(val[1], refguess, {r:row.r, c:C}, supbooks, opts);\r\n          cell.F = encode_range(val[0]);\r\n          break;\r\n        case 0x01AB: /* 'BrtShrFmla' */\r\n          if(!opts.cellFormula) break;\r\n          sharedf[encode_cell(val[0].s)] = val[1];\r\n          cell = (opts.dense ? s[R][C] : s[encode_col(C) + rr]);\r\n          cell.f = stringify_formula(val[1], refguess, {r:row.r, c:C}, supbooks, opts);\r\n          break;\r\n\r\n        /* identical to 'ColInfo' in XLS */\r\n        case 0x003C: /* 'BrtColInfo' */\r\n          if(!opts.cellStyles) break;\r\n          while(val.e >= val.s) {\r\n            colinfo[val.e--] = { width: val.w/256, hidden: !!(val.flags & 0x01) };\r\n            if(!seencol) { seencol = true; find_mdw_colw(val.w/256); }\r\n            process_col(colinfo[val.e+1]);\r\n          }\r\n          break;\r\n\r\n        case 0x00A1: /* 'BrtBeginAFilter' */\r\n          s['!autofilter'] = { ref:encode_range(val) };\r\n          break;\r\n\r\n        case 0x01DC: /* 'BrtMargins' */\r\n          s['!margins'] = val;\r\n          break;\r\n\r\n        case 0x0093: /* 'BrtWsProp' */\r\n          if(!wb.Sheets[idx]) wb.Sheets[idx] = {};\r\n          if(val.name) wb.Sheets[idx].CodeName = val.name;\r\n          break;\r\n\r\n        case 0x0089: /* 'BrtBeginWsView' */\r\n          if(!wb.Views) wb.Views = [{}];\r\n          if(!wb.Views[0]) wb.Views[0] = {};\r\n          if(val.RTL) wb.Views[0].RTL = true;\r\n          break;\r\n\r\n        case 0x01E5: /* 'BrtWsFmtInfo' */\r\n          break;\r\n        case 0x00AF: /* 'BrtAFilterDateGroupItem' */\r\n        case 0x0284: /* 'BrtActiveX' */\r\n        case 0x0271: /* 'BrtBigName' */\r\n        case 0x0232: /* 'BrtBkHim' */\r\n        case 0x018C: /* 'BrtBrk' */\r\n        case 0x0458: /* 'BrtCFIcon' */\r\n        case 0x047A: /* 'BrtCFRuleExt' */\r\n        case 0x01D7: /* 'BrtCFVO' */\r\n        case 0x041A: /* 'BrtCFVO14' */\r\n        case 0x0289: /* 'BrtCellIgnoreEC' */\r\n        case 0x0451: /* 'BrtCellIgnoreEC14' */\r\n        case 0x0031: /* 'BrtCellMeta' */\r\n        case 0x024D: /* 'BrtCellSmartTagProperty' */\r\n        case 0x025F: /* 'BrtCellWatch' */\r\n        case 0x0234: /* 'BrtColor' */\r\n        case 0x041F: /* 'BrtColor14' */\r\n        case 0x00A8: /* 'BrtColorFilter' */\r\n        case 0x00AE: /* 'BrtCustomFilter' */\r\n        case 0x049C: /* 'BrtCustomFilter14' */\r\n        case 0x01F3: /* 'BrtDRef' */\r\n        case 0x0040: /* 'BrtDVal' */\r\n        case 0x041D: /* 'BrtDVal14' */\r\n        case 0x0226: /* 'BrtDrawing' */\r\n        case 0x00AB: /* 'BrtDynamicFilter' */\r\n        case 0x00A7: /* 'BrtFilter' */\r\n        case 0x0499: /* 'BrtFilter14' */\r\n        case 0x00A9: /* 'BrtIconFilter' */\r\n        case 0x049D: /* 'BrtIconFilter14' */\r\n        case 0x0227: /* 'BrtLegacyDrawing' */\r\n        case 0x0228: /* 'BrtLegacyDrawingHF' */\r\n        case 0x0295: /* 'BrtListPart' */\r\n        case 0x027F: /* 'BrtOleObject' */\r\n        case 0x01DE: /* 'BrtPageSetup' */\r\n        case 0x0097: /* 'BrtPane' */\r\n        case 0x0219: /* 'BrtPhoneticInfo' */\r\n        case 0x01DD: /* 'BrtPrintOptions' */\r\n        case 0x0218: /* 'BrtRangeProtection' */\r\n        case 0x044F: /* 'BrtRangeProtection14' */\r\n        case 0x02A8: /* 'BrtRangeProtectionIso' */\r\n        case 0x0450: /* 'BrtRangeProtectionIso14' */\r\n        case 0x0400: /* 'BrtRwDescent' */\r\n        case 0x0098: /* 'BrtSel' */\r\n        case 0x0297: /* 'BrtSheetCalcProp' */\r\n        case 0x0217: /* 'BrtSheetProtection' */\r\n        case 0x02A6: /* 'BrtSheetProtectionIso' */\r\n        case 0x01F8: /* 'BrtSlc' */\r\n        case 0x0413: /* 'BrtSparkline' */\r\n        case 0x01AC: /* 'BrtTable' */\r\n        case 0x00AA: /* 'BrtTop10Filter' */\r\n        case 0x0C00: /* 'BrtUid' */\r\n        case 0x0032: /* 'BrtValueMeta' */\r\n        case 0x0816: /* 'BrtWebExtension' */\r\n        case 0x0415: /* 'BrtWsFmtInfoEx14' */\r\n          break;\r\n\r\n        case 0x0023: /* 'BrtFRTBegin' */\r\n          pass = true; break;\r\n        case 0x0024: /* 'BrtFRTEnd' */\r\n          pass = false; break;\r\n        case 0x0025: /* 'BrtACBegin' */ break;\r\n        case 0x0026: /* 'BrtACEnd' */ break;\r\n\r\n        default:\r\n          if((R_n||\"\").indexOf(\"Begin\") > 0){/* empty */}\r\n          else if((R_n||\"\").indexOf(\"End\") > 0){/* empty */}\r\n          else if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R_n);\r\n      }\r\n    }, opts);\r\n\r\n    delete opts.supbooks;\r\n    delete opts['!row'];\r\n\r\n    if(!s[\"!ref\"] && (refguess.s.r < 2000000 || ref && (ref.e.r > 0 || ref.e.c > 0 || ref.s.r > 0 || ref.s.c > 0))) s[\"!ref\"] = encode_range(ref || refguess);\r\n    if(opts.sheetRows && s[\"!ref\"]) {\r\n      var tmpref = safe_decode_range(s[\"!ref\"]);\r\n      if(opts.sheetRows <= +tmpref.e.r) {\r\n        tmpref.e.r = opts.sheetRows - 1;\r\n        if(tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\r\n        if(tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\r\n        if(tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\r\n        if(tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\r\n        s[\"!fullref\"] = s[\"!ref\"];\r\n        s[\"!ref\"] = encode_range(tmpref);\r\n      }\r\n    }\r\n    if(merges.length > 0) s[\"!merges\"] = merges;\r\n    if(colinfo.length > 0) s[\"!cols\"] = colinfo;\r\n    if(rowinfo.length > 0) s[\"!rows\"] = rowinfo;\r\n    return s;\r\n  }\r\n\r\n  /* TODO: something useful -- this is a stub */\r\n  function write_ws_bin_cell(ba, cell, R, C, opts, ws) {\r\n    if(cell.v === undefined) return \"\";\r\n    var vv = \"\";\r\n    switch(cell.t) {\r\n      case 'b': vv = cell.v ? \"1\" : \"0\"; break;\r\n      case 'd': // no BrtCellDate :(\r\n        cell = dup(cell);\r\n        cell.z = cell.z || SSF._table[14];\r\n        cell.v = datenum(parseDate(cell.v)); cell.t = 'n';\r\n        break;\r\n      /* falls through */\r\n      case 'n': case 'e': vv = ''+cell.v; break;\r\n      default: vv = cell.v; break;\r\n    }\r\n    var o = ({r:R, c:C});\r\n    /* TODO: cell style */\r\n    o.s = get_cell_style(opts.cellXfs, cell, opts);\r\n    if(cell.l) ws['!links'].push([encode_cell(o), cell.l]);\r\n    if(cell.c) ws['!comments'].push([encode_cell(o), cell.c]);\r\n    switch(cell.t) {\r\n      case 's': case 'str':\r\n        if(opts.bookSST) {\r\n          vv = get_sst_id(opts.Strings, (cell.v), opts.revStrings);\r\n          o.t = \"s\"; o.v = vv;\r\n          write_record(ba, \"BrtCellIsst\", write_BrtCellIsst(cell, o));\r\n        } else {\r\n          o.t = \"str\";\r\n          write_record(ba, \"BrtCellSt\", write_BrtCellSt(cell, o));\r\n        }\r\n        return;\r\n      case 'n':\r\n        /* TODO: determine threshold for Real vs RK */\r\n        if(cell.v == (cell.v | 0) && cell.v > -1000 && cell.v < 1000) write_record(ba, \"BrtCellRk\", write_BrtCellRk(cell, o));\r\n        else write_record(ba, \"BrtCellReal\", write_BrtCellReal(cell, o));\r\n        return;\r\n      case 'b':\r\n        o.t = \"b\";\r\n        write_record(ba, \"BrtCellBool\", write_BrtCellBool(cell, o));\r\n        return;\r\n      case 'e': /* TODO: error */ o.t = \"e\"; break;\r\n    }\r\n    write_record(ba, \"BrtCellBlank\", write_BrtCellBlank(cell, o));\r\n  }\r\n\r\n  function write_CELLTABLE(ba, ws, idx, opts) {\r\n    var range = safe_decode_range(ws['!ref'] || \"A1\"), ref, rr = \"\", cols = [];\r\n    write_record(ba, 'BrtBeginSheetData');\r\n    var dense = Array.isArray(ws);\r\n    var cap = range.e.r;\r\n    if(ws['!rows']) cap = Math.max(range.e.r, ws['!rows'].length - 1);\r\n    for(var R = range.s.r; R <= cap; ++R) {\r\n      rr = encode_row(R);\r\n      /* [ACCELLTABLE] */\r\n      /* BrtRowHdr */\r\n      write_row_header(ba, ws, range, R);\r\n      if(R <= range.e.r) for(var C = range.s.c; C <= range.e.c; ++C) {\r\n        /* *16384CELL */\r\n        if(R === range.s.r) cols[C] = encode_col(C);\r\n        ref = cols[C] + rr;\r\n        var cell = dense ? (ws[R]||[])[C] : ws[ref];\r\n        if(!cell) continue;\r\n        /* write cell */\r\n        write_ws_bin_cell(ba, cell, R, C, opts, ws);\r\n      }\r\n    }\r\n    write_record(ba, 'BrtEndSheetData');\r\n  }\r\n\r\n  function write_MERGECELLS(ba, ws) {\r\n    if(!ws || !ws['!merges']) return;\r\n    write_record(ba, 'BrtBeginMergeCells', write_BrtBeginMergeCells(ws['!merges'].length));\r\n    ws['!merges'].forEach(function(m) { write_record(ba, 'BrtMergeCell', write_BrtMergeCell(m)); });\r\n    write_record(ba, 'BrtEndMergeCells');\r\n  }\r\n\r\n  function write_COLINFOS(ba, ws) {\r\n    if(!ws || !ws['!cols']) return;\r\n    write_record(ba, 'BrtBeginColInfos');\r\n    ws['!cols'].forEach(function(m, i) { if(m) write_record(ba, 'BrtColInfo', write_BrtColInfo(i, m)); });\r\n    write_record(ba, 'BrtEndColInfos');\r\n  }\r\n\r\n  function write_IGNOREECS(ba, ws) {\r\n    if(!ws || !ws['!ref']) return;\r\n    write_record(ba, 'BrtBeginCellIgnoreECs');\r\n    write_record(ba, 'BrtCellIgnoreEC', write_BrtCellIgnoreEC(safe_decode_range(ws['!ref'])));\r\n    write_record(ba, 'BrtEndCellIgnoreECs');\r\n  }\r\n\r\n  function write_HLINKS(ba, ws, rels) {\r\n    /* *BrtHLink */\r\n    ws['!links'].forEach(function(l) {\r\n      if(!l[1].Target) return;\r\n      var rId = add_rels(rels, -1, l[1].Target.replace(/#.*$/, \"\"), RELS.HLINK);\r\n      write_record(ba, \"BrtHLink\", write_BrtHLink(l, rId));\r\n    });\r\n    delete ws['!links'];\r\n  }\r\n  function write_LEGACYDRAWING(ba, ws, idx, rels) {\r\n    /* [BrtLegacyDrawing] */\r\n    if(ws['!comments'].length > 0) {\r\n      var rId = add_rels(rels, -1, \"../drawings/vmlDrawing\" + (idx+1) + \".vml\", RELS.VML);\r\n      write_record(ba, \"BrtLegacyDrawing\", write_RelID(\"rId\" + rId));\r\n      ws['!legacy'] = rId;\r\n    }\r\n  }\r\n\r\n  function write_AUTOFILTER(ba, ws) {\r\n    if(!ws['!autofilter']) return;\r\n    write_record(ba, \"BrtBeginAFilter\", write_UncheckedRfX(safe_decode_range(ws['!autofilter'].ref)));\r\n    /* *FILTERCOLUMN */\r\n    /* [SORTSTATE] */\r\n    /* BrtEndAFilter */\r\n    write_record(ba, \"BrtEndAFilter\");\r\n  }\r\n\r\n  function write_WSVIEWS2(ba, ws, Workbook) {\r\n    write_record(ba, \"BrtBeginWsViews\");\r\n    { /* 1*WSVIEW2 */\r\n      /* [ACUID] */\r\n      write_record(ba, \"BrtBeginWsView\", write_BrtBeginWsView(ws, Workbook));\r\n      /* [BrtPane] */\r\n      /* *4BrtSel */\r\n      /* *4SXSELECT */\r\n      /* *FRT */\r\n      write_record(ba, \"BrtEndWsView\");\r\n    }\r\n    /* *FRT */\r\n    write_record(ba, \"BrtEndWsViews\");\r\n  }\r\n\r\n  function write_WSFMTINFO() {\r\n    /* [ACWSFMTINFO] */\r\n    //write_record(ba, \"BrtWsFmtInfo\", write_BrtWsFmtInfo(ws));\r\n  }\r\n\r\n  function write_SHEETPROTECT(ba, ws) {\r\n    if(!ws['!protect']) return;\r\n    /* [BrtSheetProtectionIso] */\r\n    write_record(ba, \"BrtSheetProtection\", write_BrtSheetProtection(ws['!protect']));\r\n  }\r\n\r\n  function write_ws_bin(idx, opts, wb, rels) {\r\n    var ba = buf_array();\r\n    var s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};\r\n    var c = s; try { if(wb && wb.Workbook) c = wb.Workbook.Sheets[idx].CodeName || c; } catch(e) {}\r\n    var r = safe_decode_range(ws['!ref'] || \"A1\");\r\n    if(r.e.c > 0x3FFF || r.e.r > 0xFFFFF) {\r\n      if(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:XFD1048576\");\r\n      r.e.c = Math.min(r.e.c, 0x3FFF);\r\n      r.e.r = Math.min(r.e.c, 0xFFFFF);\r\n    }\r\n    ws['!links'] = [];\r\n    /* passed back to write_zip and removed there */\r\n    ws['!comments'] = [];\r\n    write_record(ba, \"BrtBeginSheet\");\r\n    if(wb.vbaraw) write_record(ba, \"BrtWsProp\", write_BrtWsProp(c));\r\n    write_record(ba, \"BrtWsDim\", write_BrtWsDim(r));\r\n    write_WSVIEWS2(ba, ws, wb.Workbook);\r\n    write_WSFMTINFO(ba, ws);\r\n    write_COLINFOS(ba, ws, idx, opts, wb);\r\n    write_CELLTABLE(ba, ws, idx, opts, wb);\r\n    /* [BrtSheetCalcProp] */\r\n    write_SHEETPROTECT(ba, ws);\r\n    /* *([BrtRangeProtectionIso] BrtRangeProtection) */\r\n    /* [SCENMAN] */\r\n    write_AUTOFILTER(ba, ws);\r\n    /* [SORTSTATE] */\r\n    /* [DCON] */\r\n    /* [USERSHVIEWS] */\r\n    write_MERGECELLS(ba, ws);\r\n    /* [BrtPhoneticInfo] */\r\n    /* *CONDITIONALFORMATTING */\r\n    /* [DVALS] */\r\n    write_HLINKS(ba, ws, rels);\r\n    /* [BrtPrintOptions] */\r\n    if(ws['!margins']) write_record(ba, \"BrtMargins\", write_BrtMargins(ws['!margins']));\r\n    /* [BrtPageSetup] */\r\n    /* [HEADERFOOTER] */\r\n    /* [RWBRK] */\r\n    /* [COLBRK] */\r\n    /* *BrtBigName */\r\n    /* [CELLWATCHES] */\r\n    if(!opts || opts.ignoreEC || (opts.ignoreEC == (void 0))) write_IGNOREECS(ba, ws);\r\n    /* [SMARTTAGS] */\r\n    /* [BrtDrawing] */\r\n    write_LEGACYDRAWING(ba, ws, idx, rels);\r\n    /* [BrtLegacyDrawingHF] */\r\n    /* [BrtBkHim] */\r\n    /* [OLEOBJECTS] */\r\n    /* [ACTIVEXCONTROLS] */\r\n    /* [WEBPUBITEMS] */\r\n    /* [LISTPARTS] */\r\n    /* FRTWORKSHEET */\r\n    write_record(ba, \"BrtEndSheet\");\r\n    return ba.end();\r\n  }\r\n  function parse_numCache(data) {\r\n    var col = [];\r\n\r\n    /* 21.2.2.150 pt CT_NumVal */\r\n    (data.match(/<c:pt idx=\"(\\d*)\">(.*?)<\\/c:pt>/mg)||[]).forEach(function(pt) {\r\n      var q = pt.match(/<c:pt idx=\"(\\d*?)\"><c:v>(.*)<\\/c:v><\\/c:pt>/);\r\n      if(!q) return;\r\n      col[+q[1]] = +q[2];\r\n    });\r\n\r\n    /* 21.2.2.71 formatCode CT_Xstring */\r\n    var nf = unescapexml((data.match(/<c:formatCode>([\\s\\S]*?)<\\/c:formatCode>/) || [\"\",\"General\"])[1]);\r\n\r\n    return [col, nf];\r\n  }\r\n\r\n  /* 21.2 DrawingML - Charts */\r\n  function parse_chart(data, name, opts, rels, wb, csheet) {\r\n    var cs = ((csheet || {\"!type\":\"chart\"}));\r\n    if(!data) return csheet;\r\n    /* 21.2.2.27 chart CT_Chart */\r\n\r\n    var C = 0, R = 0, col = \"A\";\r\n    var refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\r\n\r\n    /* 21.2.2.120 numCache CT_NumData */\r\n    (data.match(/<c:numCache>[\\s\\S]*?<\\/c:numCache>/gm)||[]).forEach(function(nc) {\r\n      var cache = parse_numCache(nc);\r\n      refguess.s.r = refguess.s.c = 0;\r\n      refguess.e.c = C;\r\n      col = encode_col(C);\r\n      cache[0].forEach(function(n,i) {\r\n        cs[col + encode_row(i)] = {t:'n', v:n, z:cache[1] };\r\n        R = i;\r\n      });\r\n      if(refguess.e.r < R) refguess.e.r = R;\r\n      ++C;\r\n    });\r\n    if(C > 0) cs[\"!ref\"] = encode_range(refguess);\r\n    return cs;\r\n  }\r\n  RELS.CS = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet\";\r\n\r\n  var CS_XML_ROOT = writextag('chartsheet', null, {\r\n    'xmlns': XMLNS.main[0],\r\n    'xmlns:r': XMLNS.r\r\n  });\r\n\r\n  /* 18.3 Worksheets also covers Chartsheets */\r\n  function parse_cs_xml(data, opts, idx, rels, wb) {\r\n    if(!data) return data;\r\n    /* 18.3.1.12 chartsheet CT_ChartSheet */\r\n    if(!rels) rels = {'!id':{}};\r\n    var s = {'!type':\"chart\", '!chart':null, '!rel':\"\"};\r\n    var m;\r\n\r\n    /* 18.3.1.83 sheetPr CT_ChartsheetPr */\r\n    var sheetPr = data.match(sheetprregex);\r\n    if(sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);\r\n\r\n    /* 18.3.1.36 drawing CT_Drawing */\r\n    if((m = data.match(/drawing r:id=\"(.*?)\"/))) s['!rel'] = m[1];\r\n\r\n    if(rels['!id'][s['!rel']]) s['!chart'] = rels['!id'][s['!rel']];\r\n    return s;\r\n  }\r\n  function write_cs_xml(idx, opts, wb, rels) {\r\n    var o = [XML_HEADER, CS_XML_ROOT];\r\n    o[o.length] = writextag(\"drawing\", null, {\"r:id\": \"rId1\"});\r\n    add_rels(rels, -1, \"../drawings/drawing\" + (idx+1) + \".xml\", RELS.DRAW);\r\n    if(o.length>2) { o[o.length] = ('</chartsheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\r\n    return o.join(\"\");\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.331 BrtCsProp */\r\n  function parse_BrtCsProp(data, length) {\r\n    data.l += 10;\r\n    var name = parse_XLWideString(data, length - 10);\r\n    return { name: name };\r\n  }\r\n\r\n  /* [MS-XLSB] 2.1.7.7 Chart Sheet */\r\n  function parse_cs_bin(data, opts, idx, rels, wb) {\r\n    if(!data) return data;\r\n    if(!rels) rels = {'!id':{}};\r\n    var s = {'!type':\"chart\", '!chart':null, '!rel':\"\"};\r\n    var state = [];\r\n    var pass = false;\r\n    recordhopper(data, function cs_parse(val, R_n, RT) {\r\n      switch(RT) {\r\n\r\n        case 0x0226: /* 'BrtDrawing' */\r\n          s['!rel'] = val; break;\r\n\r\n        case 0x028B: /* 'BrtCsProp' */\r\n          if(!wb.Sheets[idx]) wb.Sheets[idx] = {};\r\n          if(val.name) wb.Sheets[idx].CodeName = val.name;\r\n          break;\r\n\r\n        case 0x0232: /* 'BrtBkHim' */\r\n        case 0x028C: /* 'BrtCsPageSetup' */\r\n        case 0x029D: /* 'BrtCsProtection' */\r\n        case 0x02A7: /* 'BrtCsProtectionIso' */\r\n        case 0x0227: /* 'BrtLegacyDrawing' */\r\n        case 0x0228: /* 'BrtLegacyDrawingHF' */\r\n        case 0x01DC: /* 'BrtMargins' */\r\n        case 0x0C00: /* 'BrtUid' */\r\n          break;\r\n\r\n        case 0x0023: /* 'BrtFRTBegin' */\r\n          pass = true; break;\r\n        case 0x0024: /* 'BrtFRTEnd' */\r\n          pass = false; break;\r\n        case 0x0025: /* 'BrtACBegin' */\r\n          state.push(R_n); break;\r\n        case 0x0026: /* 'BrtACEnd' */\r\n          state.pop(); break;\r\n\r\n        default:\r\n          if((R_n||\"\").indexOf(\"Begin\") > 0) state.push(R_n);\r\n          else if((R_n||\"\").indexOf(\"End\") > 0) state.pop();\r\n          else if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R_n);\r\n      }\r\n    }, opts);\r\n\r\n    if(rels['!id'][s['!rel']]) s['!chart'] = rels['!id'][s['!rel']];\r\n    return s;\r\n  }\r\n  function write_cs_bin() {\r\n    var ba = buf_array();\r\n    write_record(ba, \"BrtBeginSheet\");\r\n    /* [BrtCsProp] */\r\n    /* CSVIEWS */\r\n    /* [[BrtCsProtectionIso] BrtCsProtection] */\r\n    /* [USERCSVIEWS] */\r\n    /* [BrtMargins] */\r\n    /* [BrtCsPageSetup] */\r\n    /* [HEADERFOOTER] */\r\n    /* BrtDrawing */\r\n    /* [BrtLegacyDrawing] */\r\n    /* [BrtLegacyDrawingHF] */\r\n    /* [BrtBkHim] */\r\n    /* [WEBPUBITEMS] */\r\n    /* FRTCHARTSHEET */\r\n    write_record(ba, \"BrtEndSheet\");\r\n    return ba.end();\r\n  }\r\n  /* 18.2.28 (CT_WorkbookProtection) Defaults */\r\n  var WBPropsDef = [\r\n    ['allowRefreshQuery',           false, \"bool\"],\r\n    ['autoCompressPictures',        true,  \"bool\"],\r\n    ['backupFile',                  false, \"bool\"],\r\n    ['checkCompatibility',          false, \"bool\"],\r\n    ['CodeName',                    ''],\r\n    ['date1904',                    false, \"bool\"],\r\n    ['defaultThemeVersion',         0,      \"int\"],\r\n    ['filterPrivacy',               false, \"bool\"],\r\n    ['hidePivotFieldList',          false, \"bool\"],\r\n    ['promptedSolutions',           false, \"bool\"],\r\n    ['publishItems',                false, \"bool\"],\r\n    ['refreshAllConnections',       false, \"bool\"],\r\n    ['saveExternalLinkValues',      true,  \"bool\"],\r\n    ['showBorderUnselectedTables',  true,  \"bool\"],\r\n    ['showInkAnnotation',           true,  \"bool\"],\r\n    ['showObjects',                 'all'],\r\n    ['showPivotChartFilter',        false, \"bool\"],\r\n    ['updateLinks', 'userSet']\r\n  ];\r\n\r\n  /* 18.2.30 (CT_BookView) Defaults */\r\n  var WBViewDef = [\r\n    ['activeTab',                   0,      \"int\"],\r\n    ['autoFilterDateGrouping',      true,  \"bool\"],\r\n    ['firstSheet',                  0,      \"int\"],\r\n    ['minimized',                   false, \"bool\"],\r\n    ['showHorizontalScroll',        true,  \"bool\"],\r\n    ['showSheetTabs',               true,  \"bool\"],\r\n    ['showVerticalScroll',          true,  \"bool\"],\r\n    ['tabRatio',                    600,    \"int\"],\r\n    ['visibility',                  'visible']\r\n    //window{Height,Width}, {x,y}Window\r\n  ];\r\n\r\n  /* 18.2.19 (CT_Sheet) Defaults */\r\n  var SheetDef = [\r\n    //['state', 'visible']\r\n  ];\r\n\r\n  /* 18.2.2  (CT_CalcPr) Defaults */\r\n  var CalcPrDef = [\r\n    ['calcCompleted', 'true'],\r\n    ['calcMode', 'auto'],\r\n    ['calcOnSave', 'true'],\r\n    ['concurrentCalc', 'true'],\r\n    ['fullCalcOnLoad', 'false'],\r\n    ['fullPrecision', 'true'],\r\n    ['iterate', 'false'],\r\n    ['iterateCount', '100'],\r\n    ['iterateDelta', '0.001'],\r\n    ['refMode', 'A1']\r\n  ];\r\n\r\n  /* 18.2.3 (CT_CustomWorkbookView) Defaults */\r\n  /*var CustomWBViewDef = [\r\n\t['autoUpdate', 'false'],\r\n\t['changesSavedWin', 'false'],\r\n\t['includeHiddenRowCol', 'true'],\r\n\t['includePrintSettings', 'true'],\r\n\t['maximized', 'false'],\r\n\t['minimized', 'false'],\r\n\t['onlySync', 'false'],\r\n\t['personalView', 'false'],\r\n\t['showComments', 'commIndicator'],\r\n\t['showFormulaBar', 'true'],\r\n\t['showHorizontalScroll', 'true'],\r\n\t['showObjects', 'all'],\r\n\t['showSheetTabs', 'true'],\r\n\t['showStatusbar', 'true'],\r\n\t['showVerticalScroll', 'true'],\r\n\t['tabRatio', '600'],\r\n\t['xWindow', '0'],\r\n\t['yWindow', '0']\r\n];*/\r\n\r\n  function push_defaults_array(target, defaults) {\r\n    for(var j = 0; j != target.length; ++j) { var w = target[j];\r\n      for(var i=0; i != defaults.length; ++i) { var z = defaults[i];\r\n        if(w[z[0]] == null) w[z[0]] = z[1];\r\n        else switch(z[2]) {\r\n          case \"bool\": if(typeof w[z[0]] == \"string\") w[z[0]] = parsexmlbool(w[z[0]]); break;\r\n          case \"int\": if(typeof w[z[0]] == \"string\") w[z[0]] = parseInt(w[z[0]], 10); break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  function push_defaults(target, defaults) {\r\n    for(var i = 0; i != defaults.length; ++i) { var z = defaults[i];\r\n      if(target[z[0]] == null) target[z[0]] = z[1];\r\n      else switch(z[2]) {\r\n        case \"bool\": if(typeof target[z[0]] == \"string\") target[z[0]] = parsexmlbool(target[z[0]]); break;\r\n        case \"int\": if(typeof target[z[0]] == \"string\") target[z[0]] = parseInt(target[z[0]], 10); break;\r\n      }\r\n    }\r\n  }\r\n\r\n  function parse_wb_defaults(wb) {\r\n    push_defaults(wb.WBProps, WBPropsDef);\r\n    push_defaults(wb.CalcPr, CalcPrDef);\r\n\r\n    push_defaults_array(wb.WBView, WBViewDef);\r\n    push_defaults_array(wb.Sheets, SheetDef);\r\n\r\n    _ssfopts.date1904 = parsexmlbool(wb.WBProps.date1904);\r\n  }\r\n\r\n  function safe1904(wb) {\r\n    /* TODO: store date1904 somewhere else */\r\n    if(!wb.Workbook) return \"false\";\r\n    if(!wb.Workbook.WBProps) return \"false\";\r\n    return parsexmlbool(wb.Workbook.WBProps.date1904) ? \"true\" : \"false\";\r\n  }\r\n\r\n  var badchars = \"][*?\\/\\\\\".split(\"\");\r\n  function check_ws_name(n, safe) {\r\n    if(n.length > 31) { if(safe) return false; throw new Error(\"Sheet names cannot exceed 31 chars\"); }\r\n    var _good = true;\r\n    badchars.forEach(function(c) {\r\n      if(n.indexOf(c) == -1) return;\r\n      if(!safe) throw new Error(\"Sheet name cannot contain : \\\\ / ? * [ ]\");\r\n      _good = false;\r\n    });\r\n    return _good;\r\n  }\r\n  function check_wb_names(N, S, codes) {\r\n    N.forEach(function(n,i) {\r\n      check_ws_name(n);\r\n      for(var j = 0; j < i; ++j) if(n == N[j]) throw new Error(\"Duplicate Sheet Name: \" + n);\r\n      if(codes) {\r\n        var cn = (S && S[i] && S[i].CodeName) || n;\r\n        if(cn.charCodeAt(0) == 95 && cn.length > 22) throw new Error(\"Bad Code Name: Worksheet\" + cn);\r\n      }\r\n    });\r\n  }\r\n  function check_wb(wb) {\r\n    if(!wb || !wb.SheetNames || !wb.Sheets) throw new Error(\"Invalid Workbook\");\r\n    if(!wb.SheetNames.length) throw new Error(\"Workbook is empty\");\r\n    var Sheets = (wb.Workbook && wb.Workbook.Sheets) || [];\r\n    check_wb_names(wb.SheetNames, Sheets, !!wb.vbaraw);\r\n    for(var i = 0; i < wb.SheetNames.length; ++i) check_ws(wb.Sheets[wb.SheetNames[i]], wb.SheetNames[i], i);\r\n    /* TODO: validate workbook */\r\n  }\r\n  /* 18.2 Workbook */\r\n  var wbnsregex = /<\\w+:workbook/;\r\n  function parse_wb_xml(data, opts) {\r\n    if(!data) throw new Error(\"Could not find file\");\r\n    var wb = { AppVersion:{}, WBProps:{}, WBView:[], Sheets:[], CalcPr:{}, Names:[], xmlns: \"\" };\r\n    var pass = false, xmlns = \"xmlns\";\r\n    var dname = {}, dnstart = 0;\r\n    data.replace(tagregex, function xml_wb(x, idx) {\r\n      var y = parsexmltag(x);\r\n      switch(strip_ns(y[0])) {\r\n        case '<?xml': break;\r\n\r\n        /* 18.2.27 workbook CT_Workbook 1 */\r\n        case '<workbook':\r\n          if(x.match(wbnsregex)) xmlns = \"xmlns\" + x.match(/<(\\w+):/)[1];\r\n          wb.xmlns = y[xmlns];\r\n          break;\r\n        case '</workbook>': break;\r\n\r\n        /* 18.2.13 fileVersion CT_FileVersion ? */\r\n        case '<fileVersion': delete y[0]; wb.AppVersion = y; break;\r\n        case '<fileVersion/>': case '</fileVersion>': break;\r\n\r\n        /* 18.2.12 fileSharing CT_FileSharing ? */\r\n        case '<fileSharing': case '<fileSharing/>': break;\r\n\r\n        /* 18.2.28 workbookPr CT_WorkbookPr ? */\r\n        case '<workbookPr':\r\n        case '<workbookPr/>':\r\n          WBPropsDef.forEach(function(w) {\r\n            if(y[w[0]] == null) return;\r\n            switch(w[2]) {\r\n              case \"bool\": wb.WBProps[w[0]] = parsexmlbool(y[w[0]]); break;\r\n              case \"int\": wb.WBProps[w[0]] = parseInt(y[w[0]], 10); break;\r\n              default: wb.WBProps[w[0]] = y[w[0]];\r\n            }\r\n          });\r\n          if(y.codeName) wb.WBProps.CodeName = y.codeName;\r\n          break;\r\n        case '</workbookPr>': break;\r\n\r\n        /* 18.2.29 workbookProtection CT_WorkbookProtection ? */\r\n        case '<workbookProtection': break;\r\n        case '<workbookProtection/>': break;\r\n\r\n        /* 18.2.1  bookViews CT_BookViews ? */\r\n        case '<bookViews': case '<bookViews>': case '</bookViews>': break;\r\n        /* 18.2.30   workbookView CT_BookView + */\r\n        case '<workbookView': case '<workbookView/>': delete y[0]; wb.WBView.push(y); break;\r\n        case '</workbookView>': break;\r\n\r\n        /* 18.2.20 sheets CT_Sheets 1 */\r\n        case '<sheets': case '<sheets>': case '</sheets>': break; // aggregate sheet\r\n        /* 18.2.19   sheet CT_Sheet + */\r\n        case '<sheet':\r\n          switch(y.state) {\r\n            case \"hidden\": y.Hidden = 1; break;\r\n            case \"veryHidden\": y.Hidden = 2; break;\r\n            default: y.Hidden = 0;\r\n          }\r\n          delete y.state;\r\n          y.name = unescapexml(utf8read(y.name));\r\n          delete y[0]; wb.Sheets.push(y); break;\r\n        case '</sheet>': break;\r\n\r\n        /* 18.2.15 functionGroups CT_FunctionGroups ? */\r\n        case '<functionGroups': case '<functionGroups/>': break;\r\n        /* 18.2.14   functionGroup CT_FunctionGroup + */\r\n        case '<functionGroup': break;\r\n\r\n        /* 18.2.9  externalReferences CT_ExternalReferences ? */\r\n        case '<externalReferences': case '</externalReferences>': case '<externalReferences>': break;\r\n        /* 18.2.8    externalReference CT_ExternalReference + */\r\n        case '<externalReference': break;\r\n\r\n        /* 18.2.6  definedNames CT_DefinedNames ? */\r\n        case '<definedNames/>': break;\r\n        case '<definedNames>': case '<definedNames': pass=true; break;\r\n        case '</definedNames>': pass=false; break;\r\n        /* 18.2.5    definedName CT_DefinedName + */\r\n        case '<definedName': {\r\n          dname = {};\r\n          dname.Name = utf8read(y.name);\r\n          if(y.comment) dname.Comment = y.comment;\r\n          if(y.localSheetId) dname.Sheet = +y.localSheetId;\r\n          if(parsexmlbool(y.hidden||\"0\")) dname.Hidden = true;\r\n          dnstart = idx + x.length;\r\n        }\tbreak;\r\n        case '</definedName>': {\r\n          dname.Ref = unescapexml(utf8read(data.slice(dnstart, idx)));\r\n          wb.Names.push(dname);\r\n        } break;\r\n        case '<definedName/>': break;\r\n\r\n        /* 18.2.2  calcPr CT_CalcPr ? */\r\n        case '<calcPr': delete y[0]; wb.CalcPr = y; break;\r\n        case '<calcPr/>': delete y[0]; wb.CalcPr = y; break;\r\n        case '</calcPr>': break;\r\n\r\n        /* 18.2.16 oleSize CT_OleSize ? (ref required) */\r\n        case '<oleSize': break;\r\n\r\n        /* 18.2.4  customWorkbookViews CT_CustomWorkbookViews ? */\r\n        case '<customWorkbookViews>': case '</customWorkbookViews>': case '<customWorkbookViews': break;\r\n        /* 18.2.3    customWorkbookView CT_CustomWorkbookView + */\r\n        case '<customWorkbookView': case '</customWorkbookView>': break;\r\n\r\n        /* 18.2.18 pivotCaches CT_PivotCaches ? */\r\n        case '<pivotCaches>': case '</pivotCaches>': case '<pivotCaches': break;\r\n        /* 18.2.17 pivotCache CT_PivotCache ? */\r\n        case '<pivotCache': break;\r\n\r\n        /* 18.2.21 smartTagPr CT_SmartTagPr ? */\r\n        case '<smartTagPr': case '<smartTagPr/>': break;\r\n\r\n        /* 18.2.23 smartTagTypes CT_SmartTagTypes ? */\r\n        case '<smartTagTypes': case '<smartTagTypes>': case '</smartTagTypes>': break;\r\n        /* 18.2.22   smartTagType CT_SmartTagType ? */\r\n        case '<smartTagType': break;\r\n\r\n        /* 18.2.24 webPublishing CT_WebPublishing ? */\r\n        case '<webPublishing': case '<webPublishing/>': break;\r\n\r\n        /* 18.2.11 fileRecoveryPr CT_FileRecoveryPr ? */\r\n        case '<fileRecoveryPr': case '<fileRecoveryPr/>': break;\r\n\r\n        /* 18.2.26 webPublishObjects CT_WebPublishObjects ? */\r\n        case '<webPublishObjects>': case '<webPublishObjects': case '</webPublishObjects>': break;\r\n        /* 18.2.25 webPublishObject CT_WebPublishObject ? */\r\n        case '<webPublishObject': break;\r\n\r\n        /* 18.2.10 extLst CT_ExtensionList ? */\r\n        case '<extLst': case '<extLst>': case '</extLst>': case '<extLst/>': break;\r\n        /* 18.2.7    ext CT_Extension + */\r\n        case '<ext': pass=true; break; //TODO: check with versions of excel\r\n        case '</ext>': pass=false; break;\r\n\r\n        /* Others */\r\n        case '<ArchID': break;\r\n        case '<AlternateContent':\r\n        case '<AlternateContent>': pass=true; break;\r\n        case '</AlternateContent>': pass=false; break;\r\n\r\n        /* TODO */\r\n        case '<revisionPtr': break;\r\n\r\n        default: if(!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in workbook');\r\n      }\r\n      return x;\r\n    });\r\n    if(XMLNS.main.indexOf(wb.xmlns) === -1) throw new Error(\"Unknown Namespace: \" + wb.xmlns);\r\n\r\n    parse_wb_defaults(wb);\r\n\r\n    return wb;\r\n  }\r\n\r\n  var WB_XML_ROOT = writextag('workbook', null, {\r\n    'xmlns': XMLNS.main[0],\r\n    //'xmlns:mx': XMLNS.mx,\r\n    //'xmlns:s': XMLNS.main[0],\r\n    'xmlns:r': XMLNS.r\r\n  });\r\n\r\n  function write_wb_xml(wb) {\r\n    var o = [XML_HEADER];\r\n    o[o.length] = WB_XML_ROOT;\r\n\r\n    var write_names = (wb.Workbook && (wb.Workbook.Names||[]).length > 0);\r\n\r\n    /* fileVersion */\r\n    /* fileSharing */\r\n\r\n    var workbookPr = ({codeName:\"ThisWorkbook\"});\r\n    if(wb.Workbook && wb.Workbook.WBProps) {\r\n      WBPropsDef.forEach(function(x) {\r\n        if((wb.Workbook.WBProps[x[0]]) == null) return;\r\n        if((wb.Workbook.WBProps[x[0]]) == x[1]) return;\r\n        workbookPr[x[0]] = (wb.Workbook.WBProps[x[0]]);\r\n      });\r\n      if(wb.Workbook.WBProps.CodeName) { workbookPr.codeName = wb.Workbook.WBProps.CodeName; delete workbookPr.CodeName; }\r\n    }\r\n    o[o.length] = (writextag('workbookPr', null, workbookPr));\r\n\r\n    /* workbookProtection */\r\n\r\n    var sheets = wb.Workbook && wb.Workbook.Sheets || [];\r\n    var i = 0;\r\n\r\n    /* bookViews */\r\n\r\n    o[o.length] = \"<sheets>\";\r\n    for(i = 0; i != wb.SheetNames.length; ++i) {\r\n      var sht = ({name:escapexml(wb.SheetNames[i].slice(0,31))});\r\n      sht.sheetId = \"\"+(i+1);\r\n      sht[\"r:id\"] = \"rId\"+(i+1);\r\n      if(sheets[i]) switch(sheets[i].Hidden) {\r\n        case 1: sht.state = \"hidden\"; break;\r\n        case 2: sht.state = \"veryHidden\"; break;\r\n      }\r\n      o[o.length] = (writextag('sheet',null,sht));\r\n    }\r\n    o[o.length] = \"</sheets>\";\r\n\r\n    /* functionGroups */\r\n    /* externalReferences */\r\n\r\n    if(write_names) {\r\n      o[o.length] = \"<definedNames>\";\r\n      if(wb.Workbook && wb.Workbook.Names) wb.Workbook.Names.forEach(function(n) {\r\n        var d = {name:n.Name};\r\n        if(n.Comment) d.comment = n.Comment;\r\n        if(n.Sheet != null) d.localSheetId = \"\"+n.Sheet;\r\n        if(n.Hidden) d.hidden = \"1\";\r\n        if(!n.Ref) return;\r\n        o[o.length] = writextag('definedName', String(n.Ref).replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\"), d);\r\n      });\r\n      o[o.length] = \"</definedNames>\";\r\n    }\r\n\r\n    /* calcPr */\r\n    /* oleSize */\r\n    /* customWorkbookViews */\r\n    /* pivotCaches */\r\n    /* smartTagPr */\r\n    /* smartTagTypes */\r\n    /* webPublishing */\r\n    /* fileRecoveryPr */\r\n    /* webPublishObjects */\r\n    /* extLst */\r\n\r\n    if(o.length>2){ o[o.length] = '</workbook>'; o[1]=o[1].replace(\"/>\",\">\"); }\r\n    return o.join(\"\");\r\n  }\r\n  /* [MS-XLSB] 2.4.304 BrtBundleSh */\r\n  function parse_BrtBundleSh(data, length) {\r\n    var z = {};\r\n    z.Hidden = data.read_shift(4); //hsState ST_SheetState\r\n    z.iTabID = data.read_shift(4);\r\n    z.strRelID = parse_RelID(data,length-8);\r\n    z.name = parse_XLWideString(data);\r\n    return z;\r\n  }\r\n  function write_BrtBundleSh(data, o) {\r\n    if(!o) o = new_buf(127);\r\n    o.write_shift(4, data.Hidden);\r\n    o.write_shift(4, data.iTabID);\r\n    write_RelID(data.strRelID, o);\r\n    write_XLWideString(data.name.slice(0,31), o);\r\n    return o.length > o.l ? o.slice(0, o.l) : o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.815 BrtWbProp */\r\n  function parse_BrtWbProp(data, length) {\r\n    var o = ({});\r\n    var flags = data.read_shift(4);\r\n    o.defaultThemeVersion = data.read_shift(4);\r\n    var strName = (length > 8) ? parse_XLWideString(data) : \"\";\r\n    if(strName.length > 0) o.CodeName = strName;\r\n    o.autoCompressPictures = !!(flags & 0x10000);\r\n    o.backupFile = !!(flags & 0x40);\r\n    o.checkCompatibility = !!(flags & 0x1000);\r\n    o.date1904 = !!(flags & 0x01);\r\n    o.filterPrivacy = !!(flags & 0x08);\r\n    o.hidePivotFieldList = !!(flags & 0x400);\r\n    o.promptedSolutions = !!(flags & 0x10);\r\n    o.publishItems = !!(flags & 0x800);\r\n    o.refreshAllConnections = !!(flags & 0x40000);\r\n    o.saveExternalLinkValues = !!(flags & 0x80);\r\n    o.showBorderUnselectedTables = !!(flags & 0x04);\r\n    o.showInkAnnotation = !!(flags & 0x20);\r\n    o.showObjects = [\"all\", \"placeholders\", \"none\"][(flags >> 13) & 0x03];\r\n    o.showPivotChartFilter = !!(flags & 0x8000);\r\n    o.updateLinks = [\"userSet\", \"never\", \"always\"][(flags >> 8) & 0x03];\r\n    return o;\r\n  }\r\n  function write_BrtWbProp(data, o) {\r\n    if(!o) o = new_buf(72);\r\n    var flags = 0;\r\n    if(data) {\r\n      /* TODO: mirror parse_BrtWbProp fields */\r\n      if(data.filterPrivacy) flags |= 0x08;\r\n    }\r\n    o.write_shift(4, flags);\r\n    o.write_shift(4, 0);\r\n    write_XLSBCodeName(data && data.CodeName || \"ThisWorkbook\", o);\r\n    return o.slice(0, o.l);\r\n  }\r\n\r\n  function parse_BrtFRTArchID$(data, length) {\r\n    var o = {};\r\n    data.read_shift(4);\r\n    o.ArchID = data.read_shift(4);\r\n    data.l += length - 8;\r\n    return o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.687 BrtName */\r\n  function parse_BrtName(data, length, opts) {\r\n    var end = data.l + length;\r\n    data.l += 4; //var flags = data.read_shift(4);\r\n    data.l += 1; //var chKey = data.read_shift(1);\r\n    var itab = data.read_shift(4);\r\n    var name = parse_XLNameWideString(data);\r\n    var formula = parse_XLSBNameParsedFormula(data, 0, opts);\r\n    var comment = parse_XLNullableWideString(data);\r\n    //if(0 /* fProc */) {\r\n    // unusedstring1: XLNullableWideString\r\n    // description: XLNullableWideString\r\n    // helpTopic: XLNullableWideString\r\n    // unusedstring2: XLNullableWideString\r\n    //}\r\n    data.l = end;\r\n    var out = ({Name:name, Ptg:formula});\r\n    if(itab < 0xFFFFFFF) out.Sheet = itab;\r\n    if(comment) out.Comment = comment;\r\n    return out;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.1.7.61 Workbook */\r\n  function parse_wb_bin(data, opts) {\r\n    var wb = { AppVersion:{}, WBProps:{}, WBView:[], Sheets:[], CalcPr:{}, xmlns: \"\" };\r\n    var state = [];\r\n    var pass = false;\r\n\r\n    if(!opts) opts = {};\r\n    opts.biff = 12;\r\n\r\n    var Names = [];\r\n    var supbooks = ([[]]);\r\n    supbooks.SheetNames = [];\r\n    supbooks.XTI = [];\r\n\r\n    recordhopper(data, function hopper_wb(val, R_n, RT) {\r\n      switch(RT) {\r\n        case 0x009C: /* 'BrtBundleSh' */\r\n          supbooks.SheetNames.push(val.name);\r\n          wb.Sheets.push(val); break;\r\n\r\n        case 0x0099: /* 'BrtWbProp' */\r\n          wb.WBProps = val; break;\r\n\r\n        case 0x0027: /* 'BrtName' */\r\n          if(val.Sheet != null) opts.SID = val.Sheet;\r\n          val.Ref = stringify_formula(val.Ptg, null, null, supbooks, opts);\r\n          delete opts.SID;\r\n          delete val.Ptg;\r\n          Names.push(val);\r\n          break;\r\n        case 0x040C: /* 'BrtNameExt' */ break;\r\n\r\n        case 0x0165: /* 'BrtSupSelf' */\r\n        case 0x0166: /* 'BrtSupSame' */\r\n        case 0x0163: /* 'BrtSupBookSrc' */\r\n        case 0x029B: /* 'BrtSupAddin' */\r\n          if(!supbooks[0].length) supbooks[0] = [RT, val];\r\n          else supbooks.push([RT, val]);\r\n          supbooks[supbooks.length - 1].XTI = [];\r\n          break;\r\n        case 0x016A: /* 'BrtExternSheet' */\r\n          if(supbooks.length === 0) { supbooks[0] = []; supbooks[0].XTI = []; }\r\n          supbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val);\r\n          supbooks.XTI = supbooks.XTI.concat(val);\r\n          break;\r\n        case 0x0169: /* 'BrtPlaceholderName' */\r\n          break;\r\n\r\n        /* case 'BrtModelTimeGroupingCalcCol' */\r\n        case 0x0C00: /* 'BrtUid' */\r\n        case 0x0C01: /* 'BrtRevisionPtr' */\r\n        case 0x0817: /* 'BrtAbsPath15' */\r\n        case 0x0216: /* 'BrtBookProtection' */\r\n        case 0x02A5: /* 'BrtBookProtectionIso' */\r\n        case 0x009E: /* 'BrtBookView' */\r\n        case 0x009D: /* 'BrtCalcProp' */\r\n        case 0x0262: /* 'BrtCrashRecErr' */\r\n        case 0x0802: /* 'BrtDecoupledPivotCacheID' */\r\n        case 0x009B: /* 'BrtFileRecover' */\r\n        case 0x0224: /* 'BrtFileSharing' */\r\n        case 0x02A4: /* 'BrtFileSharingIso' */\r\n        case 0x0080: /* 'BrtFileVersion' */\r\n        case 0x0299: /* 'BrtFnGroup' */\r\n        case 0x0850: /* 'BrtModelRelationship' */\r\n        case 0x084D: /* 'BrtModelTable' */\r\n        case 0x0225: /* 'BrtOleSize' */\r\n        case 0x0805: /* 'BrtPivotTableRef' */\r\n        case 0x0254: /* 'BrtSmartTagType' */\r\n        case 0x081C: /* 'BrtTableSlicerCacheID' */\r\n        case 0x081B: /* 'BrtTableSlicerCacheIDs' */\r\n        case 0x0822: /* 'BrtTimelineCachePivotCacheID' */\r\n        case 0x018D: /* 'BrtUserBookView' */\r\n        case 0x009A: /* 'BrtWbFactoid' */\r\n        case 0x045D: /* 'BrtWbProp14' */\r\n        case 0x0229: /* 'BrtWebOpt' */\r\n        case 0x082B: /* 'BrtWorkBookPr15' */\r\n          break;\r\n\r\n        case 0x0023: /* 'BrtFRTBegin' */\r\n          state.push(R_n); pass = true; break;\r\n        case 0x0024: /* 'BrtFRTEnd' */\r\n          state.pop(); pass = false; break;\r\n        case 0x0025: /* 'BrtACBegin' */\r\n          state.push(R_n); pass = true; break;\r\n        case 0x0026: /* 'BrtACEnd' */\r\n          state.pop(); pass = false; break;\r\n\r\n        case 0x0010: /* 'BrtFRTArchID$' */ break;\r\n\r\n        default:\r\n          if((R_n||\"\").indexOf(\"Begin\") > 0){/* empty */}\r\n          else if((R_n||\"\").indexOf(\"End\") > 0){/* empty */}\r\n          else if(!pass || (opts.WTF && state[state.length-1] != \"BrtACBegin\" && state[state.length-1] != \"BrtFRTBegin\")) throw new Error(\"Unexpected record \" + RT + \" \" + R_n);\r\n      }\r\n    }, opts);\r\n\r\n    parse_wb_defaults(wb);\r\n\r\n    // $FlowIgnore\r\n    wb.Names = Names;\r\n\r\n    (wb).supbooks = supbooks;\r\n    return wb;\r\n  }\r\n\r\n  function write_BUNDLESHS(ba, wb) {\r\n    write_record(ba, \"BrtBeginBundleShs\");\r\n    for(var idx = 0; idx != wb.SheetNames.length; ++idx) {\r\n      var viz = wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx] && wb.Workbook.Sheets[idx].Hidden || 0;\r\n      var d = { Hidden: viz, iTabID: idx+1, strRelID: 'rId' + (idx+1), name: wb.SheetNames[idx] };\r\n      write_record(ba, \"BrtBundleSh\", write_BrtBundleSh(d));\r\n    }\r\n    write_record(ba, \"BrtEndBundleShs\");\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.649 BrtFileVersion */\r\n  function write_BrtFileVersion(data, o) {\r\n    if(!o) o = new_buf(127);\r\n    for(var i = 0; i != 4; ++i) o.write_shift(4, 0);\r\n    write_XLWideString(\"SheetJS\", o);\r\n    write_XLWideString(XLSX.version, o);\r\n    write_XLWideString(XLSX.version, o);\r\n    write_XLWideString(\"7262\", o);\r\n    o.length = o.l;\r\n    return o.length > o.l ? o.slice(0, o.l) : o;\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.301 BrtBookView */\r\n  function write_BrtBookView(idx, o) {\r\n    if(!o) o = new_buf(29);\r\n    o.write_shift(-4, 0);\r\n    o.write_shift(-4, 460);\r\n    o.write_shift(4,  28800);\r\n    o.write_shift(4,  17600);\r\n    o.write_shift(4,  500);\r\n    o.write_shift(4,  idx);\r\n    o.write_shift(4,  idx);\r\n    var flags = 0x78;\r\n    o.write_shift(1,  flags);\r\n    return o.length > o.l ? o.slice(0, o.l) : o;\r\n  }\r\n\r\n  function write_BOOKVIEWS(ba, wb) {\r\n    /* required if hidden tab appears before visible tab */\r\n    if(!wb.Workbook || !wb.Workbook.Sheets) return;\r\n    var sheets = wb.Workbook.Sheets;\r\n    var i = 0, vistab = -1, hidden = -1;\r\n    for(; i < sheets.length; ++i) {\r\n      if(!sheets[i] || !sheets[i].Hidden && vistab == -1) vistab = i;\r\n      else if(sheets[i].Hidden == 1 && hidden == -1) hidden = i;\r\n    }\r\n    if(hidden > vistab) return;\r\n    write_record(ba, \"BrtBeginBookViews\");\r\n    write_record(ba, \"BrtBookView\", write_BrtBookView(vistab));\r\n    /* 1*(BrtBookView *FRT) */\r\n    write_record(ba, \"BrtEndBookViews\");\r\n  }\r\n\r\n  /* [MS-XLSB] 2.4.305 BrtCalcProp */\r\n  /*function write_BrtCalcProp(data, o) {\r\n\tif(!o) o = new_buf(26);\r\n\to.write_shift(4,0); // force recalc\r\n\to.write_shift(4,1);\r\n\to.write_shift(4,0);\r\n\twrite_Xnum(0, o);\r\n\to.write_shift(-4, 1023);\r\n\to.write_shift(1, 0x33);\r\n\to.write_shift(1, 0x00);\r\n\treturn o;\r\n}*/\r\n\r\n  /* [MS-XLSB] 2.4.646 BrtFileRecover */\r\n  /*function write_BrtFileRecover(data, o) {\r\n\tif(!o) o = new_buf(1);\r\n\to.write_shift(1,0);\r\n\treturn o;\r\n}*/\r\n\r\n  /* [MS-XLSB] 2.1.7.61 Workbook */\r\n  function write_wb_bin(wb, opts) {\r\n    var ba = buf_array();\r\n    write_record(ba, \"BrtBeginBook\");\r\n    write_record(ba, \"BrtFileVersion\", write_BrtFileVersion());\r\n    /* [[BrtFileSharingIso] BrtFileSharing] */\r\n    write_record(ba, \"BrtWbProp\", write_BrtWbProp(wb.Workbook && wb.Workbook.WBProps || null));\r\n    /* [ACABSPATH] */\r\n    /* [[BrtBookProtectionIso] BrtBookProtection] */\r\n    write_BOOKVIEWS(ba, wb, opts);\r\n    write_BUNDLESHS(ba, wb, opts);\r\n    /* [FNGROUP] */\r\n    /* [EXTERNALS] */\r\n    /* *BrtName */\r\n    /* write_record(ba, \"BrtCalcProp\", write_BrtCalcProp()); */\r\n    /* [BrtOleSize] */\r\n    /* *(BrtUserBookView *FRT) */\r\n    /* [PIVOTCACHEIDS] */\r\n    /* [BrtWbFactoid] */\r\n    /* [SMARTTAGTYPES] */\r\n    /* [BrtWebOpt] */\r\n    /* write_record(ba, \"BrtFileRecover\", write_BrtFileRecover()); */\r\n    /* [WEBPUBITEMS] */\r\n    /* [CRERRS] */\r\n    /* FRTWORKBOOK */\r\n    write_record(ba, \"BrtEndBook\");\r\n\r\n    return ba.end();\r\n  }\r\n  function parse_wb(data, name, opts) {\r\n    if(name.slice(-4)===\".bin\") return parse_wb_bin((data), opts);\r\n    return parse_wb_xml((data), opts);\r\n  }\r\n\r\n  function parse_ws(data, name, idx, opts, rels, wb, themes, styles) {\r\n    if(name.slice(-4)===\".bin\") return parse_ws_bin((data), opts, idx, rels, wb, themes, styles);\r\n    return parse_ws_xml((data), opts, idx, rels, wb, themes, styles);\r\n  }\r\n\r\n  function parse_cs(data, name, idx, opts, rels, wb, themes, styles) {\r\n    if(name.slice(-4)===\".bin\") return parse_cs_bin((data), opts, idx, rels, wb, themes, styles);\r\n    return parse_cs_xml((data), opts, idx, rels, wb, themes, styles);\r\n  }\r\n\r\n  function parse_ms(data, name, idx, opts, rels, wb, themes, styles) {\r\n    if(name.slice(-4)===\".bin\") return parse_ms_bin((data), opts, idx, rels, wb, themes, styles);\r\n    return parse_ms_xml((data), opts, idx, rels, wb, themes, styles);\r\n  }\r\n\r\n  function parse_ds(data, name, idx, opts, rels, wb, themes, styles) {\r\n    if(name.slice(-4)===\".bin\") return parse_ds_bin((data), opts, idx, rels, wb, themes, styles);\r\n    return parse_ds_xml((data), opts, idx, rels, wb, themes, styles);\r\n  }\r\n\r\n  function parse_sty(data, name, themes, opts) {\r\n    if(name.slice(-4)===\".bin\") return parse_sty_bin((data), themes, opts);\r\n    return parse_sty_xml((data), themes, opts);\r\n  }\r\n\r\n  function parse_theme(data, name, opts) {\r\n    return parse_theme_xml(data, opts);\r\n  }\r\n\r\n  function parse_sst(data, name, opts) {\r\n    if(name.slice(-4)===\".bin\") return parse_sst_bin((data), opts);\r\n    return parse_sst_xml((data), opts);\r\n  }\r\n\r\n  function parse_cmnt(data, name, opts) {\r\n    if(name.slice(-4)===\".bin\") return parse_comments_bin((data), opts);\r\n    return parse_comments_xml((data), opts);\r\n  }\r\n\r\n  function parse_cc(data, name, opts) {\r\n    if(name.slice(-4)===\".bin\") return parse_cc_bin((data), name, opts);\r\n    return parse_cc_xml((data), name, opts);\r\n  }\r\n\r\n  function parse_xlink(data, name, opts) {\r\n    if(name.slice(-4)===\".bin\") return parse_xlink_bin((data), name, opts);\r\n    return parse_xlink_xml((data), name, opts);\r\n  }\r\n\r\n  function write_wb(wb, name, opts) {\r\n    return (name.slice(-4)===\".bin\" ? write_wb_bin : write_wb_xml)(wb, opts);\r\n  }\r\n\r\n  function write_ws(data, name, opts, wb, rels) {\r\n    return (name.slice(-4)===\".bin\" ? write_ws_bin : write_ws_xml)(data, opts, wb, rels);\r\n  }\r\n\r\n// eslint-disable-next-line no-unused-vars\r\n  function write_cs(data, name, opts, wb, rels) {\r\n    return (name.slice(-4)===\".bin\" ? write_cs_bin : write_cs_xml)(data, opts, wb, rels);\r\n  }\r\n\r\n  function write_sty(data, name, opts) {\r\n    return (name.slice(-4)===\".bin\" ? write_sty_bin : write_sty_xml)(data, opts);\r\n  }\r\n\r\n  function write_sst(data, name, opts) {\r\n    return (name.slice(-4)===\".bin\" ? write_sst_bin : write_sst_xml)(data, opts);\r\n  }\r\n\r\n  function write_cmnt(data, name, opts) {\r\n    return (name.slice(-4)===\".bin\" ? write_comments_bin : write_comments_xml)(data, opts);\r\n  }\r\n  /*\r\nfunction write_cc(data, name:string, opts) {\r\n\treturn (name.slice(-4)===\".bin\" ? write_cc_bin : write_cc_xml)(data, opts);\r\n}\r\n*/\r\n  var attregexg2=/([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\r\n  var attregex2=/([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\r\n  var _chr = function(c) { return String.fromCharCode(c); };\r\n  function xlml_parsexmltag(tag, skip_root) {\r\n    var words = tag.split(/\\s+/);\r\n    var z = ([]); if(!skip_root) z[0] = words[0];\r\n    if(words.length === 1) return z;\r\n    var m = tag.match(attregexg2), y, j, w, i;\r\n    if(m) for(i = 0; i != m.length; ++i) {\r\n      y = m[i].match(attregex2);\r\n      if((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1,y[2].length-1);\r\n      else {\r\n        if(y[1].slice(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].slice(6);\r\n        else w = y[1].slice(j+1);\r\n        z[w] = y[2].slice(1,y[2].length-1);\r\n      }\r\n    }\r\n    return z;\r\n  }\r\n  function xlml_parsexmltagobj(tag) {\r\n    var words = tag.split(/\\s+/);\r\n    var z = {};\r\n    if(words.length === 1) return z;\r\n    var m = tag.match(attregexg2), y, j, w, i;\r\n    if(m) for(i = 0; i != m.length; ++i) {\r\n      y = m[i].match(attregex2);\r\n      if((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1,y[2].length-1);\r\n      else {\r\n        if(y[1].slice(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].slice(6);\r\n        else w = y[1].slice(j+1);\r\n        z[w] = y[2].slice(1,y[2].length-1);\r\n      }\r\n    }\r\n    return z;\r\n  }\r\n\r\n// ----\r\n\r\n  function xlml_format(format, value) {\r\n    var fmt = XLMLFormatMap[format] || unescapexml(format);\r\n    if(fmt === \"General\") return SSF._general(value);\r\n    return SSF.format(fmt, value);\r\n  }\r\n\r\n  function xlml_set_custprop(Custprops, key, cp, val) {\r\n    var oval = val;\r\n    switch((cp[0].match(/dt:dt=\"([\\w.]+)\"/)||[\"\",\"\"])[1]) {\r\n      case \"boolean\": oval = parsexmlbool(val); break;\r\n      case \"i2\": case \"int\": oval = parseInt(val, 10); break;\r\n      case \"r4\": case \"float\": oval = parseFloat(val); break;\r\n      case \"date\": case \"dateTime.tz\": oval = parseDate(val); break;\r\n      case \"i8\": case \"string\": case \"fixed\": case \"uuid\": case \"bin.base64\": break;\r\n      default: throw new Error(\"bad custprop:\" + cp[0]);\r\n    }\r\n    Custprops[unescapexml(key)] = oval;\r\n  }\r\n\r\n  function safe_format_xlml(cell, nf, o) {\r\n    if(cell.t === 'z') return;\r\n    if(!o || o.cellText !== false) try {\r\n      if(cell.t === 'e') { cell.w = cell.w || BErr[cell.v]; }\r\n      else if(nf === \"General\") {\r\n        if(cell.t === 'n') {\r\n          if((cell.v|0) === cell.v) cell.w = SSF._general_int(cell.v);\r\n          else cell.w = SSF._general_num(cell.v);\r\n        }\r\n        else cell.w = SSF._general(cell.v);\r\n      }\r\n      else cell.w = xlml_format(nf||\"General\", cell.v);\r\n    } catch(e) { if(o.WTF) throw e; }\r\n    try {\r\n      var z = XLMLFormatMap[nf]||nf||\"General\";\r\n      if(o.cellNF) cell.z = z;\r\n      if(o.cellDates && cell.t == 'n' && SSF.is_date(z)) {\r\n        var _d = SSF.parse_date_code(cell.v); if(_d) { cell.t = 'd'; cell.v = new Date(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u); }\r\n      }\r\n    } catch(e) { if(o.WTF) throw e; }\r\n  }\r\n\r\n  function process_style_xlml(styles, stag, opts) {\r\n    if(opts.cellStyles) {\r\n      if(stag.Interior) {\r\n        var I = stag.Interior;\r\n        if(I.Pattern) I.patternType = XLMLPatternTypeMap[I.Pattern] || I.Pattern;\r\n      }\r\n    }\r\n    styles[stag.ID] = stag;\r\n  }\r\n\r\n  /* TODO: there must exist some form of OSP-blessed spec */\r\n  function parse_xlml_data(xml, ss, data, cell, base, styles, csty, row, arrayf, o) {\r\n    var nf = \"General\", sid = cell.StyleID, S = {}; o = o || {};\r\n    var interiors = [];\r\n    var i = 0;\r\n    if(sid === undefined && row) sid = row.StyleID;\r\n    if(sid === undefined && csty) sid = csty.StyleID;\r\n    while(styles[sid] !== undefined) {\r\n      if(styles[sid].nf) nf = styles[sid].nf;\r\n      if(styles[sid].Interior) interiors.push(styles[sid].Interior);\r\n      if(!styles[sid].Parent) break;\r\n      sid = styles[sid].Parent;\r\n    }\r\n    switch(data.Type) {\r\n      case 'Boolean':\r\n        cell.t = 'b';\r\n        cell.v = parsexmlbool(xml);\r\n        break;\r\n      case 'String':\r\n        cell.t = 's'; cell.r = xlml_fixstr(unescapexml(xml));\r\n        cell.v = xml.indexOf(\"<\") > -1 ? unescapexml(ss) : cell.r;\r\n        break;\r\n      case 'DateTime':\r\n        if(xml.slice(-1) != \"Z\") xml += \"Z\";\r\n        cell.v = (parseDate(xml) - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\r\n        if(cell.v !== cell.v) cell.v = unescapexml(xml);\r\n        else if(cell.v<60) cell.v = cell.v -1;\r\n        if(!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\r\n      /* falls through */\r\n      case 'Number':\r\n        if(cell.v === undefined) cell.v=+xml;\r\n        if(!cell.t) cell.t = 'n';\r\n        break;\r\n      case 'Error': cell.t = 'e'; cell.v = RBErr[xml]; if(o.cellText !== false) cell.w = xml; break;\r\n      default: cell.t = 's'; cell.v = xlml_fixstr(ss||xml); break;\r\n    }\r\n    safe_format_xlml(cell, nf, o);\r\n    if(o.cellFormula !== false) {\r\n      if(cell.Formula) {\r\n        var fstr = unescapexml(cell.Formula);\r\n        /* strictly speaking, the leading = is required but some writers omit */\r\n        if(fstr.charCodeAt(0) == 61 /* = */) fstr = fstr.slice(1);\r\n        cell.f = rc_to_a1(fstr, base);\r\n        delete cell.Formula;\r\n        if(cell.ArrayRange == \"RC\") cell.F = rc_to_a1(\"RC:RC\", base);\r\n        else if(cell.ArrayRange) {\r\n          cell.F = rc_to_a1(cell.ArrayRange, base);\r\n          arrayf.push([safe_decode_range(cell.F), cell.F]);\r\n        }\r\n      } else {\r\n        for(i = 0; i < arrayf.length; ++i)\r\n          if(base.r >= arrayf[i][0].s.r && base.r <= arrayf[i][0].e.r)\r\n            if(base.c >= arrayf[i][0].s.c && base.c <= arrayf[i][0].e.c)\r\n              cell.F = arrayf[i][1];\r\n      }\r\n    }\r\n    if(o.cellStyles) {\r\n      interiors.forEach(function(x) {\r\n        if(!S.patternType && x.patternType) S.patternType = x.patternType;\r\n      });\r\n      cell.s = S;\r\n    }\r\n    if(cell.StyleID !== undefined) cell.ixfe = cell.StyleID;\r\n  }\r\n\r\n  function xlml_clean_comment(comment) {\r\n    comment.t = comment.v || \"\";\r\n    comment.t = comment.t.replace(/\\r\\n/g,\"\\n\").replace(/\\r/g,\"\\n\");\r\n    comment.v = comment.w = comment.ixfe = undefined;\r\n  }\r\n\r\n  function xlml_normalize(d) {\r\n    if(has_buf && Buffer.isBuffer(d)) return d.toString('utf8');\r\n    if(typeof d === 'string') return d;\r\n    /* duktape */\r\n    if(typeof Uint8Array !== 'undefined' && d instanceof Uint8Array) return utf8read(a2s(ab2a(d)));\r\n    throw new Error(\"Bad input format: expected Buffer or string\");\r\n  }\r\n\r\n  /* TODO: Everything */\r\n  /* UOS uses CJK in tags */\r\n  var xlmlregex = /<(\\/?)([^\\s?>!\\/:]*:|)([^\\s?>:\\/]+)[^>]*>/mg;\r\n//var xlmlregex = /<(\\/?)([a-z0-9]*:|)(\\w+)[^>]*>/mg;\r\n  function parse_xlml_xml(d, _opts) {\r\n    var opts = _opts || {};\r\n    make_ssf(SSF);\r\n    var str = debom(xlml_normalize(d));\r\n    if(opts.type == 'binary' || opts.type == 'array' || opts.type == 'base64') {\r\n      if(typeof cptable !== 'undefined') str = cptable.utils.decode(65001, char_codes(str));\r\n      else str = utf8read(str);\r\n    }\r\n    var opening = str.slice(0, 1024).toLowerCase(), ishtml = false;\r\n    if(opening.indexOf(\"<?xml\") == -1) [\"html\", \"table\", \"head\", \"meta\", \"script\", \"style\", \"div\"].forEach(function(tag) { if(opening.indexOf(\"<\" + tag) >= 0) ishtml = true; });\r\n    if(ishtml) return HTML_.to_workbook(str, opts);\r\n    var Rn;\r\n    var state = [], tmp;\r\n    if(DENSE != null && opts.dense == null) opts.dense = DENSE;\r\n    var sheets = {}, sheetnames = [], cursheet = (opts.dense ? [] : {}), sheetname = \"\";\r\n    var table = {}, cell = ({}), row = {};// eslint-disable-line no-unused-vars\r\n    var dtag = xlml_parsexmltag('<Data ss:Type=\"String\">'), didx = 0;\r\n    var c = 0, r = 0;\r\n    var refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\r\n    var styles = {}, stag = {};\r\n    var ss = \"\", fidx = 0;\r\n    var merges = [];\r\n    var Props = {}, Custprops = {}, pidx = 0, cp = [];\r\n    var comments = [], comment = ({});\r\n    var cstys = [], csty, seencol = false;\r\n    var arrayf = [];\r\n    var rowinfo = [], rowobj = {}, cc = 0, rr = 0;\r\n    var Workbook = ({ Sheets:[], WBProps:{date1904:false} }), wsprops = {};\r\n    xlmlregex.lastIndex = 0;\r\n    str = str.replace(/<!--([\\s\\S]*?)-->/mg,\"\");\r\n    while((Rn = xlmlregex.exec(str))) switch(Rn[3]) {\r\n      case 'Data':\r\n        if(state[state.length-1][1]) break;\r\n        if(Rn[1]==='/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length-1][0]==\"Comment\"?comment:cell, {c:c,r:r}, styles, cstys[c], row, arrayf, opts);\r\n        else { ss = \"\"; dtag = xlml_parsexmltag(Rn[0]); didx = Rn.index + Rn[0].length; }\r\n        break;\r\n      case 'Cell':\r\n        if(Rn[1]==='/'){\r\n          if(comments.length > 0) cell.c = comments;\r\n          if((!opts.sheetRows || opts.sheetRows > r) && cell.v !== undefined) {\r\n            if(opts.dense) {\r\n              if(!cursheet[r]) cursheet[r] = [];\r\n              cursheet[r][c] = cell;\r\n            } else cursheet[encode_col(c) + encode_row(r)] = cell;\r\n          }\r\n          if(cell.HRef) {\r\n            cell.l = ({Target:cell.HRef});\r\n            if(cell.HRefScreenTip) cell.l.Tooltip = cell.HRefScreenTip;\r\n            delete cell.HRef; delete cell.HRefScreenTip;\r\n          }\r\n          if(cell.MergeAcross || cell.MergeDown) {\r\n            cc = c + (parseInt(cell.MergeAcross,10)|0);\r\n            rr = r + (parseInt(cell.MergeDown,10)|0);\r\n            merges.push({s:{c:c,r:r},e:{c:cc,r:rr}});\r\n          }\r\n          if(!opts.sheetStubs) { if(cell.MergeAcross) c = cc + 1; else ++c; }\r\n          else if(cell.MergeAcross || cell.MergeDown) {\r\n            for(var cma = c; cma <= cc; ++cma) {\r\n              for(var cmd = r; cmd <= rr; ++cmd) {\r\n                if(cma > c || cmd > r) {\r\n                  if(opts.dense) {\r\n                    if(!cursheet[cmd]) cursheet[cmd] = [];\r\n                    cursheet[cmd][cma] = {t:'z'};\r\n                  } else cursheet[encode_col(cma) + encode_row(cmd)] = {t:'z'};\r\n                }\r\n              }\r\n            }\r\n            c = cc + 1;\r\n          }\r\n          else ++c;\r\n        } else {\r\n          cell = xlml_parsexmltagobj(Rn[0]);\r\n          if(cell.Index) c = +cell.Index - 1;\r\n          if(c < refguess.s.c) refguess.s.c = c;\r\n          if(c > refguess.e.c) refguess.e.c = c;\r\n          if(Rn[0].slice(-2) === \"/>\") ++c;\r\n          comments = [];\r\n        }\r\n        break;\r\n      case 'Row':\r\n        if(Rn[1]==='/' || Rn[0].slice(-2) === \"/>\") {\r\n          if(r < refguess.s.r) refguess.s.r = r;\r\n          if(r > refguess.e.r) refguess.e.r = r;\r\n          if(Rn[0].slice(-2) === \"/>\") {\r\n            row = xlml_parsexmltag(Rn[0]);\r\n            if(row.Index) r = +row.Index - 1;\r\n          }\r\n          c = 0; ++r;\r\n        } else {\r\n          row = xlml_parsexmltag(Rn[0]);\r\n          if(row.Index) r = +row.Index - 1;\r\n          rowobj = {};\r\n          if(row.AutoFitHeight == \"0\" || row.Height) {\r\n            rowobj.hpx = parseInt(row.Height, 10); rowobj.hpt = px2pt(rowobj.hpx);\r\n            rowinfo[r] = rowobj;\r\n          }\r\n          if(row.Hidden == \"1\") { rowobj.hidden = true; rowinfo[r] = rowobj; }\r\n        }\r\n        break;\r\n      case 'Worksheet': /* TODO: read range from FullRows/FullColumns */\r\n        if(Rn[1]==='/'){\r\n          if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));\r\n          sheetnames.push(sheetname);\r\n          if(refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) {\r\n            cursheet[\"!ref\"] = encode_range(refguess);\r\n            if(opts.sheetRows && opts.sheetRows <= refguess.e.r) {\r\n              cursheet[\"!fullref\"] = cursheet[\"!ref\"];\r\n              refguess.e.r = opts.sheetRows - 1;\r\n              cursheet[\"!ref\"] = encode_range(refguess);\r\n            }\r\n          }\r\n          if(merges.length) cursheet[\"!merges\"] = merges;\r\n          if(cstys.length > 0) cursheet[\"!cols\"] = cstys;\r\n          if(rowinfo.length > 0) cursheet[\"!rows\"] = rowinfo;\r\n          sheets[sheetname] = cursheet;\r\n        } else {\r\n          refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\r\n          r = c = 0;\r\n          state.push([Rn[3], false]);\r\n          tmp = xlml_parsexmltag(Rn[0]);\r\n          sheetname = unescapexml(tmp.Name);\r\n          cursheet = (opts.dense ? [] : {});\r\n          merges = [];\r\n          arrayf = [];\r\n          rowinfo = [];\r\n          wsprops = {name:sheetname, Hidden:0};\r\n          Workbook.Sheets.push(wsprops);\r\n        }\r\n        break;\r\n      case 'Table':\r\n        if(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\r\n        else if(Rn[0].slice(-2) == \"/>\") break;\r\n        else {\r\n          table = xlml_parsexmltag(Rn[0]);\r\n          state.push([Rn[3], false]);\r\n          cstys = []; seencol = false;\r\n        }\r\n        break;\r\n\r\n      case 'Style':\r\n        if(Rn[1]==='/') process_style_xlml(styles, stag, opts);\r\n        else stag = xlml_parsexmltag(Rn[0]);\r\n        break;\r\n\r\n      case 'NumberFormat':\r\n        stag.nf = unescapexml(xlml_parsexmltag(Rn[0]).Format || \"General\");\r\n        if(XLMLFormatMap[stag.nf]) stag.nf = XLMLFormatMap[stag.nf];\r\n        for(var ssfidx = 0; ssfidx != 0x188; ++ssfidx) if(SSF._table[ssfidx] == stag.nf) break;\r\n        if(ssfidx == 0x188) for(ssfidx = 0x39; ssfidx != 0x188; ++ssfidx) if(SSF._table[ssfidx] == null) { SSF.load(stag.nf, ssfidx); break; }\r\n        break;\r\n\r\n      case 'Column':\r\n        if(state[state.length-1][0] !== 'Table') break;\r\n        csty = xlml_parsexmltag(Rn[0]);\r\n        if(csty.Hidden) { csty.hidden = true; delete csty.Hidden; }\r\n        if(csty.Width) csty.wpx = parseInt(csty.Width, 10);\r\n        if(!seencol && csty.wpx > 10) {\r\n          seencol = true; MDW = DEF_MDW; //find_mdw_wpx(csty.wpx);\r\n          for(var _col = 0; _col < cstys.length; ++_col) if(cstys[_col]) process_col(cstys[_col]);\r\n        }\r\n        if(seencol) process_col(csty);\r\n        cstys[(csty.Index-1||cstys.length)] = csty;\r\n        for(var i = 0; i < +csty.Span; ++i) cstys[cstys.length] = dup(csty);\r\n        break;\r\n\r\n      case 'NamedRange':\r\n        if(!Workbook.Names) Workbook.Names = [];\r\n        var _NamedRange = parsexmltag(Rn[0]);\r\n        var _DefinedName = ({\r\n          Name: _NamedRange.Name,\r\n          Ref: rc_to_a1(_NamedRange.RefersTo.slice(1), {r:0, c:0})\r\n        });\r\n        if(Workbook.Sheets.length>0) _DefinedName.Sheet=Workbook.Sheets.length-1;\r\n        Workbook.Names.push(_DefinedName);\r\n        break;\r\n\r\n      case 'NamedCell': break;\r\n      case 'B': break;\r\n      case 'I': break;\r\n      case 'U': break;\r\n      case 'S': break;\r\n      case 'Sub': break;\r\n      case 'Sup': break;\r\n      case 'Span': break;\r\n      case 'Border': break;\r\n      case 'Alignment': break;\r\n      case 'Borders': break;\r\n      case 'Font':\r\n        if(Rn[0].slice(-2) === \"/>\") break;\r\n        else if(Rn[1]===\"/\") ss += str.slice(fidx, Rn.index);\r\n        else fidx = Rn.index + Rn[0].length;\r\n        break;\r\n      case 'Interior':\r\n        if(!opts.cellStyles) break;\r\n        stag.Interior = xlml_parsexmltag(Rn[0]);\r\n        break;\r\n      case 'Protection': break;\r\n\r\n      case 'Author':\r\n      case 'Title':\r\n      case 'Description':\r\n      case 'Created':\r\n      case 'Keywords':\r\n      case 'Subject':\r\n      case 'Category':\r\n      case 'Company':\r\n      case 'LastAuthor':\r\n      case 'LastSaved':\r\n      case 'LastPrinted':\r\n      case 'Version':\r\n      case 'Revision':\r\n      case 'TotalTime':\r\n      case 'HyperlinkBase':\r\n      case 'Manager':\r\n      case 'ContentStatus':\r\n      case 'Identifier':\r\n      case 'Language':\r\n      case 'AppName':\r\n        if(Rn[0].slice(-2) === \"/>\") break;\r\n        else if(Rn[1]===\"/\") xlml_set_prop(Props, Rn[3], str.slice(pidx, Rn.index));\r\n        else pidx = Rn.index + Rn[0].length;\r\n        break;\r\n      case 'Paragraphs': break;\r\n\r\n      case 'Styles':\r\n      case 'Workbook':\r\n        if(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\r\n        else state.push([Rn[3], false]);\r\n        break;\r\n\r\n      case 'Comment':\r\n        if(Rn[1]==='/'){\r\n          if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));\r\n          xlml_clean_comment(comment);\r\n          comments.push(comment);\r\n        } else {\r\n          state.push([Rn[3], false]);\r\n          tmp = xlml_parsexmltag(Rn[0]);\r\n          comment = ({a:tmp.Author});\r\n        }\r\n        break;\r\n\r\n      case 'AutoFilter':\r\n        if(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\r\n        else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\r\n          var AutoFilter = xlml_parsexmltag(Rn[0]);\r\n          cursheet['!autofilter'] = { ref:rc_to_a1(AutoFilter.Range).replace(/\\$/g,\"\") };\r\n          state.push([Rn[3], true]);\r\n        }\r\n        break;\r\n\r\n      case 'Name': break;\r\n\r\n      case 'ComponentOptions':\r\n      case 'DocumentProperties':\r\n      case 'CustomDocumentProperties':\r\n      case 'OfficeDocumentSettings':\r\n      case 'PivotTable':\r\n      case 'PivotCache':\r\n      case 'Names':\r\n      case 'MapInfo':\r\n      case 'PageBreaks':\r\n      case 'QueryTable':\r\n      case 'DataValidation':\r\n      case 'Sorting':\r\n      case 'Schema':\r\n      case 'data':\r\n      case 'ConditionalFormatting':\r\n      case 'SmartTagType':\r\n      case 'SmartTags':\r\n      case 'ExcelWorkbook':\r\n      case 'WorkbookOptions':\r\n      case 'WorksheetOptions':\r\n        if(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\r\n        else if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\r\n        break;\r\n\r\n      default:\r\n        /* FODS file root is <office:document> */\r\n        if(state.length == 0 && Rn[3] == \"document\") return parse_fods(str, opts);\r\n        /* UOS file root is <uof:UOF> */\r\n        if(state.length == 0 && Rn[3] == \"UOF\") return parse_fods(str, opts);\r\n\r\n        var seen = true;\r\n        switch(state[state.length-1][0]) {\r\n          /* OfficeDocumentSettings */\r\n          case 'OfficeDocumentSettings': switch(Rn[3]) {\r\n            case 'AllowPNG': break;\r\n            case 'RemovePersonalInformation': break;\r\n            case 'DownloadComponents': break;\r\n            case 'LocationOfComponents': break;\r\n            case 'Colors': break;\r\n            case 'Color': break;\r\n            case 'Index': break;\r\n            case 'RGB': break;\r\n            case 'PixelsPerInch': break; // TODO: set PPI\r\n            case 'TargetScreenSize': break;\r\n            case 'ReadOnlyRecommended': break;\r\n            default: seen = false;\r\n          } break;\r\n\r\n          /* ComponentOptions */\r\n          case 'ComponentOptions': switch(Rn[3]) {\r\n            case 'Toolbar': break;\r\n            case 'HideOfficeLogo': break;\r\n            case 'SpreadsheetAutoFit': break;\r\n            case 'Label': break;\r\n            case 'Caption': break;\r\n            case 'MaxHeight': break;\r\n            case 'MaxWidth': break;\r\n            case 'NextSheetNumber': break;\r\n            default: seen = false;\r\n          } break;\r\n\r\n          /* ExcelWorkbook */\r\n          case 'ExcelWorkbook': switch(Rn[3]) {\r\n            case 'Date1904':\r\n              Workbook.WBProps.date1904 = true;\r\n              break;\r\n            case 'WindowHeight': break;\r\n            case 'WindowWidth': break;\r\n            case 'WindowTopX': break;\r\n            case 'WindowTopY': break;\r\n            case 'TabRatio': break;\r\n            case 'ProtectStructure': break;\r\n            case 'ProtectWindows': break;\r\n            case 'ActiveSheet': break;\r\n            case 'DisplayInkNotes': break;\r\n            case 'FirstVisibleSheet': break;\r\n            case 'SupBook': break;\r\n            case 'SheetName': break;\r\n            case 'SheetIndex': break;\r\n            case 'SheetIndexFirst': break;\r\n            case 'SheetIndexLast': break;\r\n            case 'Dll': break;\r\n            case 'AcceptLabelsInFormulas': break;\r\n            case 'DoNotSaveLinkValues': break;\r\n            case 'Iteration': break;\r\n            case 'MaxIterations': break;\r\n            case 'MaxChange': break;\r\n            case 'Path': break;\r\n            case 'Xct': break;\r\n            case 'Count': break;\r\n            case 'SelectedSheets': break;\r\n            case 'Calculation': break;\r\n            case 'Uncalced': break;\r\n            case 'StartupPrompt': break;\r\n            case 'Crn': break;\r\n            case 'ExternName': break;\r\n            case 'Formula': break;\r\n            case 'ColFirst': break;\r\n            case 'ColLast': break;\r\n            case 'WantAdvise': break;\r\n            case 'Boolean': break;\r\n            case 'Error': break;\r\n            case 'Text': break;\r\n            case 'OLE': break;\r\n            case 'NoAutoRecover': break;\r\n            case 'PublishObjects': break;\r\n            case 'DoNotCalculateBeforeSave': break;\r\n            case 'Number': break;\r\n            case 'RefModeR1C1': break;\r\n            case 'EmbedSaveSmartTags': break;\r\n            default: seen = false;\r\n          } break;\r\n\r\n          /* WorkbookOptions */\r\n          case 'WorkbookOptions': switch(Rn[3]) {\r\n            case 'OWCVersion': break;\r\n            case 'Height': break;\r\n            case 'Width': break;\r\n            default: seen = false;\r\n          } break;\r\n\r\n          /* WorksheetOptions */\r\n          case 'WorksheetOptions': switch(Rn[3]) {\r\n            case 'Visible':\r\n              if(Rn[0].slice(-2) === \"/>\"){/* empty */}\r\n              else if(Rn[1]===\"/\") switch(str.slice(pidx, Rn.index)) {\r\n                case \"SheetHidden\": wsprops.Hidden = 1; break;\r\n                case \"SheetVeryHidden\": wsprops.Hidden = 2; break;\r\n              }\r\n              else pidx = Rn.index + Rn[0].length;\r\n              break;\r\n            case 'Header':\r\n              if(!cursheet['!margins']) default_margins(cursheet['!margins']={}, 'xlml');\r\n              cursheet['!margins'].header = parsexmltag(Rn[0]).Margin;\r\n              break;\r\n            case 'Footer':\r\n              if(!cursheet['!margins']) default_margins(cursheet['!margins']={}, 'xlml');\r\n              cursheet['!margins'].footer = parsexmltag(Rn[0]).Margin;\r\n              break;\r\n            case 'PageMargins':\r\n              var pagemargins = parsexmltag(Rn[0]);\r\n              if(!cursheet['!margins']) default_margins(cursheet['!margins']={},'xlml');\r\n              if(pagemargins.Top) cursheet['!margins'].top = pagemargins.Top;\r\n              if(pagemargins.Left) cursheet['!margins'].left = pagemargins.Left;\r\n              if(pagemargins.Right) cursheet['!margins'].right = pagemargins.Right;\r\n              if(pagemargins.Bottom) cursheet['!margins'].bottom = pagemargins.Bottom;\r\n              break;\r\n            case 'DisplayRightToLeft':\r\n              if(!Workbook.Views) Workbook.Views = [];\r\n              if(!Workbook.Views[0]) Workbook.Views[0] = {};\r\n              Workbook.Views[0].RTL = true;\r\n              break;\r\n\r\n            case 'Unsynced': break;\r\n            case 'Print': break;\r\n            case 'Panes': break;\r\n            case 'Scale': break;\r\n            case 'Pane': break;\r\n            case 'Number': break;\r\n            case 'Layout': break;\r\n            case 'PageSetup': break;\r\n            case 'Selected': break;\r\n            case 'ProtectObjects': break;\r\n            case 'EnableSelection': break;\r\n            case 'ProtectScenarios': break;\r\n            case 'ValidPrinterInfo': break;\r\n            case 'HorizontalResolution': break;\r\n            case 'VerticalResolution': break;\r\n            case 'NumberofCopies': break;\r\n            case 'ActiveRow': break;\r\n            case 'ActiveCol': break;\r\n            case 'ActivePane': break;\r\n            case 'TopRowVisible': break;\r\n            case 'TopRowBottomPane': break;\r\n            case 'LeftColumnVisible': break;\r\n            case 'LeftColumnRightPane': break;\r\n            case 'FitToPage': break;\r\n            case 'RangeSelection': break;\r\n            case 'PaperSizeIndex': break;\r\n            case 'PageLayoutZoom': break;\r\n            case 'PageBreakZoom': break;\r\n            case 'FilterOn': break;\r\n            case 'DoNotDisplayGridlines': break;\r\n            case 'SplitHorizontal': break;\r\n            case 'SplitVertical': break;\r\n            case 'FreezePanes': break;\r\n            case 'FrozenNoSplit': break;\r\n            case 'FitWidth': break;\r\n            case 'FitHeight': break;\r\n            case 'CommentsLayout': break;\r\n            case 'Zoom': break;\r\n            case 'LeftToRight': break;\r\n            case 'Gridlines': break;\r\n            case 'AllowSort': break;\r\n            case 'AllowFilter': break;\r\n            case 'AllowInsertRows': break;\r\n            case 'AllowDeleteRows': break;\r\n            case 'AllowInsertCols': break;\r\n            case 'AllowDeleteCols': break;\r\n            case 'AllowInsertHyperlinks': break;\r\n            case 'AllowFormatCells': break;\r\n            case 'AllowSizeCols': break;\r\n            case 'AllowSizeRows': break;\r\n            case 'NoSummaryRowsBelowDetail': break;\r\n            case 'TabColorIndex': break;\r\n            case 'DoNotDisplayHeadings': break;\r\n            case 'ShowPageLayoutZoom': break;\r\n            case 'NoSummaryColumnsRightDetail': break;\r\n            case 'BlackAndWhite': break;\r\n            case 'DoNotDisplayZeros': break;\r\n            case 'DisplayPageBreak': break;\r\n            case 'RowColHeadings': break;\r\n            case 'DoNotDisplayOutline': break;\r\n            case 'NoOrientation': break;\r\n            case 'AllowUsePivotTables': break;\r\n            case 'ZeroHeight': break;\r\n            case 'ViewableRange': break;\r\n            case 'Selection': break;\r\n            case 'ProtectContents': break;\r\n            default: seen = false;\r\n          } break;\r\n\r\n          /* PivotTable */\r\n          case 'PivotTable': case 'PivotCache': switch(Rn[3]) {\r\n            case 'ImmediateItemsOnDrop': break;\r\n            case 'ShowPageMultipleItemLabel': break;\r\n            case 'CompactRowIndent': break;\r\n            case 'Location': break;\r\n            case 'PivotField': break;\r\n            case 'Orientation': break;\r\n            case 'LayoutForm': break;\r\n            case 'LayoutSubtotalLocation': break;\r\n            case 'LayoutCompactRow': break;\r\n            case 'Position': break;\r\n            case 'PivotItem': break;\r\n            case 'DataType': break;\r\n            case 'DataField': break;\r\n            case 'SourceName': break;\r\n            case 'ParentField': break;\r\n            case 'PTLineItems': break;\r\n            case 'PTLineItem': break;\r\n            case 'CountOfSameItems': break;\r\n            case 'Item': break;\r\n            case 'ItemType': break;\r\n            case 'PTSource': break;\r\n            case 'CacheIndex': break;\r\n            case 'ConsolidationReference': break;\r\n            case 'FileName': break;\r\n            case 'Reference': break;\r\n            case 'NoColumnGrand': break;\r\n            case 'NoRowGrand': break;\r\n            case 'BlankLineAfterItems': break;\r\n            case 'Hidden': break;\r\n            case 'Subtotal': break;\r\n            case 'BaseField': break;\r\n            case 'MapChildItems': break;\r\n            case 'Function': break;\r\n            case 'RefreshOnFileOpen': break;\r\n            case 'PrintSetTitles': break;\r\n            case 'MergeLabels': break;\r\n            case 'DefaultVersion': break;\r\n            case 'RefreshName': break;\r\n            case 'RefreshDate': break;\r\n            case 'RefreshDateCopy': break;\r\n            case 'VersionLastRefresh': break;\r\n            case 'VersionLastUpdate': break;\r\n            case 'VersionUpdateableMin': break;\r\n            case 'VersionRefreshableMin': break;\r\n            case 'Calculation': break;\r\n            default: seen = false;\r\n          } break;\r\n\r\n          /* PageBreaks */\r\n          case 'PageBreaks': switch(Rn[3]) {\r\n            case 'ColBreaks': break;\r\n            case 'ColBreak': break;\r\n            case 'RowBreaks': break;\r\n            case 'RowBreak': break;\r\n            case 'ColStart': break;\r\n            case 'ColEnd': break;\r\n            case 'RowEnd': break;\r\n            default: seen = false;\r\n          } break;\r\n\r\n          /* AutoFilter */\r\n          case 'AutoFilter': switch(Rn[3]) {\r\n            case 'AutoFilterColumn': break;\r\n            case 'AutoFilterCondition': break;\r\n            case 'AutoFilterAnd': break;\r\n            case 'AutoFilterOr': break;\r\n            default: seen = false;\r\n          } break;\r\n\r\n          /* QueryTable */\r\n          case 'QueryTable': switch(Rn[3]) {\r\n            case 'Id': break;\r\n            case 'AutoFormatFont': break;\r\n            case 'AutoFormatPattern': break;\r\n            case 'QuerySource': break;\r\n            case 'QueryType': break;\r\n            case 'EnableRedirections': break;\r\n            case 'RefreshedInXl9': break;\r\n            case 'URLString': break;\r\n            case 'HTMLTables': break;\r\n            case 'Connection': break;\r\n            case 'CommandText': break;\r\n            case 'RefreshInfo': break;\r\n            case 'NoTitles': break;\r\n            case 'NextId': break;\r\n            case 'ColumnInfo': break;\r\n            case 'OverwriteCells': break;\r\n            case 'DoNotPromptForFile': break;\r\n            case 'TextWizardSettings': break;\r\n            case 'Source': break;\r\n            case 'Number': break;\r\n            case 'Decimal': break;\r\n            case 'ThousandSeparator': break;\r\n            case 'TrailingMinusNumbers': break;\r\n            case 'FormatSettings': break;\r\n            case 'FieldType': break;\r\n            case 'Delimiters': break;\r\n            case 'Tab': break;\r\n            case 'Comma': break;\r\n            case 'AutoFormatName': break;\r\n            case 'VersionLastEdit': break;\r\n            case 'VersionLastRefresh': break;\r\n            default: seen = false;\r\n          } break;\r\n\r\n          case 'Sorting':\r\n          case 'ConditionalFormatting':\r\n          case 'DataValidation':\r\n            switch(Rn[3]) {\r\n              case 'Range': break;\r\n              case 'Type': break;\r\n              case 'Min': break;\r\n              case 'Max': break;\r\n              case 'Sort': break;\r\n              case 'Descending': break;\r\n              case 'Order': break;\r\n              case 'CaseSensitive': break;\r\n              case 'Value': break;\r\n              case 'ErrorStyle': break;\r\n              case 'ErrorMessage': break;\r\n              case 'ErrorTitle': break;\r\n              case 'CellRangeList': break;\r\n              case 'InputMessage': break;\r\n              case 'InputTitle': break;\r\n              case 'ComboHide': break;\r\n              case 'InputHide': break;\r\n              case 'Condition': break;\r\n              case 'Qualifier': break;\r\n              case 'UseBlank': break;\r\n              case 'Value1': break;\r\n              case 'Value2': break;\r\n              case 'Format': break;\r\n              default: seen = false;\r\n            } break;\r\n\r\n          /* MapInfo (schema) */\r\n          case 'MapInfo': case 'Schema': case 'data': switch(Rn[3]) {\r\n            case 'Map': break;\r\n            case 'Entry': break;\r\n            case 'Range': break;\r\n            case 'XPath': break;\r\n            case 'Field': break;\r\n            case 'XSDType': break;\r\n            case 'FilterOn': break;\r\n            case 'Aggregate': break;\r\n            case 'ElementType': break;\r\n            case 'AttributeType': break;\r\n            /* These are from xsd (XML Schema Definition) */\r\n            case 'schema':\r\n            case 'element':\r\n            case 'complexType':\r\n            case 'datatype':\r\n            case 'all':\r\n            case 'attribute':\r\n            case 'extends': break;\r\n\r\n            case 'row': break;\r\n            default: seen = false;\r\n          } break;\r\n\r\n          /* SmartTags (can be anything) */\r\n          case 'SmartTags': break;\r\n\r\n          default: seen = false; break;\r\n        }\r\n        if(seen) break;\r\n        /* CustomDocumentProperties */\r\n        if(!state[state.length-1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\r\n        if(state[state.length-1][0]==='CustomDocumentProperties') {\r\n          if(Rn[0].slice(-2) === \"/>\") break;\r\n          else if(Rn[1]===\"/\") xlml_set_custprop(Custprops, Rn[3], cp, str.slice(pidx, Rn.index));\r\n          else { cp = Rn; pidx = Rn.index + Rn[0].length; }\r\n          break;\r\n        }\r\n        if(opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\r\n    }\r\n    var out = ({});\r\n    if(!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\r\n    out.SheetNames = sheetnames;\r\n    out.Workbook = Workbook;\r\n    out.SSF = SSF.get_table();\r\n    out.Props = Props;\r\n    out.Custprops = Custprops;\r\n    return out;\r\n  }\r\n\r\n  function parse_xlml(data, opts) {\r\n    fix_read_opts(opts=opts||{});\r\n    switch(opts.type||\"base64\") {\r\n      case \"base64\": return parse_xlml_xml(Base64.decode(data), opts);\r\n      case \"binary\": case \"buffer\": case \"file\": return parse_xlml_xml(data, opts);\r\n      case \"array\": return parse_xlml_xml(a2s(data), opts);\r\n    }\r\n  }\r\n\r\n  /* TODO */\r\n  function write_props_xlml(wb, opts) {\r\n    var o = [];\r\n    /* DocumentProperties */\r\n    if(wb.Props) o.push(xlml_write_docprops(wb.Props, opts));\r\n    /* CustomDocumentProperties */\r\n    if(wb.Custprops) o.push(xlml_write_custprops(wb.Props, wb.Custprops, opts));\r\n    return o.join(\"\");\r\n  }\r\n  /* TODO */\r\n  function write_wb_xlml() {\r\n    /* OfficeDocumentSettings */\r\n    /* ExcelWorkbook */\r\n    return \"\";\r\n  }\r\n  /* TODO */\r\n  function write_sty_xlml(wb, opts) {\r\n    /* Styles */\r\n    var styles = ['<Style ss:ID=\"Default\" ss:Name=\"Normal\"><NumberFormat/></Style>'];\r\n    opts.cellXfs.forEach(function(xf, id) {\r\n      var payload = [];\r\n      payload.push(writextag('NumberFormat', null, {\"ss:Format\": escapexml(SSF._table[xf.numFmtId])}));\r\n      styles.push(writextag('Style', payload.join(\"\"), {\"ss:ID\": \"s\" + (21+id)}));\r\n    });\r\n    return writextag(\"Styles\", styles.join(\"\"));\r\n  }\r\n  function write_name_xlml(n) { return writextag(\"NamedRange\", null, {\"ss:Name\": n.Name, \"ss:RefersTo\":\"=\" + a1_to_rc(n.Ref, {r:0,c:0})}); }\r\n  function write_names_xlml(wb) {\r\n    if(!((wb||{}).Workbook||{}).Names) return \"\";\r\n    var names = wb.Workbook.Names;\r\n    var out = [];\r\n    for(var i = 0; i < names.length; ++i) {\r\n      var n = names[i];\r\n      if(n.Sheet != null) continue;\r\n      if(n.Name.match(/^_xlfn\\./)) continue;\r\n      out.push(write_name_xlml(n));\r\n    }\r\n    return writextag(\"Names\", out.join(\"\"));\r\n  }\r\n  function write_ws_xlml_names(ws, opts, idx, wb) {\r\n    if(!ws) return \"\";\r\n    if(!((wb||{}).Workbook||{}).Names) return \"\";\r\n    var names = wb.Workbook.Names;\r\n    var out = [];\r\n    for(var i = 0; i < names.length; ++i) {\r\n      var n = names[i];\r\n      if(n.Sheet != idx) continue;\r\n      /*switch(n.Name) {\r\n\t\t\tcase \"_\": continue;\r\n\t\t}*/\r\n      if(n.Name.match(/^_xlfn\\./)) continue;\r\n      out.push(write_name_xlml(n));\r\n    }\r\n    return out.join(\"\");\r\n  }\r\n  /* WorksheetOptions */\r\n  function write_ws_xlml_wsopts(ws, opts, idx, wb) {\r\n    if(!ws) return \"\";\r\n    var o = [];\r\n    /* NOTE: spec technically allows any order, but stick with implied order */\r\n\r\n    /* FitToPage */\r\n    /* DoNotDisplayColHeaders */\r\n    /* DoNotDisplayRowHeaders */\r\n    /* ViewableRange */\r\n    /* Selection */\r\n    /* GridlineColor */\r\n    /* Name */\r\n    /* ExcelWorksheetType */\r\n    /* IntlMacro */\r\n    /* Unsynced */\r\n    /* Selected */\r\n    /* CodeName */\r\n\r\n    if(ws['!margins']) {\r\n      o.push(\"<PageSetup>\");\r\n      if(ws['!margins'].header) o.push(writextag(\"Header\", null, {'x:Margin':ws['!margins'].header}));\r\n      if(ws['!margins'].footer) o.push(writextag(\"Footer\", null, {'x:Margin':ws['!margins'].footer}));\r\n      o.push(writextag(\"PageMargins\", null, {\r\n        'x:Bottom': ws['!margins'].bottom || \"0.75\",\r\n        'x:Left': ws['!margins'].left || \"0.7\",\r\n        'x:Right': ws['!margins'].right || \"0.7\",\r\n        'x:Top': ws['!margins'].top || \"0.75\"\r\n      }));\r\n      o.push(\"</PageSetup>\");\r\n    }\r\n\r\n    /* PageSetup */\r\n    /* DisplayPageBreak */\r\n    /* TransitionExpressionEvaluation */\r\n    /* TransitionFormulaEntry */\r\n    /* Print */\r\n    /* Zoom */\r\n    /* PageLayoutZoom */\r\n    /* PageBreakZoom */\r\n    /* ShowPageBreakZoom */\r\n    /* DefaultRowHeight */\r\n    /* DefaultColumnWidth */\r\n    /* StandardWidth */\r\n\r\n    if(wb && wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx]) {\r\n      /* Visible */\r\n      if(wb.Workbook.Sheets[idx].Hidden) o.push(writextag(\"Visible\", (wb.Workbook.Sheets[idx].Hidden == 1 ? \"SheetHidden\" : \"SheetVeryHidden\"), {}));\r\n      else {\r\n        /* Selected */\r\n        for(var i = 0; i < idx; ++i) if(wb.Workbook.Sheets[i] && !wb.Workbook.Sheets[i].Hidden) break;\r\n        if(i == idx) o.push(\"<Selected/>\");\r\n      }\r\n    }\r\n\r\n    /* LeftColumnVisible */\r\n\r\n    if(((((wb||{}).Workbook||{}).Views||[])[0]||{}).RTL) o.push(\"<DisplayRightToLeft/>\");\r\n\r\n    /* GridlineColorIndex */\r\n    /* DisplayFormulas */\r\n    /* DoNotDisplayGridlines */\r\n    /* DoNotDisplayHeadings */\r\n    /* DoNotDisplayOutline */\r\n    /* ApplyAutomaticOutlineStyles */\r\n    /* NoSummaryRowsBelowDetail */\r\n    /* NoSummaryColumnsRightDetail */\r\n    /* DoNotDisplayZeros */\r\n    /* ActiveRow */\r\n    /* ActiveColumn */\r\n    /* FilterOn */\r\n    /* RangeSelection */\r\n    /* TopRowVisible */\r\n    /* TopRowBottomPane */\r\n    /* LeftColumnRightPane */\r\n    /* ActivePane */\r\n    /* SplitHorizontal */\r\n    /* SplitVertical */\r\n    /* FreezePanes */\r\n    /* FrozenNoSplit */\r\n    /* TabColorIndex */\r\n    /* Panes */\r\n\r\n    /* NOTE: Password not supported in XLML Format */\r\n    if(ws['!protect']) {\r\n      o.push(writetag(\"ProtectContents\", \"True\"));\r\n      if(ws['!protect'].objects) o.push(writetag(\"ProtectObjects\", \"True\"));\r\n      if(ws['!protect'].scenarios) o.push(writetag(\"ProtectScenarios\", \"True\"));\r\n      if(ws['!protect'].selectLockedCells != null && !ws['!protect'].selectLockedCells) o.push(writetag(\"EnableSelection\", \"NoSelection\"));\r\n      else if(ws['!protect'].selectUnlockedCells != null && !ws['!protect'].selectUnlockedCells) o.push(writetag(\"EnableSelection\", \"UnlockedCells\"));\r\n      [\r\n        [ \"formatCells\", \"AllowFormatCells\" ],\r\n        [ \"formatColumns\", \"AllowSizeCols\" ],\r\n        [ \"formatRows\", \"AllowSizeRows\" ],\r\n        [ \"insertColumns\", \"AllowInsertCols\" ],\r\n        [ \"insertRows\", \"AllowInsertRows\" ],\r\n        [ \"insertHyperlinks\", \"AllowInsertHyperlinks\" ],\r\n        [ \"deleteColumns\", \"AllowDeleteCols\" ],\r\n        [ \"deleteRows\", \"AllowDeleteRows\" ],\r\n        [ \"sort\", \"AllowSort\" ],\r\n        [ \"autoFilter\", \"AllowFilter\" ],\r\n        [ \"pivotTables\", \"AllowUsePivotTables\" ]\r\n      ].forEach(function(x) { if(ws['!protect'][x[0]]) o.push(\"<\"+x[1]+\"/>\"); });\r\n    }\r\n\r\n    if(o.length == 0) return \"\";\r\n    return writextag(\"WorksheetOptions\", o.join(\"\"), {xmlns:XLMLNS.x});\r\n  }\r\n  function write_ws_xlml_comment(comments) {\r\n    return comments.map(function(c) {\r\n      // TODO: formatted text\r\n      var t = xlml_unfixstr(c.t||\"\");\r\n      var d =writextag(\"ss:Data\", t, {\"xmlns\":\"http://www.w3.org/TR/REC-html40\"});\r\n      return writextag(\"Comment\", d, {\"ss:Author\":c.a});\r\n    }).join(\"\");\r\n  }\r\n  function write_ws_xlml_cell(cell, ref, ws, opts, idx, wb, addr){\r\n    if(!cell || (cell.v == undefined && cell.f == undefined)) return \"\";\r\n\r\n    var attr = {};\r\n    if(cell.f) attr[\"ss:Formula\"] = \"=\" + escapexml(a1_to_rc(cell.f, addr));\r\n    if(cell.F && cell.F.slice(0, ref.length) == ref) {\r\n      var end = decode_cell(cell.F.slice(ref.length + 1));\r\n      attr[\"ss:ArrayRange\"] = \"RC:R\" + (end.r == addr.r ? \"\" : \"[\" + (end.r - addr.r) + \"]\") + \"C\" + (end.c == addr.c ? \"\" : \"[\" + (end.c - addr.c) + \"]\");\r\n    }\r\n\r\n    if(cell.l && cell.l.Target) {\r\n      attr[\"ss:HRef\"] = escapexml(cell.l.Target);\r\n      if(cell.l.Tooltip) attr[\"x:HRefScreenTip\"] = escapexml(cell.l.Tooltip);\r\n    }\r\n\r\n    if(ws['!merges']) {\r\n      var marr = ws['!merges'];\r\n      for(var mi = 0; mi != marr.length; ++mi) {\r\n        if(marr[mi].s.c != addr.c || marr[mi].s.r != addr.r) continue;\r\n        if(marr[mi].e.c > marr[mi].s.c) attr['ss:MergeAcross'] = marr[mi].e.c - marr[mi].s.c;\r\n        if(marr[mi].e.r > marr[mi].s.r) attr['ss:MergeDown'] = marr[mi].e.r - marr[mi].s.r;\r\n      }\r\n    }\r\n\r\n    var t = \"\", p = \"\";\r\n    switch(cell.t) {\r\n      case 'z': return \"\";\r\n      case 'n': t = 'Number'; p = String(cell.v); break;\r\n      case 'b': t = 'Boolean'; p = (cell.v ? \"1\" : \"0\"); break;\r\n      case 'e': t = 'Error'; p = BErr[cell.v]; break;\r\n      case 'd': t = 'DateTime'; p = new Date(cell.v).toISOString(); if(cell.z == null) cell.z = cell.z || SSF._table[14]; break;\r\n      case 's': t = 'String'; p = escapexlml(cell.v||\"\"); break;\r\n    }\r\n    /* TODO: cell style */\r\n    var os = get_cell_style(opts.cellXfs, cell, opts);\r\n    attr[\"ss:StyleID\"] = \"s\" + (21+os);\r\n    attr[\"ss:Index\"] = addr.c + 1;\r\n    var _v = (cell.v != null ? p : \"\");\r\n    var m = '<Data ss:Type=\"' + t + '\">' + _v + '</Data>';\r\n\r\n    if((cell.c||[]).length > 0) m += write_ws_xlml_comment(cell.c);\r\n\r\n    return writextag(\"Cell\", m, attr);\r\n  }\r\n  function write_ws_xlml_row(R, row) {\r\n    var o = '<Row ss:Index=\"' + (R+1) + '\"';\r\n    if(row) {\r\n      if(row.hpt && !row.hpx) row.hpx = pt2px(row.hpt);\r\n      if(row.hpx) o += ' ss:AutoFitHeight=\"0\" ss:Height=\"' + row.hpx + '\"';\r\n      if(row.hidden) o += ' ss:Hidden=\"1\"';\r\n    }\r\n    return o + '>';\r\n  }\r\n  /* TODO */\r\n  function write_ws_xlml_table(ws, opts, idx, wb) {\r\n    if(!ws['!ref']) return \"\";\r\n    var range = safe_decode_range(ws['!ref']);\r\n    var marr = ws['!merges'] || [], mi = 0;\r\n    var o = [];\r\n    if(ws['!cols']) ws['!cols'].forEach(function(n, i) {\r\n      process_col(n);\r\n      var w = !!n.width;\r\n      var p = col_obj_w(i, n);\r\n      var k = {\"ss:Index\":i+1};\r\n      if(w) k['ss:Width'] = width2px(p.width);\r\n      if(n.hidden) k['ss:Hidden']=\"1\";\r\n      o.push(writextag(\"Column\",null,k));\r\n    });\r\n    var dense = Array.isArray(ws);\r\n    for(var R = range.s.r; R <= range.e.r; ++R) {\r\n      var row = [write_ws_xlml_row(R, (ws['!rows']||[])[R])];\r\n      for(var C = range.s.c; C <= range.e.c; ++C) {\r\n        var skip = false;\r\n        for(mi = 0; mi != marr.length; ++mi) {\r\n          if(marr[mi].s.c > C) continue;\r\n          if(marr[mi].s.r > R) continue;\r\n          if(marr[mi].e.c < C) continue;\r\n          if(marr[mi].e.r < R) continue;\r\n          if(marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\r\n          break;\r\n        }\r\n        if(skip) continue;\r\n        var addr = {r:R,c:C};\r\n        var ref = encode_cell(addr), cell = dense ? (ws[R]||[])[C] : ws[ref];\r\n        row.push(write_ws_xlml_cell(cell, ref, ws, opts, idx, wb, addr));\r\n      }\r\n      row.push(\"</Row>\");\r\n      if(row.length > 2) o.push(row.join(\"\"));\r\n    }\r\n    return o.join(\"\");\r\n  }\r\n  function write_ws_xlml(idx, opts, wb) {\r\n    var o = [];\r\n    var s = wb.SheetNames[idx];\r\n    var ws = wb.Sheets[s];\r\n\r\n    var t = ws ? write_ws_xlml_names(ws, opts, idx, wb) : \"\";\r\n    if(t.length > 0) o.push(\"<Names>\" + t + \"</Names>\");\r\n\r\n    /* Table */\r\n    t = ws ? write_ws_xlml_table(ws, opts, idx, wb) : \"\";\r\n    if(t.length > 0) o.push(\"<Table>\" + t + \"</Table>\");\r\n\r\n    /* WorksheetOptions */\r\n    o.push(write_ws_xlml_wsopts(ws, opts, idx, wb));\r\n\r\n    return o.join(\"\");\r\n  }\r\n  function write_xlml(wb, opts) {\r\n    if(!opts) opts = {};\r\n    if(!wb.SSF) wb.SSF = SSF.get_table();\r\n    if(wb.SSF) {\r\n      make_ssf(SSF); SSF.load_table(wb.SSF);\r\n      // $FlowIgnore\r\n      opts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\r\n      opts.ssf = wb.SSF;\r\n      opts.cellXfs = [];\r\n      get_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\r\n    }\r\n    var d = [];\r\n    d.push(write_props_xlml(wb, opts));\r\n    d.push(write_wb_xlml(wb, opts));\r\n    d.push(\"\");\r\n    d.push(\"\");\r\n    for(var i = 0; i < wb.SheetNames.length; ++i)\r\n      d.push(writextag(\"Worksheet\", write_ws_xlml(i, opts, wb), {\"ss:Name\":escapexml(wb.SheetNames[i])}));\r\n    d[2] = write_sty_xlml(wb, opts);\r\n    d[3] = write_names_xlml(wb, opts);\r\n    return XML_HEADER + writextag(\"Workbook\", d.join(\"\"), {\r\n      'xmlns':      XLMLNS.ss,\r\n      'xmlns:o':    XLMLNS.o,\r\n      'xmlns:x':    XLMLNS.x,\r\n      'xmlns:ss':   XLMLNS.ss,\r\n      'xmlns:dt':   XLMLNS.dt,\r\n      'xmlns:html': XLMLNS.html\r\n    });\r\n  }\r\n  /* [MS-OLEDS] 2.3.8 CompObjStream */\r\n  function parse_compobj(obj) {\r\n    var v = {};\r\n    var o = obj.content;\r\n    /* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\r\n    o.l = 28;\r\n\r\n    v.AnsiUserType = o.read_shift(0, \"lpstr-ansi\");\r\n    v.AnsiClipboardFormat = parse_ClipboardFormatOrAnsiString(o);\r\n\r\n    if(o.length - o.l <= 4) return v;\r\n\r\n    var m = o.read_shift(4);\r\n    if(m == 0 || m > 40) return v;\r\n    o.l-=4; v.Reserved1 = o.read_shift(0, \"lpstr-ansi\");\r\n\r\n    if(o.length - o.l <= 4) return v;\r\n    m = o.read_shift(4);\r\n    if(m !== 0x71b239f4) return v;\r\n    v.UnicodeClipboardFormat = parse_ClipboardFormatOrUnicodeString(o);\r\n\r\n    m = o.read_shift(4);\r\n    if(m == 0 || m > 40) return v;\r\n    o.l-=4; v.Reserved2 = o.read_shift(0, \"lpwstr\");\r\n  }\r\n\r\n  /*\r\n\tContinue logic for:\r\n\t- 2.4.58 Continue\r\n\t- 2.4.59 ContinueBigName\r\n\t- 2.4.60 ContinueFrt\r\n\t- 2.4.61 ContinueFrt11\r\n\t- 2.4.62 ContinueFrt12\r\n*/\r\n  function slurp(R, blob, length, opts) {\r\n    var l = length;\r\n    var bufs = [];\r\n    var d = blob.slice(blob.l,blob.l+l);\r\n    if(opts && opts.enc && opts.enc.insitu) switch(R.n) {\r\n      case 'BOF': case 'FilePass': case 'FileLock': case 'InterfaceHdr': case 'RRDInfo': case 'RRDHead': case 'UsrExcl': break;\r\n      default:\r\n        if(d.length === 0) break;\r\n        opts.enc.insitu(d);\r\n    }\r\n    bufs.push(d);\r\n    blob.l += l;\r\n    var next = (XLSRecordEnum[__readUInt16LE(blob,blob.l)]);\r\n    var start = 0;\r\n    while(next != null && next.n.slice(0,8) === 'Continue') {\r\n      l = __readUInt16LE(blob,blob.l+2);\r\n      start = blob.l + 4;\r\n      if(next.n == 'ContinueFrt') start += 4;\r\n      else if(next.n.slice(0,11) == 'ContinueFrt') start += 12;\r\n      bufs.push(blob.slice(start,blob.l+4+l));\r\n      blob.l += 4+l;\r\n      next = (XLSRecordEnum[__readUInt16LE(blob, blob.l)]);\r\n    }\r\n    var b = (bconcat(bufs));\r\n    prep_blob(b, 0);\r\n    var ll = 0; b.lens = [];\r\n    for(var j = 0; j < bufs.length; ++j) { b.lens.push(ll); ll += bufs[j].length; }\r\n    return R.f(b, b.length, opts);\r\n  }\r\n\r\n  function safe_format_xf(p, opts, date1904) {\r\n    if(p.t === 'z') return;\r\n    if(!p.XF) return;\r\n    var fmtid = 0;\r\n    try {\r\n      fmtid = p.z || p.XF.numFmtId || 0;\r\n      if(opts.cellNF) p.z = SSF._table[fmtid];\r\n    } catch(e) { if(opts.WTF) throw e; }\r\n    if(!opts || opts.cellText !== false) try {\r\n      if(p.t === 'e') { p.w = p.w || BErr[p.v]; }\r\n      else if(fmtid === 0 || fmtid == \"General\") {\r\n        if(p.t === 'n') {\r\n          if((p.v|0) === p.v) p.w = SSF._general_int(p.v);\r\n          else p.w = SSF._general_num(p.v);\r\n        }\r\n        else p.w = SSF._general(p.v);\r\n      }\r\n      else p.w = SSF.format(fmtid,p.v, {date1904:!!date1904});\r\n    } catch(e) { if(opts.WTF) throw e; }\r\n    if(opts.cellDates && fmtid && p.t == 'n' && SSF.is_date(SSF._table[fmtid] || String(fmtid))) {\r\n      var _d = SSF.parse_date_code(p.v); if(_d) { p.t = 'd'; p.v = new Date(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u); }\r\n    }\r\n  }\r\n\r\n  function make_cell(val, ixfe, t) {\r\n    return ({v:val, ixfe:ixfe, t:t});\r\n  }\r\n\r\n// 2.3.2\r\n  function parse_workbook(blob, options) {\r\n    var wb = ({opts:{}});\r\n    var Sheets = {};\r\n    if(DENSE != null && options.dense == null) options.dense = DENSE;\r\n    var out = ((options.dense ? [] : {}));\r\n    var Directory = {};\r\n    var range = ({});\r\n    var last_formula = null;\r\n    var sst = ([]);\r\n    var cur_sheet = \"\";\r\n    var Preamble = {};\r\n    var lastcell, last_cell = \"\", cc, cmnt, rngC, rngR;\r\n    var sharedf = {};\r\n    var arrayf = [];\r\n    var temp_val;\r\n    var country;\r\n    var cell_valid = true;\r\n    var XFs = []; /* XF records */\r\n    var palette = [];\r\n    var Workbook = ({ Sheets:[], WBProps:{date1904:false}, Views:[{}] }), wsprops = {};\r\n    var get_rgb = function getrgb(icv) {\r\n      if(icv < 8) return XLSIcv[icv];\r\n      if(icv < 64) return palette[icv-8] || XLSIcv[icv];\r\n      return XLSIcv[icv];\r\n    };\r\n    var process_cell_style = function pcs(cell, line, options) {\r\n      var xfd = line.XF.data;\r\n      if(!xfd || !xfd.patternType || !options || !options.cellStyles) return;\r\n      line.s = ({});\r\n      line.s.patternType = xfd.patternType;\r\n      var t;\r\n      if((t = rgb2Hex(get_rgb(xfd.icvFore)))) { line.s.fgColor = {rgb:t}; }\r\n      if((t = rgb2Hex(get_rgb(xfd.icvBack)))) { line.s.bgColor = {rgb:t}; }\r\n    };\r\n    var addcell = function addcell(cell, line, options) {\r\n      if(file_depth > 1) return;\r\n      if(options.sheetRows && cell.r >= options.sheetRows) cell_valid = false;\r\n      if(!cell_valid) return;\r\n      if(options.cellStyles && line.XF && line.XF.data) process_cell_style(cell, line, options);\r\n      delete line.ixfe; delete line.XF;\r\n      lastcell = cell;\r\n      last_cell = encode_cell(cell);\r\n      if(!range || !range.s || !range.e) range = {s:{r:0,c:0},e:{r:0,c:0}};\r\n      if(cell.r < range.s.r) range.s.r = cell.r;\r\n      if(cell.c < range.s.c) range.s.c = cell.c;\r\n      if(cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\r\n      if(cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\r\n      if(options.cellFormula && line.f) {\r\n        for(var afi = 0; afi < arrayf.length; ++afi) {\r\n          if(arrayf[afi][0].s.c > cell.c || arrayf[afi][0].s.r > cell.r) continue;\r\n          if(arrayf[afi][0].e.c < cell.c || arrayf[afi][0].e.r < cell.r) continue;\r\n          line.F = encode_range(arrayf[afi][0]);\r\n          if(arrayf[afi][0].s.c != cell.c || arrayf[afi][0].s.r != cell.r) delete line.f;\r\n          if(line.f) line.f = \"\" + stringify_formula(arrayf[afi][1], range, cell, supbooks, opts);\r\n          break;\r\n        }\r\n      }\r\n      {\r\n        if(options.dense) {\r\n          if(!out[cell.r]) out[cell.r] = [];\r\n          out[cell.r][cell.c] = line;\r\n        } else out[last_cell] = line;\r\n      }\r\n    };\r\n    var opts = ({\r\n      enc: false, // encrypted\r\n      sbcch: 0, // cch in the preceding SupBook\r\n      snames: [], // sheetnames\r\n      sharedf: sharedf, // shared formulae by address\r\n      arrayf: arrayf, // array formulae array\r\n      rrtabid: [], // RRTabId\r\n      lastuser: \"\", // Last User from WriteAccess\r\n      biff: 8, // BIFF version\r\n      codepage: 0, // CP from CodePage record\r\n      winlocked: 0, // fLockWn from WinProtect\r\n      cellStyles: !!options && !!options.cellStyles,\r\n      WTF: !!options && !!options.wtf\r\n    });\r\n    if(options.password) opts.password = options.password;\r\n    var themes;\r\n    var merges = [];\r\n    var objects = [];\r\n    var colinfo = [], rowinfo = [];\r\n    // eslint-disable-next-line no-unused-vars\r\n    var defwidth = 0, defheight = 0; // twips / MDW respectively\r\n    var seencol = false;\r\n    var supbooks = ([]); // 1-indexed, will hold extern names\r\n    supbooks.SheetNames = opts.snames;\r\n    supbooks.sharedf = opts.sharedf;\r\n    supbooks.arrayf = opts.arrayf;\r\n    supbooks.names = [];\r\n    supbooks.XTI = [];\r\n    var last_Rn = '';\r\n    var file_depth = 0; /* TODO: make a real stack */\r\n    var BIFF2Fmt = 0, BIFF2FmtTable = [];\r\n    var FilterDatabases = []; /* TODO: sort out supbooks and process elsewhere */\r\n    var last_lbl;\r\n\r\n    /* explicit override for some broken writers */\r\n    opts.codepage = 1200;\r\n    set_cp(1200);\r\n    var seen_codepage = false;\r\n    while(blob.l < blob.length - 1) {\r\n      var s = blob.l;\r\n      var RecordType = blob.read_shift(2);\r\n      if(RecordType === 0 && last_Rn === 'EOF') break;\r\n      var length = (blob.l === blob.length ? 0 : blob.read_shift(2));\r\n      var R = XLSRecordEnum[RecordType];\r\n      //console.log(RecordType.toString(16), RecordType, R, blob.l, length, blob.length);\r\n      //if(!R) console.log(blob.slice(blob.l, blob.l + length));\r\n      if(R && R.f) {\r\n        if(options.bookSheets) {\r\n          if(last_Rn === 'BoundSheet8' && R.n !== 'BoundSheet8') break;\r\n        }\r\n        last_Rn = R.n;\r\n        if(R.r === 2 || R.r == 12) {\r\n          var rt = blob.read_shift(2); length -= 2;\r\n          if(!opts.enc && rt !== RecordType && (((rt&0xFF)<<8)|(rt>>8)) !== RecordType) throw new Error(\"rt mismatch: \" + rt + \"!=\" + RecordType);\r\n          if(R.r == 12){ blob.l += 10; length -= 10; } // skip FRT\r\n        }\r\n        //console.error(R,blob.l,length,blob.length);\r\n        var val;\r\n        if(R.n === 'EOF') val = R.f(blob, length, opts);\r\n        else val = slurp(R, blob, length, opts);\r\n        var Rn = R.n;\r\n        if(file_depth == 0 && Rn != 'BOF') continue;\r\n        /* nested switch statements to workaround V8 128 limit */\r\n        switch(Rn) {\r\n          /* Workbook Options */\r\n          case 'Date1904':\r\n            wb.opts.Date1904 = Workbook.WBProps.date1904 = val; break;\r\n          case 'WriteProtect': wb.opts.WriteProtect = true; break;\r\n          case 'FilePass':\r\n            if(!opts.enc) blob.l = 0;\r\n            opts.enc = val;\r\n            if(!options.password) throw new Error(\"File is password-protected\");\r\n            if(val.valid == null) throw new Error(\"Encryption scheme unsupported\");\r\n            if(!val.valid) throw new Error(\"Password is incorrect\");\r\n            break;\r\n          case 'WriteAccess': opts.lastuser = val; break;\r\n          case 'FileSharing': break; //TODO\r\n          case 'CodePage':\r\n            /* overrides based on test cases */\r\n            switch(val) {\r\n              case 0x5212: val =  1200; break;\r\n              case 0x8000: val = 10000; break;\r\n              case 0x8001: val =  1252; break;\r\n            }\r\n            set_cp(opts.codepage = val);\r\n            seen_codepage = true;\r\n            break;\r\n          case 'RRTabId': opts.rrtabid = val; break;\r\n          case 'WinProtect': opts.winlocked = val; break;\r\n          case 'Template': break; // TODO\r\n          case 'BookBool': break; // TODO\r\n          case 'UsesELFs': break;\r\n          case 'MTRSettings': break;\r\n          case 'RefreshAll':\r\n          case 'CalcCount':\r\n          case 'CalcDelta':\r\n          case 'CalcIter':\r\n          case 'CalcMode':\r\n          case 'CalcPrecision':\r\n          case 'CalcSaveRecalc':\r\n            wb.opts[Rn] = val; break;\r\n          case 'CalcRefMode': opts.CalcRefMode = val; break; // TODO: implement R1C1\r\n          case 'Uncalced': break;\r\n          case 'ForceFullCalculation': wb.opts.FullCalc = val; break;\r\n          case 'WsBool':\r\n            if(val.fDialog) out[\"!type\"] = \"dialog\";\r\n            break; // TODO\r\n          case 'XF':\r\n            XFs.push(val); break;\r\n          case 'ExtSST': break; // TODO\r\n          case 'BookExt': break; // TODO\r\n          case 'RichTextStream': break;\r\n          case 'BkHim': break;\r\n\r\n          case 'SupBook':\r\n            supbooks.push([val]);\r\n            supbooks[supbooks.length-1].XTI = [];\r\n            break;\r\n          case 'ExternName':\r\n            supbooks[supbooks.length-1].push(val);\r\n            break;\r\n          case 'Index': break; // TODO\r\n          case 'Lbl':\r\n            last_lbl = ({\r\n              Name: val.Name,\r\n              Ref: stringify_formula(val.rgce,range,null,supbooks,opts)\r\n            });\r\n            if(val.itab > 0) last_lbl.Sheet = val.itab - 1;\r\n            supbooks.names.push(last_lbl);\r\n            if(!supbooks[0]) { supbooks[0] = []; supbooks[0].XTI = []; }\r\n            supbooks[supbooks.length-1].push(val);\r\n            if(val.Name == \"_xlnm._FilterDatabase\" && val.itab > 0)\r\n              if(val.rgce && val.rgce[0] && val.rgce[0][0] && val.rgce[0][0][0] == 'PtgArea3d')\r\n                FilterDatabases[val.itab - 1] = { ref: encode_range(val.rgce[0][0][1][2]) };\r\n            break;\r\n          case 'ExternCount': opts.ExternCount = val; break;\r\n          case 'ExternSheet':\r\n            if(supbooks.length == 0) { supbooks[0] = []; supbooks[0].XTI = []; }\r\n            supbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val); supbooks.XTI = supbooks.XTI.concat(val); break;\r\n          case 'NameCmt':\r\n            /* TODO: search for correct name */\r\n            if(opts.biff < 8) break;\r\n            if(last_lbl != null) last_lbl.Comment = val[1];\r\n            break;\r\n\r\n          case 'Protect': out[\"!protect\"] = val; break; /* for sheet or book */\r\n          case 'Password': if(val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val); break;\r\n          case 'Prot4Rev': case 'Prot4RevPass': break; /*TODO: Revision Control*/\r\n\r\n          case 'BoundSheet8': {\r\n            Directory[val.pos] = val;\r\n            opts.snames.push(val.name);\r\n          } break;\r\n          case 'EOF': {\r\n            if(--file_depth) break;\r\n            if(range.e) {\r\n              if(range.e.r > 0 && range.e.c > 0) {\r\n                range.e.r--; range.e.c--;\r\n                out[\"!ref\"] = encode_range(range);\r\n                if(options.sheetRows && options.sheetRows <= range.e.r) {\r\n                  var tmpri = range.e.r;\r\n                  range.e.r = options.sheetRows - 1;\r\n                  out[\"!fullref\"] = out[\"!ref\"];\r\n                  out[\"!ref\"] = encode_range(range);\r\n                  range.e.r = tmpri;\r\n                }\r\n                range.e.r++; range.e.c++;\r\n              }\r\n              if(merges.length > 0) out[\"!merges\"] = merges;\r\n              if(objects.length > 0) out[\"!objects\"] = objects;\r\n              if(colinfo.length > 0) out[\"!cols\"] = colinfo;\r\n              if(rowinfo.length > 0) out[\"!rows\"] = rowinfo;\r\n              Workbook.Sheets.push(wsprops);\r\n            }\r\n            if(cur_sheet === \"\") Preamble = out; else Sheets[cur_sheet] = out;\r\n            out = ((options.dense ? [] : {}));\r\n          } break;\r\n          case 'BOF': {\r\n            if(opts.biff === 8) opts.biff = {\r\n              0x0009:2,\r\n              0x0209:3,\r\n              0x0409:4\r\n            }[RecordType] || {\r\n              0x0200:2,\r\n              0x0300:3,\r\n              0x0400:4,\r\n              0x0500:5,\r\n              0x0600:8,\r\n              0x0002:2,\r\n              0x0007:2\r\n            }[val.BIFFVer] || 8;\r\n            if(opts.biff == 8 && val.BIFFVer == 0 && val.dt == 16) opts.biff = 2;\r\n            if(file_depth++) break;\r\n            cell_valid = true;\r\n            out = ((options.dense ? [] : {}));\r\n\r\n            if(opts.biff < 8 && !seen_codepage) { seen_codepage = true; set_cp(opts.codepage = options.codepage || 1252); }\r\n            if(opts.biff < 5) {\r\n              if(cur_sheet === \"\") cur_sheet = \"Sheet1\";\r\n              range = {s:{r:0,c:0},e:{r:0,c:0}};\r\n              /* fake BoundSheet8 */\r\n              var fakebs8 = {pos: blob.l - length, name:cur_sheet};\r\n              Directory[fakebs8.pos] = fakebs8;\r\n              opts.snames.push(cur_sheet);\r\n            }\r\n            else cur_sheet = (Directory[s] || {name:\"\"}).name;\r\n            if(val.dt == 0x20) out[\"!type\"] = \"chart\";\r\n            if(val.dt == 0x40) out[\"!type\"] = \"macro\";\r\n            merges = [];\r\n            objects = [];\r\n            opts.arrayf = arrayf = [];\r\n            colinfo = []; rowinfo = [];\r\n            defwidth = defheight = 0;\r\n            seencol = false;\r\n            wsprops = {Hidden:(Directory[s]||{hs:0}).hs, name:cur_sheet };\r\n          } break;\r\n\r\n          case 'Number': case 'BIFF2NUM': case 'BIFF2INT': {\r\n            if(out[\"!type\"] == \"chart\") if(options.dense ? (out[val.r]||[])[val.c]: out[encode_cell({c:val.c, r:val.r})]) ++val.c;\r\n            temp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe]||{}, v:val.val, t:'n'});\r\n            if(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x1F];\r\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n            addcell({c:val.c, r:val.r}, temp_val, options);\r\n          } break;\r\n          case 'BoolErr': {\r\n            temp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.val, t:val.t});\r\n            if(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x1F];\r\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n            addcell({c:val.c, r:val.r}, temp_val, options);\r\n          } break;\r\n          case 'RK': {\r\n            temp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.rknum, t:'n'});\r\n            if(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x1F];\r\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n            addcell({c:val.c, r:val.r}, temp_val, options);\r\n          } break;\r\n          case 'MulRk': {\r\n            for(var j = val.c; j <= val.C; ++j) {\r\n              var ixfe = val.rkrec[j-val.c][0];\r\n              temp_val= ({ixfe:ixfe, XF:XFs[ixfe], v:val.rkrec[j-val.c][1], t:'n'});\r\n              if(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x1F];\r\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n              addcell({c:j, r:val.r}, temp_val, options);\r\n            }\r\n          } break;\r\n          case 'Formula': {\r\n            if(val.val == 'String') { last_formula = val; break; }\r\n            temp_val = make_cell(val.val, val.cell.ixfe, val.tt);\r\n            temp_val.XF = XFs[temp_val.ixfe];\r\n            if(options.cellFormula) {\r\n              var _f = val.formula;\r\n              if(_f && _f[0] && _f[0][0] && _f[0][0][0] == 'PtgExp') {\r\n                var _fr = _f[0][0][1][0], _fc = _f[0][0][1][1];\r\n                var _fe = encode_cell({r:_fr, c:_fc});\r\n                if(sharedf[_fe]) temp_val.f = \"\"+stringify_formula(val.formula,range,val.cell,supbooks, opts);\r\n                else temp_val.F = ((options.dense ? (out[_fr]||[])[_fc]: out[_fe]) || {}).F;\r\n              } else temp_val.f = \"\"+stringify_formula(val.formula,range,val.cell,supbooks, opts);\r\n            }\r\n            if(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x1F];\r\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n            addcell(val.cell, temp_val, options);\r\n            last_formula = val;\r\n          } break;\r\n          case 'String': {\r\n            if(last_formula) { /* technically always true */\r\n              last_formula.val = val;\r\n              temp_val = make_cell(val, last_formula.cell.ixfe, 's');\r\n              temp_val.XF = XFs[temp_val.ixfe];\r\n              if(options.cellFormula) {\r\n                temp_val.f = \"\"+stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\r\n              }\r\n              if(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x1F];\r\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n              addcell(last_formula.cell, temp_val, options);\r\n              last_formula = null;\r\n            } else throw new Error(\"String record expects Formula\");\r\n          } break;\r\n          case 'Array': {\r\n            arrayf.push(val);\r\n            var _arraystart = encode_cell(val[0].s);\r\n            cc = options.dense ? (out[val[0].s.r]||[])[val[0].s.c] : out[_arraystart];\r\n            if(options.cellFormula && cc) {\r\n              if(!last_formula) break; /* technically unreachable */\r\n              if(!_arraystart || !cc) break;\r\n              cc.f = \"\"+stringify_formula(val[1], range, val[0], supbooks, opts);\r\n              cc.F = encode_range(val[0]);\r\n            }\r\n          } break;\r\n          case 'ShrFmla': {\r\n            if(!cell_valid) break;\r\n            if(!options.cellFormula) break;\r\n            if(last_cell) {\r\n              /* TODO: capture range */\r\n              if(!last_formula) break; /* technically unreachable */\r\n              sharedf[encode_cell(last_formula.cell)]= val[0];\r\n              cc = options.dense ? (out[last_formula.cell.r]||[])[last_formula.cell.c] : out[encode_cell(last_formula.cell)];\r\n              (cc||{}).f = \"\"+stringify_formula(val[0], range, lastcell, supbooks, opts);\r\n            }\r\n          } break;\r\n          case 'LabelSst':\r\n            temp_val=make_cell(sst[val.isst].t, val.ixfe, 's');\r\n            temp_val.XF = XFs[temp_val.ixfe];\r\n            if(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x1F];\r\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n            addcell({c:val.c, r:val.r}, temp_val, options);\r\n            break;\r\n          case 'Blank': if(options.sheetStubs) {\r\n            temp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], t:'z'});\r\n            if(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x1F];\r\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n            addcell({c:val.c, r:val.r}, temp_val, options);\r\n          } break;\r\n          case 'MulBlank': if(options.sheetStubs) {\r\n            for(var _j = val.c; _j <= val.C; ++_j) {\r\n              var _ixfe = val.ixfe[_j-val.c];\r\n              temp_val= ({ixfe:_ixfe, XF:XFs[_ixfe], t:'z'});\r\n              if(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x1F];\r\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n              addcell({c:_j, r:val.r}, temp_val, options);\r\n            }\r\n          } break;\r\n          case 'RString':\r\n          case 'Label': case 'BIFF2STR':\r\n            temp_val=make_cell(val.val, val.ixfe, 's');\r\n            temp_val.XF = XFs[temp_val.ixfe];\r\n            if(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x1F];\r\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n            addcell({c:val.c, r:val.r}, temp_val, options);\r\n            break;\r\n\r\n          case 'Dimensions': {\r\n            if(file_depth === 1) range = val; /* TODO: stack */\r\n          } break;\r\n          case 'SST': {\r\n            sst = val;\r\n          } break;\r\n          case 'Format': { /* val = [id, fmt] */\r\n            if(opts.biff == 4) {\r\n              BIFF2FmtTable[BIFF2Fmt++] = val[1];\r\n              for(var b4idx = 0; b4idx < BIFF2Fmt + 163; ++b4idx) if(SSF._table[b4idx] == val[1]) break;\r\n              if(b4idx >= 163) SSF.load(val[1], BIFF2Fmt + 163);\r\n            }\r\n            else SSF.load(val[1], val[0]);\r\n          } break;\r\n          case 'BIFF2FORMAT': {\r\n            BIFF2FmtTable[BIFF2Fmt++] = val;\r\n            for(var b2idx = 0; b2idx < BIFF2Fmt + 163; ++b2idx) if(SSF._table[b2idx] == val) break;\r\n            if(b2idx >= 163) SSF.load(val, BIFF2Fmt + 163);\r\n          } break;\r\n\r\n          case 'MergeCells': merges = merges.concat(val); break;\r\n\r\n          case 'Obj': objects[val.cmo[0]] = opts.lastobj = val; break;\r\n          case 'TxO': opts.lastobj.TxO = val; break;\r\n          case 'ImData': opts.lastobj.ImData = val; break;\r\n\r\n          case 'HLink': {\r\n            for(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\r\n              for(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\r\n                cc = options.dense ? (out[rngR]||[])[rngC] : out[encode_cell({c:rngC,r:rngR})];\r\n                if(cc) cc.l = val[1];\r\n              }\r\n          } break;\r\n          case 'HLinkTooltip': {\r\n            for(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\r\n              for(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\r\n                cc = options.dense ? (out[rngR]||[])[rngC] : out[encode_cell({c:rngC,r:rngR})];\r\n                if(cc && cc.l) cc.l.Tooltip = val[1];\r\n              }\r\n          } break;\r\n\r\n          /* Comments */\r\n          case 'Note': {\r\n            if(opts.biff <= 5 && opts.biff >= 2) break; /* TODO: BIFF5 */\r\n            cc = options.dense ? (out[val[0].r]||[])[val[0].c] : out[encode_cell(val[0])];\r\n            var noteobj = objects[val[2]];\r\n            if(!cc) break;\r\n            if(!cc.c) cc.c = [];\r\n            cmnt = {a:val[1],t:noteobj.TxO.t};\r\n            cc.c.push(cmnt);\r\n          } break;\r\n\r\n          default: switch(R.n) { /* nested */\r\n            case 'ClrtClient': break;\r\n            case 'XFExt': update_xfext(XFs[val.ixfe], val.ext); break;\r\n\r\n            case 'DefColWidth': defwidth = val; break;\r\n            case 'DefaultRowHeight': defheight = val[1]; break; // TODO: flags\r\n\r\n            case 'ColInfo': {\r\n              if(!opts.cellStyles) break;\r\n              while(val.e >= val.s) {\r\n                colinfo[val.e--] = { width: val.w/256 };\r\n                if(!seencol) { seencol = true; find_mdw_colw(val.w/256); }\r\n                process_col(colinfo[val.e+1]);\r\n              }\r\n            } break;\r\n            case 'Row': {\r\n              var rowobj = {};\r\n              if(val.level != null) { rowinfo[val.r] = rowobj; rowobj.level = val.level; }\r\n              if(val.hidden) { rowinfo[val.r] = rowobj; rowobj.hidden = true; }\r\n              if(val.hpt) {\r\n                rowinfo[val.r] = rowobj;\r\n                rowobj.hpt = val.hpt; rowobj.hpx = pt2px(val.hpt);\r\n              }\r\n            } break;\r\n\r\n            case 'LeftMargin':\r\n            case 'RightMargin':\r\n            case 'TopMargin':\r\n            case 'BottomMargin':\r\n              if(!out['!margins']) default_margins(out['!margins'] = {});\r\n              out['!margins'][Rn.slice(0,-6).toLowerCase()] = val;\r\n              break;\r\n\r\n            case 'Setup': // TODO\r\n              if(!out['!margins']) default_margins(out['!margins'] = {});\r\n              out['!margins'].header = val.header;\r\n              out['!margins'].footer = val.footer;\r\n              break;\r\n\r\n            case 'Window2': // TODO\r\n              // $FlowIgnore\r\n              if(val.RTL) Workbook.Views[0].RTL = true;\r\n              break;\r\n\r\n            case 'Header': break; // TODO\r\n            case 'Footer': break; // TODO\r\n            case 'HCenter': break; // TODO\r\n            case 'VCenter': break; // TODO\r\n            case 'Pls': break; // TODO\r\n            case 'GCW': break;\r\n            case 'LHRecord': break;\r\n            case 'DBCell': break; // TODO\r\n            case 'EntExU2': break; // TODO\r\n            case 'SxView': break; // TODO\r\n            case 'Sxvd': break; // TODO\r\n            case 'SXVI': break; // TODO\r\n            case 'SXVDEx': break; // TODO\r\n            case 'SxIvd': break; // TODO\r\n            case 'SXString': break; // TODO\r\n            case 'Sync': break;\r\n            case 'Addin': break;\r\n            case 'SXDI': break; // TODO\r\n            case 'SXLI': break; // TODO\r\n            case 'SXEx': break; // TODO\r\n            case 'QsiSXTag': break; // TODO\r\n            case 'Selection': break;\r\n            case 'Feat': break;\r\n            case 'FeatHdr': case 'FeatHdr11': break;\r\n            case 'Feature11': case 'Feature12': case 'List12': break;\r\n            case 'Country': country = val; break;\r\n            case 'RecalcId': break;\r\n            case 'DxGCol': break; // TODO: htmlify\r\n            case 'Fbi': case 'Fbi2': case 'GelFrame': break;\r\n            case 'Font': break; // TODO\r\n            case 'XFCRC': break; // TODO\r\n            case 'Style': break; // TODO\r\n            case 'StyleExt': break; // TODO\r\n            case 'Palette': palette = val; break;\r\n            case 'Theme': themes = val; break;\r\n            /* Protection */\r\n            case 'ScenarioProtect': break;\r\n            case 'ObjProtect': break;\r\n\r\n            /* Conditional Formatting */\r\n            case 'CondFmt12': break;\r\n\r\n            /* Table */\r\n            case 'Table': break; // TODO\r\n            case 'TableStyles': break; // TODO\r\n            case 'TableStyle': break; // TODO\r\n            case 'TableStyleElement': break; // TODO\r\n\r\n            /* PivotTable */\r\n            case 'SXStreamID': break; // TODO\r\n            case 'SXVS': break; // TODO\r\n            case 'DConRef': break; // TODO\r\n            case 'SXAddl': break; // TODO\r\n            case 'DConBin': break; // TODO\r\n            case 'DConName': break; // TODO\r\n            case 'SXPI': break; // TODO\r\n            case 'SxFormat': break; // TODO\r\n            case 'SxSelect': break; // TODO\r\n            case 'SxRule': break; // TODO\r\n            case 'SxFilt': break; // TODO\r\n            case 'SxItm': break; // TODO\r\n            case 'SxDXF': break; // TODO\r\n\r\n            /* Scenario Manager */\r\n            case 'ScenMan': break;\r\n\r\n            /* Data Consolidation */\r\n            case 'DCon': break;\r\n\r\n            /* Watched Cell */\r\n            case 'CellWatch': break;\r\n\r\n            /* Print Settings */\r\n            case 'PrintRowCol': break;\r\n            case 'PrintGrid': break;\r\n            case 'PrintSize': break;\r\n\r\n            case 'XCT': break;\r\n            case 'CRN': break;\r\n\r\n            case 'Scl': {\r\n              //console.log(\"Zoom Level:\", val[0]/val[1],val);\r\n            } break;\r\n            case 'SheetExt': {\r\n              /* empty */\r\n            } break;\r\n            case 'SheetExtOptional': {\r\n              /* empty */\r\n            } break;\r\n\r\n            /* VBA */\r\n            case 'ObNoMacros': {\r\n              /* empty */\r\n            } break;\r\n            case 'ObProj': {\r\n              /* empty */\r\n            } break;\r\n            case 'CodeName': {\r\n              if(!cur_sheet) Workbook.WBProps.CodeName = val || \"ThisWorkbook\";\r\n              else wsprops.CodeName = val || wsprops.name;\r\n            } break;\r\n            case 'GUIDTypeLib': {\r\n              /* empty */\r\n            } break;\r\n\r\n            case 'WOpt': break; // TODO: WTF?\r\n            case 'PhoneticInfo': break;\r\n\r\n            case 'OleObjectSize': break;\r\n\r\n            /* Differential Formatting */\r\n            case 'DXF': case 'DXFN': case 'DXFN12': case 'DXFN12List': case 'DXFN12NoCB': break;\r\n\r\n            /* Data Validation */\r\n            case 'Dv': case 'DVal': break;\r\n\r\n            /* Data Series */\r\n            case 'BRAI': case 'Series': case 'SeriesText': break;\r\n\r\n            /* Data Connection */\r\n            case 'DConn': break;\r\n            case 'DbOrParamQry': break;\r\n            case 'DBQueryExt': break;\r\n\r\n            case 'OleDbConn': break;\r\n            case 'ExtString': break;\r\n\r\n            /* Formatting */\r\n            case 'IFmtRecord': break;\r\n            case 'CondFmt': case 'CF': case 'CF12': case 'CFEx': break;\r\n\r\n            /* Explicitly Ignored */\r\n            case 'Excel9File': break;\r\n            case 'Units': break;\r\n            case 'InterfaceHdr': case 'Mms': case 'InterfaceEnd': case 'DSF': break;\r\n            case 'BuiltInFnGroupCount': /* 2.4.30 0x0E or 0x10 but excel 2011 generates 0x11? */ break;\r\n            /* View Stuff */\r\n            case 'Window1': case 'HideObj': case 'GridSet': case 'Guts':\r\n            case 'UserBView': case 'UserSViewBegin': case 'UserSViewEnd':\r\n            case 'Pane': break;\r\n            default: switch(R.n) { /* nested */\r\n              /* Chart */\r\n              case 'Dat':\r\n              case 'Begin': case 'End':\r\n              case 'StartBlock': case 'EndBlock':\r\n              case 'Frame': case 'Area':\r\n              case 'Axis': case 'AxisLine': case 'Tick': break;\r\n              case 'AxesUsed':\r\n              case 'CrtLayout12': case 'CrtLayout12A': case 'CrtLink': case 'CrtLine': case 'CrtMlFrt': case 'CrtMlFrtContinue': break;\r\n              case 'LineFormat': case 'AreaFormat':\r\n              case 'Chart': case 'Chart3d': case 'Chart3DBarShape': case 'ChartFormat': case 'ChartFrtInfo': break;\r\n              case 'PlotArea': case 'PlotGrowth': break;\r\n              case 'SeriesList': case 'SerParent': case 'SerAuxTrend': break;\r\n              case 'DataFormat': case 'SerToCrt': case 'FontX': break;\r\n              case 'CatSerRange': case 'AxcExt': case 'SerFmt': break;\r\n              case 'ShtProps': break;\r\n              case 'DefaultText': case 'Text': case 'CatLab': break;\r\n              case 'DataLabExtContents': break;\r\n              case 'Legend': case 'LegendException': break;\r\n              case 'Pie': case 'Scatter': break;\r\n              case 'PieFormat': case 'MarkerFormat': break;\r\n              case 'StartObject': case 'EndObject': break;\r\n              case 'AlRuns': case 'ObjectLink': break;\r\n              case 'SIIndex': break;\r\n              case 'AttachedLabel': case 'YMult': break;\r\n\r\n              /* Chart Group */\r\n              case 'Line': case 'Bar': break;\r\n              case 'Surf': break;\r\n\r\n              /* Axis Group */\r\n              case 'AxisParent': break;\r\n              case 'Pos': break;\r\n              case 'ValueRange': break;\r\n\r\n              /* Pivot Chart */\r\n              case 'SXViewEx9': break; // TODO\r\n              case 'SXViewLink': break;\r\n              case 'PivotChartBits': break;\r\n              case 'SBaseRef': break;\r\n              case 'TextPropsStream': break;\r\n\r\n              /* Chart Misc */\r\n              case 'LnExt': break;\r\n              case 'MkrExt': break;\r\n              case 'CrtCoopt': break;\r\n\r\n              /* Query Table */\r\n              case 'Qsi': case 'Qsif': case 'Qsir': case 'QsiSXTag': break;\r\n              case 'TxtQry': break;\r\n\r\n              /* Filter */\r\n              case 'FilterMode': break;\r\n              case 'AutoFilter': case 'AutoFilterInfo': break;\r\n              case 'AutoFilter12': break;\r\n              case 'DropDownObjIds': break;\r\n              case 'Sort': break;\r\n              case 'SortData': break;\r\n\r\n              /* Drawing */\r\n              case 'ShapePropsStream': break;\r\n              case 'MsoDrawing': case 'MsoDrawingGroup': case 'MsoDrawingSelection': break;\r\n              /* Pub Stuff */\r\n              case 'WebPub': case 'AutoWebPub': break;\r\n\r\n              /* Print Stuff */\r\n              case 'HeaderFooter': case 'HFPicture': case 'PLV':\r\n              case 'HorizontalPageBreaks': case 'VerticalPageBreaks': break;\r\n              /* Behavioral */\r\n              case 'Backup': case 'CompressPictures': case 'Compat12': break;\r\n\r\n              /* Should not Happen */\r\n              case 'Continue': case 'ContinueFrt12': break;\r\n\r\n              /* Future Records */\r\n              case 'FrtFontList': case 'FrtWrapper': break;\r\n\r\n              default: switch(R.n) { /* nested */\r\n                /* BIFF5 records */\r\n                case 'TabIdConf': case 'Radar': case 'RadarArea': case 'DropBar': case 'Intl': case 'CoordList': case 'SerAuxErrBar': break;\r\n\r\n                /* BIFF2-4 records */\r\n                case 'BIFF2FONTCLR': case 'BIFF2FMTCNT': case 'BIFF2FONTXTRA': break;\r\n                case 'BIFF2XF': case 'BIFF3XF': case 'BIFF4XF': break;\r\n                case 'BIFF4FMTCNT': case 'BIFF2ROW': case 'BIFF2WINDOW2': break;\r\n\r\n                /* Miscellaneous */\r\n                case 'SCENARIO': case 'DConBin': case 'PicF': case 'DataLabExt':\r\n                case 'Lel': case 'BopPop': case 'BopPopCustom': case 'RealTimeData':\r\n                case 'Name': break;\r\n                case 'LHNGraph': case 'FnGroupName': case 'AddMenu': case 'LPr': break;\r\n                case 'ListObj': case 'ListField': break;\r\n                case 'RRSort': break;\r\n                case 'BigName': break;\r\n                case 'ToolbarHdr': case 'ToolbarEnd': break;\r\n                case 'DDEObjName': break;\r\n                case 'FRTArchId$': break;\r\n                default: if(options.WTF) throw 'Unrecognized Record ' + R.n;\r\n              }}}}\r\n      } else blob.l += length;\r\n    }\r\n    wb.SheetNames=keys(Directory).sort(function(a,b) { return Number(a) - Number(b); }).map(function(x){return Directory[x].name;});\r\n    if(!options.bookSheets) wb.Sheets=Sheets;\r\n    if(wb.Sheets) FilterDatabases.forEach(function(r,i) { wb.Sheets[wb.SheetNames[i]]['!autofilter'] = r; });\r\n    wb.Preamble=Preamble;\r\n    wb.Strings = sst;\r\n    wb.SSF = SSF.get_table();\r\n    if(opts.enc) wb.Encryption = opts.enc;\r\n    if(themes) wb.Themes = themes;\r\n    wb.Metadata = {};\r\n    if(country !== undefined) wb.Metadata.Country = country;\r\n    if(supbooks.names.length > 0) Workbook.Names = supbooks.names;\r\n    wb.Workbook = Workbook;\r\n    return wb;\r\n  }\r\n\r\n  /* TODO: split props*/\r\n  var PSCLSID = {\r\n    SI: \"e0859ff2f94f6810ab9108002b27b3d9\",\r\n    DSI: \"02d5cdd59c2e1b10939708002b2cf9ae\",\r\n    UDI: \"05d5cdd59c2e1b10939708002b2cf9ae\"\r\n  };\r\n  function parse_xls_props(cfb, props, o) {\r\n    /* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\r\n    var DSI = CFB.find(cfb, '!DocumentSummaryInformation');\r\n    if(DSI && DSI.size > 0) try {\r\n      var DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI, PSCLSID.DSI);\r\n      for(var d in DocSummary) props[d] = DocSummary[d];\r\n    } catch(e) {if(o.WTF) throw e;/* empty */}\r\n\r\n    /* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\r\n    var SI = CFB.find(cfb, '!SummaryInformation');\r\n    if(SI && SI.size > 0) try {\r\n      var Summary = parse_PropertySetStream(SI, SummaryPIDSI, PSCLSID.SI);\r\n      for(var s in Summary) if(props[s] == null) props[s] = Summary[s];\r\n    } catch(e) {if(o.WTF) throw e;/* empty */}\r\n\r\n    if(props.HeadingPairs && props.TitlesOfParts) {\r\n      load_props_pairs(props.HeadingPairs, props.TitlesOfParts, props, o);\r\n      delete props.HeadingPairs; delete props.TitlesOfParts;\r\n    }\r\n  }\r\n  function write_xls_props(wb, cfb) {\r\n    var DSEntries = [], SEntries = [], CEntries = [];\r\n    var i = 0, Keys;\r\n    if(wb.Props) {\r\n      Keys = keys(wb.Props);\r\n      // $FlowIgnore\r\n      for(i = 0; i < Keys.length; ++i) (DocSummaryRE.hasOwnProperty(Keys[i]) ? DSEntries : SummaryRE.hasOwnProperty(Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Props[Keys[i]]]);\r\n    }\r\n    if(wb.Custprops) {\r\n      Keys = keys(wb.Custprops);\r\n      // $FlowIgnore\r\n      for(i = 0; i < Keys.length; ++i) if(!(wb.Props||{}).hasOwnProperty(Keys[i])) (DocSummaryRE.hasOwnProperty(Keys[i]) ? DSEntries : SummaryRE.hasOwnProperty(Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Custprops[Keys[i]]]);\r\n    }\r\n    var CEntries2 = [];\r\n    for(i = 0; i < CEntries.length; ++i) {\r\n      if(XLSPSSkip.indexOf(CEntries[i][0]) > -1) continue;\r\n      if(CEntries[i][1] == null) continue;\r\n      CEntries2.push(CEntries[i]);\r\n    }\r\n    if(SEntries.length) CFB.utils.cfb_add(cfb, \"/\\u0005SummaryInformation\", write_PropertySetStream(SEntries, PSCLSID.SI, SummaryRE, SummaryPIDSI));\r\n    if(DSEntries.length || CEntries2.length) CFB.utils.cfb_add(cfb, \"/\\u0005DocumentSummaryInformation\", write_PropertySetStream(DSEntries, PSCLSID.DSI, DocSummaryRE, DocSummaryPIDDSI, CEntries2.length ? CEntries2 : null, PSCLSID.UDI));\r\n  }\r\n\r\n  function parse_xlscfb(cfb, options) {\r\n    if(!options) options = {};\r\n    fix_read_opts(options);\r\n    reset_cp();\r\n    if(options.codepage) set_ansi(options.codepage);\r\n    var CompObj, WB;\r\n    if(cfb.FullPaths) {\r\n      if(CFB.find(cfb, '/encryption')) throw new Error(\"File is password-protected\");\r\n      CompObj = CFB.find(cfb, '!CompObj');\r\n      WB = CFB.find(cfb, '/Workbook') || CFB.find(cfb, '/Book');\r\n    } else {\r\n      switch(options.type) {\r\n        case 'base64': cfb = s2a(Base64.decode(cfb)); break;\r\n        case 'binary': cfb = s2a(cfb); break;\r\n        case 'buffer': break;\r\n        case 'array': if(!Array.isArray(cfb)) cfb = Array.prototype.slice.call(cfb); break;\r\n      }\r\n      prep_blob(cfb, 0);\r\n      WB = ({content: cfb});\r\n    }\r\n    var WorkbookP;\r\n\r\n    var _data;\r\n    if(CompObj) parse_compobj(CompObj);\r\n    if(options.bookProps && !options.bookSheets) WorkbookP = ({});\r\n    else {\r\n      var T = has_buf ? 'buffer' : 'array';\r\n      if(WB && WB.content) WorkbookP = parse_workbook(WB.content, options);\r\n      /* Quattro Pro 7-8 */\r\n      else if((_data=CFB.find(cfb, 'PerfectOffice_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\r\n      /* Quattro Pro 9 */\r\n      else if((_data=CFB.find(cfb, 'NativeContent_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\r\n      else throw new Error(\"Cannot find Workbook stream\");\r\n      if(options.bookVBA && cfb.FullPaths && CFB.find(cfb, '/_VBA_PROJECT_CUR/VBA/dir')) WorkbookP.vbaraw = make_vba_xls(cfb);\r\n    }\r\n\r\n    var props = {};\r\n    if(cfb.FullPaths) parse_xls_props(cfb, props, options);\r\n\r\n    WorkbookP.Props = WorkbookP.Custprops = props; /* TODO: split up properties */\r\n    if(options.bookFiles) WorkbookP.cfb = cfb;\r\n    /*WorkbookP.CompObjP = CompObjP; // TODO: storage? */\r\n    return WorkbookP;\r\n  }\r\n\r\n\r\n  function write_xlscfb(wb, opts) {\r\n    var o = opts || {};\r\n    var cfb = CFB.utils.cfb_new({root:\"R\"});\r\n    var wbpath = \"/Workbook\";\r\n    switch(o.bookType || \"xls\") {\r\n      case \"xls\": o.bookType = \"biff8\";\r\n      /* falls through */\r\n      case \"xla\": if(!o.bookType) o.bookType = \"xla\";\r\n      /* falls through */\r\n      case \"biff8\": wbpath = \"/Workbook\"; o.biff = 8; break;\r\n      case \"biff5\": wbpath = \"/Book\"; o.biff = 5; break;\r\n      default: throw new Error(\"invalid type \" + o.bookType + \" for XLS CFB\");\r\n    }\r\n    CFB.utils.cfb_add(cfb, wbpath, write_biff_buf(wb, o));\r\n    if(o.biff == 8 && (wb.Props || wb.Custprops)) write_xls_props(wb, cfb);\r\n    // TODO: SI, DSI, CO\r\n    if(o.biff == 8 && wb.vbaraw) fill_vba_xls(cfb, CFB.read(wb.vbaraw, {type: typeof wb.vbaraw == \"string\" ? \"binary\" : \"buffer\"}));\r\n    return cfb;\r\n  }\r\n  /* [MS-XLSB] 2.3 Record Enumeration */\r\n  var XLSBRecordEnum = {\r\n    0x0000: { n:\"BrtRowHdr\", f:parse_BrtRowHdr },\r\n    0x0001: { n:\"BrtCellBlank\", f:parse_BrtCellBlank },\r\n    0x0002: { n:\"BrtCellRk\", f:parse_BrtCellRk },\r\n    0x0003: { n:\"BrtCellError\", f:parse_BrtCellError },\r\n    0x0004: { n:\"BrtCellBool\", f:parse_BrtCellBool },\r\n    0x0005: { n:\"BrtCellReal\", f:parse_BrtCellReal },\r\n    0x0006: { n:\"BrtCellSt\", f:parse_BrtCellSt },\r\n    0x0007: { n:\"BrtCellIsst\", f:parse_BrtCellIsst },\r\n    0x0008: { n:\"BrtFmlaString\", f:parse_BrtFmlaString },\r\n    0x0009: { n:\"BrtFmlaNum\", f:parse_BrtFmlaNum },\r\n    0x000A: { n:\"BrtFmlaBool\", f:parse_BrtFmlaBool },\r\n    0x000B: { n:\"BrtFmlaError\", f:parse_BrtFmlaError },\r\n    0x0010: { n:\"BrtFRTArchID$\", f:parse_BrtFRTArchID$ },\r\n    0x0013: { n:\"BrtSSTItem\", f:parse_RichStr },\r\n    0x0014: { n:\"BrtPCDIMissing\" },\r\n    0x0015: { n:\"BrtPCDINumber\" },\r\n    0x0016: { n:\"BrtPCDIBoolean\" },\r\n    0x0017: { n:\"BrtPCDIError\" },\r\n    0x0018: { n:\"BrtPCDIString\" },\r\n    0x0019: { n:\"BrtPCDIDatetime\" },\r\n    0x001A: { n:\"BrtPCDIIndex\" },\r\n    0x001B: { n:\"BrtPCDIAMissing\" },\r\n    0x001C: { n:\"BrtPCDIANumber\" },\r\n    0x001D: { n:\"BrtPCDIABoolean\" },\r\n    0x001E: { n:\"BrtPCDIAError\" },\r\n    0x001F: { n:\"BrtPCDIAString\" },\r\n    0x0020: { n:\"BrtPCDIADatetime\" },\r\n    0x0021: { n:\"BrtPCRRecord\" },\r\n    0x0022: { n:\"BrtPCRRecordDt\" },\r\n    0x0023: { n:\"BrtFRTBegin\" },\r\n    0x0024: { n:\"BrtFRTEnd\" },\r\n    0x0025: { n:\"BrtACBegin\" },\r\n    0x0026: { n:\"BrtACEnd\" },\r\n    0x0027: { n:\"BrtName\", f:parse_BrtName },\r\n    0x0028: { n:\"BrtIndexRowBlock\" },\r\n    0x002A: { n:\"BrtIndexBlock\" },\r\n    0x002B: { n:\"BrtFont\", f:parse_BrtFont },\r\n    0x002C: { n:\"BrtFmt\", f:parse_BrtFmt },\r\n    0x002D: { n:\"BrtFill\", f:parse_BrtFill },\r\n    0x002E: { n:\"BrtBorder\", f:parse_BrtBorder },\r\n    0x002F: { n:\"BrtXF\", f:parse_BrtXF },\r\n    0x0030: { n:\"BrtStyle\" },\r\n    0x0031: { n:\"BrtCellMeta\" },\r\n    0x0032: { n:\"BrtValueMeta\" },\r\n    0x0033: { n:\"BrtMdb\" },\r\n    0x0034: { n:\"BrtBeginFmd\" },\r\n    0x0035: { n:\"BrtEndFmd\" },\r\n    0x0036: { n:\"BrtBeginMdx\" },\r\n    0x0037: { n:\"BrtEndMdx\" },\r\n    0x0038: { n:\"BrtBeginMdxTuple\" },\r\n    0x0039: { n:\"BrtEndMdxTuple\" },\r\n    0x003A: { n:\"BrtMdxMbrIstr\" },\r\n    0x003B: { n:\"BrtStr\" },\r\n    0x003C: { n:\"BrtColInfo\", f:parse_ColInfo },\r\n    0x003E: { n:\"BrtCellRString\" },\r\n    0x003F: { n:\"BrtCalcChainItem$\", f:parse_BrtCalcChainItem$ },\r\n    0x0040: { n:\"BrtDVal\" },\r\n    0x0041: { n:\"BrtSxvcellNum\" },\r\n    0x0042: { n:\"BrtSxvcellStr\" },\r\n    0x0043: { n:\"BrtSxvcellBool\" },\r\n    0x0044: { n:\"BrtSxvcellErr\" },\r\n    0x0045: { n:\"BrtSxvcellDate\" },\r\n    0x0046: { n:\"BrtSxvcellNil\" },\r\n    0x0080: { n:\"BrtFileVersion\" },\r\n    0x0081: { n:\"BrtBeginSheet\" },\r\n    0x0082: { n:\"BrtEndSheet\" },\r\n    0x0083: { n:\"BrtBeginBook\", f:parsenoop, p:0 },\r\n    0x0084: { n:\"BrtEndBook\" },\r\n    0x0085: { n:\"BrtBeginWsViews\" },\r\n    0x0086: { n:\"BrtEndWsViews\" },\r\n    0x0087: { n:\"BrtBeginBookViews\" },\r\n    0x0088: { n:\"BrtEndBookViews\" },\r\n    0x0089: { n:\"BrtBeginWsView\", f:parse_BrtBeginWsView },\r\n    0x008A: { n:\"BrtEndWsView\" },\r\n    0x008B: { n:\"BrtBeginCsViews\" },\r\n    0x008C: { n:\"BrtEndCsViews\" },\r\n    0x008D: { n:\"BrtBeginCsView\" },\r\n    0x008E: { n:\"BrtEndCsView\" },\r\n    0x008F: { n:\"BrtBeginBundleShs\" },\r\n    0x0090: { n:\"BrtEndBundleShs\" },\r\n    0x0091: { n:\"BrtBeginSheetData\" },\r\n    0x0092: { n:\"BrtEndSheetData\" },\r\n    0x0093: { n:\"BrtWsProp\", f:parse_BrtWsProp },\r\n    0x0094: { n:\"BrtWsDim\", f:parse_BrtWsDim, p:16 },\r\n    0x0097: { n:\"BrtPane\" },\r\n    0x0098: { n:\"BrtSel\" },\r\n    0x0099: { n:\"BrtWbProp\", f:parse_BrtWbProp },\r\n    0x009A: { n:\"BrtWbFactoid\" },\r\n    0x009B: { n:\"BrtFileRecover\" },\r\n    0x009C: { n:\"BrtBundleSh\", f:parse_BrtBundleSh },\r\n    0x009D: { n:\"BrtCalcProp\" },\r\n    0x009E: { n:\"BrtBookView\" },\r\n    0x009F: { n:\"BrtBeginSst\", f:parse_BrtBeginSst },\r\n    0x00A0: { n:\"BrtEndSst\" },\r\n    0x00A1: { n:\"BrtBeginAFilter\", f:parse_UncheckedRfX },\r\n    0x00A2: { n:\"BrtEndAFilter\" },\r\n    0x00A3: { n:\"BrtBeginFilterColumn\" },\r\n    0x00A4: { n:\"BrtEndFilterColumn\" },\r\n    0x00A5: { n:\"BrtBeginFilters\" },\r\n    0x00A6: { n:\"BrtEndFilters\" },\r\n    0x00A7: { n:\"BrtFilter\" },\r\n    0x00A8: { n:\"BrtColorFilter\" },\r\n    0x00A9: { n:\"BrtIconFilter\" },\r\n    0x00AA: { n:\"BrtTop10Filter\" },\r\n    0x00AB: { n:\"BrtDynamicFilter\" },\r\n    0x00AC: { n:\"BrtBeginCustomFilters\" },\r\n    0x00AD: { n:\"BrtEndCustomFilters\" },\r\n    0x00AE: { n:\"BrtCustomFilter\" },\r\n    0x00AF: { n:\"BrtAFilterDateGroupItem\" },\r\n    0x00B0: { n:\"BrtMergeCell\", f:parse_BrtMergeCell },\r\n    0x00B1: { n:\"BrtBeginMergeCells\" },\r\n    0x00B2: { n:\"BrtEndMergeCells\" },\r\n    0x00B3: { n:\"BrtBeginPivotCacheDef\" },\r\n    0x00B4: { n:\"BrtEndPivotCacheDef\" },\r\n    0x00B5: { n:\"BrtBeginPCDFields\" },\r\n    0x00B6: { n:\"BrtEndPCDFields\" },\r\n    0x00B7: { n:\"BrtBeginPCDField\" },\r\n    0x00B8: { n:\"BrtEndPCDField\" },\r\n    0x00B9: { n:\"BrtBeginPCDSource\" },\r\n    0x00BA: { n:\"BrtEndPCDSource\" },\r\n    0x00BB: { n:\"BrtBeginPCDSRange\" },\r\n    0x00BC: { n:\"BrtEndPCDSRange\" },\r\n    0x00BD: { n:\"BrtBeginPCDFAtbl\" },\r\n    0x00BE: { n:\"BrtEndPCDFAtbl\" },\r\n    0x00BF: { n:\"BrtBeginPCDIRun\" },\r\n    0x00C0: { n:\"BrtEndPCDIRun\" },\r\n    0x00C1: { n:\"BrtBeginPivotCacheRecords\" },\r\n    0x00C2: { n:\"BrtEndPivotCacheRecords\" },\r\n    0x00C3: { n:\"BrtBeginPCDHierarchies\" },\r\n    0x00C4: { n:\"BrtEndPCDHierarchies\" },\r\n    0x00C5: { n:\"BrtBeginPCDHierarchy\" },\r\n    0x00C6: { n:\"BrtEndPCDHierarchy\" },\r\n    0x00C7: { n:\"BrtBeginPCDHFieldsUsage\" },\r\n    0x00C8: { n:\"BrtEndPCDHFieldsUsage\" },\r\n    0x00C9: { n:\"BrtBeginExtConnection\" },\r\n    0x00CA: { n:\"BrtEndExtConnection\" },\r\n    0x00CB: { n:\"BrtBeginECDbProps\" },\r\n    0x00CC: { n:\"BrtEndECDbProps\" },\r\n    0x00CD: { n:\"BrtBeginECOlapProps\" },\r\n    0x00CE: { n:\"BrtEndECOlapProps\" },\r\n    0x00CF: { n:\"BrtBeginPCDSConsol\" },\r\n    0x00D0: { n:\"BrtEndPCDSConsol\" },\r\n    0x00D1: { n:\"BrtBeginPCDSCPages\" },\r\n    0x00D2: { n:\"BrtEndPCDSCPages\" },\r\n    0x00D3: { n:\"BrtBeginPCDSCPage\" },\r\n    0x00D4: { n:\"BrtEndPCDSCPage\" },\r\n    0x00D5: { n:\"BrtBeginPCDSCPItem\" },\r\n    0x00D6: { n:\"BrtEndPCDSCPItem\" },\r\n    0x00D7: { n:\"BrtBeginPCDSCSets\" },\r\n    0x00D8: { n:\"BrtEndPCDSCSets\" },\r\n    0x00D9: { n:\"BrtBeginPCDSCSet\" },\r\n    0x00DA: { n:\"BrtEndPCDSCSet\" },\r\n    0x00DB: { n:\"BrtBeginPCDFGroup\" },\r\n    0x00DC: { n:\"BrtEndPCDFGroup\" },\r\n    0x00DD: { n:\"BrtBeginPCDFGItems\" },\r\n    0x00DE: { n:\"BrtEndPCDFGItems\" },\r\n    0x00DF: { n:\"BrtBeginPCDFGRange\" },\r\n    0x00E0: { n:\"BrtEndPCDFGRange\" },\r\n    0x00E1: { n:\"BrtBeginPCDFGDiscrete\" },\r\n    0x00E2: { n:\"BrtEndPCDFGDiscrete\" },\r\n    0x00E3: { n:\"BrtBeginPCDSDTupleCache\" },\r\n    0x00E4: { n:\"BrtEndPCDSDTupleCache\" },\r\n    0x00E5: { n:\"BrtBeginPCDSDTCEntries\" },\r\n    0x00E6: { n:\"BrtEndPCDSDTCEntries\" },\r\n    0x00E7: { n:\"BrtBeginPCDSDTCEMembers\" },\r\n    0x00E8: { n:\"BrtEndPCDSDTCEMembers\" },\r\n    0x00E9: { n:\"BrtBeginPCDSDTCEMember\" },\r\n    0x00EA: { n:\"BrtEndPCDSDTCEMember\" },\r\n    0x00EB: { n:\"BrtBeginPCDSDTCQueries\" },\r\n    0x00EC: { n:\"BrtEndPCDSDTCQueries\" },\r\n    0x00ED: { n:\"BrtBeginPCDSDTCQuery\" },\r\n    0x00EE: { n:\"BrtEndPCDSDTCQuery\" },\r\n    0x00EF: { n:\"BrtBeginPCDSDTCSets\" },\r\n    0x00F0: { n:\"BrtEndPCDSDTCSets\" },\r\n    0x00F1: { n:\"BrtBeginPCDSDTCSet\" },\r\n    0x00F2: { n:\"BrtEndPCDSDTCSet\" },\r\n    0x00F3: { n:\"BrtBeginPCDCalcItems\" },\r\n    0x00F4: { n:\"BrtEndPCDCalcItems\" },\r\n    0x00F5: { n:\"BrtBeginPCDCalcItem\" },\r\n    0x00F6: { n:\"BrtEndPCDCalcItem\" },\r\n    0x00F7: { n:\"BrtBeginPRule\" },\r\n    0x00F8: { n:\"BrtEndPRule\" },\r\n    0x00F9: { n:\"BrtBeginPRFilters\" },\r\n    0x00FA: { n:\"BrtEndPRFilters\" },\r\n    0x00FB: { n:\"BrtBeginPRFilter\" },\r\n    0x00FC: { n:\"BrtEndPRFilter\" },\r\n    0x00FD: { n:\"BrtBeginPNames\" },\r\n    0x00FE: { n:\"BrtEndPNames\" },\r\n    0x00FF: { n:\"BrtBeginPName\" },\r\n    0x0100: { n:\"BrtEndPName\" },\r\n    0x0101: { n:\"BrtBeginPNPairs\" },\r\n    0x0102: { n:\"BrtEndPNPairs\" },\r\n    0x0103: { n:\"BrtBeginPNPair\" },\r\n    0x0104: { n:\"BrtEndPNPair\" },\r\n    0x0105: { n:\"BrtBeginECWebProps\" },\r\n    0x0106: { n:\"BrtEndECWebProps\" },\r\n    0x0107: { n:\"BrtBeginEcWpTables\" },\r\n    0x0108: { n:\"BrtEndECWPTables\" },\r\n    0x0109: { n:\"BrtBeginECParams\" },\r\n    0x010A: { n:\"BrtEndECParams\" },\r\n    0x010B: { n:\"BrtBeginECParam\" },\r\n    0x010C: { n:\"BrtEndECParam\" },\r\n    0x010D: { n:\"BrtBeginPCDKPIs\" },\r\n    0x010E: { n:\"BrtEndPCDKPIs\" },\r\n    0x010F: { n:\"BrtBeginPCDKPI\" },\r\n    0x0110: { n:\"BrtEndPCDKPI\" },\r\n    0x0111: { n:\"BrtBeginDims\" },\r\n    0x0112: { n:\"BrtEndDims\" },\r\n    0x0113: { n:\"BrtBeginDim\" },\r\n    0x0114: { n:\"BrtEndDim\" },\r\n    0x0115: { n:\"BrtIndexPartEnd\" },\r\n    0x0116: { n:\"BrtBeginStyleSheet\" },\r\n    0x0117: { n:\"BrtEndStyleSheet\" },\r\n    0x0118: { n:\"BrtBeginSXView\" },\r\n    0x0119: { n:\"BrtEndSXVI\" },\r\n    0x011A: { n:\"BrtBeginSXVI\" },\r\n    0x011B: { n:\"BrtBeginSXVIs\" },\r\n    0x011C: { n:\"BrtEndSXVIs\" },\r\n    0x011D: { n:\"BrtBeginSXVD\" },\r\n    0x011E: { n:\"BrtEndSXVD\" },\r\n    0x011F: { n:\"BrtBeginSXVDs\" },\r\n    0x0120: { n:\"BrtEndSXVDs\" },\r\n    0x0121: { n:\"BrtBeginSXPI\" },\r\n    0x0122: { n:\"BrtEndSXPI\" },\r\n    0x0123: { n:\"BrtBeginSXPIs\" },\r\n    0x0124: { n:\"BrtEndSXPIs\" },\r\n    0x0125: { n:\"BrtBeginSXDI\" },\r\n    0x0126: { n:\"BrtEndSXDI\" },\r\n    0x0127: { n:\"BrtBeginSXDIs\" },\r\n    0x0128: { n:\"BrtEndSXDIs\" },\r\n    0x0129: { n:\"BrtBeginSXLI\" },\r\n    0x012A: { n:\"BrtEndSXLI\" },\r\n    0x012B: { n:\"BrtBeginSXLIRws\" },\r\n    0x012C: { n:\"BrtEndSXLIRws\" },\r\n    0x012D: { n:\"BrtBeginSXLICols\" },\r\n    0x012E: { n:\"BrtEndSXLICols\" },\r\n    0x012F: { n:\"BrtBeginSXFormat\" },\r\n    0x0130: { n:\"BrtEndSXFormat\" },\r\n    0x0131: { n:\"BrtBeginSXFormats\" },\r\n    0x0132: { n:\"BrtEndSxFormats\" },\r\n    0x0133: { n:\"BrtBeginSxSelect\" },\r\n    0x0134: { n:\"BrtEndSxSelect\" },\r\n    0x0135: { n:\"BrtBeginISXVDRws\" },\r\n    0x0136: { n:\"BrtEndISXVDRws\" },\r\n    0x0137: { n:\"BrtBeginISXVDCols\" },\r\n    0x0138: { n:\"BrtEndISXVDCols\" },\r\n    0x0139: { n:\"BrtEndSXLocation\" },\r\n    0x013A: { n:\"BrtBeginSXLocation\" },\r\n    0x013B: { n:\"BrtEndSXView\" },\r\n    0x013C: { n:\"BrtBeginSXTHs\" },\r\n    0x013D: { n:\"BrtEndSXTHs\" },\r\n    0x013E: { n:\"BrtBeginSXTH\" },\r\n    0x013F: { n:\"BrtEndSXTH\" },\r\n    0x0140: { n:\"BrtBeginISXTHRws\" },\r\n    0x0141: { n:\"BrtEndISXTHRws\" },\r\n    0x0142: { n:\"BrtBeginISXTHCols\" },\r\n    0x0143: { n:\"BrtEndISXTHCols\" },\r\n    0x0144: { n:\"BrtBeginSXTDMPS\" },\r\n    0x0145: { n:\"BrtEndSXTDMPs\" },\r\n    0x0146: { n:\"BrtBeginSXTDMP\" },\r\n    0x0147: { n:\"BrtEndSXTDMP\" },\r\n    0x0148: { n:\"BrtBeginSXTHItems\" },\r\n    0x0149: { n:\"BrtEndSXTHItems\" },\r\n    0x014A: { n:\"BrtBeginSXTHItem\" },\r\n    0x014B: { n:\"BrtEndSXTHItem\" },\r\n    0x014C: { n:\"BrtBeginMetadata\" },\r\n    0x014D: { n:\"BrtEndMetadata\" },\r\n    0x014E: { n:\"BrtBeginEsmdtinfo\" },\r\n    0x014F: { n:\"BrtMdtinfo\" },\r\n    0x0150: { n:\"BrtEndEsmdtinfo\" },\r\n    0x0151: { n:\"BrtBeginEsmdb\" },\r\n    0x0152: { n:\"BrtEndEsmdb\" },\r\n    0x0153: { n:\"BrtBeginEsfmd\" },\r\n    0x0154: { n:\"BrtEndEsfmd\" },\r\n    0x0155: { n:\"BrtBeginSingleCells\" },\r\n    0x0156: { n:\"BrtEndSingleCells\" },\r\n    0x0157: { n:\"BrtBeginList\" },\r\n    0x0158: { n:\"BrtEndList\" },\r\n    0x0159: { n:\"BrtBeginListCols\" },\r\n    0x015A: { n:\"BrtEndListCols\" },\r\n    0x015B: { n:\"BrtBeginListCol\" },\r\n    0x015C: { n:\"BrtEndListCol\" },\r\n    0x015D: { n:\"BrtBeginListXmlCPr\" },\r\n    0x015E: { n:\"BrtEndListXmlCPr\" },\r\n    0x015F: { n:\"BrtListCCFmla\" },\r\n    0x0160: { n:\"BrtListTrFmla\" },\r\n    0x0161: { n:\"BrtBeginExternals\" },\r\n    0x0162: { n:\"BrtEndExternals\" },\r\n    0x0163: { n:\"BrtSupBookSrc\", f:parse_RelID},\r\n    0x0165: { n:\"BrtSupSelf\" },\r\n    0x0166: { n:\"BrtSupSame\" },\r\n    0x0167: { n:\"BrtSupTabs\" },\r\n    0x0168: { n:\"BrtBeginSupBook\" },\r\n    0x0169: { n:\"BrtPlaceholderName\" },\r\n    0x016A: { n:\"BrtExternSheet\", f:parse_ExternSheet },\r\n    0x016B: { n:\"BrtExternTableStart\" },\r\n    0x016C: { n:\"BrtExternTableEnd\" },\r\n    0x016E: { n:\"BrtExternRowHdr\" },\r\n    0x016F: { n:\"BrtExternCellBlank\" },\r\n    0x0170: { n:\"BrtExternCellReal\" },\r\n    0x0171: { n:\"BrtExternCellBool\" },\r\n    0x0172: { n:\"BrtExternCellError\" },\r\n    0x0173: { n:\"BrtExternCellString\" },\r\n    0x0174: { n:\"BrtBeginEsmdx\" },\r\n    0x0175: { n:\"BrtEndEsmdx\" },\r\n    0x0176: { n:\"BrtBeginMdxSet\" },\r\n    0x0177: { n:\"BrtEndMdxSet\" },\r\n    0x0178: { n:\"BrtBeginMdxMbrProp\" },\r\n    0x0179: { n:\"BrtEndMdxMbrProp\" },\r\n    0x017A: { n:\"BrtBeginMdxKPI\" },\r\n    0x017B: { n:\"BrtEndMdxKPI\" },\r\n    0x017C: { n:\"BrtBeginEsstr\" },\r\n    0x017D: { n:\"BrtEndEsstr\" },\r\n    0x017E: { n:\"BrtBeginPRFItem\" },\r\n    0x017F: { n:\"BrtEndPRFItem\" },\r\n    0x0180: { n:\"BrtBeginPivotCacheIDs\" },\r\n    0x0181: { n:\"BrtEndPivotCacheIDs\" },\r\n    0x0182: { n:\"BrtBeginPivotCacheID\" },\r\n    0x0183: { n:\"BrtEndPivotCacheID\" },\r\n    0x0184: { n:\"BrtBeginISXVIs\" },\r\n    0x0185: { n:\"BrtEndISXVIs\" },\r\n    0x0186: { n:\"BrtBeginColInfos\" },\r\n    0x0187: { n:\"BrtEndColInfos\" },\r\n    0x0188: { n:\"BrtBeginRwBrk\" },\r\n    0x0189: { n:\"BrtEndRwBrk\" },\r\n    0x018A: { n:\"BrtBeginColBrk\" },\r\n    0x018B: { n:\"BrtEndColBrk\" },\r\n    0x018C: { n:\"BrtBrk\" },\r\n    0x018D: { n:\"BrtUserBookView\" },\r\n    0x018E: { n:\"BrtInfo\" },\r\n    0x018F: { n:\"BrtCUsr\" },\r\n    0x0190: { n:\"BrtUsr\" },\r\n    0x0191: { n:\"BrtBeginUsers\" },\r\n    0x0193: { n:\"BrtEOF\" },\r\n    0x0194: { n:\"BrtUCR\" },\r\n    0x0195: { n:\"BrtRRInsDel\" },\r\n    0x0196: { n:\"BrtRREndInsDel\" },\r\n    0x0197: { n:\"BrtRRMove\" },\r\n    0x0198: { n:\"BrtRREndMove\" },\r\n    0x0199: { n:\"BrtRRChgCell\" },\r\n    0x019A: { n:\"BrtRREndChgCell\" },\r\n    0x019B: { n:\"BrtRRHeader\" },\r\n    0x019C: { n:\"BrtRRUserView\" },\r\n    0x019D: { n:\"BrtRRRenSheet\" },\r\n    0x019E: { n:\"BrtRRInsertSh\" },\r\n    0x019F: { n:\"BrtRRDefName\" },\r\n    0x01A0: { n:\"BrtRRNote\" },\r\n    0x01A1: { n:\"BrtRRConflict\" },\r\n    0x01A2: { n:\"BrtRRTQSIF\" },\r\n    0x01A3: { n:\"BrtRRFormat\" },\r\n    0x01A4: { n:\"BrtRREndFormat\" },\r\n    0x01A5: { n:\"BrtRRAutoFmt\" },\r\n    0x01A6: { n:\"BrtBeginUserShViews\" },\r\n    0x01A7: { n:\"BrtBeginUserShView\" },\r\n    0x01A8: { n:\"BrtEndUserShView\" },\r\n    0x01A9: { n:\"BrtEndUserShViews\" },\r\n    0x01AA: { n:\"BrtArrFmla\", f:parse_BrtArrFmla },\r\n    0x01AB: { n:\"BrtShrFmla\", f:parse_BrtShrFmla },\r\n    0x01AC: { n:\"BrtTable\" },\r\n    0x01AD: { n:\"BrtBeginExtConnections\" },\r\n    0x01AE: { n:\"BrtEndExtConnections\" },\r\n    0x01AF: { n:\"BrtBeginPCDCalcMems\" },\r\n    0x01B0: { n:\"BrtEndPCDCalcMems\" },\r\n    0x01B1: { n:\"BrtBeginPCDCalcMem\" },\r\n    0x01B2: { n:\"BrtEndPCDCalcMem\" },\r\n    0x01B3: { n:\"BrtBeginPCDHGLevels\" },\r\n    0x01B4: { n:\"BrtEndPCDHGLevels\" },\r\n    0x01B5: { n:\"BrtBeginPCDHGLevel\" },\r\n    0x01B6: { n:\"BrtEndPCDHGLevel\" },\r\n    0x01B7: { n:\"BrtBeginPCDHGLGroups\" },\r\n    0x01B8: { n:\"BrtEndPCDHGLGroups\" },\r\n    0x01B9: { n:\"BrtBeginPCDHGLGroup\" },\r\n    0x01BA: { n:\"BrtEndPCDHGLGroup\" },\r\n    0x01BB: { n:\"BrtBeginPCDHGLGMembers\" },\r\n    0x01BC: { n:\"BrtEndPCDHGLGMembers\" },\r\n    0x01BD: { n:\"BrtBeginPCDHGLGMember\" },\r\n    0x01BE: { n:\"BrtEndPCDHGLGMember\" },\r\n    0x01BF: { n:\"BrtBeginQSI\" },\r\n    0x01C0: { n:\"BrtEndQSI\" },\r\n    0x01C1: { n:\"BrtBeginQSIR\" },\r\n    0x01C2: { n:\"BrtEndQSIR\" },\r\n    0x01C3: { n:\"BrtBeginDeletedNames\" },\r\n    0x01C4: { n:\"BrtEndDeletedNames\" },\r\n    0x01C5: { n:\"BrtBeginDeletedName\" },\r\n    0x01C6: { n:\"BrtEndDeletedName\" },\r\n    0x01C7: { n:\"BrtBeginQSIFs\" },\r\n    0x01C8: { n:\"BrtEndQSIFs\" },\r\n    0x01C9: { n:\"BrtBeginQSIF\" },\r\n    0x01CA: { n:\"BrtEndQSIF\" },\r\n    0x01CB: { n:\"BrtBeginAutoSortScope\" },\r\n    0x01CC: { n:\"BrtEndAutoSortScope\" },\r\n    0x01CD: { n:\"BrtBeginConditionalFormatting\" },\r\n    0x01CE: { n:\"BrtEndConditionalFormatting\" },\r\n    0x01CF: { n:\"BrtBeginCFRule\" },\r\n    0x01D0: { n:\"BrtEndCFRule\" },\r\n    0x01D1: { n:\"BrtBeginIconSet\" },\r\n    0x01D2: { n:\"BrtEndIconSet\" },\r\n    0x01D3: { n:\"BrtBeginDatabar\" },\r\n    0x01D4: { n:\"BrtEndDatabar\" },\r\n    0x01D5: { n:\"BrtBeginColorScale\" },\r\n    0x01D6: { n:\"BrtEndColorScale\" },\r\n    0x01D7: { n:\"BrtCFVO\" },\r\n    0x01D8: { n:\"BrtExternValueMeta\" },\r\n    0x01D9: { n:\"BrtBeginColorPalette\" },\r\n    0x01DA: { n:\"BrtEndColorPalette\" },\r\n    0x01DB: { n:\"BrtIndexedColor\" },\r\n    0x01DC: { n:\"BrtMargins\", f:parse_BrtMargins },\r\n    0x01DD: { n:\"BrtPrintOptions\" },\r\n    0x01DE: { n:\"BrtPageSetup\" },\r\n    0x01DF: { n:\"BrtBeginHeaderFooter\" },\r\n    0x01E0: { n:\"BrtEndHeaderFooter\" },\r\n    0x01E1: { n:\"BrtBeginSXCrtFormat\" },\r\n    0x01E2: { n:\"BrtEndSXCrtFormat\" },\r\n    0x01E3: { n:\"BrtBeginSXCrtFormats\" },\r\n    0x01E4: { n:\"BrtEndSXCrtFormats\" },\r\n    0x01E5: { n:\"BrtWsFmtInfo\", f:parse_BrtWsFmtInfo },\r\n    0x01E6: { n:\"BrtBeginMgs\" },\r\n    0x01E7: { n:\"BrtEndMGs\" },\r\n    0x01E8: { n:\"BrtBeginMGMaps\" },\r\n    0x01E9: { n:\"BrtEndMGMaps\" },\r\n    0x01EA: { n:\"BrtBeginMG\" },\r\n    0x01EB: { n:\"BrtEndMG\" },\r\n    0x01EC: { n:\"BrtBeginMap\" },\r\n    0x01ED: { n:\"BrtEndMap\" },\r\n    0x01EE: { n:\"BrtHLink\", f:parse_BrtHLink },\r\n    0x01EF: { n:\"BrtBeginDCon\" },\r\n    0x01F0: { n:\"BrtEndDCon\" },\r\n    0x01F1: { n:\"BrtBeginDRefs\" },\r\n    0x01F2: { n:\"BrtEndDRefs\" },\r\n    0x01F3: { n:\"BrtDRef\" },\r\n    0x01F4: { n:\"BrtBeginScenMan\" },\r\n    0x01F5: { n:\"BrtEndScenMan\" },\r\n    0x01F6: { n:\"BrtBeginSct\" },\r\n    0x01F7: { n:\"BrtEndSct\" },\r\n    0x01F8: { n:\"BrtSlc\" },\r\n    0x01F9: { n:\"BrtBeginDXFs\" },\r\n    0x01FA: { n:\"BrtEndDXFs\" },\r\n    0x01FB: { n:\"BrtDXF\" },\r\n    0x01FC: { n:\"BrtBeginTableStyles\" },\r\n    0x01FD: { n:\"BrtEndTableStyles\" },\r\n    0x01FE: { n:\"BrtBeginTableStyle\" },\r\n    0x01FF: { n:\"BrtEndTableStyle\" },\r\n    0x0200: { n:\"BrtTableStyleElement\" },\r\n    0x0201: { n:\"BrtTableStyleClient\" },\r\n    0x0202: { n:\"BrtBeginVolDeps\" },\r\n    0x0203: { n:\"BrtEndVolDeps\" },\r\n    0x0204: { n:\"BrtBeginVolType\" },\r\n    0x0205: { n:\"BrtEndVolType\" },\r\n    0x0206: { n:\"BrtBeginVolMain\" },\r\n    0x0207: { n:\"BrtEndVolMain\" },\r\n    0x0208: { n:\"BrtBeginVolTopic\" },\r\n    0x0209: { n:\"BrtEndVolTopic\" },\r\n    0x020A: { n:\"BrtVolSubtopic\" },\r\n    0x020B: { n:\"BrtVolRef\" },\r\n    0x020C: { n:\"BrtVolNum\" },\r\n    0x020D: { n:\"BrtVolErr\" },\r\n    0x020E: { n:\"BrtVolStr\" },\r\n    0x020F: { n:\"BrtVolBool\" },\r\n    0x0210: { n:\"BrtBeginCalcChain$\" },\r\n    0x0211: { n:\"BrtEndCalcChain$\" },\r\n    0x0212: { n:\"BrtBeginSortState\" },\r\n    0x0213: { n:\"BrtEndSortState\" },\r\n    0x0214: { n:\"BrtBeginSortCond\" },\r\n    0x0215: { n:\"BrtEndSortCond\" },\r\n    0x0216: { n:\"BrtBookProtection\" },\r\n    0x0217: { n:\"BrtSheetProtection\" },\r\n    0x0218: { n:\"BrtRangeProtection\" },\r\n    0x0219: { n:\"BrtPhoneticInfo\" },\r\n    0x021A: { n:\"BrtBeginECTxtWiz\" },\r\n    0x021B: { n:\"BrtEndECTxtWiz\" },\r\n    0x021C: { n:\"BrtBeginECTWFldInfoLst\" },\r\n    0x021D: { n:\"BrtEndECTWFldInfoLst\" },\r\n    0x021E: { n:\"BrtBeginECTwFldInfo\" },\r\n    0x0224: { n:\"BrtFileSharing\" },\r\n    0x0225: { n:\"BrtOleSize\" },\r\n    0x0226: { n:\"BrtDrawing\", f:parse_RelID },\r\n    0x0227: { n:\"BrtLegacyDrawing\" },\r\n    0x0228: { n:\"BrtLegacyDrawingHF\" },\r\n    0x0229: { n:\"BrtWebOpt\" },\r\n    0x022A: { n:\"BrtBeginWebPubItems\" },\r\n    0x022B: { n:\"BrtEndWebPubItems\" },\r\n    0x022C: { n:\"BrtBeginWebPubItem\" },\r\n    0x022D: { n:\"BrtEndWebPubItem\" },\r\n    0x022E: { n:\"BrtBeginSXCondFmt\" },\r\n    0x022F: { n:\"BrtEndSXCondFmt\" },\r\n    0x0230: { n:\"BrtBeginSXCondFmts\" },\r\n    0x0231: { n:\"BrtEndSXCondFmts\" },\r\n    0x0232: { n:\"BrtBkHim\" },\r\n    0x0234: { n:\"BrtColor\" },\r\n    0x0235: { n:\"BrtBeginIndexedColors\" },\r\n    0x0236: { n:\"BrtEndIndexedColors\" },\r\n    0x0239: { n:\"BrtBeginMRUColors\" },\r\n    0x023A: { n:\"BrtEndMRUColors\" },\r\n    0x023C: { n:\"BrtMRUColor\" },\r\n    0x023D: { n:\"BrtBeginDVals\" },\r\n    0x023E: { n:\"BrtEndDVals\" },\r\n    0x0241: { n:\"BrtSupNameStart\" },\r\n    0x0242: { n:\"BrtSupNameValueStart\" },\r\n    0x0243: { n:\"BrtSupNameValueEnd\" },\r\n    0x0244: { n:\"BrtSupNameNum\" },\r\n    0x0245: { n:\"BrtSupNameErr\" },\r\n    0x0246: { n:\"BrtSupNameSt\" },\r\n    0x0247: { n:\"BrtSupNameNil\" },\r\n    0x0248: { n:\"BrtSupNameBool\" },\r\n    0x0249: { n:\"BrtSupNameFmla\" },\r\n    0x024A: { n:\"BrtSupNameBits\" },\r\n    0x024B: { n:\"BrtSupNameEnd\" },\r\n    0x024C: { n:\"BrtEndSupBook\" },\r\n    0x024D: { n:\"BrtCellSmartTagProperty\" },\r\n    0x024E: { n:\"BrtBeginCellSmartTag\" },\r\n    0x024F: { n:\"BrtEndCellSmartTag\" },\r\n    0x0250: { n:\"BrtBeginCellSmartTags\" },\r\n    0x0251: { n:\"BrtEndCellSmartTags\" },\r\n    0x0252: { n:\"BrtBeginSmartTags\" },\r\n    0x0253: { n:\"BrtEndSmartTags\" },\r\n    0x0254: { n:\"BrtSmartTagType\" },\r\n    0x0255: { n:\"BrtBeginSmartTagTypes\" },\r\n    0x0256: { n:\"BrtEndSmartTagTypes\" },\r\n    0x0257: { n:\"BrtBeginSXFilters\" },\r\n    0x0258: { n:\"BrtEndSXFilters\" },\r\n    0x0259: { n:\"BrtBeginSXFILTER\" },\r\n    0x025A: { n:\"BrtEndSXFilter\" },\r\n    0x025B: { n:\"BrtBeginFills\" },\r\n    0x025C: { n:\"BrtEndFills\" },\r\n    0x025D: { n:\"BrtBeginCellWatches\" },\r\n    0x025E: { n:\"BrtEndCellWatches\" },\r\n    0x025F: { n:\"BrtCellWatch\" },\r\n    0x0260: { n:\"BrtBeginCRErrs\" },\r\n    0x0261: { n:\"BrtEndCRErrs\" },\r\n    0x0262: { n:\"BrtCrashRecErr\" },\r\n    0x0263: { n:\"BrtBeginFonts\" },\r\n    0x0264: { n:\"BrtEndFonts\" },\r\n    0x0265: { n:\"BrtBeginBorders\" },\r\n    0x0266: { n:\"BrtEndBorders\" },\r\n    0x0267: { n:\"BrtBeginFmts\" },\r\n    0x0268: { n:\"BrtEndFmts\" },\r\n    0x0269: { n:\"BrtBeginCellXFs\" },\r\n    0x026A: { n:\"BrtEndCellXFs\" },\r\n    0x026B: { n:\"BrtBeginStyles\" },\r\n    0x026C: { n:\"BrtEndStyles\" },\r\n    0x0271: { n:\"BrtBigName\" },\r\n    0x0272: { n:\"BrtBeginCellStyleXFs\" },\r\n    0x0273: { n:\"BrtEndCellStyleXFs\" },\r\n    0x0274: { n:\"BrtBeginComments\" },\r\n    0x0275: { n:\"BrtEndComments\" },\r\n    0x0276: { n:\"BrtBeginCommentAuthors\" },\r\n    0x0277: { n:\"BrtEndCommentAuthors\" },\r\n    0x0278: { n:\"BrtCommentAuthor\", f:parse_BrtCommentAuthor },\r\n    0x0279: { n:\"BrtBeginCommentList\" },\r\n    0x027A: { n:\"BrtEndCommentList\" },\r\n    0x027B: { n:\"BrtBeginComment\", f:parse_BrtBeginComment},\r\n    0x027C: { n:\"BrtEndComment\" },\r\n    0x027D: { n:\"BrtCommentText\", f:parse_BrtCommentText },\r\n    0x027E: { n:\"BrtBeginOleObjects\" },\r\n    0x027F: { n:\"BrtOleObject\" },\r\n    0x0280: { n:\"BrtEndOleObjects\" },\r\n    0x0281: { n:\"BrtBeginSxrules\" },\r\n    0x0282: { n:\"BrtEndSxRules\" },\r\n    0x0283: { n:\"BrtBeginActiveXControls\" },\r\n    0x0284: { n:\"BrtActiveX\" },\r\n    0x0285: { n:\"BrtEndActiveXControls\" },\r\n    0x0286: { n:\"BrtBeginPCDSDTCEMembersSortBy\" },\r\n    0x0288: { n:\"BrtBeginCellIgnoreECs\" },\r\n    0x0289: { n:\"BrtCellIgnoreEC\" },\r\n    0x028A: { n:\"BrtEndCellIgnoreECs\" },\r\n    0x028B: { n:\"BrtCsProp\", f:parse_BrtCsProp },\r\n    0x028C: { n:\"BrtCsPageSetup\" },\r\n    0x028D: { n:\"BrtBeginUserCsViews\" },\r\n    0x028E: { n:\"BrtEndUserCsViews\" },\r\n    0x028F: { n:\"BrtBeginUserCsView\" },\r\n    0x0290: { n:\"BrtEndUserCsView\" },\r\n    0x0291: { n:\"BrtBeginPcdSFCIEntries\" },\r\n    0x0292: { n:\"BrtEndPCDSFCIEntries\" },\r\n    0x0293: { n:\"BrtPCDSFCIEntry\" },\r\n    0x0294: { n:\"BrtBeginListParts\" },\r\n    0x0295: { n:\"BrtListPart\" },\r\n    0x0296: { n:\"BrtEndListParts\" },\r\n    0x0297: { n:\"BrtSheetCalcProp\" },\r\n    0x0298: { n:\"BrtBeginFnGroup\" },\r\n    0x0299: { n:\"BrtFnGroup\" },\r\n    0x029A: { n:\"BrtEndFnGroup\" },\r\n    0x029B: { n:\"BrtSupAddin\" },\r\n    0x029C: { n:\"BrtSXTDMPOrder\" },\r\n    0x029D: { n:\"BrtCsProtection\" },\r\n    0x029F: { n:\"BrtBeginWsSortMap\" },\r\n    0x02A0: { n:\"BrtEndWsSortMap\" },\r\n    0x02A1: { n:\"BrtBeginRRSort\" },\r\n    0x02A2: { n:\"BrtEndRRSort\" },\r\n    0x02A3: { n:\"BrtRRSortItem\" },\r\n    0x02A4: { n:\"BrtFileSharingIso\" },\r\n    0x02A5: { n:\"BrtBookProtectionIso\" },\r\n    0x02A6: { n:\"BrtSheetProtectionIso\" },\r\n    0x02A7: { n:\"BrtCsProtectionIso\" },\r\n    0x02A8: { n:\"BrtRangeProtectionIso\" },\r\n    0x0400: { n:\"BrtRwDescent\" },\r\n    0x0401: { n:\"BrtKnownFonts\" },\r\n    0x0402: { n:\"BrtBeginSXTupleSet\" },\r\n    0x0403: { n:\"BrtEndSXTupleSet\" },\r\n    0x0404: { n:\"BrtBeginSXTupleSetHeader\" },\r\n    0x0405: { n:\"BrtEndSXTupleSetHeader\" },\r\n    0x0406: { n:\"BrtSXTupleSetHeaderItem\" },\r\n    0x0407: { n:\"BrtBeginSXTupleSetData\" },\r\n    0x0408: { n:\"BrtEndSXTupleSetData\" },\r\n    0x0409: { n:\"BrtBeginSXTupleSetRow\" },\r\n    0x040A: { n:\"BrtEndSXTupleSetRow\" },\r\n    0x040B: { n:\"BrtSXTupleSetRowItem\" },\r\n    0x040C: { n:\"BrtNameExt\" },\r\n    0x040D: { n:\"BrtPCDH14\" },\r\n    0x040E: { n:\"BrtBeginPCDCalcMem14\" },\r\n    0x040F: { n:\"BrtEndPCDCalcMem14\" },\r\n    0x0410: { n:\"BrtSXTH14\" },\r\n    0x0411: { n:\"BrtBeginSparklineGroup\" },\r\n    0x0412: { n:\"BrtEndSparklineGroup\" },\r\n    0x0413: { n:\"BrtSparkline\" },\r\n    0x0414: { n:\"BrtSXDI14\" },\r\n    0x0415: { n:\"BrtWsFmtInfoEx14\" },\r\n    0x0416: { n:\"BrtBeginConditionalFormatting14\" },\r\n    0x0417: { n:\"BrtEndConditionalFormatting14\" },\r\n    0x0418: { n:\"BrtBeginCFRule14\" },\r\n    0x0419: { n:\"BrtEndCFRule14\" },\r\n    0x041A: { n:\"BrtCFVO14\" },\r\n    0x041B: { n:\"BrtBeginDatabar14\" },\r\n    0x041C: { n:\"BrtBeginIconSet14\" },\r\n    0x041D: { n:\"BrtDVal14\" },\r\n    0x041E: { n:\"BrtBeginDVals14\" },\r\n    0x041F: { n:\"BrtColor14\" },\r\n    0x0420: { n:\"BrtBeginSparklines\" },\r\n    0x0421: { n:\"BrtEndSparklines\" },\r\n    0x0422: { n:\"BrtBeginSparklineGroups\" },\r\n    0x0423: { n:\"BrtEndSparklineGroups\" },\r\n    0x0425: { n:\"BrtSXVD14\" },\r\n    0x0426: { n:\"BrtBeginSXView14\" },\r\n    0x0427: { n:\"BrtEndSXView14\" },\r\n    0x0428: { n:\"BrtBeginSXView16\" },\r\n    0x0429: { n:\"BrtEndSXView16\" },\r\n    0x042A: { n:\"BrtBeginPCD14\" },\r\n    0x042B: { n:\"BrtEndPCD14\" },\r\n    0x042C: { n:\"BrtBeginExtConn14\" },\r\n    0x042D: { n:\"BrtEndExtConn14\" },\r\n    0x042E: { n:\"BrtBeginSlicerCacheIDs\" },\r\n    0x042F: { n:\"BrtEndSlicerCacheIDs\" },\r\n    0x0430: { n:\"BrtBeginSlicerCacheID\" },\r\n    0x0431: { n:\"BrtEndSlicerCacheID\" },\r\n    0x0433: { n:\"BrtBeginSlicerCache\" },\r\n    0x0434: { n:\"BrtEndSlicerCache\" },\r\n    0x0435: { n:\"BrtBeginSlicerCacheDef\" },\r\n    0x0436: { n:\"BrtEndSlicerCacheDef\" },\r\n    0x0437: { n:\"BrtBeginSlicersEx\" },\r\n    0x0438: { n:\"BrtEndSlicersEx\" },\r\n    0x0439: { n:\"BrtBeginSlicerEx\" },\r\n    0x043A: { n:\"BrtEndSlicerEx\" },\r\n    0x043B: { n:\"BrtBeginSlicer\" },\r\n    0x043C: { n:\"BrtEndSlicer\" },\r\n    0x043D: { n:\"BrtSlicerCachePivotTables\" },\r\n    0x043E: { n:\"BrtBeginSlicerCacheOlapImpl\" },\r\n    0x043F: { n:\"BrtEndSlicerCacheOlapImpl\" },\r\n    0x0440: { n:\"BrtBeginSlicerCacheLevelsData\" },\r\n    0x0441: { n:\"BrtEndSlicerCacheLevelsData\" },\r\n    0x0442: { n:\"BrtBeginSlicerCacheLevelData\" },\r\n    0x0443: { n:\"BrtEndSlicerCacheLevelData\" },\r\n    0x0444: { n:\"BrtBeginSlicerCacheSiRanges\" },\r\n    0x0445: { n:\"BrtEndSlicerCacheSiRanges\" },\r\n    0x0446: { n:\"BrtBeginSlicerCacheSiRange\" },\r\n    0x0447: { n:\"BrtEndSlicerCacheSiRange\" },\r\n    0x0448: { n:\"BrtSlicerCacheOlapItem\" },\r\n    0x0449: { n:\"BrtBeginSlicerCacheSelections\" },\r\n    0x044A: { n:\"BrtSlicerCacheSelection\" },\r\n    0x044B: { n:\"BrtEndSlicerCacheSelections\" },\r\n    0x044C: { n:\"BrtBeginSlicerCacheNative\" },\r\n    0x044D: { n:\"BrtEndSlicerCacheNative\" },\r\n    0x044E: { n:\"BrtSlicerCacheNativeItem\" },\r\n    0x044F: { n:\"BrtRangeProtection14\" },\r\n    0x0450: { n:\"BrtRangeProtectionIso14\" },\r\n    0x0451: { n:\"BrtCellIgnoreEC14\" },\r\n    0x0457: { n:\"BrtList14\" },\r\n    0x0458: { n:\"BrtCFIcon\" },\r\n    0x0459: { n:\"BrtBeginSlicerCachesPivotCacheIDs\" },\r\n    0x045A: { n:\"BrtEndSlicerCachesPivotCacheIDs\" },\r\n    0x045B: { n:\"BrtBeginSlicers\" },\r\n    0x045C: { n:\"BrtEndSlicers\" },\r\n    0x045D: { n:\"BrtWbProp14\" },\r\n    0x045E: { n:\"BrtBeginSXEdit\" },\r\n    0x045F: { n:\"BrtEndSXEdit\" },\r\n    0x0460: { n:\"BrtBeginSXEdits\" },\r\n    0x0461: { n:\"BrtEndSXEdits\" },\r\n    0x0462: { n:\"BrtBeginSXChange\" },\r\n    0x0463: { n:\"BrtEndSXChange\" },\r\n    0x0464: { n:\"BrtBeginSXChanges\" },\r\n    0x0465: { n:\"BrtEndSXChanges\" },\r\n    0x0466: { n:\"BrtSXTupleItems\" },\r\n    0x0468: { n:\"BrtBeginSlicerStyle\" },\r\n    0x0469: { n:\"BrtEndSlicerStyle\" },\r\n    0x046A: { n:\"BrtSlicerStyleElement\" },\r\n    0x046B: { n:\"BrtBeginStyleSheetExt14\" },\r\n    0x046C: { n:\"BrtEndStyleSheetExt14\" },\r\n    0x046D: { n:\"BrtBeginSlicerCachesPivotCacheID\" },\r\n    0x046E: { n:\"BrtEndSlicerCachesPivotCacheID\" },\r\n    0x046F: { n:\"BrtBeginConditionalFormattings\" },\r\n    0x0470: { n:\"BrtEndConditionalFormattings\" },\r\n    0x0471: { n:\"BrtBeginPCDCalcMemExt\" },\r\n    0x0472: { n:\"BrtEndPCDCalcMemExt\" },\r\n    0x0473: { n:\"BrtBeginPCDCalcMemsExt\" },\r\n    0x0474: { n:\"BrtEndPCDCalcMemsExt\" },\r\n    0x0475: { n:\"BrtPCDField14\" },\r\n    0x0476: { n:\"BrtBeginSlicerStyles\" },\r\n    0x0477: { n:\"BrtEndSlicerStyles\" },\r\n    0x0478: { n:\"BrtBeginSlicerStyleElements\" },\r\n    0x0479: { n:\"BrtEndSlicerStyleElements\" },\r\n    0x047A: { n:\"BrtCFRuleExt\" },\r\n    0x047B: { n:\"BrtBeginSXCondFmt14\" },\r\n    0x047C: { n:\"BrtEndSXCondFmt14\" },\r\n    0x047D: { n:\"BrtBeginSXCondFmts14\" },\r\n    0x047E: { n:\"BrtEndSXCondFmts14\" },\r\n    0x0480: { n:\"BrtBeginSortCond14\" },\r\n    0x0481: { n:\"BrtEndSortCond14\" },\r\n    0x0482: { n:\"BrtEndDVals14\" },\r\n    0x0483: { n:\"BrtEndIconSet14\" },\r\n    0x0484: { n:\"BrtEndDatabar14\" },\r\n    0x0485: { n:\"BrtBeginColorScale14\" },\r\n    0x0486: { n:\"BrtEndColorScale14\" },\r\n    0x0487: { n:\"BrtBeginSxrules14\" },\r\n    0x0488: { n:\"BrtEndSxrules14\" },\r\n    0x0489: { n:\"BrtBeginPRule14\" },\r\n    0x048A: { n:\"BrtEndPRule14\" },\r\n    0x048B: { n:\"BrtBeginPRFilters14\" },\r\n    0x048C: { n:\"BrtEndPRFilters14\" },\r\n    0x048D: { n:\"BrtBeginPRFilter14\" },\r\n    0x048E: { n:\"BrtEndPRFilter14\" },\r\n    0x048F: { n:\"BrtBeginPRFItem14\" },\r\n    0x0490: { n:\"BrtEndPRFItem14\" },\r\n    0x0491: { n:\"BrtBeginCellIgnoreECs14\" },\r\n    0x0492: { n:\"BrtEndCellIgnoreECs14\" },\r\n    0x0493: { n:\"BrtDxf14\" },\r\n    0x0494: { n:\"BrtBeginDxF14s\" },\r\n    0x0495: { n:\"BrtEndDxf14s\" },\r\n    0x0499: { n:\"BrtFilter14\" },\r\n    0x049A: { n:\"BrtBeginCustomFilters14\" },\r\n    0x049C: { n:\"BrtCustomFilter14\" },\r\n    0x049D: { n:\"BrtIconFilter14\" },\r\n    0x049E: { n:\"BrtPivotCacheConnectionName\" },\r\n    0x0800: { n:\"BrtBeginDecoupledPivotCacheIDs\" },\r\n    0x0801: { n:\"BrtEndDecoupledPivotCacheIDs\" },\r\n    0x0802: { n:\"BrtDecoupledPivotCacheID\" },\r\n    0x0803: { n:\"BrtBeginPivotTableRefs\" },\r\n    0x0804: { n:\"BrtEndPivotTableRefs\" },\r\n    0x0805: { n:\"BrtPivotTableRef\" },\r\n    0x0806: { n:\"BrtSlicerCacheBookPivotTables\" },\r\n    0x0807: { n:\"BrtBeginSxvcells\" },\r\n    0x0808: { n:\"BrtEndSxvcells\" },\r\n    0x0809: { n:\"BrtBeginSxRow\" },\r\n    0x080A: { n:\"BrtEndSxRow\" },\r\n    0x080C: { n:\"BrtPcdCalcMem15\" },\r\n    0x0813: { n:\"BrtQsi15\" },\r\n    0x0814: { n:\"BrtBeginWebExtensions\" },\r\n    0x0815: { n:\"BrtEndWebExtensions\" },\r\n    0x0816: { n:\"BrtWebExtension\" },\r\n    0x0817: { n:\"BrtAbsPath15\" },\r\n    0x0818: { n:\"BrtBeginPivotTableUISettings\" },\r\n    0x0819: { n:\"BrtEndPivotTableUISettings\" },\r\n    0x081B: { n:\"BrtTableSlicerCacheIDs\" },\r\n    0x081C: { n:\"BrtTableSlicerCacheID\" },\r\n    0x081D: { n:\"BrtBeginTableSlicerCache\" },\r\n    0x081E: { n:\"BrtEndTableSlicerCache\" },\r\n    0x081F: { n:\"BrtSxFilter15\" },\r\n    0x0820: { n:\"BrtBeginTimelineCachePivotCacheIDs\" },\r\n    0x0821: { n:\"BrtEndTimelineCachePivotCacheIDs\" },\r\n    0x0822: { n:\"BrtTimelineCachePivotCacheID\" },\r\n    0x0823: { n:\"BrtBeginTimelineCacheIDs\" },\r\n    0x0824: { n:\"BrtEndTimelineCacheIDs\" },\r\n    0x0825: { n:\"BrtBeginTimelineCacheID\" },\r\n    0x0826: { n:\"BrtEndTimelineCacheID\" },\r\n    0x0827: { n:\"BrtBeginTimelinesEx\" },\r\n    0x0828: { n:\"BrtEndTimelinesEx\" },\r\n    0x0829: { n:\"BrtBeginTimelineEx\" },\r\n    0x082A: { n:\"BrtEndTimelineEx\" },\r\n    0x082B: { n:\"BrtWorkBookPr15\" },\r\n    0x082C: { n:\"BrtPCDH15\" },\r\n    0x082D: { n:\"BrtBeginTimelineStyle\" },\r\n    0x082E: { n:\"BrtEndTimelineStyle\" },\r\n    0x082F: { n:\"BrtTimelineStyleElement\" },\r\n    0x0830: { n:\"BrtBeginTimelineStylesheetExt15\" },\r\n    0x0831: { n:\"BrtEndTimelineStylesheetExt15\" },\r\n    0x0832: { n:\"BrtBeginTimelineStyles\" },\r\n    0x0833: { n:\"BrtEndTimelineStyles\" },\r\n    0x0834: { n:\"BrtBeginTimelineStyleElements\" },\r\n    0x0835: { n:\"BrtEndTimelineStyleElements\" },\r\n    0x0836: { n:\"BrtDxf15\" },\r\n    0x0837: { n:\"BrtBeginDxfs15\" },\r\n    0x0838: { n:\"brtEndDxfs15\" },\r\n    0x0839: { n:\"BrtSlicerCacheHideItemsWithNoData\" },\r\n    0x083A: { n:\"BrtBeginItemUniqueNames\" },\r\n    0x083B: { n:\"BrtEndItemUniqueNames\" },\r\n    0x083C: { n:\"BrtItemUniqueName\" },\r\n    0x083D: { n:\"BrtBeginExtConn15\" },\r\n    0x083E: { n:\"BrtEndExtConn15\" },\r\n    0x083F: { n:\"BrtBeginOledbPr15\" },\r\n    0x0840: { n:\"BrtEndOledbPr15\" },\r\n    0x0841: { n:\"BrtBeginDataFeedPr15\" },\r\n    0x0842: { n:\"BrtEndDataFeedPr15\" },\r\n    0x0843: { n:\"BrtTextPr15\" },\r\n    0x0844: { n:\"BrtRangePr15\" },\r\n    0x0845: { n:\"BrtDbCommand15\" },\r\n    0x0846: { n:\"BrtBeginDbTables15\" },\r\n    0x0847: { n:\"BrtEndDbTables15\" },\r\n    0x0848: { n:\"BrtDbTable15\" },\r\n    0x0849: { n:\"BrtBeginDataModel\" },\r\n    0x084A: { n:\"BrtEndDataModel\" },\r\n    0x084B: { n:\"BrtBeginModelTables\" },\r\n    0x084C: { n:\"BrtEndModelTables\" },\r\n    0x084D: { n:\"BrtModelTable\" },\r\n    0x084E: { n:\"BrtBeginModelRelationships\" },\r\n    0x084F: { n:\"BrtEndModelRelationships\" },\r\n    0x0850: { n:\"BrtModelRelationship\" },\r\n    0x0851: { n:\"BrtBeginECTxtWiz15\" },\r\n    0x0852: { n:\"BrtEndECTxtWiz15\" },\r\n    0x0853: { n:\"BrtBeginECTWFldInfoLst15\" },\r\n    0x0854: { n:\"BrtEndECTWFldInfoLst15\" },\r\n    0x0855: { n:\"BrtBeginECTWFldInfo15\" },\r\n    0x0856: { n:\"BrtFieldListActiveItem\" },\r\n    0x0857: { n:\"BrtPivotCacheIdVersion\" },\r\n    0x0858: { n:\"BrtSXDI15\" },\r\n    0x0859: { n:\"BrtBeginModelTimeGroupings\" },\r\n    0x085A: { n:\"BrtEndModelTimeGroupings\" },\r\n    0x085B: { n:\"BrtBeginModelTimeGrouping\" },\r\n    0x085C: { n:\"BrtEndModelTimeGrouping\" },\r\n    0x085D: { n:\"BrtModelTimeGroupingCalcCol\" },\r\n    0x0C00: { n:\"BrtUid\" },\r\n    0x0C01: { n:\"BrtRevisionPtr\" },\r\n    0x13e7: { n:\"BrtBeginCalcFeatures\" },\r\n    0x13e8: { n:\"BrtEndCalcFeatures\" },\r\n    0x13e9: { n:\"BrtCalcFeature\" },\r\n    0xFFFF: { n:\"\" }\r\n  };\r\n\r\n  var XLSBRE = evert_key(XLSBRecordEnum, 'n');\r\n\r\n  /* [MS-XLS] 2.3 Record Enumeration */\r\n  var XLSRecordEnum = {\r\n    0x0003: { n:\"BIFF2NUM\", f:parse_BIFF2NUM },\r\n    0x0004: { n:\"BIFF2STR\", f:parse_BIFF2STR },\r\n    0x0006: { n:\"Formula\", f:parse_Formula },\r\n    0x0009: { n:'BOF', f:parse_BOF },\r\n    0x000a: { n:'EOF', f:parsenoop2 },\r\n    0x000c: { n:\"CalcCount\", f:parseuint16 },\r\n    0x000d: { n:\"CalcMode\", f:parseuint16 },\r\n    0x000e: { n:\"CalcPrecision\", f:parsebool },\r\n    0x000f: { n:\"CalcRefMode\", f:parsebool },\r\n    0x0010: { n:\"CalcDelta\", f:parse_Xnum },\r\n    0x0011: { n:\"CalcIter\", f:parsebool },\r\n    0x0012: { n:\"Protect\", f:parsebool },\r\n    0x0013: { n:\"Password\", f:parseuint16 },\r\n    0x0014: { n:\"Header\", f:parse_XLHeaderFooter },\r\n    0x0015: { n:\"Footer\", f:parse_XLHeaderFooter },\r\n    0x0017: { n:\"ExternSheet\", f:parse_ExternSheet },\r\n    0x0018: { n:\"Lbl\", f:parse_Lbl },\r\n    0x0019: { n:\"WinProtect\", f:parsebool },\r\n    0x001a: { n:\"VerticalPageBreaks\" },\r\n    0x001b: { n:\"HorizontalPageBreaks\" },\r\n    0x001c: { n:\"Note\", f:parse_Note },\r\n    0x001d: { n:\"Selection\" },\r\n    0x0022: { n:\"Date1904\", f:parsebool },\r\n    0x0023: { n:\"ExternName\", f:parse_ExternName },\r\n    0x0026: { n:\"LeftMargin\", f:parse_Xnum },\r\n    0x0027: { n:\"RightMargin\", f:parse_Xnum },\r\n    0x0028: { n:\"TopMargin\", f:parse_Xnum },\r\n    0x0029: { n:\"BottomMargin\", f:parse_Xnum },\r\n    0x002a: { n:\"PrintRowCol\", f:parsebool },\r\n    0x002b: { n:\"PrintGrid\", f:parsebool },\r\n    0x002f: { n:\"FilePass\", f:parse_FilePass },\r\n    0x0031: { n:\"Font\", f:parse_Font },\r\n    0x0033: { n:\"PrintSize\", f:parseuint16 },\r\n    0x003c: { n:\"Continue\" },\r\n    0x003d: { n:\"Window1\", f:parse_Window1 },\r\n    0x0040: { n:\"Backup\", f:parsebool },\r\n    0x0041: { n:\"Pane\" },\r\n    0x0042: { n:'CodePage', f:parseuint16 },\r\n    0x004d: { n:\"Pls\" },\r\n    0x0050: { n:\"DCon\" },\r\n    0x0051: { n:\"DConRef\" },\r\n    0x0052: { n:\"DConName\" },\r\n    0x0055: { n:\"DefColWidth\", f:parseuint16 },\r\n    0x0059: { n:\"XCT\" },\r\n    0x005a: { n:\"CRN\" },\r\n    0x005b: { n:\"FileSharing\" },\r\n    0x005c: { n:'WriteAccess', f:parse_WriteAccess },\r\n    0x005d: { n:\"Obj\", f:parse_Obj },\r\n    0x005e: { n:\"Uncalced\" },\r\n    0x005f: { n:\"CalcSaveRecalc\", f:parsebool },\r\n    0x0060: { n:\"Template\" },\r\n    0x0061: { n:\"Intl\" },\r\n    0x0063: { n:\"ObjProtect\", f:parsebool },\r\n    0x007d: { n:\"ColInfo\", f:parse_ColInfo },\r\n    0x0080: { n:\"Guts\", f:parse_Guts },\r\n    0x0081: { n:\"WsBool\", f:parse_WsBool },\r\n    0x0082: { n:\"GridSet\", f:parseuint16 },\r\n    0x0083: { n:\"HCenter\", f:parsebool },\r\n    0x0084: { n:\"VCenter\", f:parsebool },\r\n    0x0085: { n:'BoundSheet8', f:parse_BoundSheet8 },\r\n    0x0086: { n:\"WriteProtect\" },\r\n    0x008c: { n:\"Country\", f:parse_Country },\r\n    0x008d: { n:\"HideObj\", f:parseuint16 },\r\n    0x0090: { n:\"Sort\" },\r\n    0x0092: { n:\"Palette\", f:parse_Palette },\r\n    0x0097: { n:\"Sync\" },\r\n    0x0098: { n:\"LPr\" },\r\n    0x0099: { n:\"DxGCol\" },\r\n    0x009a: { n:\"FnGroupName\" },\r\n    0x009b: { n:\"FilterMode\" },\r\n    0x009c: { n:\"BuiltInFnGroupCount\", f:parseuint16 },\r\n    0x009d: { n:\"AutoFilterInfo\" },\r\n    0x009e: { n:\"AutoFilter\" },\r\n    0x00a0: { n:\"Scl\", f:parse_Scl },\r\n    0x00a1: { n:\"Setup\", f:parse_Setup },\r\n    0x00ae: { n:\"ScenMan\" },\r\n    0x00af: { n:\"SCENARIO\" },\r\n    0x00b0: { n:\"SxView\" },\r\n    0x00b1: { n:\"Sxvd\" },\r\n    0x00b2: { n:\"SXVI\" },\r\n    0x00b4: { n:\"SxIvd\" },\r\n    0x00b5: { n:\"SXLI\" },\r\n    0x00b6: { n:\"SXPI\" },\r\n    0x00b8: { n:\"DocRoute\" },\r\n    0x00b9: { n:\"RecipName\" },\r\n    0x00bd: { n:\"MulRk\", f:parse_MulRk },\r\n    0x00be: { n:\"MulBlank\", f:parse_MulBlank },\r\n    0x00c1: { n:'Mms', f:parsenoop2 },\r\n    0x00c5: { n:\"SXDI\" },\r\n    0x00c6: { n:\"SXDB\" },\r\n    0x00c7: { n:\"SXFDB\" },\r\n    0x00c8: { n:\"SXDBB\" },\r\n    0x00c9: { n:\"SXNum\" },\r\n    0x00ca: { n:\"SxBool\", f:parsebool },\r\n    0x00cb: { n:\"SxErr\" },\r\n    0x00cc: { n:\"SXInt\" },\r\n    0x00cd: { n:\"SXString\" },\r\n    0x00ce: { n:\"SXDtr\" },\r\n    0x00cf: { n:\"SxNil\" },\r\n    0x00d0: { n:\"SXTbl\" },\r\n    0x00d1: { n:\"SXTBRGIITM\" },\r\n    0x00d2: { n:\"SxTbpg\" },\r\n    0x00d3: { n:\"ObProj\" },\r\n    0x00d5: { n:\"SXStreamID\" },\r\n    0x00d7: { n:\"DBCell\" },\r\n    0x00d8: { n:\"SXRng\" },\r\n    0x00d9: { n:\"SxIsxoper\" },\r\n    0x00da: { n:\"BookBool\", f:parseuint16 },\r\n    0x00dc: { n:\"DbOrParamQry\" },\r\n    0x00dd: { n:\"ScenarioProtect\", f:parsebool },\r\n    0x00de: { n:\"OleObjectSize\" },\r\n    0x00e0: { n:\"XF\", f:parse_XF },\r\n    0x00e1: { n:'InterfaceHdr', f:parse_InterfaceHdr },\r\n    0x00e2: { n:'InterfaceEnd', f:parsenoop2 },\r\n    0x00e3: { n:\"SXVS\" },\r\n    0x00e5: { n:\"MergeCells\", f:parse_MergeCells },\r\n    0x00e9: { n:\"BkHim\" },\r\n    0x00eb: { n:\"MsoDrawingGroup\" },\r\n    0x00ec: { n:\"MsoDrawing\" },\r\n    0x00ed: { n:\"MsoDrawingSelection\" },\r\n    0x00ef: { n:\"PhoneticInfo\" },\r\n    0x00f0: { n:\"SxRule\" },\r\n    0x00f1: { n:\"SXEx\" },\r\n    0x00f2: { n:\"SxFilt\" },\r\n    0x00f4: { n:\"SxDXF\" },\r\n    0x00f5: { n:\"SxItm\" },\r\n    0x00f6: { n:\"SxName\" },\r\n    0x00f7: { n:\"SxSelect\" },\r\n    0x00f8: { n:\"SXPair\" },\r\n    0x00f9: { n:\"SxFmla\" },\r\n    0x00fb: { n:\"SxFormat\" },\r\n    0x00fc: { n:\"SST\", f:parse_SST },\r\n    0x00fd: { n:\"LabelSst\", f:parse_LabelSst },\r\n    0x00ff: { n:\"ExtSST\", f:parse_ExtSST },\r\n    0x0100: { n:\"SXVDEx\" },\r\n    0x0103: { n:\"SXFormula\" },\r\n    0x0122: { n:\"SXDBEx\" },\r\n    0x0137: { n:\"RRDInsDel\" },\r\n    0x0138: { n:\"RRDHead\" },\r\n    0x013b: { n:\"RRDChgCell\" },\r\n    0x013d: { n:\"RRTabId\", f:parseuint16a },\r\n    0x013e: { n:\"RRDRenSheet\" },\r\n    0x013f: { n:\"RRSort\" },\r\n    0x0140: { n:\"RRDMove\" },\r\n    0x014a: { n:\"RRFormat\" },\r\n    0x014b: { n:\"RRAutoFmt\" },\r\n    0x014d: { n:\"RRInsertSh\" },\r\n    0x014e: { n:\"RRDMoveBegin\" },\r\n    0x014f: { n:\"RRDMoveEnd\" },\r\n    0x0150: { n:\"RRDInsDelBegin\" },\r\n    0x0151: { n:\"RRDInsDelEnd\" },\r\n    0x0152: { n:\"RRDConflict\" },\r\n    0x0153: { n:\"RRDDefName\" },\r\n    0x0154: { n:\"RRDRstEtxp\" },\r\n    0x015f: { n:\"LRng\" },\r\n    0x0160: { n:\"UsesELFs\", f:parsebool },\r\n    0x0161: { n:\"DSF\", f:parsenoop2 },\r\n    0x0191: { n:\"CUsr\" },\r\n    0x0192: { n:\"CbUsr\" },\r\n    0x0193: { n:\"UsrInfo\" },\r\n    0x0194: { n:\"UsrExcl\" },\r\n    0x0195: { n:\"FileLock\" },\r\n    0x0196: { n:\"RRDInfo\" },\r\n    0x0197: { n:\"BCUsrs\" },\r\n    0x0198: { n:\"UsrChk\" },\r\n    0x01a9: { n:\"UserBView\" },\r\n    0x01aa: { n:\"UserSViewBegin\" },\r\n    0x01ab: { n:\"UserSViewEnd\" },\r\n    0x01ac: { n:\"RRDUserView\" },\r\n    0x01ad: { n:\"Qsi\" },\r\n    0x01ae: { n:\"SupBook\", f:parse_SupBook },\r\n    0x01af: { n:\"Prot4Rev\", f:parsebool },\r\n    0x01b0: { n:\"CondFmt\" },\r\n    0x01b1: { n:\"CF\" },\r\n    0x01b2: { n:\"DVal\" },\r\n    0x01b5: { n:\"DConBin\" },\r\n    0x01b6: { n:\"TxO\", f:parse_TxO },\r\n    0x01b7: { n:\"RefreshAll\", f:parsebool },\r\n    0x01b8: { n:\"HLink\", f:parse_HLink },\r\n    0x01b9: { n:\"Lel\" },\r\n    0x01ba: { n:\"CodeName\", f:parse_XLUnicodeString },\r\n    0x01bb: { n:\"SXFDBType\" },\r\n    0x01bc: { n:\"Prot4RevPass\", f:parseuint16 },\r\n    0x01bd: { n:\"ObNoMacros\" },\r\n    0x01be: { n:\"Dv\" },\r\n    0x01c0: { n:\"Excel9File\", f:parsenoop2 },\r\n    0x01c1: { n:\"RecalcId\", f:parse_RecalcId, r:2},\r\n    0x01c2: { n:\"EntExU2\", f:parsenoop2 },\r\n    0x0200: { n:\"Dimensions\", f:parse_Dimensions },\r\n    0x0201: { n:\"Blank\", f:parse_Blank },\r\n    0x0203: { n:\"Number\", f:parse_Number },\r\n    0x0204: { n:\"Label\", f:parse_Label },\r\n    0x0205: { n:\"BoolErr\", f:parse_BoolErr },\r\n    0x0206: { n:\"Formula\", f:parse_Formula },\r\n    0x0207: { n:\"String\", f:parse_String },\r\n    0x0208: { n:'Row', f:parse_Row },\r\n    0x020b: { n:\"Index\" },\r\n    0x0221: { n:\"Array\", f:parse_Array },\r\n    0x0225: { n:\"DefaultRowHeight\", f:parse_DefaultRowHeight },\r\n    0x0236: { n:\"Table\" },\r\n    0x023e: { n:\"Window2\", f:parse_Window2 },\r\n    0x027e: { n:\"RK\", f:parse_RK },\r\n    0x0293: { n:\"Style\" },\r\n    0x0406: { n:\"Formula\", f:parse_Formula },\r\n    0x0418: { n:\"BigName\" },\r\n    0x041e: { n:\"Format\", f:parse_Format },\r\n    0x043c: { n:\"ContinueBigName\" },\r\n    0x04bc: { n:\"ShrFmla\", f:parse_ShrFmla },\r\n    0x0800: { n:\"HLinkTooltip\", f:parse_HLinkTooltip },\r\n    0x0801: { n:\"WebPub\" },\r\n    0x0802: { n:\"QsiSXTag\" },\r\n    0x0803: { n:\"DBQueryExt\" },\r\n    0x0804: { n:\"ExtString\" },\r\n    0x0805: { n:\"TxtQry\" },\r\n    0x0806: { n:\"Qsir\" },\r\n    0x0807: { n:\"Qsif\" },\r\n    0x0808: { n:\"RRDTQSIF\" },\r\n    0x0809: { n:'BOF', f:parse_BOF },\r\n    0x080a: { n:\"OleDbConn\" },\r\n    0x080b: { n:\"WOpt\" },\r\n    0x080c: { n:\"SXViewEx\" },\r\n    0x080d: { n:\"SXTH\" },\r\n    0x080e: { n:\"SXPIEx\" },\r\n    0x080f: { n:\"SXVDTEx\" },\r\n    0x0810: { n:\"SXViewEx9\" },\r\n    0x0812: { n:\"ContinueFrt\" },\r\n    0x0813: { n:\"RealTimeData\" },\r\n    0x0850: { n:\"ChartFrtInfo\" },\r\n    0x0851: { n:\"FrtWrapper\" },\r\n    0x0852: { n:\"StartBlock\" },\r\n    0x0853: { n:\"EndBlock\" },\r\n    0x0854: { n:\"StartObject\" },\r\n    0x0855: { n:\"EndObject\" },\r\n    0x0856: { n:\"CatLab\" },\r\n    0x0857: { n:\"YMult\" },\r\n    0x0858: { n:\"SXViewLink\" },\r\n    0x0859: { n:\"PivotChartBits\" },\r\n    0x085a: { n:\"FrtFontList\" },\r\n    0x0862: { n:\"SheetExt\" },\r\n    0x0863: { n:\"BookExt\", r:12},\r\n    0x0864: { n:\"SXAddl\" },\r\n    0x0865: { n:\"CrErr\" },\r\n    0x0866: { n:\"HFPicture\" },\r\n    0x0867: { n:'FeatHdr', f:parsenoop2 },\r\n    0x0868: { n:\"Feat\" },\r\n    0x086a: { n:\"DataLabExt\" },\r\n    0x086b: { n:\"DataLabExtContents\" },\r\n    0x086c: { n:\"CellWatch\" },\r\n    0x0871: { n:\"FeatHdr11\" },\r\n    0x0872: { n:\"Feature11\" },\r\n    0x0874: { n:\"DropDownObjIds\" },\r\n    0x0875: { n:\"ContinueFrt11\" },\r\n    0x0876: { n:\"DConn\" },\r\n    0x0877: { n:\"List12\" },\r\n    0x0878: { n:\"Feature12\" },\r\n    0x0879: { n:\"CondFmt12\" },\r\n    0x087a: { n:\"CF12\" },\r\n    0x087b: { n:\"CFEx\" },\r\n    0x087c: { n:\"XFCRC\", f:parse_XFCRC, r:12 },\r\n    0x087d: { n:\"XFExt\", f:parse_XFExt, r:12 },\r\n    0x087e: { n:\"AutoFilter12\" },\r\n    0x087f: { n:\"ContinueFrt12\" },\r\n    0x0884: { n:\"MDTInfo\" },\r\n    0x0885: { n:\"MDXStr\" },\r\n    0x0886: { n:\"MDXTuple\" },\r\n    0x0887: { n:\"MDXSet\" },\r\n    0x0888: { n:\"MDXProp\" },\r\n    0x0889: { n:\"MDXKPI\" },\r\n    0x088a: { n:\"MDB\" },\r\n    0x088b: { n:\"PLV\" },\r\n    0x088c: { n:\"Compat12\", f:parsebool, r:12 },\r\n    0x088d: { n:\"DXF\" },\r\n    0x088e: { n:\"TableStyles\", r:12 },\r\n    0x088f: { n:\"TableStyle\" },\r\n    0x0890: { n:\"TableStyleElement\" },\r\n    0x0892: { n:\"StyleExt\" },\r\n    0x0893: { n:\"NamePublish\" },\r\n    0x0894: { n:\"NameCmt\", f:parse_NameCmt, r:12 },\r\n    0x0895: { n:\"SortData\" },\r\n    0x0896: { n:\"Theme\", f:parse_Theme, r:12 },\r\n    0x0897: { n:\"GUIDTypeLib\" },\r\n    0x0898: { n:\"FnGrp12\" },\r\n    0x0899: { n:\"NameFnGrp12\" },\r\n    0x089a: { n:\"MTRSettings\", f:parse_MTRSettings, r:12 },\r\n    0x089b: { n:\"CompressPictures\", f:parsenoop2 },\r\n    0x089c: { n:\"HeaderFooter\" },\r\n    0x089d: { n:\"CrtLayout12\" },\r\n    0x089e: { n:\"CrtMlFrt\" },\r\n    0x089f: { n:\"CrtMlFrtContinue\" },\r\n    0x08a3: { n:\"ForceFullCalculation\", f:parse_ForceFullCalculation },\r\n    0x08a4: { n:\"ShapePropsStream\" },\r\n    0x08a5: { n:\"TextPropsStream\" },\r\n    0x08a6: { n:\"RichTextStream\" },\r\n    0x08a7: { n:\"CrtLayout12A\" },\r\n    0x1001: { n:\"Units\" },\r\n    0x1002: { n:\"Chart\" },\r\n    0x1003: { n:\"Series\" },\r\n    0x1006: { n:\"DataFormat\" },\r\n    0x1007: { n:\"LineFormat\" },\r\n    0x1009: { n:\"MarkerFormat\" },\r\n    0x100a: { n:\"AreaFormat\" },\r\n    0x100b: { n:\"PieFormat\" },\r\n    0x100c: { n:\"AttachedLabel\" },\r\n    0x100d: { n:\"SeriesText\" },\r\n    0x1014: { n:\"ChartFormat\" },\r\n    0x1015: { n:\"Legend\" },\r\n    0x1016: { n:\"SeriesList\" },\r\n    0x1017: { n:\"Bar\" },\r\n    0x1018: { n:\"Line\" },\r\n    0x1019: { n:\"Pie\" },\r\n    0x101a: { n:\"Area\" },\r\n    0x101b: { n:\"Scatter\" },\r\n    0x101c: { n:\"CrtLine\" },\r\n    0x101d: { n:\"Axis\" },\r\n    0x101e: { n:\"Tick\" },\r\n    0x101f: { n:\"ValueRange\" },\r\n    0x1020: { n:\"CatSerRange\" },\r\n    0x1021: { n:\"AxisLine\" },\r\n    0x1022: { n:\"CrtLink\" },\r\n    0x1024: { n:\"DefaultText\" },\r\n    0x1025: { n:\"Text\" },\r\n    0x1026: { n:\"FontX\", f:parseuint16 },\r\n    0x1027: { n:\"ObjectLink\" },\r\n    0x1032: { n:\"Frame\" },\r\n    0x1033: { n:\"Begin\" },\r\n    0x1034: { n:\"End\" },\r\n    0x1035: { n:\"PlotArea\" },\r\n    0x103a: { n:\"Chart3d\" },\r\n    0x103c: { n:\"PicF\" },\r\n    0x103d: { n:\"DropBar\" },\r\n    0x103e: { n:\"Radar\" },\r\n    0x103f: { n:\"Surf\" },\r\n    0x1040: { n:\"RadarArea\" },\r\n    0x1041: { n:\"AxisParent\" },\r\n    0x1043: { n:\"LegendException\" },\r\n    0x1044: { n:\"ShtProps\", f:parse_ShtProps },\r\n    0x1045: { n:\"SerToCrt\" },\r\n    0x1046: { n:\"AxesUsed\" },\r\n    0x1048: { n:\"SBaseRef\" },\r\n    0x104a: { n:\"SerParent\" },\r\n    0x104b: { n:\"SerAuxTrend\" },\r\n    0x104e: { n:\"IFmtRecord\" },\r\n    0x104f: { n:\"Pos\" },\r\n    0x1050: { n:\"AlRuns\" },\r\n    0x1051: { n:\"BRAI\" },\r\n    0x105b: { n:\"SerAuxErrBar\" },\r\n    0x105c: { n:\"ClrtClient\", f:parse_ClrtClient },\r\n    0x105d: { n:\"SerFmt\" },\r\n    0x105f: { n:\"Chart3DBarShape\" },\r\n    0x1060: { n:\"Fbi\" },\r\n    0x1061: { n:\"BopPop\" },\r\n    0x1062: { n:\"AxcExt\" },\r\n    0x1063: { n:\"Dat\" },\r\n    0x1064: { n:\"PlotGrowth\" },\r\n    0x1065: { n:\"SIIndex\" },\r\n    0x1066: { n:\"GelFrame\" },\r\n    0x1067: { n:\"BopPopCustom\" },\r\n    0x1068: { n:\"Fbi2\" },\r\n\r\n    0x0000: { n:\"Dimensions\", f:parse_Dimensions },\r\n    0x0002: { n:\"BIFF2INT\", f:parse_BIFF2INT },\r\n    0x0005: { n:\"BoolErr\", f:parse_BoolErr },\r\n    0x0007: { n:\"String\", f:parse_BIFF2STRING },\r\n    0x0008: { n:\"BIFF2ROW\" },\r\n    0x000b: { n:\"Index\" },\r\n    0x0016: { n:\"ExternCount\", f:parseuint16 },\r\n    0x001e: { n:\"BIFF2FORMAT\", f:parse_BIFF2Format },\r\n    0x001f: { n:\"BIFF2FMTCNT\" }, /* 16-bit cnt of BIFF2FORMAT records */\r\n    0x0020: { n:\"BIFF2COLINFO\" },\r\n    0x0021: { n:\"Array\", f:parse_Array },\r\n    0x0025: { n:\"DefaultRowHeight\", f:parse_DefaultRowHeight },\r\n    0x0032: { n:\"BIFF2FONTXTRA\", f:parse_BIFF2FONTXTRA },\r\n    0x0034: { n:\"DDEObjName\" },\r\n    0x003e: { n:\"BIFF2WINDOW2\" },\r\n    0x0043: { n:\"BIFF2XF\" },\r\n    0x0045: { n:\"BIFF2FONTCLR\" },\r\n    0x0056: { n:\"BIFF4FMTCNT\" }, /* 16-bit cnt, similar to BIFF2 */\r\n    0x007e: { n:\"RK\" }, /* Not necessarily same as 0x027e */\r\n    0x007f: { n:\"ImData\", f:parse_ImData },\r\n    0x0087: { n:\"Addin\" },\r\n    0x0088: { n:\"Edg\" },\r\n    0x0089: { n:\"Pub\" },\r\n    0x0091: { n:\"Sub\" },\r\n    0x0094: { n:\"LHRecord\" },\r\n    0x0095: { n:\"LHNGraph\" },\r\n    0x0096: { n:\"Sound\" },\r\n    0x00a9: { n:\"CoordList\" },\r\n    0x00ab: { n:\"GCW\" },\r\n    0x00bc: { n:\"ShrFmla\" }, /* Not necessarily same as 0x04bc */\r\n    0x00bf: { n:\"ToolbarHdr\" },\r\n    0x00c0: { n:\"ToolbarEnd\" },\r\n    0x00c2: { n:\"AddMenu\" },\r\n    0x00c3: { n:\"DelMenu\" },\r\n    0x00d6: { n:\"RString\", f:parse_RString },\r\n    0x00df: { n:\"UDDesc\" },\r\n    0x00ea: { n:\"TabIdConf\" },\r\n    0x0162: { n:\"XL5Modify\" },\r\n    0x01a5: { n:\"FileSharing2\" },\r\n    0x0209: { n:'BOF', f:parse_BOF },\r\n    0x0218: { n:\"Lbl\", f:parse_Lbl },\r\n    0x0223: { n:\"ExternName\", f:parse_ExternName },\r\n    0x0231: { n:\"Font\" },\r\n    0x0243: { n:\"BIFF3XF\" },\r\n    0x0409: { n:'BOF', f:parse_BOF },\r\n    0x0443: { n:\"BIFF4XF\" },\r\n    0x086d: { n:\"FeatInfo\" },\r\n    0x0873: { n:\"FeatInfo11\" },\r\n    0x0881: { n:\"SXAddl12\" },\r\n    0x08c0: { n:\"AutoWebPub\" },\r\n    0x08c1: { n:\"ListObj\" },\r\n    0x08c2: { n:\"ListField\" },\r\n    0x08c3: { n:\"ListDV\" },\r\n    0x08c4: { n:\"ListCondFmt\" },\r\n    0x08c5: { n:\"ListCF\" },\r\n    0x08c6: { n:\"FMQry\" },\r\n    0x08c7: { n:\"FMSQry\" },\r\n    0x08c8: { n:\"PLV\" },\r\n    0x08c9: { n:\"LnExt\" },\r\n    0x08ca: { n:\"MkrExt\" },\r\n    0x08cb: { n:\"CrtCoopt\" },\r\n    0x08d6: { n:\"FRTArchId$\", r:12 },\r\n\r\n    0x7262: {}\r\n  };\r\n\r\n  var XLSRE = evert_key(XLSRecordEnum, 'n');\r\n  function write_biff_rec(ba, type, payload, length) {\r\n    var t = +type || +XLSRE[type];\r\n    if(isNaN(t)) return;\r\n    var len = length || (payload||[]).length || 0;\r\n    var o = ba.next(4);\r\n    o.write_shift(2, t);\r\n    o.write_shift(2, len);\r\n    if(len > 0 && is_buf(payload)) ba.push(payload);\r\n  }\r\n\r\n  function write_BIFF2Cell(out, r, c) {\r\n    if(!out) out = new_buf(7);\r\n    out.write_shift(2, r);\r\n    out.write_shift(2, c);\r\n    out.write_shift(2, 0);\r\n    out.write_shift(1, 0);\r\n    return out;\r\n  }\r\n\r\n  function write_BIFF2BERR(r, c, val, t) {\r\n    var out = new_buf(9);\r\n    write_BIFF2Cell(out, r, c);\r\n    if(t == 'e') { out.write_shift(1, val); out.write_shift(1, 1); }\r\n    else { out.write_shift(1, val?1:0); out.write_shift(1, 0); }\r\n    return out;\r\n  }\r\n\r\n  /* TODO: codepage, large strings */\r\n  function write_BIFF2LABEL(r, c, val) {\r\n    var out = new_buf(8 + 2*val.length);\r\n    write_BIFF2Cell(out, r, c);\r\n    out.write_shift(1, val.length);\r\n    out.write_shift(val.length, val, 'sbcs');\r\n    return out.l < out.length ? out.slice(0, out.l) : out;\r\n  }\r\n\r\n  function write_ws_biff2_cell(ba, cell, R, C) {\r\n    if(cell.v != null) switch(cell.t) {\r\n      case 'd': case 'n':\r\n        var v = cell.t == 'd' ? datenum(parseDate(cell.v)) : cell.v;\r\n        if((v == (v|0)) && (v >= 0) && (v < 65536))\r\n          write_biff_rec(ba, 0x0002, write_BIFF2INT(R, C, v));\r\n        else\r\n          write_biff_rec(ba, 0x0003, write_BIFF2NUM(R,C, v));\r\n        return;\r\n      case 'b': case 'e': write_biff_rec(ba, 0x0005, write_BIFF2BERR(R, C, cell.v, cell.t)); return;\r\n      /* TODO: codepage, sst */\r\n      case 's': case 'str':\r\n        write_biff_rec(ba, 0x0004, write_BIFF2LABEL(R, C, cell.v));\r\n        return;\r\n    }\r\n    write_biff_rec(ba, 0x0001, write_BIFF2Cell(null, R, C));\r\n  }\r\n\r\n  function write_ws_biff2(ba, ws, idx, opts) {\r\n    var dense = Array.isArray(ws);\r\n    var range = safe_decode_range(ws['!ref'] || \"A1\"), ref, rr = \"\", cols = [];\r\n    if(range.e.c > 0xFF || range.e.r > 0x3FFF) {\r\n      if(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:IV16384\");\r\n      range.e.c = Math.min(range.e.c, 0xFF);\r\n      range.e.r = Math.min(range.e.c, 0x3FFF);\r\n      ref = encode_range(range);\r\n    }\r\n    for(var R = range.s.r; R <= range.e.r; ++R) {\r\n      rr = encode_row(R);\r\n      for(var C = range.s.c; C <= range.e.c; ++C) {\r\n        if(R === range.s.r) cols[C] = encode_col(C);\r\n        ref = cols[C] + rr;\r\n        var cell = dense ? (ws[R]||[])[C] : ws[ref];\r\n        if(!cell) continue;\r\n        /* write cell */\r\n        write_ws_biff2_cell(ba, cell, R, C, opts);\r\n      }\r\n    }\r\n  }\r\n\r\n  /* Based on test files */\r\n  function write_biff2_buf(wb, opts) {\r\n    var o = opts || {};\r\n    if(DENSE != null && o.dense == null) o.dense = DENSE;\r\n    var ba = buf_array();\r\n    var idx = 0;\r\n    for(var i=0;i<wb.SheetNames.length;++i) if(wb.SheetNames[i] == o.sheet) idx=i;\r\n    if(idx == 0 && !!o.sheet && wb.SheetNames[0] != o.sheet) throw new Error(\"Sheet not found: \" + o.sheet);\r\n    write_biff_rec(ba, 0x0009, write_BOF(wb, 0x10, o));\r\n    /* ... */\r\n    write_ws_biff2(ba, wb.Sheets[wb.SheetNames[idx]], idx, o, wb);\r\n    /* ... */\r\n    write_biff_rec(ba, 0x000A);\r\n    return ba.end();\r\n  }\r\n\r\n  function write_FONTS_biff8(ba, data, opts) {\r\n    write_biff_rec(ba, \"Font\", write_Font({\r\n      sz:12,\r\n      color: {theme:1},\r\n      name: \"Arial\",\r\n      family: 2,\r\n      scheme: \"minor\"\r\n    }, opts));\r\n  }\r\n\r\n\r\n  function write_FMTS_biff8(ba, NF, opts) {\r\n    if(!NF) return;\r\n    [[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\r\n      for(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) write_biff_rec(ba, \"Format\", write_Format(i, NF[i], opts));\r\n    });\r\n  }\r\n\r\n  function write_FEAT(ba, ws) {\r\n    /* [MS-XLS] 2.4.112 */\r\n    var o = new_buf(19);\r\n    o.write_shift(4, 0x867); o.write_shift(4, 0); o.write_shift(4, 0);\r\n    o.write_shift(2, 3); o.write_shift(1, 1); o.write_shift(4, 0);\r\n    write_biff_rec(ba, \"FeatHdr\", o);\r\n    /* [MS-XLS] 2.4.111 */\r\n    o = new_buf(39);\r\n    o.write_shift(4, 0x868); o.write_shift(4, 0); o.write_shift(4, 0);\r\n    o.write_shift(2, 3); o.write_shift(1, 0); o.write_shift(4, 0);\r\n    o.write_shift(2, 1); o.write_shift(4, 4); o.write_shift(2, 0);\r\n    write_Ref8U(safe_decode_range(ws['!ref']||\"A1\"), o);\r\n    o.write_shift(4, 4);\r\n    write_biff_rec(ba, \"Feat\", o);\r\n  }\r\n\r\n  function write_CELLXFS_biff8(ba, opts) {\r\n    for(var i = 0; i < 16; ++i) write_biff_rec(ba, \"XF\", write_XF({numFmtId:0, style:true}, 0, opts));\r\n    opts.cellXfs.forEach(function(c) {\r\n      write_biff_rec(ba, \"XF\", write_XF(c, 0, opts));\r\n    });\r\n  }\r\n\r\n  function write_ws_biff8_hlinks(ba, ws) {\r\n    for(var R=0; R<ws['!links'].length; ++R) {\r\n      var HL = ws['!links'][R];\r\n      write_biff_rec(ba, \"HLink\", write_HLink(HL));\r\n      if(HL[1].Tooltip) write_biff_rec(ba, \"HLinkTooltip\", write_HLinkTooltip(HL));\r\n    }\r\n    delete ws['!links'];\r\n  }\r\n\r\n  function write_ws_biff8_cell(ba, cell, R, C, opts) {\r\n    var os = 16 + get_cell_style(opts.cellXfs, cell, opts);\r\n    if(cell.v != null) switch(cell.t) {\r\n      case 'd': case 'n':\r\n        var v = cell.t == 'd' ? datenum(parseDate(cell.v)) : cell.v;\r\n        /* TODO: emit RK as appropriate */\r\n        write_biff_rec(ba, \"Number\", write_Number(R, C, v, os, opts));\r\n        return;\r\n      case 'b': case 'e': write_biff_rec(ba, 0x0205, write_BoolErr(R, C, cell.v, os, opts, cell.t)); return;\r\n      /* TODO: codepage, sst */\r\n      case 's': case 'str':\r\n        write_biff_rec(ba, \"Label\", write_Label(R, C, cell.v, os, opts));\r\n        return;\r\n    }\r\n    write_biff_rec(ba, \"Blank\", write_XLSCell(R, C, os));\r\n  }\r\n\r\n  /* [MS-XLS] 2.1.7.20.5 */\r\n  function write_ws_biff8(idx, opts, wb) {\r\n    var ba = buf_array();\r\n    var s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};\r\n    var _WB = ((wb||{}).Workbook||{});\r\n    var _sheet = ((_WB.Sheets||[])[idx]||{});\r\n    var dense = Array.isArray(ws);\r\n    var b8 = opts.biff == 8;\r\n    var ref, rr = \"\", cols = [];\r\n    var range = safe_decode_range(ws['!ref'] || \"A1\");\r\n    var MAX_ROWS = b8 ? 65536 : 16384;\r\n    if(range.e.c > 0xFF || range.e.r >= MAX_ROWS) {\r\n      if(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:IV16384\");\r\n      range.e.c = Math.min(range.e.c, 0xFF);\r\n      range.e.r = Math.min(range.e.c, MAX_ROWS-1);\r\n    }\r\n\r\n    write_biff_rec(ba, 0x0809, write_BOF(wb, 0x10, opts));\r\n    /* ... */\r\n    write_biff_rec(ba, \"CalcMode\", writeuint16(1));\r\n    write_biff_rec(ba, \"CalcCount\", writeuint16(100));\r\n    write_biff_rec(ba, \"CalcRefMode\", writebool(true));\r\n    write_biff_rec(ba, \"CalcIter\", writebool(false));\r\n    write_biff_rec(ba, \"CalcDelta\", write_Xnum(0.001));\r\n    write_biff_rec(ba, \"CalcSaveRecalc\", writebool(true));\r\n    write_biff_rec(ba, \"PrintRowCol\", writebool(false));\r\n    write_biff_rec(ba, \"PrintGrid\", writebool(false));\r\n    write_biff_rec(ba, \"GridSet\", writeuint16(1));\r\n    write_biff_rec(ba, \"Guts\", write_Guts([0,0]));\r\n    /* ... */\r\n    write_biff_rec(ba, \"HCenter\", writebool(false));\r\n    write_biff_rec(ba, \"VCenter\", writebool(false));\r\n    /* ... */\r\n    write_biff_rec(ba, 0x200, write_Dimensions(range, opts));\r\n    /* ... */\r\n\r\n    if(b8) ws['!links'] = [];\r\n    for(var R = range.s.r; R <= range.e.r; ++R) {\r\n      rr = encode_row(R);\r\n      for(var C = range.s.c; C <= range.e.c; ++C) {\r\n        if(R === range.s.r) cols[C] = encode_col(C);\r\n        ref = cols[C] + rr;\r\n        var cell = dense ? (ws[R]||[])[C] : ws[ref];\r\n        if(!cell) continue;\r\n        /* write cell */\r\n        write_ws_biff8_cell(ba, cell, R, C, opts);\r\n        if(b8 && cell.l) ws['!links'].push([ref, cell.l]);\r\n      }\r\n    }\r\n    var cname = _sheet.CodeName || _sheet.name || s;\r\n    /* ... */\r\n    if(b8 && _WB.Views) write_biff_rec(ba, \"Window2\", write_Window2(_WB.Views[0]));\r\n    /* ... */\r\n    if(b8 && (ws['!merges']||[]).length) write_biff_rec(ba, \"MergeCells\", write_MergeCells(ws['!merges']));\r\n    /* ... */\r\n    if(b8) write_ws_biff8_hlinks(ba, ws);\r\n    /* ... */\r\n    write_biff_rec(ba, \"CodeName\", write_XLUnicodeString(cname, opts));\r\n    /* ... */\r\n    if(b8) write_FEAT(ba, ws);\r\n    /* ... */\r\n    write_biff_rec(ba, \"EOF\");\r\n    return ba.end();\r\n  }\r\n\r\n  /* [MS-XLS] 2.1.7.20.3 */\r\n  function write_biff8_global(wb, bufs, opts) {\r\n    var A = buf_array();\r\n    var _WB = ((wb||{}).Workbook||{});\r\n    var _sheets = (_WB.Sheets||[]);\r\n    var _wb = _WB.WBProps||{};\r\n    var b8 = opts.biff == 8, b5 = opts.biff == 5;\r\n    write_biff_rec(A, 0x0809, write_BOF(wb, 0x05, opts));\r\n    if(opts.bookType == \"xla\") write_biff_rec(A, \"Addin\");\r\n    write_biff_rec(A, \"InterfaceHdr\", b8 ? writeuint16(0x04b0) : null);\r\n    write_biff_rec(A, \"Mms\", writezeroes(2));\r\n    if(b5) write_biff_rec(A, \"ToolbarHdr\");\r\n    if(b5) write_biff_rec(A, \"ToolbarEnd\");\r\n    write_biff_rec(A, \"InterfaceEnd\");\r\n    write_biff_rec(A, \"WriteAccess\", write_WriteAccess(\"SheetJS\", opts));\r\n    write_biff_rec(A, \"CodePage\", writeuint16(b8 ? 0x04b0 : 0x04E4));\r\n    if(b8) write_biff_rec(A, \"DSF\", writeuint16(0));\r\n    if(b8) write_biff_rec(A, \"Excel9File\");\r\n    write_biff_rec(A, \"RRTabId\", write_RRTabId(wb.SheetNames.length));\r\n    if(b8 && wb.vbaraw) {\r\n      write_biff_rec(A, \"ObProj\");\r\n      var cname = _wb.CodeName || \"ThisWorkbook\";\r\n      write_biff_rec(A, \"CodeName\", write_XLUnicodeString(cname, opts));\r\n    }\r\n    write_biff_rec(A, \"BuiltInFnGroupCount\", writeuint16(0x11));\r\n    write_biff_rec(A, \"WinProtect\", writebool(false));\r\n    write_biff_rec(A, \"Protect\", writebool(false));\r\n    write_biff_rec(A, \"Password\", writeuint16(0));\r\n    if(b8) write_biff_rec(A, \"Prot4Rev\", writebool(false));\r\n    if(b8) write_biff_rec(A, \"Prot4RevPass\", writeuint16(0));\r\n    write_biff_rec(A, \"Window1\", write_Window1(opts));\r\n    write_biff_rec(A, \"Backup\", writebool(false));\r\n    write_biff_rec(A, \"HideObj\", writeuint16(0));\r\n    write_biff_rec(A, \"Date1904\", writebool(safe1904(wb)==\"true\"));\r\n    write_biff_rec(A, \"CalcPrecision\", writebool(true));\r\n    if(b8) write_biff_rec(A, \"RefreshAll\", writebool(false));\r\n    write_biff_rec(A, \"BookBool\", writeuint16(0));\r\n    /* ... */\r\n    write_FONTS_biff8(A, wb, opts);\r\n    write_FMTS_biff8(A, wb.SSF, opts);\r\n    write_CELLXFS_biff8(A, opts);\r\n    /* ... */\r\n    if(b8) write_biff_rec(A, \"UsesELFs\", writebool(false));\r\n    var a = A.end();\r\n\r\n    var C = buf_array();\r\n    if(b8) write_biff_rec(C, \"Country\", write_Country());\r\n    /* BIFF8: [SST *Continue] ExtSST */\r\n    write_biff_rec(C, \"EOF\");\r\n    var c = C.end();\r\n\r\n    var B = buf_array();\r\n    var blen = 0, j = 0;\r\n    for(j = 0; j < wb.SheetNames.length; ++j) blen += (b8 ? 12 : 11) + (b8 ? 2 : 1) * wb.SheetNames[j].length;\r\n    var start = a.length + blen + c.length;\r\n    for(j = 0; j < wb.SheetNames.length; ++j) {\r\n      var _sheet = _sheets[j] || ({});\r\n      write_biff_rec(B, \"BoundSheet8\", write_BoundSheet8({pos:start, hs:_sheet.Hidden||0, dt:0, name:wb.SheetNames[j]}, opts));\r\n      start += bufs[j].length;\r\n    }\r\n    /* 1*BoundSheet8 */\r\n    var b = B.end();\r\n    if(blen != b.length) throw new Error(\"BS8 \" + blen + \" != \" + b.length);\r\n\r\n    var out = [];\r\n    if(a.length) out.push(a);\r\n    if(b.length) out.push(b);\r\n    if(c.length) out.push(c);\r\n    return __toBuffer([out]);\r\n  }\r\n\r\n  /* [MS-XLS] 2.1.7.20 Workbook Stream */\r\n  function write_biff8_buf(wb, opts) {\r\n    var o = opts || {};\r\n    var bufs = [];\r\n\r\n    if(wb && !wb.SSF) {\r\n      wb.SSF = SSF.get_table();\r\n    }\r\n    if(wb && wb.SSF) {\r\n      make_ssf(SSF); SSF.load_table(wb.SSF);\r\n      // $FlowIgnore\r\n      o.revssf = evert_num(wb.SSF); o.revssf[wb.SSF[65535]] = 0;\r\n      o.ssf = wb.SSF;\r\n    }\r\n    o.cellXfs = [];\r\n    o.Strings = []; o.Strings.Count = 0; o.Strings.Unique = 0;\r\n    get_cell_style(o.cellXfs, {}, {revssf:{\"General\":0}});\r\n\r\n    for(var i = 0; i < wb.SheetNames.length; ++i) bufs[bufs.length] = write_ws_biff8(i, o, wb);\r\n    bufs.unshift(write_biff8_global(wb, bufs, o));\r\n    return __toBuffer([bufs]);\r\n  }\r\n\r\n  function write_biff_buf(wb, opts) {\r\n    var o = opts || {};\r\n    switch(o.biff || 2) {\r\n      case 8: case 5: return write_biff8_buf(wb, opts);\r\n      case 4: case 3: case 2: return write_biff2_buf(wb, opts);\r\n    }\r\n    throw new Error(\"invalid type \" + o.bookType + \" for BIFF\");\r\n  }\r\n  /* note: browser DOM element cannot see mso- style attrs, must parse */\r\n  var HTML_ = (function() {\r\n    function html_to_sheet(str, _opts) {\r\n      var opts = _opts || {};\r\n      if(DENSE != null && opts.dense == null) opts.dense = DENSE;\r\n      var ws = opts.dense ? ([]) : ({});\r\n      var mtch = str.match(/<table/i);\r\n      if(!mtch) throw new Error(\"Invalid HTML: could not find <table>\");\r\n      var mtch2 = str.match(/<\\/table/i);\r\n      var i = mtch.index, j = mtch2 && mtch2.index || str.length;\r\n      var rows = split_regex(str.slice(i, j), /(:?<tr[^>]*>)/i, \"<tr>\");\r\n      var R = -1, C = 0, RS = 0, CS = 0;\r\n      var range = {s:{r:10000000, c:10000000},e:{r:0,c:0}};\r\n      var merges = [];\r\n      for(i = 0; i < rows.length; ++i) {\r\n        var row = rows[i].trim();\r\n        var hd = row.slice(0,3).toLowerCase();\r\n        if(hd == \"<tr\") { ++R; if(opts.sheetRows && opts.sheetRows <= R) { --R; break; } C = 0; continue; }\r\n        if(hd != \"<td\" && hd != \"<th\") continue;\r\n        var cells = row.split(/<\\/t[dh]>/i);\r\n        for(j = 0; j < cells.length; ++j) {\r\n          var cell = cells[j].trim();\r\n          if(!cell.match(/<t[dh]/i)) continue;\r\n          var m = cell, cc = 0;\r\n          /* TODO: parse styles etc */\r\n          while(m.charAt(0) == \"<\" && (cc = m.indexOf(\">\")) > -1) m = m.slice(cc+1);\r\n          var tag = parsexmltag(cell.slice(0, cell.indexOf(\">\")));\r\n          CS = tag.colspan ? +tag.colspan : 1;\r\n          if((RS = +tag.rowspan)>1 || CS>1) merges.push({s:{r:R,c:C},e:{r:R + (RS||1) - 1, c:C + CS - 1}});\r\n          var _t = tag.t || \"\";\r\n          /* TODO: generate stub cells */\r\n          if(!m.length) { C += CS; continue; }\r\n          m = htmldecode(m);\r\n          if(range.s.r > R) range.s.r = R; if(range.e.r < R) range.e.r = R;\r\n          if(range.s.c > C) range.s.c = C; if(range.e.c < C) range.e.c = C;\r\n          if(!m.length) continue;\r\n          var o = {t:'s', v:m};\r\n          if(opts.raw || !m.trim().length || _t == 's'){}\r\n          else if(m === 'TRUE') o = {t:'b', v:true};\r\n          else if(m === 'FALSE') o = {t:'b', v:false};\r\n          else if(!isNaN(fuzzynum(m))) o = {t:'n', v:fuzzynum(m)};\r\n          else if(!isNaN(fuzzydate(m).getDate())) {\r\n            o = ({t:'d', v:parseDate(m)});\r\n            if(!opts.cellDates) o = ({t:'n', v:datenum(o.v)});\r\n            o.z = opts.dateNF || SSF._table[14];\r\n          }\r\n          if(opts.dense) { if(!ws[R]) ws[R] = []; ws[R][C] = o; }\r\n          else ws[encode_cell({r:R, c:C})] = o;\r\n          C += CS;\r\n        }\r\n      }\r\n      ws['!ref'] = encode_range(range);\r\n      return ws;\r\n    }\r\n    function html_to_book(str, opts) {\r\n      return sheet_to_workbook(html_to_sheet(str, opts), opts);\r\n    }\r\n    function make_html_row(ws, r, R, o) {\r\n      var M = (ws['!merges'] ||[]);\r\n      var oo = [];\r\n      for(var C = r.s.c; C <= r.e.c; ++C) {\r\n        var RS = 0, CS = 0;\r\n        for(var j = 0; j < M.length; ++j) {\r\n          if(M[j].s.r > R || M[j].s.c > C) continue;\r\n          if(M[j].e.r < R || M[j].e.c < C) continue;\r\n          if(M[j].s.r < R || M[j].s.c < C) { RS = -1; break; }\r\n          RS = M[j].e.r - M[j].s.r + 1; CS = M[j].e.c - M[j].s.c + 1; break;\r\n        }\r\n        if(RS < 0) continue;\r\n        var coord = encode_cell({r:R,c:C});\r\n        var cell = o.dense ? (ws[R]||[])[C] : ws[coord];\r\n        var sp = {};\r\n        if(RS > 1) sp.rowspan = RS;\r\n        if(CS > 1) sp.colspan = CS;\r\n        /* TODO: html entities */\r\n        var w = (cell && cell.v != null) && (cell.h || escapehtml(cell.w || (format_cell(cell), cell.w) || \"\")) || \"\";\r\n        sp.t = cell && cell.t || 'z';\r\n        if(o.editable) w = '<span contenteditable=\"true\">' + w + '</span>';\r\n        sp.id = \"sjs-\" + coord;\r\n        oo.push(writextag('td', w, sp));\r\n      }\r\n      var preamble = \"<tr>\";\r\n      return preamble + oo.join(\"\") + \"</tr>\";\r\n    }\r\n    function make_html_preamble(ws, R, o) {\r\n      var out = [];\r\n      return out.join(\"\") + '<table' + (o && o.id ? ' id=\"' + o.id + '\"' : \"\") + '>';\r\n    }\r\n    var _BEGIN = '<html><head><meta charset=\"utf-8\"/><title>SheetJS Table Export</title></head><body>';\r\n    var _END = '</body></html>';\r\n    function sheet_to_html(ws, opts/*, wb:?Workbook*/) {\r\n      var o = opts || {};\r\n      var header = o.header != null ? o.header : _BEGIN;\r\n      var footer = o.footer != null ? o.footer : _END;\r\n      var out = [header];\r\n      var r = decode_range(ws['!ref']);\r\n      o.dense = Array.isArray(ws);\r\n      out.push(make_html_preamble(ws, r, o));\r\n      for(var R = r.s.r; R <= r.e.r; ++R) out.push(make_html_row(ws, r, R, o));\r\n      out.push(\"</table>\" + footer);\r\n      return out.join(\"\");\r\n    }\r\n\r\n    return {\r\n      to_workbook: html_to_book,\r\n      to_sheet: html_to_sheet,\r\n      _row: make_html_row,\r\n      BEGIN: _BEGIN,\r\n      END: _END,\r\n      _preamble: make_html_preamble,\r\n      from_sheet: sheet_to_html\r\n    };\r\n  })();\r\n\r\n  function parse_dom_table(table, _opts) {\r\n    var opts = _opts || {};\r\n    if(DENSE != null) opts.dense = DENSE;\r\n    var ws = opts.dense ? ([]) : ({});\r\n    var rows = table.getElementsByTagName('tr');\r\n    var sheetRows = opts.sheetRows || 10000000;\r\n    var range = {s:{r:0,c:0},e:{r:0,c:0}};\r\n    var merges = [], midx = 0;\r\n    var rowinfo = [];\r\n    var _R = 0, R = 0, _C, C, RS, CS;\r\n    for(; _R < rows.length && R < sheetRows; ++_R) {\r\n      var row = rows[_R];\r\n      if (is_dom_element_hidden(row)) {\r\n        if (opts.display) continue;\r\n        rowinfo[R] = {hidden: true};\r\n      }\r\n      var elts = (row.children);\r\n      for(_C = C = 0; _C < elts.length; ++_C) {\r\n        var elt = elts[_C];\r\n        if (opts.display && is_dom_element_hidden(elt)) continue;\r\n        var v = htmldecode(elt.innerHTML);\r\n        for(midx = 0; midx < merges.length; ++midx) {\r\n          var m = merges[midx];\r\n          if(m.s.c == C && m.s.r <= R && R <= m.e.r) { C = m.e.c+1; midx = -1; }\r\n        }\r\n        /* TODO: figure out how to extract nonstandard mso- style */\r\n        CS = +elt.getAttribute(\"colspan\") || 1;\r\n        if((RS = +elt.getAttribute(\"rowspan\"))>0 || CS>1) merges.push({s:{r:R,c:C},e:{r:R + (RS||1) - 1, c:C + CS - 1}});\r\n        var o = {t:'s', v:v};\r\n        var _t = elt.getAttribute(\"t\") || \"\";\r\n        if(v != null) {\r\n          if(v.length == 0) o.t = _t || 'z';\r\n          else if(opts.raw || v.trim().length == 0 || _t == \"s\"){}\r\n          else if(v === 'TRUE') o = {t:'b', v:true};\r\n          else if(v === 'FALSE') o = {t:'b', v:false};\r\n          else if(!isNaN(fuzzynum(v))) o = {t:'n', v:fuzzynum(v)};\r\n          else if(!isNaN(fuzzydate(v).getDate())) {\r\n            o = ({t:'d', v:parseDate(v)});\r\n            if(!opts.cellDates) o = ({t:'n', v:datenum(o.v)});\r\n            o.z = opts.dateNF || SSF._table[14];\r\n          }\r\n        }\r\n        if(opts.dense) { if(!ws[R]) ws[R] = []; ws[R][C] = o; }\r\n        else ws[encode_cell({c:C, r:R})] = o;\r\n        if(range.e.c < C) range.e.c = C;\r\n        C += CS;\r\n      }\r\n      ++R;\r\n    }\r\n    if(merges.length) ws['!merges'] = merges;\r\n    if(rowinfo.length) ws['!rows'] = rowinfo;\r\n    range.e.r = R - 1;\r\n    ws['!ref'] = encode_range(range);\r\n    if(R >= sheetRows) ws['!fullref'] = encode_range((range.e.r = rows.length-_R+R-1,range)); // We can count the real number of rows to parse but we don't to improve the performance\r\n    return ws;\r\n  }\r\n\r\n  function table_to_book(table, opts) {\r\n    return sheet_to_workbook(parse_dom_table(table, opts), opts);\r\n  }\r\n\r\n  function is_dom_element_hidden(element) {\r\n    var display = '';\r\n    var get_computed_style = get_get_computed_style_function(element);\r\n    if(get_computed_style) display = get_computed_style(element).getPropertyValue('display');\r\n    if(!display) display = element.style.display; // Fallback for cases when getComputedStyle is not available (e.g. an old browser or some Node.js environments) or doesn't work (e.g. if the element is not inserted to a document)\r\n    return display === 'none';\r\n  }\r\n\r\n  /* global getComputedStyle */\r\n  function get_get_computed_style_function(element) {\r\n    // The proper getComputedStyle implementation is the one defined in the element window\r\n    if(element.ownerDocument.defaultView && typeof element.ownerDocument.defaultView.getComputedStyle === 'function') return element.ownerDocument.defaultView.getComputedStyle;\r\n    // If it is not available, try to get one from the global namespace\r\n    if(typeof getComputedStyle === 'function') return getComputedStyle;\r\n    return null;\r\n  }\r\n  /* OpenDocument */\r\n  var parse_content_xml = (function() {\r\n\r\n    var parse_text_p = function(text) {\r\n      /* 6.1.2 White Space Characters */\r\n      var fixed = text\r\n        .replace(/[\\t\\r\\n]/g, \" \").trim().replace(/ +/g, \" \")\r\n        .replace(/<text:s\\/>/g,\" \")\r\n        .replace(/<text:s text:c=\"(\\d+)\"\\/>/g, function($$,$1) { return Array(parseInt($1,10)+1).join(\" \"); })\r\n        .replace(/<text:tab[^>]*\\/>/g,\"\\t\")\r\n        .replace(/<text:line-break\\/>/g,\"\\n\");\r\n      var v = unescapexml(fixed.replace(/<[^>]*>/g,\"\"));\r\n\r\n      return [v];\r\n    };\r\n\r\n    var number_formats = {\r\n      /* ods name: [short ssf fmt, long ssf fmt] */\r\n      day:           [\"d\",   \"dd\"],\r\n      month:         [\"m\",   \"mm\"],\r\n      year:          [\"y\",   \"yy\"],\r\n      hours:         [\"h\",   \"hh\"],\r\n      minutes:       [\"m\",   \"mm\"],\r\n      seconds:       [\"s\",   \"ss\"],\r\n      \"am-pm\":       [\"A/P\", \"AM/PM\"],\r\n      \"day-of-week\": [\"ddd\", \"dddd\"],\r\n      era:           [\"e\",   \"ee\"],\r\n      /* there is no native representation of LO \"Q\" format */\r\n      quarter:       [\"\\\\Qm\", \"m\\\\\\\"th quarter\\\"\"]\r\n    };\r\n\r\n    return function pcx(d, _opts) {\r\n      var opts = _opts || {};\r\n      if(DENSE != null && opts.dense == null) opts.dense = DENSE;\r\n      var str = xlml_normalize(d);\r\n      var state = [], tmp;\r\n      var tag;\r\n      var NFtag = {name:\"\"}, NF = \"\", pidx = 0;\r\n      var sheetag;\r\n      var rowtag;\r\n      var Sheets = {}, SheetNames = [];\r\n      var ws = opts.dense ? ([]) : ({});\r\n      var Rn, q;\r\n      var ctag = ({value:\"\"});\r\n      var textp = \"\", textpidx = 0, textptag;\r\n      var textR = [];\r\n      var R = -1, C = -1, range = {s: {r:1000000,c:10000000}, e: {r:0, c:0}};\r\n      var row_ol = 0;\r\n      var number_format_map = {};\r\n      var merges = [], mrange = {}, mR = 0, mC = 0;\r\n      var rowinfo = [], rowpeat = 1, colpeat = 1;\r\n      var arrayf = [];\r\n      var WB = {Names:[]};\r\n      var atag = ({});\r\n      var _Ref = [\"\", \"\"];\r\n      var comments = [], comment = ({});\r\n      var creator = \"\", creatoridx = 0;\r\n      var isstub = false, intable = false;\r\n      var i = 0;\r\n      xlmlregex.lastIndex = 0;\r\n      str = str.replace(/<!--([\\s\\S]*?)-->/mg,\"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm,\"\");\r\n      while((Rn = xlmlregex.exec(str))) switch((Rn[3]=Rn[3].replace(/_.*$/,\"\"))) {\r\n\r\n        case 'table': case '': // 9.1.2 <table:table>\r\n          if(Rn[1]==='/') {\r\n            if(range.e.c >= range.s.c && range.e.r >= range.s.r) ws['!ref'] = encode_range(range);\r\n            if(opts.sheetRows > 0 && opts.sheetRows <= range.e.r) {\r\n              ws['!fullref'] = ws['!ref'];\r\n              range.e.r = opts.sheetRows - 1;\r\n              ws['!ref'] = encode_range(range);\r\n            }\r\n            if(merges.length) ws['!merges'] = merges;\r\n            if(rowinfo.length) ws[\"!rows\"] = rowinfo;\r\n            sheetag.name = sheetag[''] || sheetag.name;\r\n            if(typeof JSON !== 'undefined') JSON.stringify(sheetag);\r\n            SheetNames.push(sheetag.name);\r\n            Sheets[sheetag.name] = ws;\r\n            intable = false;\r\n          }\r\n          else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\r\n            sheetag = parsexmltag(Rn[0], false);\r\n            R = C = -1;\r\n            range.s.r = range.s.c = 10000000; range.e.r = range.e.c = 0;\r\n            ws = opts.dense ? ([]) : ({}); merges = [];\r\n            rowinfo = [];\r\n            intable = true;\r\n          }\r\n          break;\r\n\r\n        case 'table-row-group': // 9.1.9 <table:table-row-group>\r\n          if(Rn[1] === \"/\") --row_ol; else ++row_ol;\r\n          break;\r\n        case 'table-row': case '': // 9.1.3 <table:table-row>\r\n          if(Rn[1] === '/') { R+=rowpeat; rowpeat = 1; break; }\r\n          rowtag = parsexmltag(Rn[0], false);\r\n          if(rowtag['']) R = rowtag[''] - 1; else if(R == -1) R = 0;\r\n          rowpeat = +rowtag['number-rows-repeated'] || 1;\r\n          /* TODO: remove magic */\r\n          if(rowpeat < 10) for(i = 0; i < rowpeat; ++i) if(row_ol > 0) rowinfo[R + i] = {level: row_ol};\r\n          C = -1; break;\r\n        case 'covered-table-cell': // 9.1.5 <table:covered-table-cell>\r\n          if(Rn[1] !== '/') ++C;\r\n          if(opts.sheetStubs) {\r\n            if(opts.dense) { if(!ws[R]) ws[R] = []; ws[R][C] = {t:'z'}; }\r\n            else ws[encode_cell({r:R,c:C})] = {t:'z'};\r\n          }\r\n          textp = \"\"; textR = [];\r\n          break; /* stub */\r\n        case 'table-cell': case '':\r\n          if(Rn[0].charAt(Rn[0].length-2) === '/') {\r\n            ++C;\r\n            ctag = parsexmltag(Rn[0], false);\r\n            colpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10);\r\n            q = ({t:'z', v:null});\r\n            if(ctag.formula && opts.cellFormula != false) q.f = ods_to_csf_formula(unescapexml(ctag.formula));\r\n            if((ctag[''] || ctag['value-type']) == \"string\") {\r\n              q.t = \"s\"; q.v = unescapexml(ctag['string-value'] || \"\");\r\n              if(opts.dense) {\r\n                if(!ws[R]) ws[R] = [];\r\n                ws[R][C] = q;\r\n              } else {\r\n                ws[encode_cell({r:R,c:C})] = q;\r\n              }\r\n            }\r\n            C+= colpeat-1;\r\n          } else if(Rn[1]!=='/') {\r\n            ++C;\r\n            colpeat = 1;\r\n            var rptR = rowpeat ? R + rowpeat - 1 : R;\r\n            if(C > range.e.c) range.e.c = C;\r\n            if(C < range.s.c) range.s.c = C;\r\n            if(R < range.s.r) range.s.r = R;\r\n            if(rptR > range.e.r) range.e.r = rptR;\r\n            ctag = parsexmltag(Rn[0], false);\r\n            comments = []; comment = ({});\r\n            q = ({t:ctag[''] || ctag['value-type'], v:null});\r\n            if(opts.cellFormula) {\r\n              if(ctag.formula) ctag.formula = unescapexml(ctag.formula);\r\n              if(ctag['number-matrix-columns-spanned'] && ctag['number-matrix-rows-spanned']) {\r\n                mR = parseInt(ctag['number-matrix-rows-spanned'],10) || 0;\r\n                mC = parseInt(ctag['number-matrix-columns-spanned'],10) || 0;\r\n                mrange = {s: {r:R,c:C}, e:{r:R + mR-1,c:C + mC-1}};\r\n                q.F = encode_range(mrange);\r\n                arrayf.push([mrange, q.F]);\r\n              }\r\n              if(ctag.formula) q.f = ods_to_csf_formula(ctag.formula);\r\n              else for(i = 0; i < arrayf.length; ++i)\r\n                if(R >= arrayf[i][0].s.r && R <= arrayf[i][0].e.r)\r\n                  if(C >= arrayf[i][0].s.c && C <= arrayf[i][0].e.c)\r\n                    q.F = arrayf[i][1];\r\n            }\r\n            if(ctag['number-columns-spanned'] || ctag['number-rows-spanned']) {\r\n              mR = parseInt(ctag['number-rows-spanned'],10) || 0;\r\n              mC = parseInt(ctag['number-columns-spanned'],10) || 0;\r\n              mrange = {s: {r:R,c:C}, e:{r:R + mR-1,c:C + mC-1}};\r\n              merges.push(mrange);\r\n            }\r\n\r\n            /* 19.675.2 table:number-columns-repeated */\r\n            if(ctag['number-columns-repeated']) colpeat = parseInt(ctag['number-columns-repeated'], 10);\r\n\r\n            /* 19.385 office:value-type */\r\n            switch(q.t) {\r\n              case 'boolean': q.t = 'b'; q.v = parsexmlbool(ctag['boolean-value']); break;\r\n              case 'float': q.t = 'n'; q.v = parseFloat(ctag.value); break;\r\n              case 'percentage': q.t = 'n'; q.v = parseFloat(ctag.value); break;\r\n              case 'currency': q.t = 'n'; q.v = parseFloat(ctag.value); break;\r\n              case 'date': q.t = 'd'; q.v = parseDate(ctag['date-value']);\r\n                if(!opts.cellDates) { q.t = 'n'; q.v = datenum(q.v); }\r\n                q.z = 'm/d/yy'; break;\r\n              case 'time': q.t = 'n'; q.v = parse_isodur(ctag['time-value'])/86400; break;\r\n              case 'number': q.t = 'n'; q.v = parseFloat(ctag['']); break;\r\n              default:\r\n                if(q.t === 'string' || q.t === 'text' || !q.t) {\r\n                  q.t = 's';\r\n                  if(ctag['string-value'] != null) { textp = unescapexml(ctag['string-value']); textR = []; }\r\n                } else throw new Error('Unsupported value type ' + q.t);\r\n            }\r\n          } else {\r\n            isstub = false;\r\n            if(q.t === 's') {\r\n              q.v = textp || '';\r\n              if(textR.length) q.R = textR;\r\n              isstub = textpidx == 0;\r\n            }\r\n            if(atag.Target) q.l = atag;\r\n            if(comments.length > 0) { q.c = comments; comments = []; }\r\n            if(textp && opts.cellText !== false) q.w = textp;\r\n            if(!isstub || opts.sheetStubs) {\r\n              if(!(opts.sheetRows && opts.sheetRows <= R)) {\r\n                for(var rpt = 0; rpt < rowpeat; ++rpt) {\r\n                  colpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10);\r\n                  if(opts.dense) {\r\n                    if(!ws[R + rpt]) ws[R + rpt] = [];\r\n                    ws[R + rpt][C] = rpt == 0 ? q : dup(q);\r\n                    while(--colpeat > 0) ws[R + rpt][C + colpeat] = dup(q);\r\n                  } else {\r\n                    ws[encode_cell({r:R + rpt,c:C})] = q;\r\n                    while(--colpeat > 0) ws[encode_cell({r:R + rpt,c:C + colpeat})] = dup(q);\r\n                  }\r\n                  if(range.e.c <= C) range.e.c = C;\r\n                }\r\n              }\r\n            }\r\n            colpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10);\r\n            C += colpeat-1; colpeat = 0;\r\n            q = {};\r\n            textp = \"\"; textR = [];\r\n          }\r\n          atag = ({});\r\n          break; // 9.1.4 <table:table-cell>\r\n\r\n        /* pure state */\r\n        case 'document': // TODO: <office:document> is the root for FODS\r\n        case 'document-content': case '': // 3.1.3.2 <office:document-content>\r\n        case 'spreadsheet': case '': // 3.7 <office:spreadsheet>\r\n        case 'scripts': // 3.12 <office:scripts>\r\n        case 'styles': // TODO <office:styles>\r\n        case 'font-face-decls': // 3.14 <office:font-face-decls>\r\n          if(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\r\n          else if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\r\n          break;\r\n\r\n        case 'annotation': // 14.1 <office:annotation>\r\n          if(Rn[1]==='/'){\r\n            if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\r\n            comment.t = textp;\r\n            if(textR.length) comment.R = textR;\r\n            comment.a = creator;\r\n            comments.push(comment);\r\n          }\r\n          else if(Rn[0].charAt(Rn[0].length-2) !== '/') {state.push([Rn[3], false]);}\r\n          creator = \"\"; creatoridx = 0;\r\n          textp = \"\"; textpidx = 0; textR = [];\r\n          break;\r\n\r\n        case 'creator': // 4.3.2.7 <dc:creator>\r\n          if(Rn[1]==='/') { creator = str.slice(creatoridx,Rn.index); }\r\n          else creatoridx = Rn.index + Rn[0].length;\r\n          break;\r\n\r\n        /* ignore state */\r\n        case 'meta': case '': // TODO: <office:meta> <uof:> FODS/UOF\r\n        case 'settings': // TODO: <office:settings>\r\n        case 'config-item-set': // TODO: <office:config-item-set>\r\n        case 'config-item-map-indexed': // TODO: <office:config-item-map-indexed>\r\n        case 'config-item-map-entry': // TODO: <office:config-item-map-entry>\r\n        case 'config-item-map-named': // TODO: <office:config-item-map-entry>\r\n        case 'shapes': // 9.2.8 <table:shapes>\r\n        case 'frame': // 10.4.2 <draw:frame>\r\n        case 'text-box': // 10.4.3 <draw:text-box>\r\n        case 'image': // 10.4.4 <draw:image>\r\n        case 'data-pilot-tables': // 9.6.2 <table:data-pilot-tables>\r\n        case 'list-style': // 16.30 <text:list-style>\r\n        case 'form': // 13.13 <form:form>\r\n        case 'dde-links': // 9.8 <table:dde-links>\r\n        case 'event-listeners': // TODO\r\n        case 'chart': // TODO\r\n          if(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\r\n          else if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], false]);\r\n          textp = \"\"; textpidx = 0; textR = [];\r\n          break;\r\n\r\n        case 'scientific-number': // TODO: <number:scientific-number>\r\n          break;\r\n        case 'currency-symbol': // TODO: <number:currency-symbol>\r\n          break;\r\n        case 'currency-style': // TODO: <number:currency-style>\r\n          break;\r\n        case 'number-style': // 16.27.2 <number:number-style>\r\n        case 'percentage-style': // 16.27.9 <number:percentage-style>\r\n        case 'date-style': // 16.27.10 <number:date-style>\r\n        case 'time-style': // 16.27.18 <number:time-style>\r\n          if(Rn[1]==='/'){\r\n            number_format_map[NFtag.name] = NF;\r\n            if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\r\n          } else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\r\n            NF = \"\";\r\n            NFtag = parsexmltag(Rn[0], false);\r\n            state.push([Rn[3], true]);\r\n          } break;\r\n\r\n        case 'script': break; // 3.13 <office:script>\r\n        case 'libraries': break; // TODO: <ooo:libraries>\r\n        case 'automatic-styles': break; // 3.15.3 <office:automatic-styles>\r\n        case 'master-styles': break; // TODO: <office:master-styles>\r\n\r\n        case 'default-style': // TODO: <style:default-style>\r\n        case 'page-layout': break; // TODO: <style:page-layout>\r\n        case 'style': // 16.2 <style:style>\r\n          break;\r\n        case 'map': break; // 16.3 <style:map>\r\n        case 'font-face': break; // 16.21 <style:font-face>\r\n\r\n        case 'paragraph-properties': break; // 17.6 <style:paragraph-properties>\r\n        case 'table-properties': break; // 17.15 <style:table-properties>\r\n        case 'table-column-properties': break; // 17.16 <style:table-column-properties>\r\n        case 'table-row-properties': break; // 17.17 <style:table-row-properties>\r\n        case 'table-cell-properties': break; // 17.18 <style:table-cell-properties>\r\n\r\n        case 'number': // 16.27.3 <number:number>\r\n          switch(state[state.length-1][0]) {\r\n            case 'time-style':\r\n            case 'date-style':\r\n              tag = parsexmltag(Rn[0], false);\r\n              NF += number_formats[Rn[3]][tag.style==='long'?1:0]; break;\r\n          } break;\r\n\r\n        case 'fraction': break; // TODO 16.27.6 <number:fraction>\r\n\r\n        case 'day': // 16.27.11 <number:day>\r\n        case 'month': // 16.27.12 <number:month>\r\n        case 'year': // 16.27.13 <number:year>\r\n        case 'era': // 16.27.14 <number:era>\r\n        case 'day-of-week': // 16.27.15 <number:day-of-week>\r\n        case 'week-of-year': // 16.27.16 <number:week-of-year>\r\n        case 'quarter': // 16.27.17 <number:quarter>\r\n        case 'hours': // 16.27.19 <number:hours>\r\n        case 'minutes': // 16.27.20 <number:minutes>\r\n        case 'seconds': // 16.27.21 <number:seconds>\r\n        case 'am-pm': // 16.27.22 <number:am-pm>\r\n          switch(state[state.length-1][0]) {\r\n            case 'time-style':\r\n            case 'date-style':\r\n              tag = parsexmltag(Rn[0], false);\r\n              NF += number_formats[Rn[3]][tag.style==='long'?1:0]; break;\r\n          } break;\r\n\r\n        case 'boolean-style': break; // 16.27.23 <number:boolean-style>\r\n        case 'boolean': break; // 16.27.24 <number:boolean>\r\n        case 'text-style': break; // 16.27.25 <number:text-style>\r\n        case 'text': // 16.27.26 <number:text>\r\n          if(Rn[0].slice(-2) === \"/>\") break;\r\n          else if(Rn[1]===\"/\") switch(state[state.length-1][0]) {\r\n            case 'number-style':\r\n            case 'date-style':\r\n            case 'time-style':\r\n              NF += str.slice(pidx, Rn.index);\r\n              break;\r\n          }\r\n          else pidx = Rn.index + Rn[0].length;\r\n          break;\r\n\r\n        case 'named-range': // 9.4.12 <table:named-range>\r\n          tag = parsexmltag(Rn[0], false);\r\n          _Ref = ods_to_csf_3D(tag['cell-range-address']);\r\n          var nrange = ({Name:tag.name, Ref:_Ref[0] + '!' + _Ref[1]});\r\n          if(intable) nrange.Sheet = SheetNames.length;\r\n          WB.Names.push(nrange);\r\n          break;\r\n\r\n        case 'text-content': break; // 16.27.27 <number:text-content>\r\n        case 'text-properties': break; // 16.27.27 <style:text-properties>\r\n        case 'embedded-text': break; // 16.27.4 <number:embedded-text>\r\n\r\n        case 'body': case '': break; // 3.3 16.9.6 19.726.3\r\n\r\n        case 'forms': break; // 12.25.2 13.2\r\n        case 'table-column': break; // 9.1.6 <table:table-column>\r\n        case 'table-header-rows': break; // 9.1.7 <table:table-header-rows>\r\n        case 'table-rows': break; // 9.1.12 <table:table-rows>\r\n        /* TODO: outline levels */\r\n        case 'table-column-group': break; // 9.1.10 <table:table-column-group>\r\n        case 'table-header-columns': break; // 9.1.11 <table:table-header-columns>\r\n        case 'table-columns': break; // 9.1.12 <table:table-columns>\r\n\r\n        case 'null-date': break; // 9.4.2 <table:null-date> TODO: date1904\r\n\r\n        case 'graphic-properties': break; // 17.21 <style:graphic-properties>\r\n        case 'calculation-settings': break; // 9.4.1 <table:calculation-settings>\r\n        case 'named-expressions': break; // 9.4.11 <table:named-expressions>\r\n        case 'label-range': break; // 9.4.9 <table:label-range>\r\n        case 'label-ranges': break; // 9.4.10 <table:label-ranges>\r\n        case 'named-expression': break; // 9.4.13 <table:named-expression>\r\n        case 'sort': break; // 9.4.19 <table:sort>\r\n        case 'sort-by': break; // 9.4.20 <table:sort-by>\r\n        case 'sort-groups': break; // 9.4.22 <table:sort-groups>\r\n\r\n        case 'tab': break; // 6.1.4 <text:tab>\r\n        case 'line-break': break; // 6.1.5 <text:line-break>\r\n        case 'span': break; // 6.1.7 <text:span>\r\n        case 'p': case '': // 5.1.3 <text:p>\r\n          if(Rn[1]==='/' && (!ctag || !ctag['string-value'])) {\r\n            var ptp = parse_text_p(str.slice(textpidx,Rn.index), textptag);\r\n            textp = (textp.length > 0 ? textp + \"\\n\" : \"\") + ptp[0];\r\n          } else { textptag = parsexmltag(Rn[0], false); textpidx = Rn.index + Rn[0].length; }\r\n          break; // <text:p>\r\n        case 's': break; // <text:s>\r\n\r\n        case 'database-range': // 9.4.15 <table:database-range>\r\n          if(Rn[1]==='/') break;\r\n          try {\r\n            _Ref = ods_to_csf_3D(parsexmltag(Rn[0])['target-range-address']);\r\n            Sheets[_Ref[0]]['!autofilter'] = { ref:_Ref[1] };\r\n          } catch(e) {/* empty */}\r\n          break;\r\n\r\n        case 'date': break; // <*:date>\r\n\r\n        case 'object': break; // 10.4.6.2 <draw:object>\r\n        case 'title': case '': break; // <*:title> OR <uof:>\r\n        case 'desc': break; // <*:desc>\r\n        case 'binary-data': break; // 10.4.5 TODO: b64 blob\r\n\r\n        /* 9.2 Advanced Tables */\r\n        case 'table-source': break; // 9.2.6\r\n        case 'scenario': break; // 9.2.6\r\n\r\n        case 'iteration': break; // 9.4.3 <table:iteration>\r\n        case 'content-validations': break; // 9.4.4 <table:\r\n        case 'content-validation': break; // 9.4.5 <table:\r\n        case 'help-message': break; // 9.4.6 <table:\r\n        case 'error-message': break; // 9.4.7 <table:\r\n        case 'database-ranges': break; // 9.4.14 <table:database-ranges>\r\n        case 'filter': break; // 9.5.2 <table:filter>\r\n        case 'filter-and': break; // 9.5.3 <table:filter-and>\r\n        case 'filter-or': break; // 9.5.4 <table:filter-or>\r\n        case 'filter-condition': break; // 9.5.5 <table:filter-condition>\r\n\r\n        case 'list-level-style-bullet': break; // 16.31 <text:\r\n        case 'list-level-style-number': break; // 16.32 <text:\r\n        case 'list-level-properties': break; // 17.19 <style:\r\n\r\n        /* 7.3 Document Fields */\r\n        case 'sender-firstname': // 7.3.6.2\r\n        case 'sender-lastname': // 7.3.6.3\r\n        case 'sender-initials': // 7.3.6.4\r\n        case 'sender-title': // 7.3.6.5\r\n        case 'sender-position': // 7.3.6.6\r\n        case 'sender-email': // 7.3.6.7\r\n        case 'sender-phone-private': // 7.3.6.8\r\n        case 'sender-fax': // 7.3.6.9\r\n        case 'sender-company': // 7.3.6.10\r\n        case 'sender-phone-work': // 7.3.6.11\r\n        case 'sender-street': // 7.3.6.12\r\n        case 'sender-city': // 7.3.6.13\r\n        case 'sender-postal-code': // 7.3.6.14\r\n        case 'sender-country': // 7.3.6.15\r\n        case 'sender-state-or-province': // 7.3.6.16\r\n        case 'author-name': // 7.3.7.1\r\n        case 'author-initials': // 7.3.7.2\r\n        case 'chapter': // 7.3.8\r\n        case 'file-name': // 7.3.9\r\n        case 'template-name': // 7.3.9\r\n        case 'sheet-name': // 7.3.9\r\n          break;\r\n\r\n        case 'event-listener':\r\n          break;\r\n        /* TODO: FODS Properties */\r\n        case 'initial-creator':\r\n        case 'creation-date':\r\n        case 'print-date':\r\n        case 'generator':\r\n        case 'document-statistic':\r\n        case 'user-defined':\r\n        case 'editing-duration':\r\n        case 'editing-cycles':\r\n          break;\r\n\r\n        /* TODO: FODS Config */\r\n        case 'config-item':\r\n          break;\r\n\r\n        /* TODO: style tokens */\r\n        case 'page-number': break; // TODO <text:page-number>\r\n        case 'page-count': break; // TODO <text:page-count>\r\n        case 'time': break; // TODO <text:time>\r\n\r\n        /* 9.3 Advanced Table Cells */\r\n        case 'cell-range-source': break; // 9.3.1 <table:\r\n        case 'detective': break; // 9.3.2 <table:\r\n        case 'operation': break; // 9.3.3 <table:\r\n        case 'highlighted-range': break; // 9.3.4 <table:\r\n\r\n        /* 9.6 Data Pilot Tables <table: */\r\n        case 'data-pilot-table': // 9.6.3\r\n        case 'source-cell-range': // 9.6.5\r\n        case 'source-service': // 9.6.6\r\n        case 'data-pilot-field': // 9.6.7\r\n        case 'data-pilot-level': // 9.6.8\r\n        case 'data-pilot-subtotals': // 9.6.9\r\n        case 'data-pilot-subtotal': // 9.6.10\r\n        case 'data-pilot-members': // 9.6.11\r\n        case 'data-pilot-member': // 9.6.12\r\n        case 'data-pilot-display-info': // 9.6.13\r\n        case 'data-pilot-sort-info': // 9.6.14\r\n        case 'data-pilot-layout-info': // 9.6.15\r\n        case 'data-pilot-field-reference': // 9.6.16\r\n        case 'data-pilot-groups': // 9.6.17\r\n        case 'data-pilot-group': // 9.6.18\r\n        case 'data-pilot-group-member': // 9.6.19\r\n          break;\r\n\r\n        /* 10.3 Drawing Shapes */\r\n        case 'rect': // 10.3.2\r\n          break;\r\n\r\n        /* 14.6 DDE Connections */\r\n        case 'dde-connection-decls': // 14.6.2 <text:\r\n        case 'dde-connection-decl': // 14.6.3 <text:\r\n        case 'dde-link': // 14.6.4 <table:\r\n        case 'dde-source': // 14.6.5 <office:\r\n          break;\r\n\r\n        case 'properties': break; // 13.7 <form:properties>\r\n        case 'property': break; // 13.8 <form:property>\r\n\r\n        case 'a': // 6.1.8 hyperlink\r\n          if(Rn[1]!== '/') {\r\n            atag = parsexmltag(Rn[0], false);\r\n            if(!atag.href) break;\r\n            atag.Target = atag.href; delete atag.href;\r\n            if(atag.Target.charAt(0) == \"#\" && atag.Target.indexOf(\".\") > -1) {\r\n              _Ref = ods_to_csf_3D(atag.Target.slice(1));\r\n              atag.Target = \"#\" + _Ref[0] + \"!\" + _Ref[1];\r\n            }\r\n          }\r\n          break;\r\n\r\n        /* non-standard */\r\n        case 'table-protection': break;\r\n        case 'data-pilot-grand-total': break; // <table:\r\n        case 'office-document-common-attrs': break; // bare\r\n        default: switch(Rn[2]) {\r\n          case 'dc:':       // TODO: properties\r\n          case 'calcext:':  // ignore undocumented extensions\r\n          case 'loext:':    // ignore undocumented extensions\r\n          case 'ooo:':      // ignore undocumented extensions\r\n          case 'chartooo:': // ignore undocumented extensions\r\n          case 'draw:':     // TODO: drawing\r\n          case 'style:':    // TODO: styles\r\n          case 'chart:':    // TODO: charts\r\n          case 'form:':     // TODO: forms\r\n          case 'uof:':      // TODO: uof\r\n          case ':':       // TODO: uof\r\n          case ':':       // TODO: uof\r\n            break;\r\n          default: if(opts.WTF) throw new Error(Rn);\r\n        }\r\n      }\r\n      var out = ({\r\n        Sheets: Sheets,\r\n        SheetNames: SheetNames,\r\n        Workbook: WB\r\n      });\r\n      if(opts.bookSheets) delete out.Sheets;\r\n      return out;\r\n    };\r\n  })();\r\n\r\n  function parse_ods(zip, opts) {\r\n    opts = opts || ({});\r\n    var ods = !!safegetzipfile(zip, 'objectdata');\r\n    if(ods) parse_manifest(getzipdata(zip, 'META-INF/manifest.xml'), opts);\r\n    var content = getzipstr(zip, 'content.xml');\r\n    if(!content) throw new Error(\"Missing content.xml in \" + (ods ? \"ODS\" : \"UOF\")+ \" file\");\r\n    var wb = parse_content_xml(ods ? content : utf8read(content), opts);\r\n    if(safegetzipfile(zip, 'meta.xml')) wb.Props = parse_core_props(getzipdata(zip, 'meta.xml'));\r\n    return wb;\r\n  }\r\n  function parse_fods(data, opts) {\r\n    return parse_content_xml(data, opts);\r\n  }\r\n\r\n  /* OpenDocument */\r\n  var write_styles_ods = (function() {\r\n    var payload = '<office:document-styles ' + wxt_helper({\r\n      'xmlns:office':   \"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\r\n      'xmlns:table':    \"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\r\n      'xmlns:style':    \"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\r\n      'xmlns:text':     \"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\r\n      'xmlns:draw':     \"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\r\n      'xmlns:fo':       \"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\r\n      'xmlns:xlink':    \"http://www.w3.org/1999/xlink\",\r\n      'xmlns:dc':       \"http://purl.org/dc/elements/1.1/\",\r\n      'xmlns:number':   \"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\r\n      'xmlns:svg':      \"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\r\n      'xmlns:of':       \"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\r\n      'office:version': \"1.2\"\r\n    }) + '></office:document-styles>';\r\n    return function wso() {\r\n      return XML_HEADER + payload;\r\n    };\r\n  })();\r\n  var write_content_ods = (function() {\r\n    /* 6.1.2 White Space Characters */\r\n    var write_text_p = function(text) {\r\n      return escapexml(text)\r\n        .replace(/  +/g, function($$){return '<text:s text:c=\"'+$$.length+'\"/>';})\r\n        .replace(/\\t/g, \"<text:tab/>\")\r\n        .replace(/\\n/g, \"<text:line-break/>\")\r\n        .replace(/^ /, \"<text:s/>\").replace(/ $/, \"<text:s/>\");\r\n    };\r\n\r\n    var null_cell_xml = '          <table:table-cell />\\n';\r\n    var covered_cell_xml = '          <table:covered-table-cell/>\\n';\r\n    var write_ws = function(ws, wb, i) {\r\n      /* Section 9 Tables */\r\n      var o = [];\r\n      o.push('      <table:table table:name=\"' + escapexml(wb.SheetNames[i]) + '\">\\n');\r\n      var R=0,C=0, range = decode_range(ws['!ref']);\r\n      var marr = ws['!merges'] || [], mi = 0;\r\n      var dense = Array.isArray(ws);\r\n      for(R = 0; R < range.s.r; ++R) o.push('        <table:table-row></table:table-row>\\n');\r\n      for(; R <= range.e.r; ++R) {\r\n        o.push('        <table:table-row>\\n');\r\n        for(C=0; C < range.s.c; ++C) o.push(null_cell_xml);\r\n        for(; C <= range.e.c; ++C) {\r\n          var skip = false, ct = {}, textp = \"\";\r\n          for(mi = 0; mi != marr.length; ++mi) {\r\n            if(marr[mi].s.c > C) continue;\r\n            if(marr[mi].s.r > R) continue;\r\n            if(marr[mi].e.c < C) continue;\r\n            if(marr[mi].e.r < R) continue;\r\n            if(marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\r\n            ct['table:number-columns-spanned'] = (marr[mi].e.c - marr[mi].s.c + 1);\r\n            ct['table:number-rows-spanned'] =    (marr[mi].e.r - marr[mi].s.r + 1);\r\n            break;\r\n          }\r\n          if(skip) { o.push(covered_cell_xml); continue; }\r\n          var ref = encode_cell({r:R, c:C}), cell = dense ? (ws[R]||[])[C]: ws[ref];\r\n          if(cell && cell.f) {\r\n            ct['table:formula'] = escapexml(csf_to_ods_formula(cell.f));\r\n            if(cell.F) {\r\n              if(cell.F.slice(0, ref.length) == ref) {\r\n                var _Fref = decode_range(cell.F);\r\n                ct['table:number-matrix-columns-spanned'] = (_Fref.e.c - _Fref.s.c + 1);\r\n                ct['table:number-matrix-rows-spanned'] =    (_Fref.e.r - _Fref.s.r + 1);\r\n              }\r\n            }\r\n          }\r\n          if(!cell) { o.push(null_cell_xml); continue; }\r\n          switch(cell.t) {\r\n            case 'b':\r\n              textp = (cell.v ? 'TRUE' : 'FALSE');\r\n              ct['office:value-type'] = \"boolean\";\r\n              ct['office:boolean-value'] = (cell.v ? 'true' : 'false');\r\n              break;\r\n            case 'n':\r\n              textp = (cell.w||String(cell.v||0));\r\n              ct['office:value-type'] = \"float\";\r\n              ct['office:value'] = (cell.v||0);\r\n              break;\r\n            case 's': case 'str':\r\n              textp = cell.v;\r\n              ct['office:value-type'] = \"string\";\r\n              break;\r\n            case 'd':\r\n              textp = (cell.w||(parseDate(cell.v).toISOString()));\r\n              ct['office:value-type'] = \"date\";\r\n              ct['office:date-value'] = (parseDate(cell.v).toISOString());\r\n              ct['table:style-name'] = \"ce1\";\r\n              break;\r\n            //case 'e':\r\n            default: o.push(null_cell_xml); continue;\r\n          }\r\n          var text_p = write_text_p(textp);\r\n          if(cell.l && cell.l.Target) {\r\n            var _tgt = cell.l.Target; _tgt = _tgt.charAt(0) == \"#\" ? \"#\" + csf_to_ods_3D(_tgt.slice(1)) : _tgt;\r\n            text_p = writextag('text:a', text_p, {'xlink:href': _tgt});\r\n          }\r\n          o.push('          ' + writextag('table:table-cell', writextag('text:p', text_p, {}), ct) + '\\n');\r\n        }\r\n        o.push('        </table:table-row>\\n');\r\n      }\r\n      o.push('      </table:table>\\n');\r\n      return o.join(\"\");\r\n    };\r\n\r\n    var write_automatic_styles_ods = function(o) {\r\n      o.push(' <office:automatic-styles>\\n');\r\n      o.push('  <number:date-style style:name=\"N37\" number:automatic-order=\"true\">\\n');\r\n      o.push('   <number:month number:style=\"long\"/>\\n');\r\n      o.push('   <number:text>/</number:text>\\n');\r\n      o.push('   <number:day number:style=\"long\"/>\\n');\r\n      o.push('   <number:text>/</number:text>\\n');\r\n      o.push('   <number:year/>\\n');\r\n      o.push('  </number:date-style>\\n');\r\n      o.push('  <style:style style:name=\"ce1\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"N37\"/>\\n');\r\n      o.push(' </office:automatic-styles>\\n');\r\n    };\r\n\r\n    return function wcx(wb, opts) {\r\n      var o = [XML_HEADER];\r\n      /* 3.1.3.2 */\r\n      var attr = wxt_helper({\r\n        'xmlns:office':       \"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\r\n        'xmlns:table':        \"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\r\n        'xmlns:style':        \"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\r\n        'xmlns:text':         \"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\r\n        'xmlns:draw':         \"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\r\n        'xmlns:fo':           \"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\r\n        'xmlns:xlink':        \"http://www.w3.org/1999/xlink\",\r\n        'xmlns:dc':           \"http://purl.org/dc/elements/1.1/\",\r\n        'xmlns:meta':         \"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\",\r\n        'xmlns:number':       \"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\r\n        'xmlns:presentation': \"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0\",\r\n        'xmlns:svg':          \"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\r\n        'xmlns:chart':        \"urn:oasis:names:tc:opendocument:xmlns:chart:1.0\",\r\n        'xmlns:dr3d':         \"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0\",\r\n        'xmlns:math':         \"http://www.w3.org/1998/Math/MathML\",\r\n        'xmlns:form':         \"urn:oasis:names:tc:opendocument:xmlns:form:1.0\",\r\n        'xmlns:script':       \"urn:oasis:names:tc:opendocument:xmlns:script:1.0\",\r\n        'xmlns:ooo':          \"http://openoffice.org/2004/office\",\r\n        'xmlns:ooow':         \"http://openoffice.org/2004/writer\",\r\n        'xmlns:oooc':         \"http://openoffice.org/2004/calc\",\r\n        'xmlns:dom':          \"http://www.w3.org/2001/xml-events\",\r\n        'xmlns:xforms':       \"http://www.w3.org/2002/xforms\",\r\n        'xmlns:xsd':          \"http://www.w3.org/2001/XMLSchema\",\r\n        'xmlns:xsi':          \"http://www.w3.org/2001/XMLSchema-instance\",\r\n        'xmlns:sheet':        \"urn:oasis:names:tc:opendocument:sh33tjs:1.0\",\r\n        'xmlns:rpt':          \"http://openoffice.org/2005/report\",\r\n        'xmlns:of':           \"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\r\n        'xmlns:xhtml':        \"http://www.w3.org/1999/xhtml\",\r\n        'xmlns:grddl':        \"http://www.w3.org/2003/g/data-view#\",\r\n        'xmlns:tableooo':     \"http://openoffice.org/2009/table\",\r\n        'xmlns:drawooo':      \"http://openoffice.org/2010/draw\",\r\n        'xmlns:calcext':      \"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0\",\r\n        'xmlns:loext':        \"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0\",\r\n        'xmlns:field':        \"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0\",\r\n        'xmlns:formx':        \"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0\",\r\n        'xmlns:css3t':        \"http://www.w3.org/TR/css3-text/\",\r\n        'office:version':     \"1.2\"\r\n      });\r\n\r\n      var fods = wxt_helper({\r\n        'xmlns:config':    \"urn:oasis:names:tc:opendocument:xmlns:config:1.0\",\r\n        'office:mimetype': \"application/vnd.oasis.opendocument.spreadsheet\"\r\n      });\r\n\r\n      if(opts.bookType == \"fods\") o.push('<office:document' + attr + fods + '>\\n');\r\n      else o.push('<office:document-content' + attr  + '>\\n');\r\n      write_automatic_styles_ods(o);\r\n      o.push('  <office:body>\\n');\r\n      o.push('    <office:spreadsheet>\\n');\r\n      for(var i = 0; i != wb.SheetNames.length; ++i) o.push(write_ws(wb.Sheets[wb.SheetNames[i]], wb, i, opts));\r\n      o.push('    </office:spreadsheet>\\n');\r\n      o.push('  </office:body>\\n');\r\n      if(opts.bookType == \"fods\") o.push('</office:document>');\r\n      else o.push('</office:document-content>');\r\n      return o.join(\"\");\r\n    };\r\n  })();\r\n\r\n  function write_ods(wb, opts) {\r\n    if(opts.bookType == \"fods\") return write_content_ods(wb, opts);\r\n\r\n    var zip = new jszip();\r\n    var f = \"\";\r\n\r\n    var manifest = [];\r\n    var rdf = [];\r\n\r\n    /* Part 3 Section 3.3 MIME Media Type */\r\n    f = \"mimetype\";\r\n    zip.file(f, \"application/vnd.oasis.opendocument.spreadsheet\");\r\n\r\n    /* Part 1 Section 2.2 Documents */\r\n    f = \"content.xml\";\r\n    zip.file(f, write_content_ods(wb, opts));\r\n    manifest.push([f, \"text/xml\"]);\r\n    rdf.push([f, \"ContentFile\"]);\r\n\r\n    /* TODO: these are hard-coded styles to satiate excel */\r\n    f = \"styles.xml\";\r\n    zip.file(f, write_styles_ods(wb, opts));\r\n    manifest.push([f, \"text/xml\"]);\r\n    rdf.push([f, \"StylesFile\"]);\r\n\r\n    /* TODO: this is hard-coded to satiate excel */\r\n    f = \"meta.xml\";\r\n    zip.file(f, write_meta_ods());\r\n    manifest.push([f, \"text/xml\"]);\r\n    rdf.push([f, \"MetadataFile\"]);\r\n\r\n    /* Part 3 Section 6 Metadata Manifest File */\r\n    f = \"manifest.rdf\";\r\n    zip.file(f, write_rdf(rdf/*, opts*/));\r\n    manifest.push([f, \"application/rdf+xml\"]);\r\n\r\n    /* Part 3 Section 4 Manifest File */\r\n    f = \"META-INF/manifest.xml\";\r\n    zip.file(f, write_manifest(manifest/*, opts*/));\r\n\r\n    return zip;\r\n  }\r\n\r\n  function write_sheet_index(wb, sheet) {\r\n    if(!sheet) return 0;\r\n    var idx = wb.SheetNames.indexOf(sheet);\r\n    if(idx == -1) throw new Error(\"Sheet not found: \" + sheet);\r\n    return idx;\r\n  }\r\n\r\n  function write_obj_str(factory) {\r\n    return function write_str(wb, o) {\r\n      var idx = write_sheet_index(wb, o.sheet);\r\n      return factory.from_sheet(wb.Sheets[wb.SheetNames[idx]], o, wb);\r\n    };\r\n  }\r\n\r\n  var write_htm_str = write_obj_str(HTML_);\r\n  var write_csv_str = write_obj_str({from_sheet:sheet_to_csv});\r\n  var write_slk_str = write_obj_str(SYLK);\r\n  var write_dif_str = write_obj_str(DIF);\r\n  var write_prn_str = write_obj_str(PRN);\r\n  var write_rtf_str = write_obj_str(RTF);\r\n  var write_txt_str = write_obj_str({from_sheet:sheet_to_txt});\r\n  var write_dbf_buf = write_obj_str(DBF);\r\n  var write_eth_str = write_obj_str(ETH);\r\n\r\n  function fix_opts_func(defaults) {\r\n    return function fix_opts(opts) {\r\n      for(var i = 0; i != defaults.length; ++i) {\r\n        var d = defaults[i];\r\n        if(opts[d[0]] === undefined) opts[d[0]] = d[1];\r\n        if(d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\r\n      }\r\n    };\r\n  }\r\n\r\n  var fix_read_opts = fix_opts_func([\r\n    ['cellNF', false], /* emit cell number format string as .z */\r\n    ['cellHTML', true], /* emit html string as .h */\r\n    ['cellFormula', true], /* emit formulae as .f */\r\n    ['cellStyles', false], /* emits style/theme as .s */\r\n    ['cellText', true], /* emit formatted text as .w */\r\n    ['cellDates', false], /* emit date cells with type `d` */\r\n\r\n    ['sheetStubs', false], /* emit empty cells */\r\n    ['sheetRows', 0, 'n'], /* read n rows (0 = read all rows) */\r\n\r\n    ['bookDeps', false], /* parse calculation chains */\r\n    ['bookSheets', false], /* only try to get sheet names (no Sheets) */\r\n    ['bookProps', false], /* only try to get properties (no Sheets) */\r\n    ['bookFiles', false], /* include raw file structure (keys, files, cfb) */\r\n    ['bookVBA', false], /* include vba raw data (vbaraw) */\r\n\r\n    ['password',''], /* password */\r\n    ['WTF', false] /* WTF mode (throws errors) */\r\n  ]);\r\n\r\n\r\n  var fix_write_opts = fix_opts_func([\r\n    ['cellDates', false], /* write date cells with type `d` */\r\n\r\n    ['bookSST', false], /* Generate Shared String Table */\r\n\r\n    ['bookType', 'xlsx'], /* Type of workbook (xlsx/m/b) */\r\n\r\n    ['compression', false], /* Use file compression */\r\n\r\n    ['WTF', false] /* WTF mode (throws errors) */\r\n  ]);\r\n  function get_sheet_type(n) {\r\n    if(RELS.WS.indexOf(n) > -1) return \"sheet\";\r\n    if(RELS.CS && n == RELS.CS) return \"chart\";\r\n    if(RELS.DS && n == RELS.DS) return \"dialog\";\r\n    if(RELS.MS && n == RELS.MS) return \"macro\";\r\n    return (n && n.length) ? n : \"sheet\";\r\n  }\r\n  function safe_parse_wbrels(wbrels, sheets) {\r\n    if(!wbrels) return 0;\r\n    try {\r\n      wbrels = sheets.map(function pwbr(w) { if(!w.id) w.id = w.strRelID; return [w.name, wbrels['!id'][w.id].Target, get_sheet_type(wbrels['!id'][w.id].Type)]; });\r\n    } catch(e) { return null; }\r\n    return !wbrels || wbrels.length === 0 ? null : wbrels;\r\n  }\r\n\r\n  function safe_parse_sheet(zip, path, relsPath, sheet, idx, sheetRels, sheets, stype, opts, wb, themes, styles) {\r\n    try {\r\n      sheetRels[sheet]=parse_rels(getzipstr(zip, relsPath, true), path);\r\n      var data = getzipdata(zip, path);\r\n      var _ws;\r\n      switch(stype) {\r\n        case 'sheet':  _ws = parse_ws(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\r\n        case 'chart':  _ws = parse_cs(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\r\n          if(!_ws || !_ws['!chart']) break;\r\n          var dfile = resolve_path(_ws['!chart'].Target, path);\r\n          var drelsp = get_rels_path(dfile);\r\n          var draw = parse_drawing(getzipstr(zip, dfile, true), parse_rels(getzipstr(zip, drelsp, true), dfile));\r\n          var chartp = resolve_path(draw, dfile);\r\n          var crelsp = get_rels_path(chartp);\r\n          _ws = parse_chart(getzipstr(zip, chartp, true), chartp, opts, parse_rels(getzipstr(zip, crelsp, true), chartp), wb, _ws);\r\n          break;\r\n        case 'macro':  _ws = parse_ms(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\r\n        case 'dialog': _ws = parse_ds(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\r\n      }\r\n      sheets[sheet] = _ws;\r\n    } catch(e) { if(opts.WTF) throw e; }\r\n  }\r\n\r\n  function strip_front_slash(x) { return x.charAt(0) == '/' ? x.slice(1) : x; }\r\n\r\n  function parse_zip(zip, opts) {\r\n    make_ssf(SSF);\r\n    opts = opts || {};\r\n    fix_read_opts(opts);\r\n\r\n    /* OpenDocument Part 3 Section 2.2.1 OpenDocument Package */\r\n    if(safegetzipfile(zip, 'META-INF/manifest.xml')) return parse_ods(zip, opts);\r\n    /* UOC */\r\n    if(safegetzipfile(zip, 'objectdata.xml')) return parse_ods(zip, opts);\r\n    /* Numbers */\r\n    if(safegetzipfile(zip, 'Index/Document.iwa')) throw new Error('Unsupported NUMBERS file');\r\n\r\n    var entries = zipentries(zip);\r\n    var dir = parse_ct((getzipstr(zip, '[Content_Types].xml')));\r\n    var xlsb = false;\r\n    var sheets, binname;\r\n    if(dir.workbooks.length === 0) {\r\n      binname = \"xl/workbook.xml\";\r\n      if(getzipdata(zip,binname, true)) dir.workbooks.push(binname);\r\n    }\r\n    if(dir.workbooks.length === 0) {\r\n      binname = \"xl/workbook.bin\";\r\n      if(!getzipdata(zip,binname,true)) throw new Error(\"Could not find workbook\");\r\n      dir.workbooks.push(binname);\r\n      xlsb = true;\r\n    }\r\n    if(dir.workbooks[0].slice(-3) == \"bin\") xlsb = true;\r\n\r\n    var themes = ({});\r\n    var styles = ({});\r\n    if(!opts.bookSheets && !opts.bookProps) {\r\n      strs = [];\r\n      if(dir.sst) try { strs=parse_sst(getzipdata(zip, strip_front_slash(dir.sst)), dir.sst, opts); } catch(e) { if(opts.WTF) throw e; }\r\n\r\n      if(opts.cellStyles && dir.themes.length) themes = parse_theme(getzipstr(zip, dir.themes[0].replace(/^\\//,''), true)||\"\",dir.themes[0], opts);\r\n\r\n      if(dir.style) styles = parse_sty(getzipdata(zip, strip_front_slash(dir.style)), dir.style, themes, opts);\r\n    }\r\n\r\n    /*var externbooks = */dir.links.map(function(link) {\r\n      return parse_xlink(getzipdata(zip, strip_front_slash(link)), link, opts);\r\n    });\r\n\r\n    var wb = parse_wb(getzipdata(zip, strip_front_slash(dir.workbooks[0])), dir.workbooks[0], opts);\r\n\r\n    var props = {}, propdata = \"\";\r\n\r\n    if(dir.coreprops.length) {\r\n      propdata = getzipdata(zip, strip_front_slash(dir.coreprops[0]), true);\r\n      if(propdata) props = parse_core_props(propdata);\r\n      if(dir.extprops.length !== 0) {\r\n        propdata = getzipdata(zip, strip_front_slash(dir.extprops[0]), true);\r\n        if(propdata) parse_ext_props(propdata, props, opts);\r\n      }\r\n    }\r\n\r\n    var custprops = {};\r\n    if(!opts.bookSheets || opts.bookProps) {\r\n      if (dir.custprops.length !== 0) {\r\n        propdata = getzipstr(zip, strip_front_slash(dir.custprops[0]), true);\r\n        if(propdata) custprops = parse_cust_props(propdata, opts);\r\n      }\r\n    }\r\n\r\n    var out = ({});\r\n    if(opts.bookSheets || opts.bookProps) {\r\n      if(wb.Sheets) sheets = wb.Sheets.map(function pluck(x){ return x.name; });\r\n      else if(props.Worksheets && props.SheetNames.length > 0) sheets=props.SheetNames;\r\n      if(opts.bookProps) { out.Props = props; out.Custprops = custprops; }\r\n      if(opts.bookSheets && typeof sheets !== 'undefined') out.SheetNames = sheets;\r\n      if(opts.bookSheets ? out.SheetNames : opts.bookProps) return out;\r\n    }\r\n    sheets = {};\r\n\r\n    var deps = {};\r\n    if(opts.bookDeps && dir.calcchain) deps=parse_cc(getzipdata(zip, strip_front_slash(dir.calcchain)),dir.calcchain,opts);\r\n\r\n    var i=0;\r\n    var sheetRels = ({});\r\n    var path, relsPath;\r\n\r\n    {\r\n      var wbsheets = wb.Sheets;\r\n      props.Worksheets = wbsheets.length;\r\n      props.SheetNames = [];\r\n      for(var j = 0; j != wbsheets.length; ++j) {\r\n        props.SheetNames[j] = wbsheets[j].name;\r\n      }\r\n    }\r\n\r\n    var wbext = xlsb ? \"bin\" : \"xml\";\r\n    var wbrelsi = dir.workbooks[0].lastIndexOf(\"/\");\r\n    var wbrelsfile = (dir.workbooks[0].slice(0, wbrelsi+1) + \"_rels/\" + dir.workbooks[0].slice(wbrelsi+1) + \".rels\").replace(/^\\//,\"\");\r\n    if(!safegetzipfile(zip, wbrelsfile)) wbrelsfile = 'xl/_rels/workbook.' + wbext + '.rels';\r\n    var wbrels = parse_rels(getzipstr(zip, wbrelsfile, true), wbrelsfile);\r\n    if(wbrels) wbrels = safe_parse_wbrels(wbrels, wb.Sheets);\r\n\r\n    /* Numbers iOS hack */\r\n    var nmode = (getzipdata(zip,\"xl/worksheets/sheet.xml\",true))?1:0;\r\n    for(i = 0; i != props.Worksheets; ++i) {\r\n      var stype = \"sheet\";\r\n      if(wbrels && wbrels[i]) {\r\n        path = 'xl/' + (wbrels[i][1]).replace(/[\\/]?xl\\//, \"\");\r\n        if(!safegetzipfile(zip, path)) path = wbrels[i][1];\r\n        if(!safegetzipfile(zip, path)) path = wbrelsfile.replace(/_rels\\/.*$/,\"\") + wbrels[i][1];\r\n        stype = wbrels[i][2];\r\n      } else {\r\n        path = 'xl/worksheets/sheet'+(i+1-nmode)+\".\" + wbext;\r\n        path = path.replace(/sheet0\\./,\"sheet.\");\r\n      }\r\n      relsPath = path.replace(/^(.*)(\\/)([^\\/]*)$/, \"$1/_rels/$3.rels\");\r\n      safe_parse_sheet(zip, path, relsPath, props.SheetNames[i], i, sheetRels, sheets, stype, opts, wb, themes, styles);\r\n    }\r\n\r\n    if(dir.comments) parse_comments(zip, dir.comments, sheets, sheetRels, opts);\r\n\r\n    out = ({\r\n      Directory: dir,\r\n      Workbook: wb,\r\n      Props: props,\r\n      Custprops: custprops,\r\n      Deps: deps,\r\n      Sheets: sheets,\r\n      SheetNames: props.SheetNames,\r\n      Strings: strs,\r\n      Styles: styles,\r\n      Themes: themes,\r\n      SSF: SSF.get_table()\r\n    });\r\n    if(opts.bookFiles) {\r\n      out.keys = entries;\r\n      out.files = zip.files;\r\n    }\r\n    if(opts.bookVBA) {\r\n      if(dir.vba.length > 0) out.vbaraw = getzipdata(zip,strip_front_slash(dir.vba[0]),true);\r\n      else if(dir.defaults && dir.defaults.bin === CT_VBA) out.vbaraw = getzipdata(zip, 'xl/vbaProject.bin',true);\r\n    }\r\n    return out;\r\n  }\r\n\r\n  /* [MS-OFFCRYPTO] 2.1.1 */\r\n  function parse_xlsxcfb(cfb, _opts) {\r\n    var opts = _opts || {};\r\n    var f = 'Workbook', data = CFB.find(cfb, f);\r\n    try {\r\n      f = '/!DataSpaces/Version';\r\n      data = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\r\n      /*var version = */parse_DataSpaceVersionInfo(data.content);\r\n\r\n      /* 2.3.4.1 */\r\n      f = '/!DataSpaces/DataSpaceMap';\r\n      data = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\r\n      var dsm = parse_DataSpaceMap(data.content);\r\n      if(dsm.length !== 1 || dsm[0].comps.length !== 1 || dsm[0].comps[0].t !== 0 || dsm[0].name !== \"StrongEncryptionDataSpace\" || dsm[0].comps[0].v !== \"EncryptedPackage\")\r\n        throw new Error(\"ECMA-376 Encrypted file bad \" + f);\r\n\r\n      /* 2.3.4.2 */\r\n      f = '/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace';\r\n      data = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\r\n      var seds = parse_DataSpaceDefinition(data.content);\r\n      if(seds.length != 1 || seds[0] != \"StrongEncryptionTransform\")\r\n        throw new Error(\"ECMA-376 Encrypted file bad \" + f);\r\n\r\n      /* 2.3.4.3 */\r\n      f = '/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary';\r\n      data = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\r\n      /*var hdr = */parse_Primary(data.content);\r\n    } catch(e) {}\r\n\r\n    f = '/EncryptionInfo';\r\n    data = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\r\n    var einfo = parse_EncryptionInfo(data.content);\r\n\r\n    /* 2.3.4.4 */\r\n    f = '/EncryptedPackage';\r\n    data = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\r\n\r\n    /*global decrypt_agile */\r\n    if(einfo[0] == 0x04 && typeof decrypt_agile !== 'undefined') return decrypt_agile(einfo[1], data.content, opts.password || \"\", opts);\r\n    /*global decrypt_std76 */\r\n    if(einfo[0] == 0x02 && typeof decrypt_std76 !== 'undefined') return decrypt_std76(einfo[1], data.content, opts.password || \"\", opts);\r\n    throw new Error(\"File is password-protected\");\r\n  }\r\n\r\n  function write_zip(wb, opts) {\r\n    _shapeid = 1024;\r\n    if(opts.bookType == \"ods\") return write_ods(wb, opts);\r\n    if(wb && !wb.SSF) {\r\n      wb.SSF = SSF.get_table();\r\n    }\r\n    if(wb && wb.SSF) {\r\n      make_ssf(SSF); SSF.load_table(wb.SSF);\r\n      // $FlowIgnore\r\n      opts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\r\n      opts.ssf = wb.SSF;\r\n    }\r\n    opts.rels = {}; opts.wbrels = {};\r\n    opts.Strings = []; opts.Strings.Count = 0; opts.Strings.Unique = 0;\r\n    if(browser_has_Map) opts.revStrings = new Map();\r\n    else { opts.revStrings = {}; opts.revStrings.foo = []; delete opts.revStrings.foo; }\r\n    var wbext = opts.bookType == \"xlsb\" ? \"bin\" : \"xml\";\r\n    var vbafmt = VBAFMTS.indexOf(opts.bookType) > -1;\r\n    var ct = new_ct();\r\n    fix_write_opts(opts = opts || {});\r\n    var zip = new jszip();\r\n    var f = \"\", rId = 0;\r\n\r\n    opts.cellXfs = [];\r\n    get_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\r\n\r\n    if(!wb.Props) wb.Props = {};\r\n\r\n    f = \"docProps/core.xml\";\r\n    zip.file(f, write_core_props(wb.Props, opts));\r\n    ct.coreprops.push(f);\r\n    add_rels(opts.rels, 2, f, RELS.CORE_PROPS);\r\n\r\n    f = \"docProps/app.xml\";\r\n    if(wb.Props && wb.Props.SheetNames){/* empty */}\r\n    else if(!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;\r\n    else {\r\n      var _sn = [];\r\n      for(var _i = 0; _i < wb.SheetNames.length; ++_i)\r\n        if((wb.Workbook.Sheets[_i]||{}).Hidden != 2) _sn.push(wb.SheetNames[_i]);\r\n      wb.Props.SheetNames = _sn;\r\n    }\r\n    wb.Props.Worksheets = wb.Props.SheetNames.length;\r\n    zip.file(f, write_ext_props(wb.Props, opts));\r\n    ct.extprops.push(f);\r\n    add_rels(opts.rels, 3, f, RELS.EXT_PROPS);\r\n\r\n    if(wb.Custprops !== wb.Props && keys(wb.Custprops||{}).length > 0) {\r\n      f = \"docProps/custom.xml\";\r\n      zip.file(f, write_cust_props(wb.Custprops, opts));\r\n      ct.custprops.push(f);\r\n      add_rels(opts.rels, 4, f, RELS.CUST_PROPS);\r\n    }\r\n\r\n    for(rId=1;rId <= wb.SheetNames.length; ++rId) {\r\n      var wsrels = {'!id':{}};\r\n      var ws = wb.Sheets[wb.SheetNames[rId-1]];\r\n      var _type = (ws || {})[\"!type\"] || \"sheet\";\r\n      switch(_type) {\r\n        case \"chart\": /*\r\n\t\t\tf = \"xl/chartsheets/sheet\" + rId + \".\" + wbext;\r\n\t\t\tzip.file(f, write_cs(rId-1, f, opts, wb, wsrels));\r\n\t\t\tct.charts.push(f);\r\n\t\t\tadd_rels(wsrels, -1, \"chartsheets/sheet\" + rId + \".\" + wbext, RELS.CS);\r\n\t\t\tbreak; */\r\n        /* falls through */\r\n        default:\r\n          f = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\r\n          zip.file(f, write_ws(rId-1, f, opts, wb, wsrels));\r\n          ct.sheets.push(f);\r\n          add_rels(opts.wbrels, -1, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS[0]);\r\n      }\r\n\r\n      if(ws) {\r\n        var comments = ws['!comments'];\r\n        var need_vml = false;\r\n        if(comments && comments.length > 0) {\r\n          var cf = \"xl/comments\" + rId + \".\" + wbext;\r\n          zip.file(cf, write_cmnt(comments, cf, opts));\r\n          ct.comments.push(cf);\r\n          add_rels(wsrels, -1, \"../comments\" + rId + \".\" + wbext, RELS.CMNT);\r\n          need_vml = true;\r\n        }\r\n        if(ws['!legacy']) {\r\n          if(need_vml) zip.file(\"xl/drawings/vmlDrawing\" + (rId) + \".vml\", write_comments_vml(rId, ws['!comments']));\r\n        }\r\n        delete ws['!comments'];\r\n        delete ws['!legacy'];\r\n      }\r\n\r\n      if(wsrels['!id'].rId1) zip.file(get_rels_path(f), write_rels(wsrels));\r\n    }\r\n\r\n    if(opts.Strings != null && opts.Strings.length > 0) {\r\n      f = \"xl/sharedStrings.\" + wbext;\r\n      zip.file(f, write_sst(opts.Strings, f, opts));\r\n      ct.strs.push(f);\r\n      add_rels(opts.wbrels, -1, \"sharedStrings.\" + wbext, RELS.SST);\r\n    }\r\n\r\n    f = \"xl/workbook.\" + wbext;\r\n    zip.file(f, write_wb(wb, f, opts));\r\n    ct.workbooks.push(f);\r\n    add_rels(opts.rels, 1, f, RELS.WB);\r\n\r\n    /* TODO: something more intelligent with themes */\r\n\r\n    f = \"xl/theme/theme1.xml\";\r\n    zip.file(f, write_theme(wb.Themes, opts));\r\n    ct.themes.push(f);\r\n    add_rels(opts.wbrels, -1, \"theme/theme1.xml\", RELS.THEME);\r\n\r\n    /* TODO: something more intelligent with styles */\r\n\r\n    f = \"xl/styles.\" + wbext;\r\n    zip.file(f, write_sty(wb, f, opts));\r\n    ct.styles.push(f);\r\n    add_rels(opts.wbrels, -1, \"styles.\" + wbext, RELS.STY);\r\n\r\n    if(wb.vbaraw && vbafmt) {\r\n      f = \"xl/vbaProject.bin\";\r\n      zip.file(f, wb.vbaraw);\r\n      ct.vba.push(f);\r\n      add_rels(opts.wbrels, -1, \"vbaProject.bin\", RELS.VBA);\r\n    }\r\n\r\n    zip.file(\"[Content_Types].xml\", write_ct(ct, opts));\r\n    zip.file('_rels/.rels', write_rels(opts.rels));\r\n    zip.file('xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\r\n\r\n    delete opts.revssf; delete opts.ssf;\r\n    return zip;\r\n  }\r\n  function firstbyte(f,o) {\r\n    var x = \"\";\r\n    switch((o||{}).type || \"base64\") {\r\n      case 'buffer': return [f[0], f[1], f[2], f[3]];\r\n      case 'base64': x = Base64.decode(f.slice(0,24)); break;\r\n      case 'binary': x = f; break;\r\n      case 'array':  return [f[0], f[1], f[2], f[3]];\r\n      default: throw new Error(\"Unrecognized type \" + (o && o.type || \"undefined\"));\r\n    }\r\n    return [x.charCodeAt(0), x.charCodeAt(1), x.charCodeAt(2), x.charCodeAt(3)];\r\n  }\r\n\r\n  function read_cfb(cfb, opts) {\r\n    if(CFB.find(cfb, \"EncryptedPackage\")) return parse_xlsxcfb(cfb, opts);\r\n    return parse_xlscfb(cfb, opts);\r\n  }\r\n\r\n  function read_zip(data, opts) {\r\n    var zip, d = data;\r\n    var o = opts||{};\r\n    if(!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\r\n    switch(o.type) {\r\n      case \"base64\": zip = new jszip(d, { base64:true }); break;\r\n      case \"binary\": case \"array\": zip = new jszip(d, { base64:false }); break;\r\n      case \"buffer\": zip = new jszip(d); break;\r\n      default: throw new Error(\"Unrecognized type \" + o.type);\r\n    }\r\n    return parse_zip(zip, o);\r\n  }\r\n\r\n  function read_plaintext(data, o) {\r\n    var i = 0;\r\n    main: while(i < data.length) switch(data.charCodeAt(i)) {\r\n      case 0x0A: case 0x0D: case 0x20: ++i; break;\r\n      case 0x3C: return parse_xlml(data.slice(i),o);\r\n      default: break main;\r\n    }\r\n    return PRN.to_workbook(data, o);\r\n  }\r\n\r\n  function read_plaintext_raw(data, o) {\r\n    var str = \"\", bytes = firstbyte(data, o);\r\n    switch(o.type) {\r\n      case 'base64': str = Base64.decode(data); break;\r\n      case 'binary': str = data; break;\r\n      case 'buffer': str = data.toString('binary'); break;\r\n      case 'array': str = cc2str(data); break;\r\n      default: throw new Error(\"Unrecognized type \" + o.type);\r\n    }\r\n    if(bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str);\r\n    return read_plaintext(str, o);\r\n  }\r\n\r\n  function read_utf16(data, o) {\r\n    var d = data;\r\n    if(o.type == 'base64') d = Base64.decode(d);\r\n    d = cptable.utils.decode(1200, d.slice(2), 'str');\r\n    o.type = \"binary\";\r\n    return read_plaintext(d, o);\r\n  }\r\n\r\n  function bstrify(data) {\r\n    return !data.match(/[^\\x00-\\x7F]/) ? data : utf8write(data);\r\n  }\r\n\r\n  function read_prn(data, d, o, str) {\r\n    if(str) { o.type = \"string\"; return PRN.to_workbook(data, o); }\r\n    return PRN.to_workbook(d, o);\r\n  }\r\n\r\n  function readSync(data, opts) {\r\n    reset_cp();\r\n    if(typeof ArrayBuffer !== 'undefined' && data instanceof ArrayBuffer) return readSync(new Uint8Array(data), opts);\r\n    var d = data, n = [0,0,0,0], str = false;\r\n    var o = opts||{};\r\n    _ssfopts = {};\r\n    if(o.dateNF) _ssfopts.dateNF = o.dateNF;\r\n    if(!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\r\n    if(o.type == \"file\") { o.type = has_buf ? \"buffer\" : \"binary\"; d = read_binary(data); }\r\n    if(o.type == \"string\") { str = true; o.type = \"binary\"; o.codepage = 65001; d = bstrify(data); }\r\n    if(o.type == 'array' && typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && typeof ArrayBuffer !== 'undefined') {\r\n      // $FlowIgnore\r\n      var ab=new ArrayBuffer(3), vu=new Uint8Array(ab); vu.foo=\"bar\";\r\n      // $FlowIgnore\r\n      if(!vu.foo) {o=dup(o); o.type='array'; return readSync(ab2a(d), o);}\r\n    }\r\n    switch((n = firstbyte(d, o))[0]) {\r\n      case 0xD0: return read_cfb(CFB.read(d, o), o);\r\n      case 0x09: return parse_xlscfb(d, o);\r\n      case 0x3C: return parse_xlml(d, o);\r\n      case 0x49: if(n[1] === 0x44) return read_wb_ID(d, o); break;\r\n      case 0x54: if(n[1] === 0x41 && n[2] === 0x42 && n[3] === 0x4C) return DIF.to_workbook(d, o); break;\r\n      case 0x50: return (n[1] === 0x4B && n[2] < 0x09 && n[3] < 0x09) ? read_zip(d, o) : read_prn(data, d, o, str);\r\n      case 0xEF: return n[3] === 0x3C ? parse_xlml(d, o) : read_prn(data, d, o, str);\r\n      case 0xFF: if(n[1] === 0xFE) { return read_utf16(d, o); } break;\r\n      case 0x00: if(n[1] === 0x00 && n[2] >= 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o); break;\r\n      case 0x03: case 0x83: case 0x8B: case 0x8C: return DBF.to_workbook(d, o);\r\n      case 0x7B: if(n[1] === 0x5C && n[2] === 0x72 && n[3] === 0x74) return RTF.to_workbook(d, o); break;\r\n      case 0x0A: case 0x0D: case 0x20: return read_plaintext_raw(d, o);\r\n    }\r\n    if(n[2] <= 12 && n[3] <= 31) return DBF.to_workbook(d, o);\r\n    return read_prn(data, d, o, str);\r\n  }\r\n\r\n  function readFileSync(filename, opts) {\r\n    var o = opts||{}; o.type = 'file';\r\n    return readSync(filename, o);\r\n  }\r\n  function write_cfb_ctr(cfb, o) {\r\n    switch(o.type) {\r\n      case \"base64\": case \"binary\": break;\r\n      case \"buffer\": case \"array\": o.type = \"\"; break;\r\n      case \"file\": return write_dl(o.file, CFB.write(cfb, {type:has_buf ? 'buffer' : \"\"}));\r\n      case \"string\": throw new Error(\"'string' output type invalid for '\" + o.bookType + \"' files\");\r\n      default: throw new Error(\"Unrecognized type \" + o.type);\r\n    }\r\n    return CFB.write(cfb, o);\r\n  }\r\n\r\n  /*global encrypt_agile */\r\n  function write_zip_type(wb, opts) {\r\n    var o = opts||{};\r\n    style_builder  = new StyleBuilder(opts);\r\n    var z = write_zip(wb, o);\r\n    var oopts = {};\r\n    if(o.compression) oopts.compression = 'DEFLATE';\r\n    if(o.password) oopts.type = has_buf ? \"nodebuffer\" : \"string\";\r\n    else switch(o.type) {\r\n      case \"base64\": oopts.type = \"base64\"; break;\r\n      case \"binary\": oopts.type = \"string\"; break;\r\n      case \"string\": throw new Error(\"'string' output type invalid for '\" + o.bookType + \"' files\");\r\n      case \"buffer\":\r\n      case \"file\": oopts.type = has_buf ? \"nodebuffer\" : \"string\"; break;\r\n      default: throw new Error(\"Unrecognized type \" + o.type);\r\n    }\r\n    var out = z.generate(oopts);\r\n    if(o.password && typeof encrypt_agile !== 'undefined') return write_cfb_ctr(encrypt_agile(out, o.password), o);\r\n    if(o.type === \"file\") return write_dl(o.file, out);\r\n    return o.type == \"string\" ? utf8read(out) : out;\r\n  }\r\n\r\n  function write_cfb_type(wb, opts) {\r\n    var o = opts||{};\r\n    var cfb = write_xlscfb(wb, o);\r\n    return write_cfb_ctr(cfb, o);\r\n  }\r\n\r\n  function write_string_type(out, opts, bom) {\r\n    if(!bom) bom = \"\";\r\n    var o = bom + out;\r\n    switch(opts.type) {\r\n      case \"base64\": return Base64.encode(utf8write(o));\r\n      case \"binary\": return utf8write(o);\r\n      case \"string\": return out;\r\n      case \"file\": return write_dl(opts.file, o, 'utf8');\r\n      case \"buffer\": {\r\n        // $FlowIgnore\r\n        if(has_buf) return Buffer_from(o, 'utf8');\r\n        else return write_string_type(o, {type:'binary'}).split(\"\").map(function(c) { return c.charCodeAt(0); });\r\n      }\r\n    }\r\n    throw new Error(\"Unrecognized type \" + opts.type);\r\n  }\r\n\r\n  function write_stxt_type(out, opts) {\r\n    switch(opts.type) {\r\n      case \"base64\": return Base64.encode(out);\r\n      case \"binary\": return out;\r\n      case \"string\": return out; /* override in sheet_to_txt */\r\n      case \"file\": return write_dl(opts.file, out, 'binary');\r\n      case \"buffer\": {\r\n        // $FlowIgnore\r\n        if(has_buf) return Buffer_from(out, 'binary');\r\n        else return out.split(\"\").map(function(c) { return c.charCodeAt(0); });\r\n      }\r\n    }\r\n    throw new Error(\"Unrecognized type \" + opts.type);\r\n  }\r\n\r\n  /* TODO: test consistency */\r\n  function write_binary_type(out, opts) {\r\n    switch(opts.type) {\r\n      case \"string\":\r\n      case \"base64\":\r\n      case \"binary\":\r\n        var bstr = \"\";\r\n        // $FlowIgnore\r\n        for(var i = 0; i < out.length; ++i) bstr += String.fromCharCode(out[i]);\r\n        return opts.type == 'base64' ? Base64.encode(bstr) : opts.type == 'string' ? utf8read(bstr) : bstr;\r\n      case \"file\": return write_dl(opts.file, out);\r\n      case \"buffer\": return out;\r\n      default: throw new Error(\"Unrecognized type \" + opts.type);\r\n    }\r\n  }\r\n\r\n  function writeSync(wb, opts) {\r\n    check_wb(wb);\r\n    var o = opts||{};\r\n    if(o.type == \"array\") { o.type = \"binary\"; var out = (writeSync(wb, o)); o.type = \"array\"; return s2ab(out); }\r\n    switch(o.bookType || 'xlsb') {\r\n      case 'xml':\r\n      case 'xlml': return write_string_type(write_xlml(wb, o), o);\r\n      case 'slk':\r\n      case 'sylk': return write_string_type(write_slk_str(wb, o), o);\r\n      case 'htm':\r\n      case 'html': return write_string_type(write_htm_str(wb, o), o);\r\n      case 'txt': return write_stxt_type(write_txt_str(wb, o), o);\r\n      case 'csv': return write_string_type(write_csv_str(wb, o), o, \"\\ufeff\");\r\n      case 'dif': return write_string_type(write_dif_str(wb, o), o);\r\n      case 'dbf': return write_binary_type(write_dbf_buf(wb, o), o);\r\n      case 'prn': return write_string_type(write_prn_str(wb, o), o);\r\n      case 'rtf': return write_string_type(write_rtf_str(wb, o), o);\r\n      case 'eth': return write_string_type(write_eth_str(wb, o), o);\r\n      case 'fods': return write_string_type(write_ods(wb, o), o);\r\n      case 'biff2': if(!o.biff) o.biff = 2; /* falls through */\r\n      case 'biff3': if(!o.biff) o.biff = 3; /* falls through */\r\n      case 'biff4': if(!o.biff) o.biff = 4; return write_binary_type(write_biff_buf(wb, o), o);\r\n      case 'biff5': if(!o.biff) o.biff = 5; /* falls through */\r\n      case 'biff8':\r\n      case 'xla':\r\n      case 'xls': if(!o.biff) o.biff = 8; return write_cfb_type(wb, o);\r\n      case 'xlsx':\r\n      case 'xlsm':\r\n      case 'xlam':\r\n      case 'xlsb':\r\n      case 'ods': return write_zip_type(wb, o);\r\n      default: throw new Error (\"Unrecognized bookType |\" + o.bookType + \"|\");\r\n    }\r\n  }\r\n\r\n  function resolve_book_type(o) {\r\n    if(o.bookType) return;\r\n    var _BT = {\r\n      \"xls\": \"biff8\",\r\n      \"htm\": \"html\",\r\n      \"slk\": \"sylk\",\r\n      \"socialcalc\": \"eth\",\r\n      \"Sh33tJS\": \"WTF\"\r\n    };\r\n    var ext = o.file.slice(o.file.lastIndexOf(\".\")).toLowerCase();\r\n    if(ext.match(/^\\.[a-z]+$/)) o.bookType = ext.slice(1);\r\n    o.bookType = _BT[o.bookType] || o.bookType;\r\n  }\r\n\r\n  function writeFileSync(wb, filename, opts) {\r\n    var o = opts||{}; o.type = 'file';\r\n    o.file = filename;\r\n    resolve_book_type(o);\r\n    return writeSync(wb, o);\r\n  }\r\n\r\n  function writeFileAsync(filename, wb, opts, cb) {\r\n    var o = opts||{}; o.type = 'file';\r\n    o.file = filename;\r\n    resolve_book_type(o);\r\n    o.type = 'buffer';\r\n    var _cb = cb; if(!(_cb instanceof Function)) _cb = (opts);\r\n    return _fs.writeFile(filename, writeSync(wb, o), _cb);\r\n  }\r\n  function make_json_row(sheet, r, R, cols, header, hdr, dense, o) {\r\n    var rr = encode_row(R);\r\n    var defval = o.defval, raw = o.raw || !o.hasOwnProperty(\"raw\");\r\n    var isempty = true;\r\n    var row = (header === 1) ? [] : {};\r\n    if(header !== 1) {\r\n      if(Object.defineProperty) try { Object.defineProperty(row, '__rowNum__', {value:R, enumerable:false}); } catch(e) { row.__rowNum__ = R; }\r\n      else row.__rowNum__ = R;\r\n    }\r\n    if(!dense || sheet[R]) for (var C = r.s.c; C <= r.e.c; ++C) {\r\n      var val = dense ? sheet[R][C] : sheet[cols[C] + rr];\r\n      if(val === undefined || val.t === undefined) {\r\n        if(defval === undefined) continue;\r\n        if(hdr[C] != null) { row[hdr[C]] = defval; }\r\n        continue;\r\n      }\r\n      var v = val.v;\r\n      switch(val.t){\r\n        case 'z': if(v == null) break; continue;\r\n        case 'e': v = void 0; break;\r\n        case 's': case 'd': case 'b': case 'n': break;\r\n        default: throw new Error('unrecognized type ' + val.t);\r\n      }\r\n      if(hdr[C] != null) {\r\n        if(v == null) {\r\n          if(defval !== undefined) row[hdr[C]] = defval;\r\n          else if(raw && v === null) row[hdr[C]] = null;\r\n          else continue;\r\n        } else {\r\n          row[hdr[C]] = raw ? v : format_cell(val,v,o);\r\n        }\r\n        if(v != null) isempty = false;\r\n      }\r\n    }\r\n    return { row: row, isempty: isempty };\r\n  }\r\n\r\n\r\n  function sheet_to_json(sheet, opts) {\r\n    if(sheet == null || sheet[\"!ref\"] == null) return [];\r\n    var val = {t:'n',v:0}, header = 0, offset = 1, hdr = [], v=0, vv=\"\";\r\n    var r = {s:{r:0,c:0},e:{r:0,c:0}};\r\n    var o = opts || {};\r\n    var range = o.range != null ? o.range : sheet[\"!ref\"];\r\n    if(o.header === 1) header = 1;\r\n    else if(o.header === \"A\") header = 2;\r\n    else if(Array.isArray(o.header)) header = 3;\r\n    switch(typeof range) {\r\n      case 'string': r = safe_decode_range(range); break;\r\n      case 'number': r = safe_decode_range(sheet[\"!ref\"]); r.s.r = range; break;\r\n      default: r = range;\r\n    }\r\n    if(header > 0) offset = 0;\r\n    var rr = encode_row(r.s.r);\r\n    var cols = [];\r\n    var out = [];\r\n    var outi = 0, counter = 0;\r\n    var dense = Array.isArray(sheet);\r\n    var R = r.s.r, C = 0, CC = 0;\r\n    if(dense && !sheet[R]) sheet[R] = [];\r\n    for(C = r.s.c; C <= r.e.c; ++C) {\r\n      cols[C] = encode_col(C);\r\n      val = dense ? sheet[R][C] : sheet[cols[C] + rr];\r\n      switch(header) {\r\n        case 1: hdr[C] = C - r.s.c; break;\r\n        case 2: hdr[C] = cols[C]; break;\r\n        case 3: hdr[C] = o.header[C - r.s.c]; break;\r\n        default:\r\n          if(val == null) val = {w: \"__EMPTY\", t: \"s\"};\r\n          vv = v = format_cell(val, null, o);\r\n          counter = 0;\r\n          for(CC = 0; CC < hdr.length; ++CC) if(hdr[CC] == vv) vv = v + \"_\" + (++counter);\r\n          hdr[C] = vv;\r\n      }\r\n    }\r\n    for (R = r.s.r + offset; R <= r.e.r; ++R) {\r\n      var row = make_json_row(sheet, r, R, cols, header, hdr, dense, o);\r\n      if((row.isempty === false) || (header === 1 ? o.blankrows !== false : !!o.blankrows)) out[outi++] = row.row;\r\n    }\r\n    out.length = outi;\r\n    return out;\r\n  }\r\n\r\n  var qreg = /\"/g;\r\n  function make_csv_row(sheet, r, R, cols, fs, rs, FS, o) {\r\n    var isempty = true;\r\n    var row = [], txt = \"\", rr = encode_row(R);\r\n    for(var C = r.s.c; C <= r.e.c; ++C) {\r\n      if (!cols[C]) continue;\r\n      var val = o.dense ? (sheet[R]||[])[C]: sheet[cols[C] + rr];\r\n      if(val == null) txt = \"\";\r\n      else if(val.v != null) {\r\n        isempty = false;\r\n        txt = ''+format_cell(val, null, o);\r\n        for(var i = 0, cc = 0; i !== txt.length; ++i) if((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34) {txt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\"; break; }\r\n        if(txt == \"ID\") txt = '\"ID\"';\r\n      } else if(val.f != null && !val.F) {\r\n        isempty = false;\r\n        txt = '=' + val.f; if(txt.indexOf(\",\") >= 0) txt = '\"' + txt.replace(qreg, '\"\"') + '\"';\r\n      } else txt = \"\";\r\n      /* NOTE: Excel CSV does not support array formulae */\r\n      row.push(txt);\r\n    }\r\n    if(o.blankrows === false && isempty) return null;\r\n    return row.join(FS);\r\n  }\r\n\r\n  function sheet_to_csv(sheet, opts) {\r\n    var out = [];\r\n    var o = opts == null ? {} : opts;\r\n    if(sheet == null || sheet[\"!ref\"] == null) return \"\";\r\n    var r = safe_decode_range(sheet[\"!ref\"]);\r\n    var FS = o.FS !== undefined ? o.FS : \",\", fs = FS.charCodeAt(0);\r\n    var RS = o.RS !== undefined ? o.RS : \"\\n\", rs = RS.charCodeAt(0);\r\n    var endregex = new RegExp((FS==\"|\" ? \"\\\\|\" : FS)+\"+$\");\r\n    var row = \"\", cols = [];\r\n    o.dense = Array.isArray(sheet);\r\n    var colinfo = o.skipHidden && sheet[\"!cols\"] || [];\r\n    var rowinfo = o.skipHidden && sheet[\"!rows\"] || [];\r\n    for(var C = r.s.c; C <= r.e.c; ++C) if (!((colinfo[C]||{}).hidden)) cols[C] = encode_col(C);\r\n    for(var R = r.s.r; R <= r.e.r; ++R) {\r\n      if ((rowinfo[R]||{}).hidden) continue;\r\n      row = make_csv_row(sheet, r, R, cols, fs, rs, FS, o);\r\n      if(row == null) { continue; }\r\n      if(o.strip) row = row.replace(endregex,\"\");\r\n      out.push(row + RS);\r\n    }\r\n    delete o.dense;\r\n    return out.join(\"\");\r\n  }\r\n\r\n  function sheet_to_txt(sheet, opts) {\r\n    if(!opts) opts = {}; opts.FS = \"\\t\"; opts.RS = \"\\n\";\r\n    var s = sheet_to_csv(sheet, opts);\r\n    if(typeof cptable == 'undefined' || opts.type == 'string') return s;\r\n    var o = cptable.utils.encode(1200, s, 'str');\r\n    return String.fromCharCode(255) + String.fromCharCode(254) + o;\r\n  }\r\n\r\n  function sheet_to_formulae(sheet) {\r\n    var y = \"\", x, val=\"\";\r\n    if(sheet == null || sheet[\"!ref\"] == null) return [];\r\n    var r = safe_decode_range(sheet['!ref']), rr = \"\", cols = [], C;\r\n    var cmds = [];\r\n    var dense = Array.isArray(sheet);\r\n    for(C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\r\n    for(var R = r.s.r; R <= r.e.r; ++R) {\r\n      rr = encode_row(R);\r\n      for(C = r.s.c; C <= r.e.c; ++C) {\r\n        y = cols[C] + rr;\r\n        x = dense ? (sheet[R]||[])[C] : sheet[y];\r\n        val = \"\";\r\n        if(x === undefined) continue;\r\n        else if(x.F != null) {\r\n          y = x.F;\r\n          if(!x.f) continue;\r\n          val = x.f;\r\n          if(y.indexOf(\":\") == -1) y = y + \":\" + y;\r\n        }\r\n        if(x.f != null) val = x.f;\r\n        else if(x.t == 'z') continue;\r\n        else if(x.t == 'n' && x.v != null) val = \"\" + x.v;\r\n        else if(x.t == 'b') val = x.v ? \"TRUE\" : \"FALSE\";\r\n        else if(x.w !== undefined) val = \"'\" + x.w;\r\n        else if(x.v === undefined) continue;\r\n        else if(x.t == 's') val = \"'\" + x.v;\r\n        else val = \"\"+x.v;\r\n        cmds[cmds.length] = y + \"=\" + val;\r\n      }\r\n    }\r\n    return cmds;\r\n  }\r\n\r\n  function sheet_add_json(_ws, js, opts) {\r\n    var o = opts || {};\r\n    var offset = +!o.skipHeader;\r\n    var ws = _ws || ({});\r\n    var _R = 0, _C = 0;\r\n    if(ws && o.origin != null) {\r\n      if(typeof o.origin == 'number') _R = o.origin;\r\n      else {\r\n        var _origin = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\r\n        _R = _origin.r; _C = _origin.c;\r\n      }\r\n    }\r\n    var cell;\r\n    var range = ({s: {c:0, r:0}, e: {c:_C, r:_R + js.length - 1 + offset}});\r\n    if(ws['!ref']) {\r\n      var _range = safe_decode_range(ws['!ref']);\r\n      range.e.c = Math.max(range.e.c, _range.e.c);\r\n      range.e.r = Math.max(range.e.r, _range.e.r);\r\n      if(_R == -1) { _R = range.e.r + 1; range.e.r = _R + js.length - 1 + offset; }\r\n    }\r\n    var hdr = o.header || [], C = 0;\r\n\r\n    js.forEach(function (JS, R) {\r\n      keys(JS).forEach(function(k) {\r\n        if((C=hdr.indexOf(k)) == -1) hdr[C=hdr.length] = k;\r\n        var v = JS[k];\r\n        var t = 'z';\r\n        var z = \"\";\r\n        if(v && typeof v === 'object' && !(v instanceof Date)){\r\n          ws[encode_cell({c:_C + C,r:_R + R + offset})] = v;\r\n        } else {\r\n          if(typeof v == 'number') t = 'n';\r\n          else if(typeof v == 'boolean') t = 'b';\r\n          else if(typeof v == 'string') t = 's';\r\n          else if(v instanceof Date) {\r\n            t = 'd';\r\n            if(!o.cellDates) { t = 'n'; v = datenum(v); }\r\n            z = o.dateNF || SSF._table[14];\r\n          }\r\n          ws[encode_cell({c:_C + C,r:_R + R + offset})] = cell = ({t:t, v:v});\r\n          if(z) cell.z = z;\r\n        }\r\n      });\r\n    });\r\n    range.e.c = Math.max(range.e.c, _C + hdr.length - 1);\r\n    var __R = encode_row(_R);\r\n    if(offset) for(C = 0; C < hdr.length; ++C) ws[encode_col(C + _C) + __R] = {t:'s', v:hdr[C]};\r\n    ws['!ref'] = encode_range(range);\r\n    return ws;\r\n  }\r\n  function json_to_sheet(js, opts) { return sheet_add_json(null, js, opts); }\r\n\r\n  var utils = {\r\n    encode_col: encode_col,\r\n    encode_row: encode_row,\r\n    encode_cell: encode_cell,\r\n    encode_range: encode_range,\r\n    decode_col: decode_col,\r\n    decode_row: decode_row,\r\n    split_cell: split_cell,\r\n    decode_cell: decode_cell,\r\n    decode_range: decode_range,\r\n    format_cell: format_cell,\r\n    get_formulae: sheet_to_formulae,\r\n    make_csv: sheet_to_csv,\r\n    make_json: sheet_to_json,\r\n    make_formulae: sheet_to_formulae,\r\n    sheet_add_aoa: sheet_add_aoa,\r\n    sheet_add_json: sheet_add_json,\r\n    aoa_to_sheet: aoa_to_sheet,\r\n    json_to_sheet: json_to_sheet,\r\n    table_to_sheet: parse_dom_table,\r\n    table_to_book: table_to_book,\r\n    sheet_to_csv: sheet_to_csv,\r\n    sheet_to_txt: sheet_to_txt,\r\n    sheet_to_json: sheet_to_json,\r\n    sheet_to_html: HTML_.from_sheet,\r\n    sheet_to_dif: DIF.from_sheet,\r\n    sheet_to_slk: SYLK.from_sheet,\r\n    sheet_to_eth: ETH.from_sheet,\r\n    sheet_to_formulae: sheet_to_formulae,\r\n    sheet_to_row_object_array: sheet_to_json\r\n  };\r\n\r\n  (function(utils) {\r\n    utils.consts = utils.consts || {};\r\n    function add_consts(R/*Array<any>*/) { R.forEach(function(a){ utils.consts[a[0]] = a[1]; }); }\r\n\r\n    function get_default(x, y, z) { return x[y] != null ? x[y] : (x[y] = z); }\r\n\r\n    /* get cell, creating a stub if necessary */\r\n    function ws_get_cell_stub(ws, R, C) {\r\n      /* A1 cell address */\r\n      if(typeof R == \"string\") return ws[R] || (ws[R] = {t:'z'});\r\n      /* cell address object */\r\n      if(typeof R != \"number\") return ws_get_cell_stub(ws, encode_cell(R));\r\n      /* R and C are 0-based indices */\r\n      return ws_get_cell_stub(ws, encode_cell({r:R,c:C||0}));\r\n    }\r\n\r\n    /* find sheet index for given name / validate index */\r\n    function wb_sheet_idx(wb, sh) {\r\n      if(typeof sh == \"number\") {\r\n        if(sh >= 0 && wb.SheetNames.length > sh) return sh;\r\n        throw new Error(\"Cannot find sheet # \" + sh);\r\n      } else if(typeof sh == \"string\") {\r\n        var idx = wb.SheetNames.indexOf(sh);\r\n        if(idx > -1) return idx;\r\n        throw new Error(\"Cannot find sheet name |\" + sh + \"|\");\r\n      } else throw new Error(\"Cannot find sheet |\" + sh + \"|\");\r\n    }\r\n\r\n    /* simple blank workbook object */\r\n    utils.book_new = function() {\r\n      return { SheetNames: [], Sheets: {} };\r\n    };\r\n\r\n    /* add a worksheet to the end of a given workbook */\r\n    utils.book_append_sheet = function(wb, ws, name) {\r\n      if(!name) for(var i = 1; i <= 0xFFFF; ++i) if(wb.SheetNames.indexOf(name = \"Sheet\" + i) == -1) break;\r\n      if(!name) throw new Error(\"Too many worksheets\");\r\n      check_ws_name(name);\r\n      if(wb.SheetNames.indexOf(name) >= 0) throw new Error(\"Worksheet with name |\" + name + \"| already exists!\");\r\n\r\n      wb.SheetNames.push(name);\r\n      wb.Sheets[name] = ws;\r\n    };\r\n\r\n    /* set sheet visibility (visible/hidden/very hidden) */\r\n    utils.book_set_sheet_visibility = function(wb, sh, vis) {\r\n      get_default(wb,\"Workbook\",{});\r\n      get_default(wb.Workbook,\"Sheets\",[]);\r\n\r\n      var idx = wb_sheet_idx(wb, sh);\r\n      // $FlowIgnore\r\n      get_default(wb.Workbook.Sheets,idx, {});\r\n\r\n      switch(vis) {\r\n        case 0: case 1: case 2: break;\r\n        default: throw new Error(\"Bad sheet visibility setting \" + vis);\r\n      }\r\n      // $FlowIgnore\r\n      wb.Workbook.Sheets[idx].Hidden = vis;\r\n    };\r\n    add_consts([\r\n      [\"SHEET_VISIBLE\", 0],\r\n      [\"SHEET_HIDDEN\", 1],\r\n      [\"SHEET_VERY_HIDDEN\", 2]\r\n    ]);\r\n\r\n    /* set number format */\r\n    utils.cell_set_number_format = function(cell, fmt) {\r\n      cell.z = fmt;\r\n      return cell;\r\n    };\r\n\r\n    /* set cell hyperlink */\r\n    utils.cell_set_hyperlink = function(cell, target, tooltip) {\r\n      if(!target) {\r\n        delete cell.l;\r\n      } else {\r\n        cell.l = ({ Target: target });\r\n        if(tooltip) cell.l.Tooltip = tooltip;\r\n      }\r\n      return cell;\r\n    };\r\n    utils.cell_set_internal_link = function(cell, range, tooltip) { return utils.cell_set_hyperlink(cell, \"#\" + range, tooltip); };\r\n\r\n    /* add to cell comments */\r\n    utils.cell_add_comment = function(cell, text, author) {\r\n      if(!cell.c) cell.c = [];\r\n      cell.c.push({t:text, a:author||\"SheetJS\"});\r\n    };\r\n\r\n    /* set array formula and flush related cells */\r\n    utils.sheet_set_array_formula = function(ws, range, formula) {\r\n      var rng = typeof range != \"string\" ? range : safe_decode_range(range);\r\n      var rngstr = typeof range == \"string\" ? range : encode_range(range);\r\n      for(var R = rng.s.r; R <= rng.e.r; ++R) for(var C = rng.s.c; C <= rng.e.c; ++C) {\r\n        var cell = ws_get_cell_stub(ws, R, C);\r\n        cell.t = 'n';\r\n        cell.F = rngstr;\r\n        delete cell.v;\r\n        if(R == rng.s.r && C == rng.s.c) cell.f = formula;\r\n      }\r\n      return ws;\r\n    };\r\n\r\n    return utils;\r\n  })(utils);\r\n\r\n  if(has_buf && typeof require != 'undefined') (function() {\r\n    var Readable = {}.Readable;\r\n\r\n    var write_csv_stream = function(sheet, opts) {\r\n      var stream = Readable();\r\n      var o = opts == null ? {} : opts;\r\n      if(sheet == null || sheet[\"!ref\"] == null) { stream.push(null); return stream; }\r\n      var r = safe_decode_range(sheet[\"!ref\"]);\r\n      var FS = o.FS !== undefined ? o.FS : \",\", fs = FS.charCodeAt(0);\r\n      var RS = o.RS !== undefined ? o.RS : \"\\n\", rs = RS.charCodeAt(0);\r\n      var endregex = new RegExp((FS==\"|\" ? \"\\\\|\" : FS)+\"+$\");\r\n      var row = \"\", cols = [];\r\n      o.dense = Array.isArray(sheet);\r\n      var colinfo = o.skipHidden && sheet[\"!cols\"] || [];\r\n      var rowinfo = o.skipHidden && sheet[\"!rows\"] || [];\r\n      for(var C = r.s.c; C <= r.e.c; ++C) if (!((colinfo[C]||{}).hidden)) cols[C] = encode_col(C);\r\n      var R = r.s.r;\r\n      var BOM = false;\r\n      stream._read = function() {\r\n        if(!BOM) { BOM = true; return stream.push(\"\\uFEFF\"); }\r\n        if(R > r.e.r) return stream.push(null);\r\n        while(R <= r.e.r) {\r\n          ++R;\r\n          if ((rowinfo[R-1]||{}).hidden) continue;\r\n          row = make_csv_row(sheet, r, R-1, cols, fs, rs, FS, o);\r\n          if(row != null) {\r\n            if(o.strip) row = row.replace(endregex,\"\");\r\n            stream.push(row + RS);\r\n            break;\r\n          }\r\n        }\r\n      };\r\n      return stream;\r\n    };\r\n\r\n    var write_html_stream = function(ws, opts) {\r\n      var stream = Readable();\r\n\r\n      var o = opts || {};\r\n      var header = o.header != null ? o.header : HTML_.BEGIN;\r\n      var footer = o.footer != null ? o.footer : HTML_.END;\r\n      stream.push(header);\r\n      var r = decode_range(ws['!ref']);\r\n      o.dense = Array.isArray(ws);\r\n      stream.push(HTML_._preamble(ws, r, o));\r\n      var R = r.s.r;\r\n      var end = false;\r\n      stream._read = function() {\r\n        if(R > r.e.r) {\r\n          if(!end) { end = true; stream.push(\"</table>\" + footer); }\r\n          return stream.push(null);\r\n        }\r\n        while(R <= r.e.r) {\r\n          stream.push(HTML_._row(ws, r, R, o));\r\n          ++R;\r\n          break;\r\n        }\r\n      };\r\n      return stream;\r\n    };\r\n\r\n    var write_json_stream = function(sheet, opts) {\r\n      var stream = Readable({objectMode:true});\r\n\r\n      if(sheet == null || sheet[\"!ref\"] == null) { stream.push(null); return stream; }\r\n      var val = {t:'n',v:0}, header = 0, offset = 1, hdr = [], v=0, vv=\"\";\r\n      var r = {s:{r:0,c:0},e:{r:0,c:0}};\r\n      var o = opts || {};\r\n      var range = o.range != null ? o.range : sheet[\"!ref\"];\r\n      if(o.header === 1) header = 1;\r\n      else if(o.header === \"A\") header = 2;\r\n      else if(Array.isArray(o.header)) header = 3;\r\n      switch(typeof range) {\r\n        case 'string': r = safe_decode_range(range); break;\r\n        case 'number': r = safe_decode_range(sheet[\"!ref\"]); r.s.r = range; break;\r\n        default: r = range;\r\n      }\r\n      if(header > 0) offset = 0;\r\n      var rr = encode_row(r.s.r);\r\n      var cols = [];\r\n      var counter = 0;\r\n      var dense = Array.isArray(sheet);\r\n      var R = r.s.r, C = 0, CC = 0;\r\n      if(dense && !sheet[R]) sheet[R] = [];\r\n      for(C = r.s.c; C <= r.e.c; ++C) {\r\n        cols[C] = encode_col(C);\r\n        val = dense ? sheet[R][C] : sheet[cols[C] + rr];\r\n        switch(header) {\r\n          case 1: hdr[C] = C - r.s.c; break;\r\n          case 2: hdr[C] = cols[C]; break;\r\n          case 3: hdr[C] = o.header[C - r.s.c]; break;\r\n          default:\r\n            if(val == null) val = {w: \"__EMPTY\", t: \"s\"};\r\n            vv = v = format_cell(val, null, o);\r\n            counter = 0;\r\n            for(CC = 0; CC < hdr.length; ++CC) if(hdr[CC] == vv) vv = v + \"_\" + (++counter);\r\n            hdr[C] = vv;\r\n        }\r\n      }\r\n      R = r.s.r + offset;\r\n      stream._read = function() {\r\n        if(R > r.e.r) return stream.push(null);\r\n        while(R <= r.e.r) {\r\n          //if ((rowinfo[R-1]||{}).hidden) continue;\r\n          var row = make_json_row(sheet, r, R, cols, header, hdr, dense, o);\r\n          ++R;\r\n          if((row.isempty === false) || (header === 1 ? o.blankrows !== false : !!o.blankrows)) {\r\n            stream.push(row.row);\r\n            break;\r\n          }\r\n        }\r\n      };\r\n      return stream;\r\n    };\r\n\r\n    XLSX.stream = {\r\n      to_json: write_json_stream,\r\n      to_html: write_html_stream,\r\n      to_csv: write_csv_stream\r\n    };\r\n  })();\r\n  /**\r\n   *  -- start\r\n   */\r\n  /////////////////////////////////////////////////////////////////////////////////////////////////////\r\n  var XmlNode = (function () {\r\n      function XmlNode(tagName, attributes, children) {\r\n\r\n        if (!(this instanceof XmlNode)) {\r\n          return new XmlNode(tagName, attributes, children);\r\n        }\r\n        this.tagName = tagName;\r\n        this._attributes = attributes || {};\r\n        this._children = children || [];\r\n        this._prefix = '';\r\n        return this;\r\n      }\r\n\r\n      XmlNode.prototype.createElement = function () {\r\n        return new XmlNode(arguments)\r\n      }\r\n\r\n      XmlNode.prototype.children = function() {\r\n        return this._children;\r\n      }\r\n\r\n      XmlNode.prototype.append = function (node) {\r\n        this._children.push(node);\r\n        return this;\r\n      }\r\n\r\n      XmlNode.prototype.prefix = function (prefix) {\r\n        if (arguments.length==0) { return this._prefix;}\r\n        this._prefix = prefix;\r\n        return this;\r\n      }\r\n\r\n      XmlNode.prototype.attr = function (attr, value) {\r\n        if (value == undefined) {\r\n          delete this._attributes[attr];\r\n          return this;\r\n        }\r\n        if (arguments.length == 0) {\r\n          return this._attributes;\r\n        }\r\n        else if (typeof attr == 'string' && arguments.length == 1) {\r\n          return this._attributes.attr[attr];\r\n        }\r\n        if (typeof attr == 'object' && arguments.length == 1) {\r\n          for (var key in attr) {\r\n            this._attributes[key] = attr[key];\r\n          }\r\n        }\r\n        else if (arguments.length == 2 && typeof attr == 'string') {\r\n          this._attributes[attr] = value;\r\n        }\r\n        return this;\r\n      }\r\n\r\n      var APOS = \"'\"; QUOTE = '\"'\r\n      var ESCAPED_QUOTE = {  }\r\n      ESCAPED_QUOTE[QUOTE] = '&quot;'\r\n      ESCAPED_QUOTE[APOS] = '&apos;'\r\n\r\n      XmlNode.prototype.escapeAttributeValue = function(att_value) {\r\n        return '\"' + att_value.replace(/\\\"/g,'&quot;') + '\"';// TODO Extend with four other codes\r\n\r\n      }\r\n\r\n      XmlNode.prototype.toXml = function (node) {\r\n        if (!node) node = this;\r\n        var xml = node._prefix;\r\n        xml += '<' + node.tagName;\r\n        if (node._attributes) {\r\n          for (var key in node._attributes) {\r\n            xml += ' ' + key + '=' + this.escapeAttributeValue(''+node._attributes[key]) + ''\r\n          }\r\n        }\r\n        if (node._children && node._children.length > 0) {\r\n          xml += \">\";\r\n          for (var i = 0; i < node._children.length; i++) {\r\n            xml += this.toXml(node._children[i]);\r\n          }\r\n          xml += '</' + node.tagName + '>';\r\n        }\r\n        else {\r\n          xml += '/>';\r\n        }\r\n        return xml;\r\n      }\r\n      return XmlNode;\r\n    })();\r\n  /////////////////////////////////////////////////////////////////////////////////////////////////////\r\n  var StyleBuilder = function (options) {\r\n\r\n    var customNumFmtId = 164;\r\n\r\n\r\n\r\n    var table_fmt = {\r\n      0:  'General',\r\n      1:  '0',\r\n      2:  '0.00',\r\n      3:  '#,##0',\r\n      4:  '#,##0.00',\r\n      9:  '0%',\r\n      10: '0.00%',\r\n      11: '0.00E+00',\r\n      12: '# ?/?',\r\n      13: '# ??/??',\r\n      14: 'm/d/yy',\r\n      15: 'd-mmm-yy',\r\n      16: 'd-mmm',\r\n      17: 'mmm-yy',\r\n      18: 'h:mm AM/PM',\r\n      19: 'h:mm:ss AM/PM',\r\n      20: 'h:mm',\r\n      21: 'h:mm:ss',\r\n      22: 'm/d/yy h:mm',\r\n      37: '#,##0 ;(#,##0)',\r\n      38: '#,##0 ;[Red](#,##0)',\r\n      39: '#,##0.00;(#,##0.00)',\r\n      40: '#,##0.00;[Red](#,##0.00)',\r\n      45: 'mm:ss',\r\n      46: '[h]:mm:ss',\r\n      47: 'mmss.0',\r\n      48: '##0.0E+0',\r\n      49: '@',\r\n      56: '\"/ \"hh\"\"mm\"\"ss\" \"'    };\r\n    var fmt_table = {};\r\n\r\n    for (var idx in table_fmt) {\r\n      fmt_table[table_fmt[idx]] = idx;\r\n    }\r\n\r\n\r\n    // cache style specs to avoid excessive duplication\r\n    _hashIndex = {};\r\n    _listIndex = [];\r\n\r\n    return {\r\n\r\n      initialize: function (options) {\r\n\r\n        this.$fonts = XmlNode('fonts').attr('count',0).attr(\"x14ac:knownFonts\",\"1\");\r\n        this.$fills = XmlNode('fills').attr('count',0);\r\n        this.$borders = XmlNode('borders').attr('count',0);\r\n        this.$numFmts = XmlNode('numFmts').attr('count',0);\r\n        this.$cellStyleXfs = XmlNode('cellStyleXfs');\r\n        this.$xf = XmlNode('xf')\r\n          .attr('numFmtId', 0)\r\n          .attr('fontId', 0)\r\n          .attr('fillId', 0)\r\n          .attr('borderId', 0);\r\n\r\n        this.$cellXfs = XmlNode('cellXfs').attr('count',0);\r\n        this.$cellStyles = XmlNode('cellStyles')\r\n          .append(XmlNode('cellStyle')\r\n            .attr('name', 'Normal')\r\n            .attr('xfId',0)\r\n            .attr('builtinId',0)\r\n          );\r\n        this.$dxfs = XmlNode('dxfs').attr('count', \"0\");\r\n        this.$tableStyles = XmlNode('tableStyles')\r\n          .attr('count','0')\r\n          .attr('defaultTableStyle','TableStyleMedium9')\r\n          .attr('defaultPivotStyle','PivotStyleMedium4')\r\n\r\n\r\n        this.$styles = XmlNode('styleSheet')\r\n          .attr('xmlns:mc','http://schemas.openxmlformats.org/markup-compatibility/2006')\r\n          .attr('xmlns:x14ac','http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac')\r\n          .attr('xmlns','http://schemas.openxmlformats.org/spreadsheetml/2006/main')\r\n          .attr('mc:Ignorable','x14ac')\r\n          .prefix('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>')\r\n          .append(this.$numFmts)\r\n          .append(this.$fonts)\r\n          .append(this.$fills)\r\n          .append(this.$borders)\r\n          .append(this.$cellStyleXfs.append(this.$xf))\r\n          .append(this.$cellXfs)\r\n          .append(this.$cellStyles)\r\n          .append(this.$dxfs)\r\n          .append(this.$tableStyles);\r\n\r\n\r\n        // need to specify styles at index 0 and 1.\r\n        // the second style MUST be gray125 for some reason\r\n\r\n        var defaultStyle = options.defaultCellStyle || {};\r\n        if (!defaultStyle.font) defaultStyle.font = {name: 'Calibri', sz: '12'};\r\n        if (!defaultStyle.font.name) defaultStyle.font.name = 'Calibri';\r\n        if (!defaultStyle.font.sz) defaultStyle.font.sz = 11;\r\n        if (!defaultStyle.fill) defaultStyle.fill = {  patternType: \"none\", fgColor: {}};\r\n        if (!defaultStyle.border) defaultStyle.border = {};\r\n        if (!defaultStyle.numFmt) defaultStyle.numFmt = 0;\r\n\r\n        this.defaultStyle = defaultStyle;\r\n\r\n        var gray125Style = JSON.parse(JSON.stringify(defaultStyle));\r\n        gray125Style.fill = {patternType: \"gray125\", fgColor: { }}\r\n\r\n        this.addStyles([defaultStyle, gray125Style]);\r\n        return this;\r\n      },\r\n\r\n      // create a style entry and returns an integer index that can be used in the cell .s property\r\n      // these format of this object follows the emerging Common Spreadsheet Format\r\n      addStyle: function (attributes) {\r\n\r\n        var hashKey = JSON.stringify(attributes);\r\n        var index = _hashIndex[hashKey];\r\n        if (index == undefined) {\r\n\r\n          index = this._addXf(attributes); //_listIndex.push(attributes) -1;\r\n          _hashIndex[hashKey] = index;\r\n        }\r\n        else {\r\n          index = _hashIndex[hashKey];\r\n        }\r\n        return index;\r\n      },\r\n\r\n      // create style entries and returns array of integer indexes that can be used in cell .s property\r\n      addStyles: function (styles) {\r\n        var self = this;\r\n        return styles.map(function (style) {\r\n          return self.addStyle(style);\r\n        })\r\n      },\r\n\r\n      _duckTypeStyle: function(attributes) {\r\n\r\n        if (typeof attributes == 'object' && (attributes.patternFill || attributes.fgColor)) {\r\n          return {fill: attributes }; // this must be read via XLSX.parseFile(...)\r\n        }\r\n        else if (attributes.font || attributes.numFmt || attributes.border || attributes.fill) {\r\n          return attributes;\r\n        }\r\n        else {\r\n          return this._getStyleCSS(attributes)\r\n        }\r\n      },\r\n\r\n      _getStyleCSS: function(css) {\r\n        return css; //TODO\r\n      },\r\n\r\n      // Create an <xf> record for the style as well as corresponding <font>, <fill>, <border>, <numfmts>\r\n      // Right now this is simple and creates a <font>, <fill>, <border>, <numfmts> for every <xf>\r\n      // We could perhaps get fancier and avoid duplicating  auxiliary entries as Excel presumably intended, but bother.\r\n      _addXf: function (attributes) {\r\n\r\n\r\n        var fontId = this._addFont(attributes.font);\r\n        var fillId = this._addFill(attributes.fill);\r\n        var borderId = this._addBorder(attributes.border);\r\n        var numFmtId = this._addNumFmt(attributes.numFmt);\r\n\r\n        var $xf = XmlNode('xf')\r\n          .attr(\"numFmtId\", numFmtId)\r\n          .attr(\"fontId\", fontId)\r\n          .attr(\"fillId\", fillId)\r\n          .attr(\"borderId\", borderId)\r\n          .attr(\"xfId\", \"0\");\r\n\r\n        if (fontId > 0) {\r\n          $xf.attr('applyFont', \"1\");\r\n        }\r\n        if (fillId > 0) {\r\n          $xf.attr('applyFill', \"1\");\r\n        }\r\n        if (borderId > 0) {\r\n          $xf.attr('applyBorder', \"1\");\r\n        }\r\n        if (numFmtId > 0) {\r\n          $xf.attr('applyNumberFormat', \"1\");\r\n        }\r\n\r\n        if (attributes.alignment) {\r\n          var $alignment = XmlNode('alignment');\r\n          if (attributes.alignment.horizontal) { $alignment.attr('horizontal', attributes.alignment.horizontal);}\r\n          if (attributes.alignment.vertical)  { $alignment.attr('vertical', attributes.alignment.vertical);}\r\n          if (attributes.alignment.indent)  { $alignment.attr('indent', attributes.alignment.indent);}\r\n          if (attributes.alignment.readingOrder)  { $alignment.attr('readingOrder', attributes.alignment.readingOrder);}\r\n          if (attributes.alignment.wrapText)  { $alignment.attr('wrapText', attributes.alignment.wrapText);}\r\n          if (attributes.alignment.textRotation!=undefined)  { $alignment.attr('textRotation', attributes.alignment.textRotation);}\r\n\r\n          $xf.append($alignment).attr('applyAlignment',1)\r\n\r\n        }\r\n        this.$cellXfs.append($xf);\r\n        var count = +this.$cellXfs.children().length;\r\n\r\n        this.$cellXfs.attr('count', count);\r\n        return count - 1;\r\n      },\r\n\r\n      _addFont: function (attributes) {\r\n\r\n        if (!attributes) {  return 0; }\r\n\r\n        var $font = XmlNode('font')\r\n          .append(XmlNode('sz').attr('val', attributes.sz || this.defaultStyle.font.sz))\r\n          .append(XmlNode('name').attr('val', attributes.name || this.defaultStyle.font.name))\r\n\r\n        if (attributes.bold) $font.append(XmlNode('b'));\r\n        if (attributes.underline)  $font.append(XmlNode('u'));\r\n        if (attributes.italic)  $font.append(XmlNode('i'));\r\n        if (attributes.strike)  $font.append(XmlNode('strike'));\r\n        if (attributes.outline)  $font.append(XmlNode('outline'));\r\n        if (attributes.shadow)  $font.append(XmlNode('shadow'));\r\n\r\n        if (attributes.vertAlign) {\r\n          $font.append(XmlNode('vertAlign').attr('val', attributes.vertAlign))\r\n        }\r\n\r\n\r\n        if (attributes.color) {\r\n          if (attributes.color.theme) {\r\n            $font.append(XmlNode('color').attr('theme', attributes.color.theme))\r\n\r\n            if (attributes.color.tint) { //tint only if theme\r\n              $font.append(XmlNode('tint').attr('theme', attributes.color.tint))\r\n            }\r\n\r\n          } else if (attributes.color.rgb) { // not both rgb and theme\r\n            $font.append(XmlNode('color').attr('rgb', attributes.color.rgb))\r\n          }\r\n        }\r\n\r\n        this.$fonts.append($font);\r\n\r\n        var count = this.$fonts.children().length;\r\n        this.$fonts.attr('count', count);\r\n        return count - 1;\r\n      },\r\n\r\n      _addNumFmt: function (numFmt) {\r\n        if (!numFmt) { return 0; }\r\n\r\n        if (typeof numFmt == 'string') {\r\n          var numFmtIdx = fmt_table[numFmt];\r\n          if (numFmtIdx >= 0) {\r\n            return numFmtIdx; // we found a match against built in formats\r\n          }\r\n        }\r\n\r\n        if (/^[0-9]+$/.exec(numFmt)) {\r\n          return numFmt; // we're matching an integer against some known code\r\n        }\r\n        numFmt = numFmt\r\n          .replace(/&/g, '&amp;')\r\n          .replace(/</g, '&lt;')\r\n          .replace(/>/g, '&gt;')\r\n          .replace(/\"/g, '&quot;')\r\n          .replace(/'/g, '&apos;');\r\n\r\n        var $numFmt = XmlNode('numFmt')\r\n          .attr('numFmtId', (++customNumFmtId))\r\n          .attr('formatCode', numFmt);\r\n\r\n        this.$numFmts.append($numFmt);\r\n\r\n        var count = this.$numFmts.children().length;\r\n        this.$numFmts.attr('count', count);\r\n        return customNumFmtId ;\r\n      },\r\n\r\n      _addFill: function (attributes) {\r\n\r\n        if (!attributes) { return 0; }\r\n\r\n        var $patternFill = XmlNode('patternFill')\r\n          .attr('patternType', attributes.patternType || 'solid');\r\n\r\n        if (attributes.fgColor) {\r\n          var $fgColor = XmlNode('fgColor');\r\n\r\n          //Excel doesn't like it when we set both rgb and theme+tint, but xlsx.parseFile() sets both\r\n          //var $fgColor = createElement('<fgColor/>', null, null, {xmlMode: true}).attr(attributes.fgColor)\r\n          if (attributes.fgColor.rgb) {\r\n\r\n            if (attributes.fgColor.rgb.length == 6) {\r\n              attributes.fgColor.rgb = \"FF\" + attributes.fgColor.rgb /// add alpha to an RGB as Excel expects aRGB\r\n            }\r\n\r\n            $fgColor.attr('rgb', attributes.fgColor.rgb);\r\n            $patternFill.append($fgColor);\r\n          }\r\n          else if (attributes.fgColor.theme) {\r\n            $fgColor.attr('theme', attributes.fgColor.theme);\r\n            if (attributes.fgColor.tint) {\r\n              $fgColor.attr('tint', attributes.fgColor.tint);\r\n            }\r\n            $patternFill.append($fgColor);\r\n          }\r\n\r\n          if (!attributes.bgColor) {\r\n            attributes.bgColor = { \"indexed\": \"64\"}\r\n          }\r\n        }\r\n\r\n        if (attributes.bgColor) {\r\n          var $bgColor = XmlNode('bgColor').attr(attributes.bgColor);\r\n          $patternFill.append($bgColor);\r\n        }\r\n\r\n        var $fill = XmlNode('fill')\r\n          .append($patternFill);\r\n\r\n        this.$fills.append($fill);\r\n\r\n        var count = this.$fills.children().length;\r\n        this.$fills.attr('count', count);\r\n        return count - 1;\r\n      },\r\n\r\n      _getSubBorder: function(direction, spec) {\r\n\r\n        var $direction = XmlNode(direction);\r\n        if (spec){\r\n          if (spec.style) $direction.attr('style', spec.style);\r\n          if (spec.color) {\r\n            var $color = XmlNode('color');\r\n            if (spec.color.auto) {\r\n              $color.attr('auto', spec.color.auto);\r\n            }\r\n            else if (spec.color.rgb) {\r\n              $color.attr('rgb', spec.color.rgb);\r\n            }\r\n            else if (spec.color.theme || spec.color.tint) {\r\n              $color.attr('theme', spec.color.theme || \"1\");\r\n              $color.attr('tint', spec.color.tint || \"0\");\r\n            }\r\n            $direction.append($color)\r\n          }\r\n        }\r\n        return $direction;\r\n      },\r\n\r\n      _addBorder: function (attributes) {\r\n        if (!attributes) { return 0; }\r\n\r\n        var self = this;\r\n\r\n        var $border = XmlNode('border')\r\n          .attr(\"diagonalUp\",attributes.diagonalUp)\r\n          .attr(\"diagonalDown\",attributes.diagonalDown);\r\n\r\n        var directions = [\"left\",\"right\",\"top\",\"bottom\",\"diagonal\"];\r\n\r\n        directions.forEach(function(direction) {\r\n          $border.append(self._getSubBorder(direction, attributes[direction]))\r\n        });\r\n        this.$borders.append($border);\r\n\r\n        var count = this.$borders.children().length;\r\n        this.$borders.attr('count', count);\r\n        return count -1;\r\n      },\r\n\r\n      toXml: function () {\r\n        return this.$styles.toXml();\r\n      }\r\n    }.initialize(options||{});\r\n  }\r\n  /**\r\n   *  -- end\r\n   */\r\n\r\n  XLSX.parse_xlscfb = parse_xlscfb;\r\n  XLSX.parse_ods = parse_ods;\r\n  XLSX.parse_fods = parse_fods;\r\n  XLSX.write_ods = write_ods;\r\n  XLSX.parse_zip = parse_zip;\r\n  XLSX.read = readSync; //xlsread\r\n  XLSX.readFile = readFileSync; //readFile\r\n  XLSX.readFileSync = readFileSync;\r\n  XLSX.write = writeSync;\r\n  XLSX.writeFile = writeFileSync;\r\n  XLSX.writeFileSync = writeFileSync;\r\n  XLSX.writeFileAsync = writeFileAsync;\r\n  XLSX.utils = utils;\r\n  XLSX.SSF = SSF;\r\n  XLSX.CFB = CFB;\r\n}\r\n/*global define */\r\nif(typeof exports !== 'undefined') make_xlsx_lib(exports);\r\nelse if(typeof module !== 'undefined' && module.exports) make_xlsx_lib(module.exports);\r\nelse if(typeof define === 'function' && define.amd) define('xlsx', function() { if(!XLSX.version) make_xlsx_lib(XLSX); return XLSX; });\r\nelse make_xlsx_lib(XLSX);\r\n// make_xlsx_lib(XLSX);\r\n/*exported XLS, ODS */\r\n// var XLS = XLSX, ODS = XLSX;\r\n","\"use strict\";\n\nrequire(\"core-js/shim\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nrequire(\"core-js/fn/regexp/escape\");\n\nif (global._babelPolyfill) {\n  throw new Error(\"only one instance of babel-polyfill is allowed\");\n}\nglobal._babelPolyfill = true;\n\nvar DEFINE_PROPERTY = \"defineProperty\";\nfunction define(O, key, value) {\n  O[key] || Object[DEFINE_PROPERTY](O, key, {\n    writable: true,\n    configurable: true,\n    value: value\n  });\n}\n\ndefine(String.prototype, \"padLeft\", \"\".padStart);\ndefine(String.prototype, \"padRight\", \"\".padEnd);\n\n\"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill\".split(\",\").forEach(function (key) {\n  [][key] && define(Array, key, Function.call.bind([][key]));\n});","/**\r\n * Create a blob builder even when vendor prefixes exist\r\n */\r\n\r\nvar BlobBuilder = typeof BlobBuilder !== 'undefined' ? BlobBuilder :\r\n  typeof WebKitBlobBuilder !== 'undefined' ? WebKitBlobBuilder :\r\n  typeof MSBlobBuilder !== 'undefined' ? MSBlobBuilder :\r\n  typeof MozBlobBuilder !== 'undefined' ? MozBlobBuilder : \r\n  false;\r\n\r\n/**\r\n * Check if Blob constructor is supported\r\n */\r\n\r\nvar blobSupported = (function() {\r\n  try {\r\n    var a = new Blob(['hi']);\r\n    return a.size === 2;\r\n  } catch(e) {\r\n    return false;\r\n  }\r\n})();\r\n\r\n/**\r\n * Check if Blob constructor supports ArrayBufferViews\r\n * Fails in Safari 6, so we need to map to ArrayBuffers there.\r\n */\r\n\r\nvar blobSupportsArrayBufferView = blobSupported && (function() {\r\n  try {\r\n    var b = new Blob([new Uint8Array([1,2])]);\r\n    return b.size === 2;\r\n  } catch(e) {\r\n    return false;\r\n  }\r\n})();\r\n\r\n/**\r\n * Check if BlobBuilder is supported\r\n */\r\n\r\nvar blobBuilderSupported = BlobBuilder\r\n  && BlobBuilder.prototype.append\r\n  && BlobBuilder.prototype.getBlob;\r\n\r\n/**\r\n * Helper function that maps ArrayBufferViews to ArrayBuffers\r\n * Used by BlobBuilder constructor and old browsers that didn't\r\n * support it in the Blob constructor.\r\n */\r\n\r\nfunction mapArrayBufferViews(ary) {\r\n  return ary.map(function(chunk) {\r\n    if (chunk.buffer instanceof ArrayBuffer) {\r\n      var buf = chunk.buffer;\r\n\r\n      // if this is a subarray, make a copy so we only\r\n      // include the subarray region from the underlying buffer\r\n      if (chunk.byteLength !== buf.byteLength) {\r\n        var copy = new Uint8Array(chunk.byteLength);\r\n        copy.set(new Uint8Array(buf, chunk.byteOffset, chunk.byteLength));\r\n        buf = copy.buffer;\r\n      }\r\n\r\n      return buf;\r\n    }\r\n\r\n    return chunk;\r\n  });\r\n}\r\n\r\nfunction BlobBuilderConstructor(ary, options) {\r\n  options = options || {};\r\n\r\n  var bb = new BlobBuilder();\r\n  mapArrayBufferViews(ary).forEach(function(part) {\r\n    bb.append(part);\r\n  });\r\n\r\n  return (options.type) ? bb.getBlob(options.type) : bb.getBlob();\r\n}\r\n\r\nfunction BlobConstructor(ary, options) {\r\n  return new Blob(mapArrayBufferViews(ary), options || {});\r\n}\r\n\r\nif (typeof Blob !== 'undefined') {\r\n  BlobBuilderConstructor.prototype = Blob.prototype;\r\n  BlobConstructor.prototype = Blob.prototype;\r\n}\r\n\r\nexport default (function() {\r\n  if (blobSupported) {\r\n    return blobSupportsArrayBufferView ? Blob : BlobConstructor;\r\n  } else if (blobBuilderSupported) {\r\n    return BlobBuilderConstructor;\r\n  } else {\r\n    return undefined;\r\n  }\r\n})();\r\n","require('../../modules/core.regexp.escape');\nmodule.exports = require('../../modules/_core').RegExp.escape;\n","module.exports = function (it) {\n  if (typeof it != 'function') throw TypeError(it + ' is not a function!');\n  return it;\n};\n","var cof = require('./_cof');\nmodule.exports = function (it, msg) {\n  if (typeof it != 'number' && cof(it) != 'Number') throw TypeError(msg);\n  return +it;\n};\n","// 22.1.3.31 Array.prototype[@@unscopables]\nvar UNSCOPABLES = require('./_wks')('unscopables');\nvar ArrayProto = Array.prototype;\nif (ArrayProto[UNSCOPABLES] == undefined) require('./_hide')(ArrayProto, UNSCOPABLES, {});\nmodule.exports = function (key) {\n  ArrayProto[UNSCOPABLES][key] = true;\n};\n","'use strict';\nvar at = require('./_string-at')(true);\n\n // `AdvanceStringIndex` abstract operation\n// https://tc39.github.io/ecma262/#sec-advancestringindex\nmodule.exports = function (S, index, unicode) {\n  return index + (unicode ? at(S, index).length : 1);\n};\n","module.exports = function (it, Constructor, name, forbiddenField) {\n  if (!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)) {\n    throw TypeError(name + ': incorrect invocation!');\n  } return it;\n};\n","var isObject = require('./_is-object');\nmodule.exports = function (it) {\n  if (!isObject(it)) throw TypeError(it + ' is not an object!');\n  return it;\n};\n","// 22.1.3.3 Array.prototype.copyWithin(target, start, end = this.length)\n'use strict';\nvar toObject = require('./_to-object');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nvar toLength = require('./_to-length');\n\nmodule.exports = [].copyWithin || function copyWithin(target /* = 0 */, start /* = 0, end = @length */) {\n  var O = toObject(this);\n  var len = toLength(O.length);\n  var to = toAbsoluteIndex(target, len);\n  var from = toAbsoluteIndex(start, len);\n  var end = arguments.length > 2 ? arguments[2] : undefined;\n  var count = Math.min((end === undefined ? len : toAbsoluteIndex(end, len)) - from, len - to);\n  var inc = 1;\n  if (from < to && to < from + count) {\n    inc = -1;\n    from += count - 1;\n    to += count - 1;\n  }\n  while (count-- > 0) {\n    if (from in O) O[to] = O[from];\n    else delete O[to];\n    to += inc;\n    from += inc;\n  } return O;\n};\n","// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)\n'use strict';\nvar toObject = require('./_to-object');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nvar toLength = require('./_to-length');\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = toLength(O.length);\n  var aLen = arguments.length;\n  var index = toAbsoluteIndex(aLen > 1 ? arguments[1] : undefined, length);\n  var end = aLen > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n","var forOf = require('./_for-of');\n\nmodule.exports = function (iter, ITERATOR) {\n  var result = [];\n  forOf(iter, false, result.push, result, ITERATOR);\n  return result;\n};\n","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject');\nvar toLength = require('./_to-length');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nmodule.exports = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {\n      if (O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n","// 0 -> Array#forEach\n// 1 -> Array#map\n// 2 -> Array#filter\n// 3 -> Array#some\n// 4 -> Array#every\n// 5 -> Array#find\n// 6 -> Array#findIndex\nvar ctx = require('./_ctx');\nvar IObject = require('./_iobject');\nvar toObject = require('./_to-object');\nvar toLength = require('./_to-length');\nvar asc = require('./_array-species-create');\nmodule.exports = function (TYPE, $create) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  var create = $create || asc;\n  return function ($this, callbackfn, that) {\n    var O = toObject($this);\n    var self = IObject(O);\n    var f = ctx(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var result = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var val, res;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      val = self[index];\n      res = f(val, index, O);\n      if (TYPE) {\n        if (IS_MAP) result[index] = res;   // map\n        else if (res) switch (TYPE) {\n          case 3: return true;             // some\n          case 5: return val;              // find\n          case 6: return index;            // findIndex\n          case 2: result.push(val);        // filter\n        } else if (IS_EVERY) return false; // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : result;\n  };\n};\n","var aFunction = require('./_a-function');\nvar toObject = require('./_to-object');\nvar IObject = require('./_iobject');\nvar toLength = require('./_to-length');\n\nmodule.exports = function (that, callbackfn, aLen, memo, isRight) {\n  aFunction(callbackfn);\n  var O = toObject(that);\n  var self = IObject(O);\n  var length = toLength(O.length);\n  var index = isRight ? length - 1 : 0;\n  var i = isRight ? -1 : 1;\n  if (aLen < 2) for (;;) {\n    if (index in self) {\n      memo = self[index];\n      index += i;\n      break;\n    }\n    index += i;\n    if (isRight ? index < 0 : length <= index) {\n      throw TypeError('Reduce of empty array with no initial value');\n    }\n  }\n  for (;isRight ? index >= 0 : length > index; index += i) if (index in self) {\n    memo = callbackfn(memo, self[index], index, O);\n  }\n  return memo;\n};\n","var isObject = require('./_is-object');\nvar isArray = require('./_is-array');\nvar SPECIES = require('./_wks')('species');\n\nmodule.exports = function (original) {\n  var C;\n  if (isArray(original)) {\n    C = original.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return C === undefined ? Array : C;\n};\n","// 9.4.2.3 ArraySpeciesCreate(originalArray, length)\nvar speciesConstructor = require('./_array-species-constructor');\n\nmodule.exports = function (original, length) {\n  return new (speciesConstructor(original))(length);\n};\n","'use strict';\nvar aFunction = require('./_a-function');\nvar isObject = require('./_is-object');\nvar invoke = require('./_invoke');\nvar arraySlice = [].slice;\nvar factories = {};\n\nvar construct = function (F, len, args) {\n  if (!(len in factories)) {\n    for (var n = [], i = 0; i < len; i++) n[i] = 'a[' + i + ']';\n    // eslint-disable-next-line no-new-func\n    factories[len] = Function('F,a', 'return new F(' + n.join(',') + ')');\n  } return factories[len](F, args);\n};\n\nmodule.exports = Function.bind || function bind(that /* , ...args */) {\n  var fn = aFunction(this);\n  var partArgs = arraySlice.call(arguments, 1);\n  var bound = function (/* args... */) {\n    var args = partArgs.concat(arraySlice.call(arguments));\n    return this instanceof bound ? construct(fn, args.length, args) : invoke(fn, args, that);\n  };\n  if (isObject(fn.prototype)) bound.prototype = fn.prototype;\n  return bound;\n};\n","// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = require('./_cof');\nvar TAG = require('./_wks')('toStringTag');\n// ES3 wrong here\nvar ARG = cof(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (e) { /* empty */ }\n};\n\nmodule.exports = function (it) {\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","'use strict';\nvar dP = require('./_object-dp').f;\nvar create = require('./_object-create');\nvar redefineAll = require('./_redefine-all');\nvar ctx = require('./_ctx');\nvar anInstance = require('./_an-instance');\nvar forOf = require('./_for-of');\nvar $iterDefine = require('./_iter-define');\nvar step = require('./_iter-step');\nvar setSpecies = require('./_set-species');\nvar DESCRIPTORS = require('./_descriptors');\nvar fastKey = require('./_meta').fastKey;\nvar validate = require('./_validate-collection');\nvar SIZE = DESCRIPTORS ? '_s' : 'size';\n\nvar getEntry = function (that, key) {\n  // fast case\n  var index = fastKey(key);\n  var entry;\n  if (index !== 'F') return that._i[index];\n  // frozen object case\n  for (entry = that._f; entry; entry = entry.n) {\n    if (entry.k == key) return entry;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function (wrapper, NAME, IS_MAP, ADDER) {\n    var C = wrapper(function (that, iterable) {\n      anInstance(that, C, NAME, '_i');\n      that._t = NAME;         // collection type\n      that._i = create(null); // index\n      that._f = undefined;    // first entry\n      that._l = undefined;    // last entry\n      that[SIZE] = 0;         // size\n      if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);\n    });\n    redefineAll(C.prototype, {\n      // 23.1.3.1 Map.prototype.clear()\n      // 23.2.3.2 Set.prototype.clear()\n      clear: function clear() {\n        for (var that = validate(this, NAME), data = that._i, entry = that._f; entry; entry = entry.n) {\n          entry.r = true;\n          if (entry.p) entry.p = entry.p.n = undefined;\n          delete data[entry.i];\n        }\n        that._f = that._l = undefined;\n        that[SIZE] = 0;\n      },\n      // 23.1.3.3 Map.prototype.delete(key)\n      // 23.2.3.4 Set.prototype.delete(value)\n      'delete': function (key) {\n        var that = validate(this, NAME);\n        var entry = getEntry(that, key);\n        if (entry) {\n          var next = entry.n;\n          var prev = entry.p;\n          delete that._i[entry.i];\n          entry.r = true;\n          if (prev) prev.n = next;\n          if (next) next.p = prev;\n          if (that._f == entry) that._f = next;\n          if (that._l == entry) that._l = prev;\n          that[SIZE]--;\n        } return !!entry;\n      },\n      // 23.2.3.6 Set.prototype.forEach(callbackfn, thisArg = undefined)\n      // 23.1.3.5 Map.prototype.forEach(callbackfn, thisArg = undefined)\n      forEach: function forEach(callbackfn /* , that = undefined */) {\n        validate(this, NAME);\n        var f = ctx(callbackfn, arguments.length > 1 ? arguments[1] : undefined, 3);\n        var entry;\n        while (entry = entry ? entry.n : this._f) {\n          f(entry.v, entry.k, this);\n          // revert to the last existing entry\n          while (entry && entry.r) entry = entry.p;\n        }\n      },\n      // 23.1.3.7 Map.prototype.has(key)\n      // 23.2.3.7 Set.prototype.has(value)\n      has: function has(key) {\n        return !!getEntry(validate(this, NAME), key);\n      }\n    });\n    if (DESCRIPTORS) dP(C.prototype, 'size', {\n      get: function () {\n        return validate(this, NAME)[SIZE];\n      }\n    });\n    return C;\n  },\n  def: function (that, key, value) {\n    var entry = getEntry(that, key);\n    var prev, index;\n    // change existing entry\n    if (entry) {\n      entry.v = value;\n    // create new entry\n    } else {\n      that._l = entry = {\n        i: index = fastKey(key, true), // <- index\n        k: key,                        // <- key\n        v: value,                      // <- value\n        p: prev = that._l,             // <- previous entry\n        n: undefined,                  // <- next entry\n        r: false                       // <- removed\n      };\n      if (!that._f) that._f = entry;\n      if (prev) prev.n = entry;\n      that[SIZE]++;\n      // add to index\n      if (index !== 'F') that._i[index] = entry;\n    } return that;\n  },\n  getEntry: getEntry,\n  setStrong: function (C, NAME, IS_MAP) {\n    // add .keys, .values, .entries, [@@iterator]\n    // 23.1.3.4, 23.1.3.8, 23.1.3.11, 23.1.3.12, 23.2.3.5, 23.2.3.8, 23.2.3.10, 23.2.3.11\n    $iterDefine(C, NAME, function (iterated, kind) {\n      this._t = validate(iterated, NAME); // target\n      this._k = kind;                     // kind\n      this._l = undefined;                // previous\n    }, function () {\n      var that = this;\n      var kind = that._k;\n      var entry = that._l;\n      // revert to the last existing entry\n      while (entry && entry.r) entry = entry.p;\n      // get next entry\n      if (!that._t || !(that._l = entry = entry ? entry.n : that._t._f)) {\n        // or finish the iteration\n        that._t = undefined;\n        return step(1);\n      }\n      // return step by kind\n      if (kind == 'keys') return step(0, entry.k);\n      if (kind == 'values') return step(0, entry.v);\n      return step(0, [entry.k, entry.v]);\n    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);\n\n    // add [@@species], 23.1.2.2, 23.2.2.2\n    setSpecies(NAME);\n  }\n};\n","// https://github.com/DavidBruant/Map-Set.prototype.toJSON\nvar classof = require('./_classof');\nvar from = require('./_array-from-iterable');\nmodule.exports = function (NAME) {\n  return function toJSON() {\n    if (classof(this) != NAME) throw TypeError(NAME + \"#toJSON isn't generic\");\n    return from(this);\n  };\n};\n","'use strict';\nvar redefineAll = require('./_redefine-all');\nvar getWeak = require('./_meta').getWeak;\nvar anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar anInstance = require('./_an-instance');\nvar forOf = require('./_for-of');\nvar createArrayMethod = require('./_array-methods');\nvar $has = require('./_has');\nvar validate = require('./_validate-collection');\nvar arrayFind = createArrayMethod(5);\nvar arrayFindIndex = createArrayMethod(6);\nvar id = 0;\n\n// fallback for uncaught frozen keys\nvar uncaughtFrozenStore = function (that) {\n  return that._l || (that._l = new UncaughtFrozenStore());\n};\nvar UncaughtFrozenStore = function () {\n  this.a = [];\n};\nvar findUncaughtFrozen = function (store, key) {\n  return arrayFind(store.a, function (it) {\n    return it[0] === key;\n  });\n};\nUncaughtFrozenStore.prototype = {\n  get: function (key) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) return entry[1];\n  },\n  has: function (key) {\n    return !!findUncaughtFrozen(this, key);\n  },\n  set: function (key, value) {\n    var entry = findUncaughtFrozen(this, key);\n    if (entry) entry[1] = value;\n    else this.a.push([key, value]);\n  },\n  'delete': function (key) {\n    var index = arrayFindIndex(this.a, function (it) {\n      return it[0] === key;\n    });\n    if (~index) this.a.splice(index, 1);\n    return !!~index;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function (wrapper, NAME, IS_MAP, ADDER) {\n    var C = wrapper(function (that, iterable) {\n      anInstance(that, C, NAME, '_i');\n      that._t = NAME;      // collection type\n      that._i = id++;      // collection id\n      that._l = undefined; // leak store for uncaught frozen objects\n      if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);\n    });\n    redefineAll(C.prototype, {\n      // 23.3.3.2 WeakMap.prototype.delete(key)\n      // 23.4.3.3 WeakSet.prototype.delete(value)\n      'delete': function (key) {\n        if (!isObject(key)) return false;\n        var data = getWeak(key);\n        if (data === true) return uncaughtFrozenStore(validate(this, NAME))['delete'](key);\n        return data && $has(data, this._i) && delete data[this._i];\n      },\n      // 23.3.3.4 WeakMap.prototype.has(key)\n      // 23.4.3.4 WeakSet.prototype.has(value)\n      has: function has(key) {\n        if (!isObject(key)) return false;\n        var data = getWeak(key);\n        if (data === true) return uncaughtFrozenStore(validate(this, NAME)).has(key);\n        return data && $has(data, this._i);\n      }\n    });\n    return C;\n  },\n  def: function (that, key, value) {\n    var data = getWeak(anObject(key), true);\n    if (data === true) uncaughtFrozenStore(that).set(key, value);\n    else data[that._i] = value;\n    return that;\n  },\n  ufstore: uncaughtFrozenStore\n};\n","'use strict';\nvar global = require('./_global');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar redefineAll = require('./_redefine-all');\nvar meta = require('./_meta');\nvar forOf = require('./_for-of');\nvar anInstance = require('./_an-instance');\nvar isObject = require('./_is-object');\nvar fails = require('./_fails');\nvar $iterDetect = require('./_iter-detect');\nvar setToStringTag = require('./_set-to-string-tag');\nvar inheritIfRequired = require('./_inherit-if-required');\n\nmodule.exports = function (NAME, wrapper, methods, common, IS_MAP, IS_WEAK) {\n  var Base = global[NAME];\n  var C = Base;\n  var ADDER = IS_MAP ? 'set' : 'add';\n  var proto = C && C.prototype;\n  var O = {};\n  var fixMethod = function (KEY) {\n    var fn = proto[KEY];\n    redefine(proto, KEY,\n      KEY == 'delete' ? function (a) {\n        return IS_WEAK && !isObject(a) ? false : fn.call(this, a === 0 ? 0 : a);\n      } : KEY == 'has' ? function has(a) {\n        return IS_WEAK && !isObject(a) ? false : fn.call(this, a === 0 ? 0 : a);\n      } : KEY == 'get' ? function get(a) {\n        return IS_WEAK && !isObject(a) ? undefined : fn.call(this, a === 0 ? 0 : a);\n      } : KEY == 'add' ? function add(a) { fn.call(this, a === 0 ? 0 : a); return this; }\n        : function set(a, b) { fn.call(this, a === 0 ? 0 : a, b); return this; }\n    );\n  };\n  if (typeof C != 'function' || !(IS_WEAK || proto.forEach && !fails(function () {\n    new C().entries().next();\n  }))) {\n    // create collection constructor\n    C = common.getConstructor(wrapper, NAME, IS_MAP, ADDER);\n    redefineAll(C.prototype, methods);\n    meta.NEED = true;\n  } else {\n    var instance = new C();\n    // early implementations not supports chaining\n    var HASNT_CHAINING = instance[ADDER](IS_WEAK ? {} : -0, 1) != instance;\n    // V8 ~  Chromium 40- weak-collections throws on primitives, but should return false\n    var THROWS_ON_PRIMITIVES = fails(function () { instance.has(1); });\n    // most early implementations doesn't supports iterables, most modern - not close it correctly\n    var ACCEPT_ITERABLES = $iterDetect(function (iter) { new C(iter); }); // eslint-disable-line no-new\n    // for early implementations -0 and +0 not the same\n    var BUGGY_ZERO = !IS_WEAK && fails(function () {\n      // V8 ~ Chromium 42- fails only with 5+ elements\n      var $instance = new C();\n      var index = 5;\n      while (index--) $instance[ADDER](index, index);\n      return !$instance.has(-0);\n    });\n    if (!ACCEPT_ITERABLES) {\n      C = wrapper(function (target, iterable) {\n        anInstance(target, C, NAME);\n        var that = inheritIfRequired(new Base(), target, C);\n        if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);\n        return that;\n      });\n      C.prototype = proto;\n      proto.constructor = C;\n    }\n    if (THROWS_ON_PRIMITIVES || BUGGY_ZERO) {\n      fixMethod('delete');\n      fixMethod('has');\n      IS_MAP && fixMethod('get');\n    }\n    if (BUGGY_ZERO || HASNT_CHAINING) fixMethod(ADDER);\n    // weak collections should not contains .clear method\n    if (IS_WEAK && proto.clear) delete proto.clear;\n  }\n\n  setToStringTag(C, NAME);\n\n  O[NAME] = C;\n  $export($export.G + $export.W + $export.F * (C != Base), O);\n\n  if (!IS_WEAK) common.setStrong(C, NAME, IS_MAP);\n\n  return C;\n};\n","var core = module.exports = { version: '2.6.11' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n","'use strict';\nvar $defineProperty = require('./_object-dp');\nvar createDesc = require('./_property-desc');\n\nmodule.exports = function (object, index, value) {\n  if (index in object) $defineProperty.f(object, index, createDesc(0, value));\n  else object[index] = value;\n};\n","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","'use strict';\n// 20.3.4.36 / 15.9.5.43 Date.prototype.toISOString()\nvar fails = require('./_fails');\nvar getTime = Date.prototype.getTime;\nvar $toISOString = Date.prototype.toISOString;\n\nvar lz = function (num) {\n  return num > 9 ? num : '0' + num;\n};\n\n// PhantomJS / old WebKit has a broken implementations\nmodule.exports = (fails(function () {\n  return $toISOString.call(new Date(-5e13 - 1)) != '0385-07-25T07:06:39.999Z';\n}) || !fails(function () {\n  $toISOString.call(new Date(NaN));\n})) ? function toISOString() {\n  if (!isFinite(getTime.call(this))) throw RangeError('Invalid time value');\n  var d = this;\n  var y = d.getUTCFullYear();\n  var m = d.getUTCMilliseconds();\n  var s = y < 0 ? '-' : y > 9999 ? '+' : '';\n  return s + ('00000' + Math.abs(y)).slice(s ? -6 : -4) +\n    '-' + lz(d.getUTCMonth() + 1) + '-' + lz(d.getUTCDate()) +\n    'T' + lz(d.getUTCHours()) + ':' + lz(d.getUTCMinutes()) +\n    ':' + lz(d.getUTCSeconds()) + '.' + (m > 99 ? m : '0' + lz(m)) + 'Z';\n} : $toISOString;\n","'use strict';\nvar anObject = require('./_an-object');\nvar toPrimitive = require('./_to-primitive');\nvar NUMBER = 'number';\n\nmodule.exports = function (hint) {\n  if (hint !== 'string' && hint !== NUMBER && hint !== 'default') throw TypeError('Incorrect hint');\n  return toPrimitive(anObject(this), hint != NUMBER);\n};\n","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n","var isObject = require('./_is-object');\nvar document = require('./_global').document;\n// typeof document.createElement is 'object' in old IE\nvar is = isObject(document) && isObject(document.createElement);\nmodule.exports = function (it) {\n  return is ? document.createElement(it) : {};\n};\n","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n","// all enumerable object keys, includes symbols\nvar getKeys = require('./_object-keys');\nvar gOPS = require('./_object-gops');\nvar pIE = require('./_object-pie');\nmodule.exports = function (it) {\n  var result = getKeys(it);\n  var getSymbols = gOPS.f;\n  if (getSymbols) {\n    var symbols = getSymbols(it);\n    var isEnum = pIE.f;\n    var i = 0;\n    var key;\n    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);\n  } return result;\n};\n","var global = require('./_global');\nvar core = require('./_core');\nvar hide = require('./_hide');\nvar redefine = require('./_redefine');\nvar ctx = require('./_ctx');\nvar PROTOTYPE = 'prototype';\n\nvar $export = function (type, name, source) {\n  var IS_FORCED = type & $export.F;\n  var IS_GLOBAL = type & $export.G;\n  var IS_STATIC = type & $export.S;\n  var IS_PROTO = type & $export.P;\n  var IS_BIND = type & $export.B;\n  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] || (global[name] = {}) : (global[name] || {})[PROTOTYPE];\n  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});\n  var expProto = exports[PROTOTYPE] || (exports[PROTOTYPE] = {});\n  var key, own, out, exp;\n  if (IS_GLOBAL) source = name;\n  for (key in source) {\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    // export native or passed\n    out = (own ? target : source)[key];\n    // bind timers to global for call from export context\n    exp = IS_BIND && own ? ctx(out, global) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // extend global\n    if (target) redefine(target, key, out, type & $export.U);\n    // export\n    if (exports[key] != out) hide(exports, key, exp);\n    if (IS_PROTO && expProto[key] != out) expProto[key] = out;\n  }\n};\nglobal.core = core;\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library`\nmodule.exports = $export;\n","var MATCH = require('./_wks')('match');\nmodule.exports = function (KEY) {\n  var re = /./;\n  try {\n    '/./'[KEY](re);\n  } catch (e) {\n    try {\n      re[MATCH] = false;\n      return !'/./'[KEY](re);\n    } catch (f) { /* empty */ }\n  } return true;\n};\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (e) {\n    return true;\n  }\n};\n","'use strict';\nrequire('./es6.regexp.exec');\nvar redefine = require('./_redefine');\nvar hide = require('./_hide');\nvar fails = require('./_fails');\nvar defined = require('./_defined');\nvar wks = require('./_wks');\nvar regexpExec = require('./_regexp-exec');\n\nvar SPECIES = wks('species');\n\nvar REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {\n  // #replace needs built-in support for named groups.\n  // #match works fine because it just return the exec results, even if it has\n  // a \"grops\" property.\n  var re = /./;\n  re.exec = function () {\n    var result = [];\n    result.groups = { a: '7' };\n    return result;\n  };\n  return ''.replace(re, '$<a>') !== '7';\n});\n\nvar SPLIT_WORKS_WITH_OVERWRITTEN_EXEC = (function () {\n  // Chrome 51 has a buggy \"split\" implementation when RegExp#exec !== nativeExec\n  var re = /(?:)/;\n  var originalExec = re.exec;\n  re.exec = function () { return originalExec.apply(this, arguments); };\n  var result = 'ab'.split(re);\n  return result.length === 2 && result[0] === 'a' && result[1] === 'b';\n})();\n\nmodule.exports = function (KEY, length, exec) {\n  var SYMBOL = wks(KEY);\n\n  var DELEGATES_TO_SYMBOL = !fails(function () {\n    // String methods call symbol-named RegEp methods\n    var O = {};\n    O[SYMBOL] = function () { return 7; };\n    return ''[KEY](O) != 7;\n  });\n\n  var DELEGATES_TO_EXEC = DELEGATES_TO_SYMBOL ? !fails(function () {\n    // Symbol-named RegExp methods call .exec\n    var execCalled = false;\n    var re = /a/;\n    re.exec = function () { execCalled = true; return null; };\n    if (KEY === 'split') {\n      // RegExp[@@split] doesn't call the regex's exec method, but first creates\n      // a new one. We need to return the patched regex when creating the new one.\n      re.constructor = {};\n      re.constructor[SPECIES] = function () { return re; };\n    }\n    re[SYMBOL]('');\n    return !execCalled;\n  }) : undefined;\n\n  if (\n    !DELEGATES_TO_SYMBOL ||\n    !DELEGATES_TO_EXEC ||\n    (KEY === 'replace' && !REPLACE_SUPPORTS_NAMED_GROUPS) ||\n    (KEY === 'split' && !SPLIT_WORKS_WITH_OVERWRITTEN_EXEC)\n  ) {\n    var nativeRegExpMethod = /./[SYMBOL];\n    var fns = exec(\n      defined,\n      SYMBOL,\n      ''[KEY],\n      function maybeCallNative(nativeMethod, regexp, str, arg2, forceStringMethod) {\n        if (regexp.exec === regexpExec) {\n          if (DELEGATES_TO_SYMBOL && !forceStringMethod) {\n            // The native String method already delegates to @@method (this\n            // polyfilled function), leasing to infinite recursion.\n            // We avoid it by directly calling the native @@method method.\n            return { done: true, value: nativeRegExpMethod.call(regexp, str, arg2) };\n          }\n          return { done: true, value: nativeMethod.call(str, regexp, arg2) };\n        }\n        return { done: false };\n      }\n    );\n    var strfn = fns[0];\n    var rxfn = fns[1];\n\n    redefine(String.prototype, KEY, strfn);\n    hide(RegExp.prototype, SYMBOL, length == 2\n      // 21.2.5.8 RegExp.prototype[@@replace](string, replaceValue)\n      // 21.2.5.11 RegExp.prototype[@@split](string, limit)\n      ? function (string, arg) { return rxfn.call(string, this, arg); }\n      // 21.2.5.6 RegExp.prototype[@@match](string)\n      // 21.2.5.9 RegExp.prototype[@@search](string)\n      : function (string) { return rxfn.call(string, this); }\n    );\n  }\n};\n","'use strict';\n// 21.2.5.3 get RegExp.prototype.flags\nvar anObject = require('./_an-object');\nmodule.exports = function () {\n  var that = anObject(this);\n  var result = '';\n  if (that.global) result += 'g';\n  if (that.ignoreCase) result += 'i';\n  if (that.multiline) result += 'm';\n  if (that.unicode) result += 'u';\n  if (that.sticky) result += 'y';\n  return result;\n};\n","'use strict';\n// https://tc39.github.io/proposal-flatMap/#sec-FlattenIntoArray\nvar isArray = require('./_is-array');\nvar isObject = require('./_is-object');\nvar toLength = require('./_to-length');\nvar ctx = require('./_ctx');\nvar IS_CONCAT_SPREADABLE = require('./_wks')('isConcatSpreadable');\n\nfunction flattenIntoArray(target, original, source, sourceLen, start, depth, mapper, thisArg) {\n  var targetIndex = start;\n  var sourceIndex = 0;\n  var mapFn = mapper ? ctx(mapper, thisArg, 3) : false;\n  var element, spreadable;\n\n  while (sourceIndex < sourceLen) {\n    if (sourceIndex in source) {\n      element = mapFn ? mapFn(source[sourceIndex], sourceIndex, original) : source[sourceIndex];\n\n      spreadable = false;\n      if (isObject(element)) {\n        spreadable = element[IS_CONCAT_SPREADABLE];\n        spreadable = spreadable !== undefined ? !!spreadable : isArray(element);\n      }\n\n      if (spreadable && depth > 0) {\n        targetIndex = flattenIntoArray(target, original, element, toLength(element.length), targetIndex, depth - 1) - 1;\n      } else {\n        if (targetIndex >= 0x1fffffffffffff) throw TypeError();\n        target[targetIndex] = element;\n      }\n\n      targetIndex++;\n    }\n    sourceIndex++;\n  }\n  return targetIndex;\n}\n\nmodule.exports = flattenIntoArray;\n","var ctx = require('./_ctx');\nvar call = require('./_iter-call');\nvar isArrayIter = require('./_is-array-iter');\nvar anObject = require('./_an-object');\nvar toLength = require('./_to-length');\nvar getIterFn = require('./core.get-iterator-method');\nvar BREAK = {};\nvar RETURN = {};\nvar exports = module.exports = function (iterable, entries, fn, that, ITERATOR) {\n  var iterFn = ITERATOR ? function () { return iterable; } : getIterFn(iterable);\n  var f = ctx(fn, that, entries ? 2 : 1);\n  var index = 0;\n  var length, step, iterator, result;\n  if (typeof iterFn != 'function') throw TypeError(iterable + ' is not iterable!');\n  // fast case for arrays with default iterator\n  if (isArrayIter(iterFn)) for (length = toLength(iterable.length); length > index; index++) {\n    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);\n    if (result === BREAK || result === RETURN) return result;\n  } else for (iterator = iterFn.call(iterable); !(step = iterator.next()).done;) {\n    result = call(iterator, f, step.value, entries);\n    if (result === BREAK || result === RETURN) return result;\n  }\n};\nexports.BREAK = BREAK;\nexports.RETURN = RETURN;\n","module.exports = require('./_shared')('native-function-to-string', Function.toString);\n","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\nif (typeof __g == 'number') __g = global; // eslint-disable-line no-undef\n","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","var dP = require('./_object-dp');\nvar createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function (object, key, value) {\n  return dP.f(object, key, createDesc(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var document = require('./_global').document;\nmodule.exports = document && document.documentElement;\n","module.exports = !require('./_descriptors') && !require('./_fails')(function () {\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;\n});\n","var isObject = require('./_is-object');\nvar setPrototypeOf = require('./_set-proto').set;\nmodule.exports = function (that, target, C) {\n  var S = target.constructor;\n  var P;\n  if (S !== C && typeof S == 'function' && (P = S.prototype) !== C.prototype && isObject(P) && setPrototypeOf) {\n    setPrototypeOf(that, P);\n  } return that;\n};\n","// fast apply, http://jsperf.lnkit.com/fast-apply/5\nmodule.exports = function (fn, args, that) {\n  var un = that === undefined;\n  switch (args.length) {\n    case 0: return un ? fn()\n                      : fn.call(that);\n    case 1: return un ? fn(args[0])\n                      : fn.call(that, args[0]);\n    case 2: return un ? fn(args[0], args[1])\n                      : fn.call(that, args[0], args[1]);\n    case 3: return un ? fn(args[0], args[1], args[2])\n                      : fn.call(that, args[0], args[1], args[2]);\n    case 4: return un ? fn(args[0], args[1], args[2], args[3])\n                      : fn.call(that, args[0], args[1], args[2], args[3]);\n  } return fn.apply(that, args);\n};\n","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\n// eslint-disable-next-line no-prototype-builtins\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n","// check on default Array iterator\nvar Iterators = require('./_iterators');\nvar ITERATOR = require('./_wks')('iterator');\nvar ArrayProto = Array.prototype;\n\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);\n};\n","// 7.2.2 IsArray(argument)\nvar cof = require('./_cof');\nmodule.exports = Array.isArray || function isArray(arg) {\n  return cof(arg) == 'Array';\n};\n","// 20.1.2.3 Number.isInteger(number)\nvar isObject = require('./_is-object');\nvar floor = Math.floor;\nmodule.exports = function isInteger(it) {\n  return !isObject(it) && isFinite(it) && floor(it) === it;\n};\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","// 7.2.8 IsRegExp(argument)\nvar isObject = require('./_is-object');\nvar cof = require('./_cof');\nvar MATCH = require('./_wks')('match');\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : cof(it) == 'RegExp');\n};\n","// call something on iterator step with safe closing on error\nvar anObject = require('./_an-object');\nmodule.exports = function (iterator, fn, value, entries) {\n  try {\n    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch (e) {\n    var ret = iterator['return'];\n    if (ret !== undefined) anObject(ret.call(iterator));\n    throw e;\n  }\n};\n","'use strict';\nvar create = require('./_object-create');\nvar descriptor = require('./_property-desc');\nvar setToStringTag = require('./_set-to-string-tag');\nvar IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nrequire('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function () { return this; });\n\nmodule.exports = function (Constructor, NAME, next) {\n  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });\n  setToStringTag(Constructor, NAME + ' Iterator');\n};\n","'use strict';\nvar LIBRARY = require('./_library');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar $iterCreate = require('./_iter-create');\nvar setToStringTag = require('./_set-to-string-tag');\nvar getPrototypeOf = require('./_object-gpo');\nvar ITERATOR = require('./_wks')('iterator');\nvar BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`\nvar FF_ITERATOR = '@@iterator';\nvar KEYS = 'keys';\nvar VALUES = 'values';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function (kind) {\n    if (!BUGGY && kind in proto) return proto[kind];\n    switch (kind) {\n      case KEYS: return function keys() { return new Constructor(this, kind); };\n      case VALUES: return function values() { return new Constructor(this, kind); };\n    } return function entries() { return new Constructor(this, kind); };\n  };\n  var TAG = NAME + ' Iterator';\n  var DEF_VALUES = DEFAULT == VALUES;\n  var VALUES_BUG = false;\n  var proto = Base.prototype;\n  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];\n  var $default = $native || getMethod(DEFAULT);\n  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;\n  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;\n  var methods, key, IteratorPrototype;\n  // Fix native\n  if ($anyNative) {\n    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));\n    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {\n      // Set @@toStringTag to native iterators\n      setToStringTag(IteratorPrototype, TAG, true);\n      // fix for some old engines\n      if (!LIBRARY && typeof IteratorPrototype[ITERATOR] != 'function') hide(IteratorPrototype, ITERATOR, returnThis);\n    }\n  }\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if (DEF_VALUES && $native && $native.name !== VALUES) {\n    VALUES_BUG = true;\n    $default = function values() { return $native.call(this); };\n  }\n  // Define iterator\n  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG] = returnThis;\n  if (DEFAULT) {\n    methods = {\n      values: DEF_VALUES ? $default : getMethod(VALUES),\n      keys: IS_SET ? $default : getMethod(KEYS),\n      entries: $entries\n    };\n    if (FORCED) for (key in methods) {\n      if (!(key in proto)) redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};\n","var ITERATOR = require('./_wks')('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var riter = [7][ITERATOR]();\n  riter['return'] = function () { SAFE_CLOSING = true; };\n  // eslint-disable-next-line no-throw-literal\n  Array.from(riter, function () { throw 2; });\n} catch (e) { /* empty */ }\n\nmodule.exports = function (exec, skipClosing) {\n  if (!skipClosing && !SAFE_CLOSING) return false;\n  var safe = false;\n  try {\n    var arr = [7];\n    var iter = arr[ITERATOR]();\n    iter.next = function () { return { done: safe = true }; };\n    arr[ITERATOR] = function () { return iter; };\n    exec(arr);\n  } catch (e) { /* empty */ }\n  return safe;\n};\n","module.exports = function (done, value) {\n  return { value: value, done: !!done };\n};\n","module.exports = {};\n","module.exports = false;\n","// 20.2.2.14 Math.expm1(x)\nvar $expm1 = Math.expm1;\nmodule.exports = (!$expm1\n  // Old FF bug\n  || $expm1(10) > 22025.465794806719 || $expm1(10) < 22025.4657948067165168\n  // Tor Browser bug\n  || $expm1(-2e-17) != -2e-17\n) ? function expm1(x) {\n  return (x = +x) == 0 ? x : x > -1e-6 && x < 1e-6 ? x + x * x / 2 : Math.exp(x) - 1;\n} : $expm1;\n","// 20.2.2.16 Math.fround(x)\nvar sign = require('./_math-sign');\nvar pow = Math.pow;\nvar EPSILON = pow(2, -52);\nvar EPSILON32 = pow(2, -23);\nvar MAX32 = pow(2, 127) * (2 - EPSILON32);\nvar MIN32 = pow(2, -126);\n\nvar roundTiesToEven = function (n) {\n  return n + 1 / EPSILON - 1 / EPSILON;\n};\n\nmodule.exports = Math.fround || function fround(x) {\n  var $abs = Math.abs(x);\n  var $sign = sign(x);\n  var a, result;\n  if ($abs < MIN32) return $sign * roundTiesToEven($abs / MIN32 / EPSILON32) * MIN32 * EPSILON32;\n  a = (1 + EPSILON32 / EPSILON) * $abs;\n  result = a - (a - $abs);\n  // eslint-disable-next-line no-self-compare\n  if (result > MAX32 || result != result) return $sign * Infinity;\n  return $sign * result;\n};\n","// 20.2.2.20 Math.log1p(x)\nmodule.exports = Math.log1p || function log1p(x) {\n  return (x = +x) > -1e-8 && x < 1e-8 ? x - x * x / 2 : Math.log(1 + x);\n};\n","// https://rwaldron.github.io/proposal-math-extensions/\nmodule.exports = Math.scale || function scale(x, inLow, inHigh, outLow, outHigh) {\n  if (\n    arguments.length === 0\n      // eslint-disable-next-line no-self-compare\n      || x != x\n      // eslint-disable-next-line no-self-compare\n      || inLow != inLow\n      // eslint-disable-next-line no-self-compare\n      || inHigh != inHigh\n      // eslint-disable-next-line no-self-compare\n      || outLow != outLow\n      // eslint-disable-next-line no-self-compare\n      || outHigh != outHigh\n  ) return NaN;\n  if (x === Infinity || x === -Infinity) return x;\n  return (x - inLow) * (outHigh - outLow) / (inHigh - inLow) + outLow;\n};\n","// 20.2.2.28 Math.sign(x)\nmodule.exports = Math.sign || function sign(x) {\n  // eslint-disable-next-line no-self-compare\n  return (x = +x) == 0 || x != x ? x : x < 0 ? -1 : 1;\n};\n","var META = require('./_uid')('meta');\nvar isObject = require('./_is-object');\nvar has = require('./_has');\nvar setDesc = require('./_object-dp').f;\nvar id = 0;\nvar isExtensible = Object.isExtensible || function () {\n  return true;\n};\nvar FREEZE = !require('./_fails')(function () {\n  return isExtensible(Object.preventExtensions({}));\n});\nvar setMeta = function (it) {\n  setDesc(it, META, { value: {\n    i: 'O' + ++id, // object ID\n    w: {}          // weak collections IDs\n  } });\n};\nvar fastKey = function (it, create) {\n  // return primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMeta(it);\n  // return object ID\n  } return it[META].i;\n};\nvar getWeak = function (it, create) {\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMeta(it);\n  // return hash weak collections IDs\n  } return it[META].w;\n};\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);\n  return it;\n};\nvar meta = module.exports = {\n  KEY: META,\n  NEED: false,\n  fastKey: fastKey,\n  getWeak: getWeak,\n  onFreeze: onFreeze\n};\n","var Map = require('./es6.map');\nvar $export = require('./_export');\nvar shared = require('./_shared')('metadata');\nvar store = shared.store || (shared.store = new (require('./es6.weak-map'))());\n\nvar getOrCreateMetadataMap = function (target, targetKey, create) {\n  var targetMetadata = store.get(target);\n  if (!targetMetadata) {\n    if (!create) return undefined;\n    store.set(target, targetMetadata = new Map());\n  }\n  var keyMetadata = targetMetadata.get(targetKey);\n  if (!keyMetadata) {\n    if (!create) return undefined;\n    targetMetadata.set(targetKey, keyMetadata = new Map());\n  } return keyMetadata;\n};\nvar ordinaryHasOwnMetadata = function (MetadataKey, O, P) {\n  var metadataMap = getOrCreateMetadataMap(O, P, false);\n  return metadataMap === undefined ? false : metadataMap.has(MetadataKey);\n};\nvar ordinaryGetOwnMetadata = function (MetadataKey, O, P) {\n  var metadataMap = getOrCreateMetadataMap(O, P, false);\n  return metadataMap === undefined ? undefined : metadataMap.get(MetadataKey);\n};\nvar ordinaryDefineOwnMetadata = function (MetadataKey, MetadataValue, O, P) {\n  getOrCreateMetadataMap(O, P, true).set(MetadataKey, MetadataValue);\n};\nvar ordinaryOwnMetadataKeys = function (target, targetKey) {\n  var metadataMap = getOrCreateMetadataMap(target, targetKey, false);\n  var keys = [];\n  if (metadataMap) metadataMap.forEach(function (_, key) { keys.push(key); });\n  return keys;\n};\nvar toMetaKey = function (it) {\n  return it === undefined || typeof it == 'symbol' ? it : String(it);\n};\nvar exp = function (O) {\n  $export($export.S, 'Reflect', O);\n};\n\nmodule.exports = {\n  store: store,\n  map: getOrCreateMetadataMap,\n  has: ordinaryHasOwnMetadata,\n  get: ordinaryGetOwnMetadata,\n  set: ordinaryDefineOwnMetadata,\n  keys: ordinaryOwnMetadataKeys,\n  key: toMetaKey,\n  exp: exp\n};\n","var global = require('./_global');\nvar macrotask = require('./_task').set;\nvar Observer = global.MutationObserver || global.WebKitMutationObserver;\nvar process = global.process;\nvar Promise = global.Promise;\nvar isNode = require('./_cof')(process) == 'process';\n\nmodule.exports = function () {\n  var head, last, notify;\n\n  var flush = function () {\n    var parent, fn;\n    if (isNode && (parent = process.domain)) parent.exit();\n    while (head) {\n      fn = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch (e) {\n        if (head) notify();\n        else last = undefined;\n        throw e;\n      }\n    } last = undefined;\n    if (parent) parent.enter();\n  };\n\n  // Node.js\n  if (isNode) {\n    notify = function () {\n      process.nextTick(flush);\n    };\n  // browsers with MutationObserver, except iOS Safari - https://github.com/zloirock/core-js/issues/339\n  } else if (Observer && !(global.navigator && global.navigator.standalone)) {\n    var toggle = true;\n    var node = document.createTextNode('');\n    new Observer(flush).observe(node, { characterData: true }); // eslint-disable-line no-new\n    notify = function () {\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if (Promise && Promise.resolve) {\n    // Promise.resolve without an argument throws an error in LG WebOS 2\n    var promise = Promise.resolve(undefined);\n    notify = function () {\n      promise.then(flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    notify = function () {\n      // strange IE + webpack dev server bug - use .call(global)\n      macrotask.call(global, flush);\n    };\n  }\n\n  return function (fn) {\n    var task = { fn: fn, next: undefined };\n    if (last) last.next = task;\n    if (!head) {\n      head = task;\n      notify();\n    } last = task;\n  };\n};\n","'use strict';\n// 25.4.1.5 NewPromiseCapability(C)\nvar aFunction = require('./_a-function');\n\nfunction PromiseCapability(C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aFunction(resolve);\n  this.reject = aFunction(reject);\n}\n\nmodule.exports.f = function (C) {\n  return new PromiseCapability(C);\n};\n","'use strict';\n// 19.1.2.1 Object.assign(target, source, ...)\nvar DESCRIPTORS = require('./_descriptors');\nvar getKeys = require('./_object-keys');\nvar gOPS = require('./_object-gops');\nvar pIE = require('./_object-pie');\nvar toObject = require('./_to-object');\nvar IObject = require('./_iobject');\nvar $assign = Object.assign;\n\n// should work with symbols and should have deterministic property order (V8 bug)\nmodule.exports = !$assign || require('./_fails')(function () {\n  var A = {};\n  var B = {};\n  // eslint-disable-next-line no-undef\n  var S = Symbol();\n  var K = 'abcdefghijklmnopqrst';\n  A[S] = 7;\n  K.split('').forEach(function (k) { B[k] = k; });\n  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;\n}) ? function assign(target, source) { // eslint-disable-line no-unused-vars\n  var T = toObject(target);\n  var aLen = arguments.length;\n  var index = 1;\n  var getSymbols = gOPS.f;\n  var isEnum = pIE.f;\n  while (aLen > index) {\n    var S = IObject(arguments[index++]);\n    var keys = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S);\n    var length = keys.length;\n    var j = 0;\n    var key;\n    while (length > j) {\n      key = keys[j++];\n      if (!DESCRIPTORS || isEnum.call(S, key)) T[key] = S[key];\n    }\n  } return T;\n} : $assign;\n","// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject = require('./_an-object');\nvar dPs = require('./_object-dps');\nvar enumBugKeys = require('./_enum-bug-keys');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar Empty = function () { /* empty */ };\nvar PROTOTYPE = 'prototype';\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = require('./_dom-create')('iframe');\n  var i = enumBugKeys.length;\n  var lt = '<';\n  var gt = '>';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  require('./_html').appendChild(iframe);\n  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n  // createDict = iframe.contentWindow.Object;\n  // html.removeChild(iframe);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty();\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : dPs(result, Properties);\n};\n","var anObject = require('./_an-object');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar toPrimitive = require('./_to-primitive');\nvar dP = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return dP(O, P, Attributes);\n  } catch (e) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var dP = require('./_object-dp');\nvar anObject = require('./_an-object');\nvar getKeys = require('./_object-keys');\n\nmodule.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = getKeys(Properties);\n  var length = keys.length;\n  var i = 0;\n  var P;\n  while (length > i) dP.f(O, P = keys[i++], Properties[P]);\n  return O;\n};\n","'use strict';\n// Forced replacement prototype accessors methods\nmodule.exports = require('./_library') || !require('./_fails')(function () {\n  var K = Math.random();\n  // In FF throws only define methods\n  // eslint-disable-next-line no-undef, no-useless-call\n  __defineSetter__.call(null, K, function () { /* empty */ });\n  delete require('./_global')[K];\n});\n","var pIE = require('./_object-pie');\nvar createDesc = require('./_property-desc');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar has = require('./_has');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nexports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P) {\n  O = toIObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return gOPD(O, P);\n  } catch (e) { /* empty */ }\n  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);\n};\n","// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nvar toIObject = require('./_to-iobject');\nvar gOPN = require('./_object-gopn').f;\nvar toString = {}.toString;\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function (it) {\n  try {\n    return gOPN(it);\n  } catch (e) {\n    return windowNames.slice();\n  }\n};\n\nmodule.exports.f = function getOwnPropertyNames(it) {\n  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));\n};\n","// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar $keys = require('./_object-keys-internal');\nvar hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return $keys(O, hiddenKeys);\n};\n","exports.f = Object.getOwnPropertySymbols;\n","// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)\nvar has = require('./_has');\nvar toObject = require('./_to-object');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar ObjectProto = Object.prototype;\n\nmodule.exports = Object.getPrototypeOf || function (O) {\n  O = toObject(O);\n  if (has(O, IE_PROTO)) return O[IE_PROTO];\n  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectProto : null;\n};\n","var has = require('./_has');\nvar toIObject = require('./_to-iobject');\nvar arrayIndexOf = require('./_array-includes')(false);\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function (object, names) {\n  var O = toIObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys = require('./_object-keys-internal');\nvar enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O) {\n  return $keys(O, enumBugKeys);\n};\n","exports.f = {}.propertyIsEnumerable;\n","// most Object methods by ES6 should accept primitives\nvar $export = require('./_export');\nvar core = require('./_core');\nvar fails = require('./_fails');\nmodule.exports = function (KEY, exec) {\n  var fn = (core.Object || {})[KEY] || Object[KEY];\n  var exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);\n};\n","var DESCRIPTORS = require('./_descriptors');\nvar getKeys = require('./_object-keys');\nvar toIObject = require('./_to-iobject');\nvar isEnum = require('./_object-pie').f;\nmodule.exports = function (isEntries) {\n  return function (it) {\n    var O = toIObject(it);\n    var keys = getKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) {\n      key = keys[i++];\n      if (!DESCRIPTORS || isEnum.call(O, key)) {\n        result.push(isEntries ? [key, O[key]] : O[key]);\n      }\n    }\n    return result;\n  };\n};\n","// all object keys, includes non-enumerable and symbols\nvar gOPN = require('./_object-gopn');\nvar gOPS = require('./_object-gops');\nvar anObject = require('./_an-object');\nvar Reflect = require('./_global').Reflect;\nmodule.exports = Reflect && Reflect.ownKeys || function ownKeys(it) {\n  var keys = gOPN.f(anObject(it));\n  var getSymbols = gOPS.f;\n  return getSymbols ? keys.concat(getSymbols(it)) : keys;\n};\n","var $parseFloat = require('./_global').parseFloat;\nvar $trim = require('./_string-trim').trim;\n\nmodule.exports = 1 / $parseFloat(require('./_string-ws') + '-0') !== -Infinity ? function parseFloat(str) {\n  var string = $trim(String(str), 3);\n  var result = $parseFloat(string);\n  return result === 0 && string.charAt(0) == '-' ? -0 : result;\n} : $parseFloat;\n","var $parseInt = require('./_global').parseInt;\nvar $trim = require('./_string-trim').trim;\nvar ws = require('./_string-ws');\nvar hex = /^[-+]?0[xX]/;\n\nmodule.exports = $parseInt(ws + '08') !== 8 || $parseInt(ws + '0x16') !== 22 ? function parseInt(str, radix) {\n  var string = $trim(String(str), 3);\n  return $parseInt(string, (radix >>> 0) || (hex.test(string) ? 16 : 10));\n} : $parseInt;\n","module.exports = function (exec) {\n  try {\n    return { e: false, v: exec() };\n  } catch (e) {\n    return { e: true, v: e };\n  }\n};\n","var anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar newPromiseCapability = require('./_new-promise-capability');\n\nmodule.exports = function (C, x) {\n  anObject(C);\n  if (isObject(x) && x.constructor === C) return x;\n  var promiseCapability = newPromiseCapability.f(C);\n  var resolve = promiseCapability.resolve;\n  resolve(x);\n  return promiseCapability.promise;\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","var redefine = require('./_redefine');\nmodule.exports = function (target, src, safe) {\n  for (var key in src) redefine(target, key, src[key], safe);\n  return target;\n};\n","var global = require('./_global');\nvar hide = require('./_hide');\nvar has = require('./_has');\nvar SRC = require('./_uid')('src');\nvar $toString = require('./_function-to-string');\nvar TO_STRING = 'toString';\nvar TPL = ('' + $toString).split(TO_STRING);\n\nrequire('./_core').inspectSource = function (it) {\n  return $toString.call(it);\n};\n\n(module.exports = function (O, key, val, safe) {\n  var isFunction = typeof val == 'function';\n  if (isFunction) has(val, 'name') || hide(val, 'name', key);\n  if (O[key] === val) return;\n  if (isFunction) has(val, SRC) || hide(val, SRC, O[key] ? '' + O[key] : TPL.join(String(key)));\n  if (O === global) {\n    O[key] = val;\n  } else if (!safe) {\n    delete O[key];\n    hide(O, key, val);\n  } else if (O[key]) {\n    O[key] = val;\n  } else {\n    hide(O, key, val);\n  }\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, TO_STRING, function toString() {\n  return typeof this == 'function' && this[SRC] || $toString.call(this);\n});\n","'use strict';\n\nvar classof = require('./_classof');\nvar builtinExec = RegExp.prototype.exec;\n\n // `RegExpExec` abstract operation\n// https://tc39.github.io/ecma262/#sec-regexpexec\nmodule.exports = function (R, S) {\n  var exec = R.exec;\n  if (typeof exec === 'function') {\n    var result = exec.call(R, S);\n    if (typeof result !== 'object') {\n      throw new TypeError('RegExp exec method returned something other than an Object or null');\n    }\n    return result;\n  }\n  if (classof(R) !== 'RegExp') {\n    throw new TypeError('RegExp#exec called on incompatible receiver');\n  }\n  return builtinExec.call(R, S);\n};\n","'use strict';\n\nvar regexpFlags = require('./_flags');\n\nvar nativeExec = RegExp.prototype.exec;\n// This always refers to the native implementation, because the\n// String#replace polyfill uses ./fix-regexp-well-known-symbol-logic.js,\n// which loads this file before patching the method.\nvar nativeReplace = String.prototype.replace;\n\nvar patchedExec = nativeExec;\n\nvar LAST_INDEX = 'lastIndex';\n\nvar UPDATES_LAST_INDEX_WRONG = (function () {\n  var re1 = /a/,\n      re2 = /b*/g;\n  nativeExec.call(re1, 'a');\n  nativeExec.call(re2, 'a');\n  return re1[LAST_INDEX] !== 0 || re2[LAST_INDEX] !== 0;\n})();\n\n// nonparticipating capturing group, copied from es5-shim's String#split patch.\nvar NPCG_INCLUDED = /()??/.exec('')[1] !== undefined;\n\nvar PATCH = UPDATES_LAST_INDEX_WRONG || NPCG_INCLUDED;\n\nif (PATCH) {\n  patchedExec = function exec(str) {\n    var re = this;\n    var lastIndex, reCopy, match, i;\n\n    if (NPCG_INCLUDED) {\n      reCopy = new RegExp('^' + re.source + '$(?!\\\\s)', regexpFlags.call(re));\n    }\n    if (UPDATES_LAST_INDEX_WRONG) lastIndex = re[LAST_INDEX];\n\n    match = nativeExec.call(re, str);\n\n    if (UPDATES_LAST_INDEX_WRONG && match) {\n      re[LAST_INDEX] = re.global ? match.index + match[0].length : lastIndex;\n    }\n    if (NPCG_INCLUDED && match && match.length > 1) {\n      // Fix browsers whose `exec` methods don't consistently return `undefined`\n      // for NPCG, like IE8. NOTE: This doesn' work for /(.?)?/\n      // eslint-disable-next-line no-loop-func\n      nativeReplace.call(match[0], reCopy, function () {\n        for (i = 1; i < arguments.length - 2; i++) {\n          if (arguments[i] === undefined) match[i] = undefined;\n        }\n      });\n    }\n\n    return match;\n  };\n}\n\nmodule.exports = patchedExec;\n","module.exports = function (regExp, replace) {\n  var replacer = replace === Object(replace) ? function (part) {\n    return replace[part];\n  } : replace;\n  return function (it) {\n    return String(it).replace(regExp, replacer);\n  };\n};\n","// 7.2.9 SameValue(x, y)\nmodule.exports = Object.is || function is(x, y) {\n  // eslint-disable-next-line no-self-compare\n  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;\n};\n","'use strict';\n// https://tc39.github.io/proposal-setmap-offrom/\nvar $export = require('./_export');\nvar aFunction = require('./_a-function');\nvar ctx = require('./_ctx');\nvar forOf = require('./_for-of');\n\nmodule.exports = function (COLLECTION) {\n  $export($export.S, COLLECTION, { from: function from(source /* , mapFn, thisArg */) {\n    var mapFn = arguments[1];\n    var mapping, A, n, cb;\n    aFunction(this);\n    mapping = mapFn !== undefined;\n    if (mapping) aFunction(mapFn);\n    if (source == undefined) return new this();\n    A = [];\n    if (mapping) {\n      n = 0;\n      cb = ctx(mapFn, arguments[2], 2);\n      forOf(source, false, function (nextItem) {\n        A.push(cb(nextItem, n++));\n      });\n    } else {\n      forOf(source, false, A.push, A);\n    }\n    return new this(A);\n  } });\n};\n","'use strict';\n// https://tc39.github.io/proposal-setmap-offrom/\nvar $export = require('./_export');\n\nmodule.exports = function (COLLECTION) {\n  $export($export.S, COLLECTION, { of: function of() {\n    var length = arguments.length;\n    var A = new Array(length);\n    while (length--) A[length] = arguments[length];\n    return new this(A);\n  } });\n};\n","// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nvar isObject = require('./_is-object');\nvar anObject = require('./_an-object');\nvar check = function (O, proto) {\n  anObject(O);\n  if (!isObject(proto) && proto !== null) throw TypeError(proto + \": can't set as prototype!\");\n};\nmodule.exports = {\n  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line\n    function (test, buggy, set) {\n      try {\n        set = require('./_ctx')(Function.call, require('./_object-gopd').f(Object.prototype, '__proto__').set, 2);\n        set(test, []);\n        buggy = !(test instanceof Array);\n      } catch (e) { buggy = true; }\n      return function setPrototypeOf(O, proto) {\n        check(O, proto);\n        if (buggy) O.__proto__ = proto;\n        else set(O, proto);\n        return O;\n      };\n    }({}, false) : undefined),\n  check: check\n};\n","'use strict';\nvar global = require('./_global');\nvar dP = require('./_object-dp');\nvar DESCRIPTORS = require('./_descriptors');\nvar SPECIES = require('./_wks')('species');\n\nmodule.exports = function (KEY) {\n  var C = global[KEY];\n  if (DESCRIPTORS && C && !C[SPECIES]) dP.f(C, SPECIES, {\n    configurable: true,\n    get: function () { return this; }\n  });\n};\n","var def = require('./_object-dp').f;\nvar has = require('./_has');\nvar TAG = require('./_wks')('toStringTag');\n\nmodule.exports = function (it, tag, stat) {\n  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });\n};\n","var shared = require('./_shared')('keys');\nvar uid = require('./_uid');\nmodule.exports = function (key) {\n  return shared[key] || (shared[key] = uid(key));\n};\n","var core = require('./_core');\nvar global = require('./_global');\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || (global[SHARED] = {});\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: core.version,\n  mode: require('./_library') ? 'pure' : 'global',\n  copyright: ' 2019 Denis Pushkarev (zloirock.ru)'\n});\n","// 7.3.20 SpeciesConstructor(O, defaultConstructor)\nvar anObject = require('./_an-object');\nvar aFunction = require('./_a-function');\nvar SPECIES = require('./_wks')('species');\nmodule.exports = function (O, D) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);\n};\n","'use strict';\nvar fails = require('./_fails');\n\nmodule.exports = function (method, arg) {\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call\n    arg ? method.call(null, function () { /* empty */ }, 1) : method.call(null);\n  });\n};\n","var toInteger = require('./_to-integer');\nvar defined = require('./_defined');\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function (TO_STRING) {\n  return function (that, pos) {\n    var s = String(defined(that));\n    var i = toInteger(pos);\n    var l = s.length;\n    var a, b;\n    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};\n","// helper for String#{startsWith, endsWith, includes}\nvar isRegExp = require('./_is-regexp');\nvar defined = require('./_defined');\n\nmodule.exports = function (that, searchString, NAME) {\n  if (isRegExp(searchString)) throw TypeError('String#' + NAME + \" doesn't accept regex!\");\n  return String(defined(that));\n};\n","var $export = require('./_export');\nvar fails = require('./_fails');\nvar defined = require('./_defined');\nvar quot = /\"/g;\n// B.2.3.2.1 CreateHTML(string, tag, attribute, value)\nvar createHTML = function (string, tag, attribute, value) {\n  var S = String(defined(string));\n  var p1 = '<' + tag;\n  if (attribute !== '') p1 += ' ' + attribute + '=\"' + String(value).replace(quot, '&quot;') + '\"';\n  return p1 + '>' + S + '</' + tag + '>';\n};\nmodule.exports = function (NAME, exec) {\n  var O = {};\n  O[NAME] = exec(createHTML);\n  $export($export.P + $export.F * fails(function () {\n    var test = ''[NAME]('\"');\n    return test !== test.toLowerCase() || test.split('\"').length > 3;\n  }), 'String', O);\n};\n","// https://github.com/tc39/proposal-string-pad-start-end\nvar toLength = require('./_to-length');\nvar repeat = require('./_string-repeat');\nvar defined = require('./_defined');\n\nmodule.exports = function (that, maxLength, fillString, left) {\n  var S = String(defined(that));\n  var stringLength = S.length;\n  var fillStr = fillString === undefined ? ' ' : String(fillString);\n  var intMaxLength = toLength(maxLength);\n  if (intMaxLength <= stringLength || fillStr == '') return S;\n  var fillLen = intMaxLength - stringLength;\n  var stringFiller = repeat.call(fillStr, Math.ceil(fillLen / fillStr.length));\n  if (stringFiller.length > fillLen) stringFiller = stringFiller.slice(0, fillLen);\n  return left ? stringFiller + S : S + stringFiller;\n};\n","'use strict';\nvar toInteger = require('./_to-integer');\nvar defined = require('./_defined');\n\nmodule.exports = function repeat(count) {\n  var str = String(defined(this));\n  var res = '';\n  var n = toInteger(count);\n  if (n < 0 || n == Infinity) throw RangeError(\"Count can't be negative\");\n  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) res += str;\n  return res;\n};\n","var $export = require('./_export');\nvar defined = require('./_defined');\nvar fails = require('./_fails');\nvar spaces = require('./_string-ws');\nvar space = '[' + spaces + ']';\nvar non = '\\u200b\\u0085';\nvar ltrim = RegExp('^' + space + space + '*');\nvar rtrim = RegExp(space + space + '*$');\n\nvar exporter = function (KEY, exec, ALIAS) {\n  var exp = {};\n  var FORCE = fails(function () {\n    return !!spaces[KEY]() || non[KEY]() != non;\n  });\n  var fn = exp[KEY] = FORCE ? exec(trim) : spaces[KEY];\n  if (ALIAS) exp[ALIAS] = fn;\n  $export($export.P + $export.F * FORCE, 'String', exp);\n};\n\n// 1 -> String#trimLeft\n// 2 -> String#trimRight\n// 3 -> String#trim\nvar trim = exporter.trim = function (string, TYPE) {\n  string = String(defined(string));\n  if (TYPE & 1) string = string.replace(ltrim, '');\n  if (TYPE & 2) string = string.replace(rtrim, '');\n  return string;\n};\n\nmodule.exports = exporter;\n","module.exports = '\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003' +\n  '\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n","var ctx = require('./_ctx');\nvar invoke = require('./_invoke');\nvar html = require('./_html');\nvar cel = require('./_dom-create');\nvar global = require('./_global');\nvar process = global.process;\nvar setTask = global.setImmediate;\nvar clearTask = global.clearImmediate;\nvar MessageChannel = global.MessageChannel;\nvar Dispatch = global.Dispatch;\nvar counter = 0;\nvar queue = {};\nvar ONREADYSTATECHANGE = 'onreadystatechange';\nvar defer, channel, port;\nvar run = function () {\n  var id = +this;\n  // eslint-disable-next-line no-prototype-builtins\n  if (queue.hasOwnProperty(id)) {\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\nvar listener = function (event) {\n  run.call(event.data);\n};\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif (!setTask || !clearTask) {\n  setTask = function setImmediate(fn) {\n    var args = [];\n    var i = 1;\n    while (arguments.length > i) args.push(arguments[i++]);\n    queue[++counter] = function () {\n      // eslint-disable-next-line no-new-func\n      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clearTask = function clearImmediate(id) {\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if (require('./_cof')(process) == 'process') {\n    defer = function (id) {\n      process.nextTick(ctx(run, id, 1));\n    };\n  // Sphere (JS game engine) Dispatch API\n  } else if (Dispatch && Dispatch.now) {\n    defer = function (id) {\n      Dispatch.now(ctx(run, id, 1));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  } else if (MessageChannel) {\n    channel = new MessageChannel();\n    port = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = ctx(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if (global.addEventListener && typeof postMessage == 'function' && !global.importScripts) {\n    defer = function (id) {\n      global.postMessage(id + '', '*');\n    };\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if (ONREADYSTATECHANGE in cel('script')) {\n    defer = function (id) {\n      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function () {\n        html.removeChild(this);\n        run.call(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function (id) {\n      setTimeout(ctx(run, id, 1), 0);\n    };\n  }\n}\nmodule.exports = {\n  set: setTask,\n  clear: clearTask\n};\n","var toInteger = require('./_to-integer');\nvar max = Math.max;\nvar min = Math.min;\nmodule.exports = function (index, length) {\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n","// https://tc39.github.io/ecma262/#sec-toindex\nvar toInteger = require('./_to-integer');\nvar toLength = require('./_to-length');\nmodule.exports = function (it) {\n  if (it === undefined) return 0;\n  var number = toInteger(it);\n  var length = toLength(number);\n  if (number !== length) throw RangeError('Wrong length!');\n  return length;\n};\n","// 7.1.4 ToInteger\nvar ceil = Math.ceil;\nvar floor = Math.floor;\nmodule.exports = function (it) {\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject');\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return IObject(defined(it));\n};\n","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer');\nvar min = Math.min;\nmodule.exports = function (it) {\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n","// 7.1.13 ToObject(argument)\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return Object(defined(it));\n};\n","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","'use strict';\nif (require('./_descriptors')) {\n  var LIBRARY = require('./_library');\n  var global = require('./_global');\n  var fails = require('./_fails');\n  var $export = require('./_export');\n  var $typed = require('./_typed');\n  var $buffer = require('./_typed-buffer');\n  var ctx = require('./_ctx');\n  var anInstance = require('./_an-instance');\n  var propertyDesc = require('./_property-desc');\n  var hide = require('./_hide');\n  var redefineAll = require('./_redefine-all');\n  var toInteger = require('./_to-integer');\n  var toLength = require('./_to-length');\n  var toIndex = require('./_to-index');\n  var toAbsoluteIndex = require('./_to-absolute-index');\n  var toPrimitive = require('./_to-primitive');\n  var has = require('./_has');\n  var classof = require('./_classof');\n  var isObject = require('./_is-object');\n  var toObject = require('./_to-object');\n  var isArrayIter = require('./_is-array-iter');\n  var create = require('./_object-create');\n  var getPrototypeOf = require('./_object-gpo');\n  var gOPN = require('./_object-gopn').f;\n  var getIterFn = require('./core.get-iterator-method');\n  var uid = require('./_uid');\n  var wks = require('./_wks');\n  var createArrayMethod = require('./_array-methods');\n  var createArrayIncludes = require('./_array-includes');\n  var speciesConstructor = require('./_species-constructor');\n  var ArrayIterators = require('./es6.array.iterator');\n  var Iterators = require('./_iterators');\n  var $iterDetect = require('./_iter-detect');\n  var setSpecies = require('./_set-species');\n  var arrayFill = require('./_array-fill');\n  var arrayCopyWithin = require('./_array-copy-within');\n  var $DP = require('./_object-dp');\n  var $GOPD = require('./_object-gopd');\n  var dP = $DP.f;\n  var gOPD = $GOPD.f;\n  var RangeError = global.RangeError;\n  var TypeError = global.TypeError;\n  var Uint8Array = global.Uint8Array;\n  var ARRAY_BUFFER = 'ArrayBuffer';\n  var SHARED_BUFFER = 'Shared' + ARRAY_BUFFER;\n  var BYTES_PER_ELEMENT = 'BYTES_PER_ELEMENT';\n  var PROTOTYPE = 'prototype';\n  var ArrayProto = Array[PROTOTYPE];\n  var $ArrayBuffer = $buffer.ArrayBuffer;\n  var $DataView = $buffer.DataView;\n  var arrayForEach = createArrayMethod(0);\n  var arrayFilter = createArrayMethod(2);\n  var arraySome = createArrayMethod(3);\n  var arrayEvery = createArrayMethod(4);\n  var arrayFind = createArrayMethod(5);\n  var arrayFindIndex = createArrayMethod(6);\n  var arrayIncludes = createArrayIncludes(true);\n  var arrayIndexOf = createArrayIncludes(false);\n  var arrayValues = ArrayIterators.values;\n  var arrayKeys = ArrayIterators.keys;\n  var arrayEntries = ArrayIterators.entries;\n  var arrayLastIndexOf = ArrayProto.lastIndexOf;\n  var arrayReduce = ArrayProto.reduce;\n  var arrayReduceRight = ArrayProto.reduceRight;\n  var arrayJoin = ArrayProto.join;\n  var arraySort = ArrayProto.sort;\n  var arraySlice = ArrayProto.slice;\n  var arrayToString = ArrayProto.toString;\n  var arrayToLocaleString = ArrayProto.toLocaleString;\n  var ITERATOR = wks('iterator');\n  var TAG = wks('toStringTag');\n  var TYPED_CONSTRUCTOR = uid('typed_constructor');\n  var DEF_CONSTRUCTOR = uid('def_constructor');\n  var ALL_CONSTRUCTORS = $typed.CONSTR;\n  var TYPED_ARRAY = $typed.TYPED;\n  var VIEW = $typed.VIEW;\n  var WRONG_LENGTH = 'Wrong length!';\n\n  var $map = createArrayMethod(1, function (O, length) {\n    return allocate(speciesConstructor(O, O[DEF_CONSTRUCTOR]), length);\n  });\n\n  var LITTLE_ENDIAN = fails(function () {\n    // eslint-disable-next-line no-undef\n    return new Uint8Array(new Uint16Array([1]).buffer)[0] === 1;\n  });\n\n  var FORCED_SET = !!Uint8Array && !!Uint8Array[PROTOTYPE].set && fails(function () {\n    new Uint8Array(1).set({});\n  });\n\n  var toOffset = function (it, BYTES) {\n    var offset = toInteger(it);\n    if (offset < 0 || offset % BYTES) throw RangeError('Wrong offset!');\n    return offset;\n  };\n\n  var validate = function (it) {\n    if (isObject(it) && TYPED_ARRAY in it) return it;\n    throw TypeError(it + ' is not a typed array!');\n  };\n\n  var allocate = function (C, length) {\n    if (!(isObject(C) && TYPED_CONSTRUCTOR in C)) {\n      throw TypeError('It is not a typed array constructor!');\n    } return new C(length);\n  };\n\n  var speciesFromList = function (O, list) {\n    return fromList(speciesConstructor(O, O[DEF_CONSTRUCTOR]), list);\n  };\n\n  var fromList = function (C, list) {\n    var index = 0;\n    var length = list.length;\n    var result = allocate(C, length);\n    while (length > index) result[index] = list[index++];\n    return result;\n  };\n\n  var addGetter = function (it, key, internal) {\n    dP(it, key, { get: function () { return this._d[internal]; } });\n  };\n\n  var $from = function from(source /* , mapfn, thisArg */) {\n    var O = toObject(source);\n    var aLen = arguments.length;\n    var mapfn = aLen > 1 ? arguments[1] : undefined;\n    var mapping = mapfn !== undefined;\n    var iterFn = getIterFn(O);\n    var i, length, values, result, step, iterator;\n    if (iterFn != undefined && !isArrayIter(iterFn)) {\n      for (iterator = iterFn.call(O), values = [], i = 0; !(step = iterator.next()).done; i++) {\n        values.push(step.value);\n      } O = values;\n    }\n    if (mapping && aLen > 2) mapfn = ctx(mapfn, arguments[2], 2);\n    for (i = 0, length = toLength(O.length), result = allocate(this, length); length > i; i++) {\n      result[i] = mapping ? mapfn(O[i], i) : O[i];\n    }\n    return result;\n  };\n\n  var $of = function of(/* ...items */) {\n    var index = 0;\n    var length = arguments.length;\n    var result = allocate(this, length);\n    while (length > index) result[index] = arguments[index++];\n    return result;\n  };\n\n  // iOS Safari 6.x fails here\n  var TO_LOCALE_BUG = !!Uint8Array && fails(function () { arrayToLocaleString.call(new Uint8Array(1)); });\n\n  var $toLocaleString = function toLocaleString() {\n    return arrayToLocaleString.apply(TO_LOCALE_BUG ? arraySlice.call(validate(this)) : validate(this), arguments);\n  };\n\n  var proto = {\n    copyWithin: function copyWithin(target, start /* , end */) {\n      return arrayCopyWithin.call(validate(this), target, start, arguments.length > 2 ? arguments[2] : undefined);\n    },\n    every: function every(callbackfn /* , thisArg */) {\n      return arrayEvery(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    fill: function fill(value /* , start, end */) { // eslint-disable-line no-unused-vars\n      return arrayFill.apply(validate(this), arguments);\n    },\n    filter: function filter(callbackfn /* , thisArg */) {\n      return speciesFromList(this, arrayFilter(validate(this), callbackfn,\n        arguments.length > 1 ? arguments[1] : undefined));\n    },\n    find: function find(predicate /* , thisArg */) {\n      return arrayFind(validate(this), predicate, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    findIndex: function findIndex(predicate /* , thisArg */) {\n      return arrayFindIndex(validate(this), predicate, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    forEach: function forEach(callbackfn /* , thisArg */) {\n      arrayForEach(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    indexOf: function indexOf(searchElement /* , fromIndex */) {\n      return arrayIndexOf(validate(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    includes: function includes(searchElement /* , fromIndex */) {\n      return arrayIncludes(validate(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    join: function join(separator) { // eslint-disable-line no-unused-vars\n      return arrayJoin.apply(validate(this), arguments);\n    },\n    lastIndexOf: function lastIndexOf(searchElement /* , fromIndex */) { // eslint-disable-line no-unused-vars\n      return arrayLastIndexOf.apply(validate(this), arguments);\n    },\n    map: function map(mapfn /* , thisArg */) {\n      return $map(validate(this), mapfn, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    reduce: function reduce(callbackfn /* , initialValue */) { // eslint-disable-line no-unused-vars\n      return arrayReduce.apply(validate(this), arguments);\n    },\n    reduceRight: function reduceRight(callbackfn /* , initialValue */) { // eslint-disable-line no-unused-vars\n      return arrayReduceRight.apply(validate(this), arguments);\n    },\n    reverse: function reverse() {\n      var that = this;\n      var length = validate(that).length;\n      var middle = Math.floor(length / 2);\n      var index = 0;\n      var value;\n      while (index < middle) {\n        value = that[index];\n        that[index++] = that[--length];\n        that[length] = value;\n      } return that;\n    },\n    some: function some(callbackfn /* , thisArg */) {\n      return arraySome(validate(this), callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    },\n    sort: function sort(comparefn) {\n      return arraySort.call(validate(this), comparefn);\n    },\n    subarray: function subarray(begin, end) {\n      var O = validate(this);\n      var length = O.length;\n      var $begin = toAbsoluteIndex(begin, length);\n      return new (speciesConstructor(O, O[DEF_CONSTRUCTOR]))(\n        O.buffer,\n        O.byteOffset + $begin * O.BYTES_PER_ELEMENT,\n        toLength((end === undefined ? length : toAbsoluteIndex(end, length)) - $begin)\n      );\n    }\n  };\n\n  var $slice = function slice(start, end) {\n    return speciesFromList(this, arraySlice.call(validate(this), start, end));\n  };\n\n  var $set = function set(arrayLike /* , offset */) {\n    validate(this);\n    var offset = toOffset(arguments[1], 1);\n    var length = this.length;\n    var src = toObject(arrayLike);\n    var len = toLength(src.length);\n    var index = 0;\n    if (len + offset > length) throw RangeError(WRONG_LENGTH);\n    while (index < len) this[offset + index] = src[index++];\n  };\n\n  var $iterators = {\n    entries: function entries() {\n      return arrayEntries.call(validate(this));\n    },\n    keys: function keys() {\n      return arrayKeys.call(validate(this));\n    },\n    values: function values() {\n      return arrayValues.call(validate(this));\n    }\n  };\n\n  var isTAIndex = function (target, key) {\n    return isObject(target)\n      && target[TYPED_ARRAY]\n      && typeof key != 'symbol'\n      && key in target\n      && String(+key) == String(key);\n  };\n  var $getDesc = function getOwnPropertyDescriptor(target, key) {\n    return isTAIndex(target, key = toPrimitive(key, true))\n      ? propertyDesc(2, target[key])\n      : gOPD(target, key);\n  };\n  var $setDesc = function defineProperty(target, key, desc) {\n    if (isTAIndex(target, key = toPrimitive(key, true))\n      && isObject(desc)\n      && has(desc, 'value')\n      && !has(desc, 'get')\n      && !has(desc, 'set')\n      // TODO: add validation descriptor w/o calling accessors\n      && !desc.configurable\n      && (!has(desc, 'writable') || desc.writable)\n      && (!has(desc, 'enumerable') || desc.enumerable)\n    ) {\n      target[key] = desc.value;\n      return target;\n    } return dP(target, key, desc);\n  };\n\n  if (!ALL_CONSTRUCTORS) {\n    $GOPD.f = $getDesc;\n    $DP.f = $setDesc;\n  }\n\n  $export($export.S + $export.F * !ALL_CONSTRUCTORS, 'Object', {\n    getOwnPropertyDescriptor: $getDesc,\n    defineProperty: $setDesc\n  });\n\n  if (fails(function () { arrayToString.call({}); })) {\n    arrayToString = arrayToLocaleString = function toString() {\n      return arrayJoin.call(this);\n    };\n  }\n\n  var $TypedArrayPrototype$ = redefineAll({}, proto);\n  redefineAll($TypedArrayPrototype$, $iterators);\n  hide($TypedArrayPrototype$, ITERATOR, $iterators.values);\n  redefineAll($TypedArrayPrototype$, {\n    slice: $slice,\n    set: $set,\n    constructor: function () { /* noop */ },\n    toString: arrayToString,\n    toLocaleString: $toLocaleString\n  });\n  addGetter($TypedArrayPrototype$, 'buffer', 'b');\n  addGetter($TypedArrayPrototype$, 'byteOffset', 'o');\n  addGetter($TypedArrayPrototype$, 'byteLength', 'l');\n  addGetter($TypedArrayPrototype$, 'length', 'e');\n  dP($TypedArrayPrototype$, TAG, {\n    get: function () { return this[TYPED_ARRAY]; }\n  });\n\n  // eslint-disable-next-line max-statements\n  module.exports = function (KEY, BYTES, wrapper, CLAMPED) {\n    CLAMPED = !!CLAMPED;\n    var NAME = KEY + (CLAMPED ? 'Clamped' : '') + 'Array';\n    var GETTER = 'get' + KEY;\n    var SETTER = 'set' + KEY;\n    var TypedArray = global[NAME];\n    var Base = TypedArray || {};\n    var TAC = TypedArray && getPrototypeOf(TypedArray);\n    var FORCED = !TypedArray || !$typed.ABV;\n    var O = {};\n    var TypedArrayPrototype = TypedArray && TypedArray[PROTOTYPE];\n    var getter = function (that, index) {\n      var data = that._d;\n      return data.v[GETTER](index * BYTES + data.o, LITTLE_ENDIAN);\n    };\n    var setter = function (that, index, value) {\n      var data = that._d;\n      if (CLAMPED) value = (value = Math.round(value)) < 0 ? 0 : value > 0xff ? 0xff : value & 0xff;\n      data.v[SETTER](index * BYTES + data.o, value, LITTLE_ENDIAN);\n    };\n    var addElement = function (that, index) {\n      dP(that, index, {\n        get: function () {\n          return getter(this, index);\n        },\n        set: function (value) {\n          return setter(this, index, value);\n        },\n        enumerable: true\n      });\n    };\n    if (FORCED) {\n      TypedArray = wrapper(function (that, data, $offset, $length) {\n        anInstance(that, TypedArray, NAME, '_d');\n        var index = 0;\n        var offset = 0;\n        var buffer, byteLength, length, klass;\n        if (!isObject(data)) {\n          length = toIndex(data);\n          byteLength = length * BYTES;\n          buffer = new $ArrayBuffer(byteLength);\n        } else if (data instanceof $ArrayBuffer || (klass = classof(data)) == ARRAY_BUFFER || klass == SHARED_BUFFER) {\n          buffer = data;\n          offset = toOffset($offset, BYTES);\n          var $len = data.byteLength;\n          if ($length === undefined) {\n            if ($len % BYTES) throw RangeError(WRONG_LENGTH);\n            byteLength = $len - offset;\n            if (byteLength < 0) throw RangeError(WRONG_LENGTH);\n          } else {\n            byteLength = toLength($length) * BYTES;\n            if (byteLength + offset > $len) throw RangeError(WRONG_LENGTH);\n          }\n          length = byteLength / BYTES;\n        } else if (TYPED_ARRAY in data) {\n          return fromList(TypedArray, data);\n        } else {\n          return $from.call(TypedArray, data);\n        }\n        hide(that, '_d', {\n          b: buffer,\n          o: offset,\n          l: byteLength,\n          e: length,\n          v: new $DataView(buffer)\n        });\n        while (index < length) addElement(that, index++);\n      });\n      TypedArrayPrototype = TypedArray[PROTOTYPE] = create($TypedArrayPrototype$);\n      hide(TypedArrayPrototype, 'constructor', TypedArray);\n    } else if (!fails(function () {\n      TypedArray(1);\n    }) || !fails(function () {\n      new TypedArray(-1); // eslint-disable-line no-new\n    }) || !$iterDetect(function (iter) {\n      new TypedArray(); // eslint-disable-line no-new\n      new TypedArray(null); // eslint-disable-line no-new\n      new TypedArray(1.5); // eslint-disable-line no-new\n      new TypedArray(iter); // eslint-disable-line no-new\n    }, true)) {\n      TypedArray = wrapper(function (that, data, $offset, $length) {\n        anInstance(that, TypedArray, NAME);\n        var klass;\n        // `ws` module bug, temporarily remove validation length for Uint8Array\n        // https://github.com/websockets/ws/pull/645\n        if (!isObject(data)) return new Base(toIndex(data));\n        if (data instanceof $ArrayBuffer || (klass = classof(data)) == ARRAY_BUFFER || klass == SHARED_BUFFER) {\n          return $length !== undefined\n            ? new Base(data, toOffset($offset, BYTES), $length)\n            : $offset !== undefined\n              ? new Base(data, toOffset($offset, BYTES))\n              : new Base(data);\n        }\n        if (TYPED_ARRAY in data) return fromList(TypedArray, data);\n        return $from.call(TypedArray, data);\n      });\n      arrayForEach(TAC !== Function.prototype ? gOPN(Base).concat(gOPN(TAC)) : gOPN(Base), function (key) {\n        if (!(key in TypedArray)) hide(TypedArray, key, Base[key]);\n      });\n      TypedArray[PROTOTYPE] = TypedArrayPrototype;\n      if (!LIBRARY) TypedArrayPrototype.constructor = TypedArray;\n    }\n    var $nativeIterator = TypedArrayPrototype[ITERATOR];\n    var CORRECT_ITER_NAME = !!$nativeIterator\n      && ($nativeIterator.name == 'values' || $nativeIterator.name == undefined);\n    var $iterator = $iterators.values;\n    hide(TypedArray, TYPED_CONSTRUCTOR, true);\n    hide(TypedArrayPrototype, TYPED_ARRAY, NAME);\n    hide(TypedArrayPrototype, VIEW, true);\n    hide(TypedArrayPrototype, DEF_CONSTRUCTOR, TypedArray);\n\n    if (CLAMPED ? new TypedArray(1)[TAG] != NAME : !(TAG in TypedArrayPrototype)) {\n      dP(TypedArrayPrototype, TAG, {\n        get: function () { return NAME; }\n      });\n    }\n\n    O[NAME] = TypedArray;\n\n    $export($export.G + $export.W + $export.F * (TypedArray != Base), O);\n\n    $export($export.S, NAME, {\n      BYTES_PER_ELEMENT: BYTES\n    });\n\n    $export($export.S + $export.F * fails(function () { Base.of.call(TypedArray, 1); }), NAME, {\n      from: $from,\n      of: $of\n    });\n\n    if (!(BYTES_PER_ELEMENT in TypedArrayPrototype)) hide(TypedArrayPrototype, BYTES_PER_ELEMENT, BYTES);\n\n    $export($export.P, NAME, proto);\n\n    setSpecies(NAME);\n\n    $export($export.P + $export.F * FORCED_SET, NAME, { set: $set });\n\n    $export($export.P + $export.F * !CORRECT_ITER_NAME, NAME, $iterators);\n\n    if (!LIBRARY && TypedArrayPrototype.toString != arrayToString) TypedArrayPrototype.toString = arrayToString;\n\n    $export($export.P + $export.F * fails(function () {\n      new TypedArray(1).slice();\n    }), NAME, { slice: $slice });\n\n    $export($export.P + $export.F * (fails(function () {\n      return [1, 2].toLocaleString() != new TypedArray([1, 2]).toLocaleString();\n    }) || !fails(function () {\n      TypedArrayPrototype.toLocaleString.call([1, 2]);\n    })), NAME, { toLocaleString: $toLocaleString });\n\n    Iterators[NAME] = CORRECT_ITER_NAME ? $nativeIterator : $iterator;\n    if (!LIBRARY && !CORRECT_ITER_NAME) hide(TypedArrayPrototype, ITERATOR, $iterator);\n  };\n} else module.exports = function () { /* empty */ };\n","'use strict';\nvar global = require('./_global');\nvar DESCRIPTORS = require('./_descriptors');\nvar LIBRARY = require('./_library');\nvar $typed = require('./_typed');\nvar hide = require('./_hide');\nvar redefineAll = require('./_redefine-all');\nvar fails = require('./_fails');\nvar anInstance = require('./_an-instance');\nvar toInteger = require('./_to-integer');\nvar toLength = require('./_to-length');\nvar toIndex = require('./_to-index');\nvar gOPN = require('./_object-gopn').f;\nvar dP = require('./_object-dp').f;\nvar arrayFill = require('./_array-fill');\nvar setToStringTag = require('./_set-to-string-tag');\nvar ARRAY_BUFFER = 'ArrayBuffer';\nvar DATA_VIEW = 'DataView';\nvar PROTOTYPE = 'prototype';\nvar WRONG_LENGTH = 'Wrong length!';\nvar WRONG_INDEX = 'Wrong index!';\nvar $ArrayBuffer = global[ARRAY_BUFFER];\nvar $DataView = global[DATA_VIEW];\nvar Math = global.Math;\nvar RangeError = global.RangeError;\n// eslint-disable-next-line no-shadow-restricted-names\nvar Infinity = global.Infinity;\nvar BaseBuffer = $ArrayBuffer;\nvar abs = Math.abs;\nvar pow = Math.pow;\nvar floor = Math.floor;\nvar log = Math.log;\nvar LN2 = Math.LN2;\nvar BUFFER = 'buffer';\nvar BYTE_LENGTH = 'byteLength';\nvar BYTE_OFFSET = 'byteOffset';\nvar $BUFFER = DESCRIPTORS ? '_b' : BUFFER;\nvar $LENGTH = DESCRIPTORS ? '_l' : BYTE_LENGTH;\nvar $OFFSET = DESCRIPTORS ? '_o' : BYTE_OFFSET;\n\n// IEEE754 conversions based on https://github.com/feross/ieee754\nfunction packIEEE754(value, mLen, nBytes) {\n  var buffer = new Array(nBytes);\n  var eLen = nBytes * 8 - mLen - 1;\n  var eMax = (1 << eLen) - 1;\n  var eBias = eMax >> 1;\n  var rt = mLen === 23 ? pow(2, -24) - pow(2, -77) : 0;\n  var i = 0;\n  var s = value < 0 || value === 0 && 1 / value < 0 ? 1 : 0;\n  var e, m, c;\n  value = abs(value);\n  // eslint-disable-next-line no-self-compare\n  if (value != value || value === Infinity) {\n    // eslint-disable-next-line no-self-compare\n    m = value != value ? 1 : 0;\n    e = eMax;\n  } else {\n    e = floor(log(value) / LN2);\n    if (value * (c = pow(2, -e)) < 1) {\n      e--;\n      c *= 2;\n    }\n    if (e + eBias >= 1) {\n      value += rt / c;\n    } else {\n      value += rt * pow(2, 1 - eBias);\n    }\n    if (value * c >= 2) {\n      e++;\n      c /= 2;\n    }\n    if (e + eBias >= eMax) {\n      m = 0;\n      e = eMax;\n    } else if (e + eBias >= 1) {\n      m = (value * c - 1) * pow(2, mLen);\n      e = e + eBias;\n    } else {\n      m = value * pow(2, eBias - 1) * pow(2, mLen);\n      e = 0;\n    }\n  }\n  for (; mLen >= 8; buffer[i++] = m & 255, m /= 256, mLen -= 8);\n  e = e << mLen | m;\n  eLen += mLen;\n  for (; eLen > 0; buffer[i++] = e & 255, e /= 256, eLen -= 8);\n  buffer[--i] |= s * 128;\n  return buffer;\n}\nfunction unpackIEEE754(buffer, mLen, nBytes) {\n  var eLen = nBytes * 8 - mLen - 1;\n  var eMax = (1 << eLen) - 1;\n  var eBias = eMax >> 1;\n  var nBits = eLen - 7;\n  var i = nBytes - 1;\n  var s = buffer[i--];\n  var e = s & 127;\n  var m;\n  s >>= 7;\n  for (; nBits > 0; e = e * 256 + buffer[i], i--, nBits -= 8);\n  m = e & (1 << -nBits) - 1;\n  e >>= -nBits;\n  nBits += mLen;\n  for (; nBits > 0; m = m * 256 + buffer[i], i--, nBits -= 8);\n  if (e === 0) {\n    e = 1 - eBias;\n  } else if (e === eMax) {\n    return m ? NaN : s ? -Infinity : Infinity;\n  } else {\n    m = m + pow(2, mLen);\n    e = e - eBias;\n  } return (s ? -1 : 1) * m * pow(2, e - mLen);\n}\n\nfunction unpackI32(bytes) {\n  return bytes[3] << 24 | bytes[2] << 16 | bytes[1] << 8 | bytes[0];\n}\nfunction packI8(it) {\n  return [it & 0xff];\n}\nfunction packI16(it) {\n  return [it & 0xff, it >> 8 & 0xff];\n}\nfunction packI32(it) {\n  return [it & 0xff, it >> 8 & 0xff, it >> 16 & 0xff, it >> 24 & 0xff];\n}\nfunction packF64(it) {\n  return packIEEE754(it, 52, 8);\n}\nfunction packF32(it) {\n  return packIEEE754(it, 23, 4);\n}\n\nfunction addGetter(C, key, internal) {\n  dP(C[PROTOTYPE], key, { get: function () { return this[internal]; } });\n}\n\nfunction get(view, bytes, index, isLittleEndian) {\n  var numIndex = +index;\n  var intIndex = toIndex(numIndex);\n  if (intIndex + bytes > view[$LENGTH]) throw RangeError(WRONG_INDEX);\n  var store = view[$BUFFER]._b;\n  var start = intIndex + view[$OFFSET];\n  var pack = store.slice(start, start + bytes);\n  return isLittleEndian ? pack : pack.reverse();\n}\nfunction set(view, bytes, index, conversion, value, isLittleEndian) {\n  var numIndex = +index;\n  var intIndex = toIndex(numIndex);\n  if (intIndex + bytes > view[$LENGTH]) throw RangeError(WRONG_INDEX);\n  var store = view[$BUFFER]._b;\n  var start = intIndex + view[$OFFSET];\n  var pack = conversion(+value);\n  for (var i = 0; i < bytes; i++) store[start + i] = pack[isLittleEndian ? i : bytes - i - 1];\n}\n\nif (!$typed.ABV) {\n  $ArrayBuffer = function ArrayBuffer(length) {\n    anInstance(this, $ArrayBuffer, ARRAY_BUFFER);\n    var byteLength = toIndex(length);\n    this._b = arrayFill.call(new Array(byteLength), 0);\n    this[$LENGTH] = byteLength;\n  };\n\n  $DataView = function DataView(buffer, byteOffset, byteLength) {\n    anInstance(this, $DataView, DATA_VIEW);\n    anInstance(buffer, $ArrayBuffer, DATA_VIEW);\n    var bufferLength = buffer[$LENGTH];\n    var offset = toInteger(byteOffset);\n    if (offset < 0 || offset > bufferLength) throw RangeError('Wrong offset!');\n    byteLength = byteLength === undefined ? bufferLength - offset : toLength(byteLength);\n    if (offset + byteLength > bufferLength) throw RangeError(WRONG_LENGTH);\n    this[$BUFFER] = buffer;\n    this[$OFFSET] = offset;\n    this[$LENGTH] = byteLength;\n  };\n\n  if (DESCRIPTORS) {\n    addGetter($ArrayBuffer, BYTE_LENGTH, '_l');\n    addGetter($DataView, BUFFER, '_b');\n    addGetter($DataView, BYTE_LENGTH, '_l');\n    addGetter($DataView, BYTE_OFFSET, '_o');\n  }\n\n  redefineAll($DataView[PROTOTYPE], {\n    getInt8: function getInt8(byteOffset) {\n      return get(this, 1, byteOffset)[0] << 24 >> 24;\n    },\n    getUint8: function getUint8(byteOffset) {\n      return get(this, 1, byteOffset)[0];\n    },\n    getInt16: function getInt16(byteOffset /* , littleEndian */) {\n      var bytes = get(this, 2, byteOffset, arguments[1]);\n      return (bytes[1] << 8 | bytes[0]) << 16 >> 16;\n    },\n    getUint16: function getUint16(byteOffset /* , littleEndian */) {\n      var bytes = get(this, 2, byteOffset, arguments[1]);\n      return bytes[1] << 8 | bytes[0];\n    },\n    getInt32: function getInt32(byteOffset /* , littleEndian */) {\n      return unpackI32(get(this, 4, byteOffset, arguments[1]));\n    },\n    getUint32: function getUint32(byteOffset /* , littleEndian */) {\n      return unpackI32(get(this, 4, byteOffset, arguments[1])) >>> 0;\n    },\n    getFloat32: function getFloat32(byteOffset /* , littleEndian */) {\n      return unpackIEEE754(get(this, 4, byteOffset, arguments[1]), 23, 4);\n    },\n    getFloat64: function getFloat64(byteOffset /* , littleEndian */) {\n      return unpackIEEE754(get(this, 8, byteOffset, arguments[1]), 52, 8);\n    },\n    setInt8: function setInt8(byteOffset, value) {\n      set(this, 1, byteOffset, packI8, value);\n    },\n    setUint8: function setUint8(byteOffset, value) {\n      set(this, 1, byteOffset, packI8, value);\n    },\n    setInt16: function setInt16(byteOffset, value /* , littleEndian */) {\n      set(this, 2, byteOffset, packI16, value, arguments[2]);\n    },\n    setUint16: function setUint16(byteOffset, value /* , littleEndian */) {\n      set(this, 2, byteOffset, packI16, value, arguments[2]);\n    },\n    setInt32: function setInt32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packI32, value, arguments[2]);\n    },\n    setUint32: function setUint32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packI32, value, arguments[2]);\n    },\n    setFloat32: function setFloat32(byteOffset, value /* , littleEndian */) {\n      set(this, 4, byteOffset, packF32, value, arguments[2]);\n    },\n    setFloat64: function setFloat64(byteOffset, value /* , littleEndian */) {\n      set(this, 8, byteOffset, packF64, value, arguments[2]);\n    }\n  });\n} else {\n  if (!fails(function () {\n    $ArrayBuffer(1);\n  }) || !fails(function () {\n    new $ArrayBuffer(-1); // eslint-disable-line no-new\n  }) || fails(function () {\n    new $ArrayBuffer(); // eslint-disable-line no-new\n    new $ArrayBuffer(1.5); // eslint-disable-line no-new\n    new $ArrayBuffer(NaN); // eslint-disable-line no-new\n    return $ArrayBuffer.name != ARRAY_BUFFER;\n  })) {\n    $ArrayBuffer = function ArrayBuffer(length) {\n      anInstance(this, $ArrayBuffer);\n      return new BaseBuffer(toIndex(length));\n    };\n    var ArrayBufferProto = $ArrayBuffer[PROTOTYPE] = BaseBuffer[PROTOTYPE];\n    for (var keys = gOPN(BaseBuffer), j = 0, key; keys.length > j;) {\n      if (!((key = keys[j++]) in $ArrayBuffer)) hide($ArrayBuffer, key, BaseBuffer[key]);\n    }\n    if (!LIBRARY) ArrayBufferProto.constructor = $ArrayBuffer;\n  }\n  // iOS Safari 7.x bug\n  var view = new $DataView(new $ArrayBuffer(2));\n  var $setInt8 = $DataView[PROTOTYPE].setInt8;\n  view.setInt8(0, 2147483648);\n  view.setInt8(1, 2147483649);\n  if (view.getInt8(0) || !view.getInt8(1)) redefineAll($DataView[PROTOTYPE], {\n    setInt8: function setInt8(byteOffset, value) {\n      $setInt8.call(this, byteOffset, value << 24 >> 24);\n    },\n    setUint8: function setUint8(byteOffset, value) {\n      $setInt8.call(this, byteOffset, value << 24 >> 24);\n    }\n  }, true);\n}\nsetToStringTag($ArrayBuffer, ARRAY_BUFFER);\nsetToStringTag($DataView, DATA_VIEW);\nhide($DataView[PROTOTYPE], $typed.VIEW, true);\nexports[ARRAY_BUFFER] = $ArrayBuffer;\nexports[DATA_VIEW] = $DataView;\n","var global = require('./_global');\nvar hide = require('./_hide');\nvar uid = require('./_uid');\nvar TYPED = uid('typed_array');\nvar VIEW = uid('view');\nvar ABV = !!(global.ArrayBuffer && global.DataView);\nvar CONSTR = ABV;\nvar i = 0;\nvar l = 9;\nvar Typed;\n\nvar TypedArrayConstructors = (\n  'Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array'\n).split(',');\n\nwhile (i < l) {\n  if (Typed = global[TypedArrayConstructors[i++]]) {\n    hide(Typed.prototype, TYPED, true);\n    hide(Typed.prototype, VIEW, true);\n  } else CONSTR = false;\n}\n\nmodule.exports = {\n  ABV: ABV,\n  CONSTR: CONSTR,\n  TYPED: TYPED,\n  VIEW: VIEW\n};\n","var id = 0;\nvar px = Math.random();\nmodule.exports = function (key) {\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n","var global = require('./_global');\nvar navigator = global.navigator;\n\nmodule.exports = navigator && navigator.userAgent || '';\n","var isObject = require('./_is-object');\nmodule.exports = function (it, TYPE) {\n  if (!isObject(it) || it._t !== TYPE) throw TypeError('Incompatible receiver, ' + TYPE + ' required!');\n  return it;\n};\n","var global = require('./_global');\nvar core = require('./_core');\nvar LIBRARY = require('./_library');\nvar wksExt = require('./_wks-ext');\nvar defineProperty = require('./_object-dp').f;\nmodule.exports = function (name) {\n  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});\n  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });\n};\n","exports.f = require('./_wks');\n","var store = require('./_shared')('wks');\nvar uid = require('./_uid');\nvar Symbol = require('./_global').Symbol;\nvar USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function (name) {\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;\n","var classof = require('./_classof');\nvar ITERATOR = require('./_wks')('iterator');\nvar Iterators = require('./_iterators');\nmodule.exports = require('./_core').getIteratorMethod = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n","// https://github.com/benjamingr/RexExp.escape\nvar $export = require('./_export');\nvar $re = require('./_replacer')(/[\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n\n$export($export.S, 'RegExp', { escape: function escape(it) { return $re(it); } });\n","// 22.1.3.3 Array.prototype.copyWithin(target, start, end = this.length)\nvar $export = require('./_export');\n\n$export($export.P, 'Array', { copyWithin: require('./_array-copy-within') });\n\nrequire('./_add-to-unscopables')('copyWithin');\n","'use strict';\nvar $export = require('./_export');\nvar $every = require('./_array-methods')(4);\n\n$export($export.P + $export.F * !require('./_strict-method')([].every, true), 'Array', {\n  // 22.1.3.5 / 15.4.4.16 Array.prototype.every(callbackfn [, thisArg])\n  every: function every(callbackfn /* , thisArg */) {\n    return $every(this, callbackfn, arguments[1]);\n  }\n});\n","// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)\nvar $export = require('./_export');\n\n$export($export.P, 'Array', { fill: require('./_array-fill') });\n\nrequire('./_add-to-unscopables')('fill');\n","'use strict';\nvar $export = require('./_export');\nvar $filter = require('./_array-methods')(2);\n\n$export($export.P + $export.F * !require('./_strict-method')([].filter, true), 'Array', {\n  // 22.1.3.7 / 15.4.4.20 Array.prototype.filter(callbackfn [, thisArg])\n  filter: function filter(callbackfn /* , thisArg */) {\n    return $filter(this, callbackfn, arguments[1]);\n  }\n});\n","'use strict';\n// 22.1.3.9 Array.prototype.findIndex(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(6);\nvar KEY = 'findIndex';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n","'use strict';\n// 22.1.3.8 Array.prototype.find(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(5);\nvar KEY = 'find';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n","'use strict';\nvar $export = require('./_export');\nvar $forEach = require('./_array-methods')(0);\nvar STRICT = require('./_strict-method')([].forEach, true);\n\n$export($export.P + $export.F * !STRICT, 'Array', {\n  // 22.1.3.10 / 15.4.4.18 Array.prototype.forEach(callbackfn [, thisArg])\n  forEach: function forEach(callbackfn /* , thisArg */) {\n    return $forEach(this, callbackfn, arguments[1]);\n  }\n});\n","'use strict';\nvar ctx = require('./_ctx');\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar call = require('./_iter-call');\nvar isArrayIter = require('./_is-array-iter');\nvar toLength = require('./_to-length');\nvar createProperty = require('./_create-property');\nvar getIterFn = require('./core.get-iterator-method');\n\n$export($export.S + $export.F * !require('./_iter-detect')(function (iter) { Array.from(iter); }), 'Array', {\n  // 22.1.2.1 Array.from(arrayLike, mapfn = undefined, thisArg = undefined)\n  from: function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n    var O = toObject(arrayLike);\n    var C = typeof this == 'function' ? this : Array;\n    var aLen = arguments.length;\n    var mapfn = aLen > 1 ? arguments[1] : undefined;\n    var mapping = mapfn !== undefined;\n    var index = 0;\n    var iterFn = getIterFn(O);\n    var length, result, step, iterator;\n    if (mapping) mapfn = ctx(mapfn, aLen > 2 ? arguments[2] : undefined, 2);\n    // if object isn't iterable or it's array with default iterator - use simple case\n    if (iterFn != undefined && !(C == Array && isArrayIter(iterFn))) {\n      for (iterator = iterFn.call(O), result = new C(); !(step = iterator.next()).done; index++) {\n        createProperty(result, index, mapping ? call(iterator, mapfn, [step.value, index], true) : step.value);\n      }\n    } else {\n      length = toLength(O.length);\n      for (result = new C(length); length > index; index++) {\n        createProperty(result, index, mapping ? mapfn(O[index], index) : O[index]);\n      }\n    }\n    result.length = index;\n    return result;\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar $indexOf = require('./_array-includes')(false);\nvar $native = [].indexOf;\nvar NEGATIVE_ZERO = !!$native && 1 / [1].indexOf(1, -0) < 0;\n\n$export($export.P + $export.F * (NEGATIVE_ZERO || !require('./_strict-method')($native)), 'Array', {\n  // 22.1.3.11 / 15.4.4.14 Array.prototype.indexOf(searchElement [, fromIndex])\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? $native.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments[1]);\n  }\n});\n","// 22.1.2.2 / 15.4.3.2 Array.isArray(arg)\nvar $export = require('./_export');\n\n$export($export.S, 'Array', { isArray: require('./_is-array') });\n","'use strict';\nvar addToUnscopables = require('./_add-to-unscopables');\nvar step = require('./_iter-step');\nvar Iterators = require('./_iterators');\nvar toIObject = require('./_to-iobject');\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = require('./_iter-define')(Array, 'Array', function (iterated, kind) {\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var kind = this._k;\n  var index = this._i++;\n  if (!O || index >= O.length) {\n    this._t = undefined;\n    return step(1);\n  }\n  if (kind == 'keys') return step(0, index);\n  if (kind == 'values') return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n","'use strict';\n// 22.1.3.13 Array.prototype.join(separator)\nvar $export = require('./_export');\nvar toIObject = require('./_to-iobject');\nvar arrayJoin = [].join;\n\n// fallback for not array-like strings\n$export($export.P + $export.F * (require('./_iobject') != Object || !require('./_strict-method')(arrayJoin)), 'Array', {\n  join: function join(separator) {\n    return arrayJoin.call(toIObject(this), separator === undefined ? ',' : separator);\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar toIObject = require('./_to-iobject');\nvar toInteger = require('./_to-integer');\nvar toLength = require('./_to-length');\nvar $native = [].lastIndexOf;\nvar NEGATIVE_ZERO = !!$native && 1 / [1].lastIndexOf(1, -0) < 0;\n\n$export($export.P + $export.F * (NEGATIVE_ZERO || !require('./_strict-method')($native)), 'Array', {\n  // 22.1.3.14 / 15.4.4.15 Array.prototype.lastIndexOf(searchElement [, fromIndex])\n  lastIndexOf: function lastIndexOf(searchElement /* , fromIndex = @[*-1] */) {\n    // convert -0 to +0\n    if (NEGATIVE_ZERO) return $native.apply(this, arguments) || 0;\n    var O = toIObject(this);\n    var length = toLength(O.length);\n    var index = length - 1;\n    if (arguments.length > 1) index = Math.min(index, toInteger(arguments[1]));\n    if (index < 0) index = length + index;\n    for (;index >= 0; index--) if (index in O) if (O[index] === searchElement) return index || 0;\n    return -1;\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar $map = require('./_array-methods')(1);\n\n$export($export.P + $export.F * !require('./_strict-method')([].map, true), 'Array', {\n  // 22.1.3.15 / 15.4.4.19 Array.prototype.map(callbackfn [, thisArg])\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments[1]);\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar createProperty = require('./_create-property');\n\n// WebKit Array.of isn't generic\n$export($export.S + $export.F * require('./_fails')(function () {\n  function F() { /* empty */ }\n  return !(Array.of.call(F) instanceof F);\n}), 'Array', {\n  // 22.1.2.3 Array.of( ...items)\n  of: function of(/* ...args */) {\n    var index = 0;\n    var aLen = arguments.length;\n    var result = new (typeof this == 'function' ? this : Array)(aLen);\n    while (aLen > index) createProperty(result, index, arguments[index++]);\n    result.length = aLen;\n    return result;\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar $reduce = require('./_array-reduce');\n\n$export($export.P + $export.F * !require('./_strict-method')([].reduceRight, true), 'Array', {\n  // 22.1.3.19 / 15.4.4.22 Array.prototype.reduceRight(callbackfn [, initialValue])\n  reduceRight: function reduceRight(callbackfn /* , initialValue */) {\n    return $reduce(this, callbackfn, arguments.length, arguments[1], true);\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar $reduce = require('./_array-reduce');\n\n$export($export.P + $export.F * !require('./_strict-method')([].reduce, true), 'Array', {\n  // 22.1.3.18 / 15.4.4.21 Array.prototype.reduce(callbackfn [, initialValue])\n  reduce: function reduce(callbackfn /* , initialValue */) {\n    return $reduce(this, callbackfn, arguments.length, arguments[1], false);\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar html = require('./_html');\nvar cof = require('./_cof');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nvar toLength = require('./_to-length');\nvar arraySlice = [].slice;\n\n// fallback for not array-like ES3 strings and DOM objects\n$export($export.P + $export.F * require('./_fails')(function () {\n  if (html) arraySlice.call(html);\n}), 'Array', {\n  slice: function slice(begin, end) {\n    var len = toLength(this.length);\n    var klass = cof(this);\n    end = end === undefined ? len : end;\n    if (klass == 'Array') return arraySlice.call(this, begin, end);\n    var start = toAbsoluteIndex(begin, len);\n    var upTo = toAbsoluteIndex(end, len);\n    var size = toLength(upTo - start);\n    var cloned = new Array(size);\n    var i = 0;\n    for (; i < size; i++) cloned[i] = klass == 'String'\n      ? this.charAt(start + i)\n      : this[start + i];\n    return cloned;\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar $some = require('./_array-methods')(3);\n\n$export($export.P + $export.F * !require('./_strict-method')([].some, true), 'Array', {\n  // 22.1.3.23 / 15.4.4.17 Array.prototype.some(callbackfn [, thisArg])\n  some: function some(callbackfn /* , thisArg */) {\n    return $some(this, callbackfn, arguments[1]);\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar aFunction = require('./_a-function');\nvar toObject = require('./_to-object');\nvar fails = require('./_fails');\nvar $sort = [].sort;\nvar test = [1, 2, 3];\n\n$export($export.P + $export.F * (fails(function () {\n  // IE8-\n  test.sort(undefined);\n}) || !fails(function () {\n  // V8 bug\n  test.sort(null);\n  // Old WebKit\n}) || !require('./_strict-method')($sort)), 'Array', {\n  // 22.1.3.25 Array.prototype.sort(comparefn)\n  sort: function sort(comparefn) {\n    return comparefn === undefined\n      ? $sort.call(toObject(this))\n      : $sort.call(toObject(this), aFunction(comparefn));\n  }\n});\n","require('./_set-species')('Array');\n","// 20.3.3.1 / 15.9.4.4 Date.now()\nvar $export = require('./_export');\n\n$export($export.S, 'Date', { now: function () { return new Date().getTime(); } });\n","// 20.3.4.36 / 15.9.5.43 Date.prototype.toISOString()\nvar $export = require('./_export');\nvar toISOString = require('./_date-to-iso-string');\n\n// PhantomJS / old WebKit has a broken implementations\n$export($export.P + $export.F * (Date.prototype.toISOString !== toISOString), 'Date', {\n  toISOString: toISOString\n});\n","'use strict';\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar toPrimitive = require('./_to-primitive');\n\n$export($export.P + $export.F * require('./_fails')(function () {\n  return new Date(NaN).toJSON() !== null\n    || Date.prototype.toJSON.call({ toISOString: function () { return 1; } }) !== 1;\n}), 'Date', {\n  // eslint-disable-next-line no-unused-vars\n  toJSON: function toJSON(key) {\n    var O = toObject(this);\n    var pv = toPrimitive(O);\n    return typeof pv == 'number' && !isFinite(pv) ? null : O.toISOString();\n  }\n});\n","var TO_PRIMITIVE = require('./_wks')('toPrimitive');\nvar proto = Date.prototype;\n\nif (!(TO_PRIMITIVE in proto)) require('./_hide')(proto, TO_PRIMITIVE, require('./_date-to-primitive'));\n","var DateProto = Date.prototype;\nvar INVALID_DATE = 'Invalid Date';\nvar TO_STRING = 'toString';\nvar $toString = DateProto[TO_STRING];\nvar getTime = DateProto.getTime;\nif (new Date(NaN) + '' != INVALID_DATE) {\n  require('./_redefine')(DateProto, TO_STRING, function toString() {\n    var value = getTime.call(this);\n    // eslint-disable-next-line no-self-compare\n    return value === value ? $toString.call(this) : INVALID_DATE;\n  });\n}\n","// 19.2.3.2 / 15.3.4.5 Function.prototype.bind(thisArg, args...)\nvar $export = require('./_export');\n\n$export($export.P, 'Function', { bind: require('./_bind') });\n","'use strict';\nvar isObject = require('./_is-object');\nvar getPrototypeOf = require('./_object-gpo');\nvar HAS_INSTANCE = require('./_wks')('hasInstance');\nvar FunctionProto = Function.prototype;\n// 19.2.3.6 Function.prototype[@@hasInstance](V)\nif (!(HAS_INSTANCE in FunctionProto)) require('./_object-dp').f(FunctionProto, HAS_INSTANCE, { value: function (O) {\n  if (typeof this != 'function' || !isObject(O)) return false;\n  if (!isObject(this.prototype)) return O instanceof this;\n  // for environment w/o native `@@hasInstance` logic enough `instanceof`, but add this:\n  while (O = getPrototypeOf(O)) if (this.prototype === O) return true;\n  return false;\n} });\n","var dP = require('./_object-dp').f;\nvar FProto = Function.prototype;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// 19.2.4.2 name\nNAME in FProto || require('./_descriptors') && dP(FProto, NAME, {\n  configurable: true,\n  get: function () {\n    try {\n      return ('' + this).match(nameRE)[1];\n    } catch (e) {\n      return '';\n    }\n  }\n});\n","'use strict';\nvar strong = require('./_collection-strong');\nvar validate = require('./_validate-collection');\nvar MAP = 'Map';\n\n// 23.1 Map Objects\nmodule.exports = require('./_collection')(MAP, function (get) {\n  return function Map() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };\n}, {\n  // 23.1.3.6 Map.prototype.get(key)\n  get: function get(key) {\n    var entry = strong.getEntry(validate(this, MAP), key);\n    return entry && entry.v;\n  },\n  // 23.1.3.9 Map.prototype.set(key, value)\n  set: function set(key, value) {\n    return strong.def(validate(this, MAP), key === 0 ? 0 : key, value);\n  }\n}, strong, true);\n","// 20.2.2.3 Math.acosh(x)\nvar $export = require('./_export');\nvar log1p = require('./_math-log1p');\nvar sqrt = Math.sqrt;\nvar $acosh = Math.acosh;\n\n$export($export.S + $export.F * !($acosh\n  // V8 bug: https://code.google.com/p/v8/issues/detail?id=3509\n  && Math.floor($acosh(Number.MAX_VALUE)) == 710\n  // Tor Browser bug: Math.acosh(Infinity) -> NaN\n  && $acosh(Infinity) == Infinity\n), 'Math', {\n  acosh: function acosh(x) {\n    return (x = +x) < 1 ? NaN : x > 94906265.62425156\n      ? Math.log(x) + Math.LN2\n      : log1p(x - 1 + sqrt(x - 1) * sqrt(x + 1));\n  }\n});\n","// 20.2.2.5 Math.asinh(x)\nvar $export = require('./_export');\nvar $asinh = Math.asinh;\n\nfunction asinh(x) {\n  return !isFinite(x = +x) || x == 0 ? x : x < 0 ? -asinh(-x) : Math.log(x + Math.sqrt(x * x + 1));\n}\n\n// Tor Browser bug: Math.asinh(0) -> -0\n$export($export.S + $export.F * !($asinh && 1 / $asinh(0) > 0), 'Math', { asinh: asinh });\n","// 20.2.2.7 Math.atanh(x)\nvar $export = require('./_export');\nvar $atanh = Math.atanh;\n\n// Tor Browser bug: Math.atanh(-0) -> 0\n$export($export.S + $export.F * !($atanh && 1 / $atanh(-0) < 0), 'Math', {\n  atanh: function atanh(x) {\n    return (x = +x) == 0 ? x : Math.log((1 + x) / (1 - x)) / 2;\n  }\n});\n","// 20.2.2.9 Math.cbrt(x)\nvar $export = require('./_export');\nvar sign = require('./_math-sign');\n\n$export($export.S, 'Math', {\n  cbrt: function cbrt(x) {\n    return sign(x = +x) * Math.pow(Math.abs(x), 1 / 3);\n  }\n});\n","// 20.2.2.11 Math.clz32(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', {\n  clz32: function clz32(x) {\n    return (x >>>= 0) ? 31 - Math.floor(Math.log(x + 0.5) * Math.LOG2E) : 32;\n  }\n});\n","// 20.2.2.12 Math.cosh(x)\nvar $export = require('./_export');\nvar exp = Math.exp;\n\n$export($export.S, 'Math', {\n  cosh: function cosh(x) {\n    return (exp(x = +x) + exp(-x)) / 2;\n  }\n});\n","// 20.2.2.14 Math.expm1(x)\nvar $export = require('./_export');\nvar $expm1 = require('./_math-expm1');\n\n$export($export.S + $export.F * ($expm1 != Math.expm1), 'Math', { expm1: $expm1 });\n","// 20.2.2.16 Math.fround(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', { fround: require('./_math-fround') });\n","// 20.2.2.17 Math.hypot([value1[, value2[,  ]]])\nvar $export = require('./_export');\nvar abs = Math.abs;\n\n$export($export.S, 'Math', {\n  hypot: function hypot(value1, value2) { // eslint-disable-line no-unused-vars\n    var sum = 0;\n    var i = 0;\n    var aLen = arguments.length;\n    var larg = 0;\n    var arg, div;\n    while (i < aLen) {\n      arg = abs(arguments[i++]);\n      if (larg < arg) {\n        div = larg / arg;\n        sum = sum * div * div + 1;\n        larg = arg;\n      } else if (arg > 0) {\n        div = arg / larg;\n        sum += div * div;\n      } else sum += arg;\n    }\n    return larg === Infinity ? Infinity : larg * Math.sqrt(sum);\n  }\n});\n","// 20.2.2.18 Math.imul(x, y)\nvar $export = require('./_export');\nvar $imul = Math.imul;\n\n// some WebKit versions fails with big numbers, some has wrong arity\n$export($export.S + $export.F * require('./_fails')(function () {\n  return $imul(0xffffffff, 5) != -5 || $imul.length != 2;\n}), 'Math', {\n  imul: function imul(x, y) {\n    var UINT16 = 0xffff;\n    var xn = +x;\n    var yn = +y;\n    var xl = UINT16 & xn;\n    var yl = UINT16 & yn;\n    return 0 | xl * yl + ((UINT16 & xn >>> 16) * yl + xl * (UINT16 & yn >>> 16) << 16 >>> 0);\n  }\n});\n","// 20.2.2.21 Math.log10(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', {\n  log10: function log10(x) {\n    return Math.log(x) * Math.LOG10E;\n  }\n});\n","// 20.2.2.20 Math.log1p(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', { log1p: require('./_math-log1p') });\n","// 20.2.2.22 Math.log2(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', {\n  log2: function log2(x) {\n    return Math.log(x) / Math.LN2;\n  }\n});\n","// 20.2.2.28 Math.sign(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', { sign: require('./_math-sign') });\n","// 20.2.2.30 Math.sinh(x)\nvar $export = require('./_export');\nvar expm1 = require('./_math-expm1');\nvar exp = Math.exp;\n\n// V8 near Chromium 38 has a problem with very small numbers\n$export($export.S + $export.F * require('./_fails')(function () {\n  return !Math.sinh(-2e-17) != -2e-17;\n}), 'Math', {\n  sinh: function sinh(x) {\n    return Math.abs(x = +x) < 1\n      ? (expm1(x) - expm1(-x)) / 2\n      : (exp(x - 1) - exp(-x - 1)) * (Math.E / 2);\n  }\n});\n","// 20.2.2.33 Math.tanh(x)\nvar $export = require('./_export');\nvar expm1 = require('./_math-expm1');\nvar exp = Math.exp;\n\n$export($export.S, 'Math', {\n  tanh: function tanh(x) {\n    var a = expm1(x = +x);\n    var b = expm1(-x);\n    return a == Infinity ? 1 : b == Infinity ? -1 : (a - b) / (exp(x) + exp(-x));\n  }\n});\n","// 20.2.2.34 Math.trunc(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', {\n  trunc: function trunc(it) {\n    return (it > 0 ? Math.floor : Math.ceil)(it);\n  }\n});\n","'use strict';\nvar global = require('./_global');\nvar has = require('./_has');\nvar cof = require('./_cof');\nvar inheritIfRequired = require('./_inherit-if-required');\nvar toPrimitive = require('./_to-primitive');\nvar fails = require('./_fails');\nvar gOPN = require('./_object-gopn').f;\nvar gOPD = require('./_object-gopd').f;\nvar dP = require('./_object-dp').f;\nvar $trim = require('./_string-trim').trim;\nvar NUMBER = 'Number';\nvar $Number = global[NUMBER];\nvar Base = $Number;\nvar proto = $Number.prototype;\n// Opera ~12 has broken Object#toString\nvar BROKEN_COF = cof(require('./_object-create')(proto)) == NUMBER;\nvar TRIM = 'trim' in String.prototype;\n\n// 7.1.3 ToNumber(argument)\nvar toNumber = function (argument) {\n  var it = toPrimitive(argument, false);\n  if (typeof it == 'string' && it.length > 2) {\n    it = TRIM ? it.trim() : $trim(it, 3);\n    var first = it.charCodeAt(0);\n    var third, radix, maxCode;\n    if (first === 43 || first === 45) {\n      third = it.charCodeAt(2);\n      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix\n    } else if (first === 48) {\n      switch (it.charCodeAt(1)) {\n        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal /^0b[01]+$/i\n        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal /^0o[0-7]+$/i\n        default: return +it;\n      }\n      for (var digits = it.slice(2), i = 0, l = digits.length, code; i < l; i++) {\n        code = digits.charCodeAt(i);\n        // parseInt parses a string to a first unavailable symbol\n        // but ToNumber should return NaN if a string contains unavailable symbols\n        if (code < 48 || code > maxCode) return NaN;\n      } return parseInt(digits, radix);\n    }\n  } return +it;\n};\n\nif (!$Number(' 0o1') || !$Number('0b1') || $Number('+0x1')) {\n  $Number = function Number(value) {\n    var it = arguments.length < 1 ? 0 : value;\n    var that = this;\n    return that instanceof $Number\n      // check on 1..constructor(foo) case\n      && (BROKEN_COF ? fails(function () { proto.valueOf.call(that); }) : cof(that) != NUMBER)\n        ? inheritIfRequired(new Base(toNumber(it)), that, $Number) : toNumber(it);\n  };\n  for (var keys = require('./_descriptors') ? gOPN(Base) : (\n    // ES3:\n    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +\n    // ES6 (in case, if modules with ES6 Number statics required before):\n    'EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,' +\n    'MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger'\n  ).split(','), j = 0, key; keys.length > j; j++) {\n    if (has(Base, key = keys[j]) && !has($Number, key)) {\n      dP($Number, key, gOPD(Base, key));\n    }\n  }\n  $Number.prototype = proto;\n  proto.constructor = $Number;\n  require('./_redefine')(global, NUMBER, $Number);\n}\n","// 20.1.2.1 Number.EPSILON\nvar $export = require('./_export');\n\n$export($export.S, 'Number', { EPSILON: Math.pow(2, -52) });\n","// 20.1.2.2 Number.isFinite(number)\nvar $export = require('./_export');\nvar _isFinite = require('./_global').isFinite;\n\n$export($export.S, 'Number', {\n  isFinite: function isFinite(it) {\n    return typeof it == 'number' && _isFinite(it);\n  }\n});\n","// 20.1.2.3 Number.isInteger(number)\nvar $export = require('./_export');\n\n$export($export.S, 'Number', { isInteger: require('./_is-integer') });\n","// 20.1.2.4 Number.isNaN(number)\nvar $export = require('./_export');\n\n$export($export.S, 'Number', {\n  isNaN: function isNaN(number) {\n    // eslint-disable-next-line no-self-compare\n    return number != number;\n  }\n});\n","// 20.1.2.5 Number.isSafeInteger(number)\nvar $export = require('./_export');\nvar isInteger = require('./_is-integer');\nvar abs = Math.abs;\n\n$export($export.S, 'Number', {\n  isSafeInteger: function isSafeInteger(number) {\n    return isInteger(number) && abs(number) <= 0x1fffffffffffff;\n  }\n});\n","// 20.1.2.6 Number.MAX_SAFE_INTEGER\nvar $export = require('./_export');\n\n$export($export.S, 'Number', { MAX_SAFE_INTEGER: 0x1fffffffffffff });\n","// 20.1.2.10 Number.MIN_SAFE_INTEGER\nvar $export = require('./_export');\n\n$export($export.S, 'Number', { MIN_SAFE_INTEGER: -0x1fffffffffffff });\n","var $export = require('./_export');\nvar $parseFloat = require('./_parse-float');\n// 20.1.2.12 Number.parseFloat(string)\n$export($export.S + $export.F * (Number.parseFloat != $parseFloat), 'Number', { parseFloat: $parseFloat });\n","var $export = require('./_export');\nvar $parseInt = require('./_parse-int');\n// 20.1.2.13 Number.parseInt(string, radix)\n$export($export.S + $export.F * (Number.parseInt != $parseInt), 'Number', { parseInt: $parseInt });\n","'use strict';\nvar $export = require('./_export');\nvar toInteger = require('./_to-integer');\nvar aNumberValue = require('./_a-number-value');\nvar repeat = require('./_string-repeat');\nvar $toFixed = 1.0.toFixed;\nvar floor = Math.floor;\nvar data = [0, 0, 0, 0, 0, 0];\nvar ERROR = 'Number.toFixed: incorrect invocation!';\nvar ZERO = '0';\n\nvar multiply = function (n, c) {\n  var i = -1;\n  var c2 = c;\n  while (++i < 6) {\n    c2 += n * data[i];\n    data[i] = c2 % 1e7;\n    c2 = floor(c2 / 1e7);\n  }\n};\nvar divide = function (n) {\n  var i = 6;\n  var c = 0;\n  while (--i >= 0) {\n    c += data[i];\n    data[i] = floor(c / n);\n    c = (c % n) * 1e7;\n  }\n};\nvar numToString = function () {\n  var i = 6;\n  var s = '';\n  while (--i >= 0) {\n    if (s !== '' || i === 0 || data[i] !== 0) {\n      var t = String(data[i]);\n      s = s === '' ? t : s + repeat.call(ZERO, 7 - t.length) + t;\n    }\n  } return s;\n};\nvar pow = function (x, n, acc) {\n  return n === 0 ? acc : n % 2 === 1 ? pow(x, n - 1, acc * x) : pow(x * x, n / 2, acc);\n};\nvar log = function (x) {\n  var n = 0;\n  var x2 = x;\n  while (x2 >= 4096) {\n    n += 12;\n    x2 /= 4096;\n  }\n  while (x2 >= 2) {\n    n += 1;\n    x2 /= 2;\n  } return n;\n};\n\n$export($export.P + $export.F * (!!$toFixed && (\n  0.00008.toFixed(3) !== '0.000' ||\n  0.9.toFixed(0) !== '1' ||\n  1.255.toFixed(2) !== '1.25' ||\n  1000000000000000128.0.toFixed(0) !== '1000000000000000128'\n) || !require('./_fails')(function () {\n  // V8 ~ Android 4.3-\n  $toFixed.call({});\n})), 'Number', {\n  toFixed: function toFixed(fractionDigits) {\n    var x = aNumberValue(this, ERROR);\n    var f = toInteger(fractionDigits);\n    var s = '';\n    var m = ZERO;\n    var e, z, j, k;\n    if (f < 0 || f > 20) throw RangeError(ERROR);\n    // eslint-disable-next-line no-self-compare\n    if (x != x) return 'NaN';\n    if (x <= -1e21 || x >= 1e21) return String(x);\n    if (x < 0) {\n      s = '-';\n      x = -x;\n    }\n    if (x > 1e-21) {\n      e = log(x * pow(2, 69, 1)) - 69;\n      z = e < 0 ? x * pow(2, -e, 1) : x / pow(2, e, 1);\n      z *= 0x10000000000000;\n      e = 52 - e;\n      if (e > 0) {\n        multiply(0, z);\n        j = f;\n        while (j >= 7) {\n          multiply(1e7, 0);\n          j -= 7;\n        }\n        multiply(pow(10, j, 1), 0);\n        j = e - 1;\n        while (j >= 23) {\n          divide(1 << 23);\n          j -= 23;\n        }\n        divide(1 << j);\n        multiply(1, 1);\n        divide(2);\n        m = numToString();\n      } else {\n        multiply(0, z);\n        multiply(1 << -e, 0);\n        m = numToString() + repeat.call(ZERO, f);\n      }\n    }\n    if (f > 0) {\n      k = m.length;\n      m = s + (k <= f ? '0.' + repeat.call(ZERO, f - k) + m : m.slice(0, k - f) + '.' + m.slice(k - f));\n    } else {\n      m = s + m;\n    } return m;\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar $fails = require('./_fails');\nvar aNumberValue = require('./_a-number-value');\nvar $toPrecision = 1.0.toPrecision;\n\n$export($export.P + $export.F * ($fails(function () {\n  // IE7-\n  return $toPrecision.call(1, undefined) !== '1';\n}) || !$fails(function () {\n  // V8 ~ Android 4.3-\n  $toPrecision.call({});\n})), 'Number', {\n  toPrecision: function toPrecision(precision) {\n    var that = aNumberValue(this, 'Number#toPrecision: incorrect invocation!');\n    return precision === undefined ? $toPrecision.call(that) : $toPrecision.call(that, precision);\n  }\n});\n","// 19.1.3.1 Object.assign(target, source)\nvar $export = require('./_export');\n\n$export($export.S + $export.F, 'Object', { assign: require('./_object-assign') });\n","var $export = require('./_export');\n// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\n$export($export.S, 'Object', { create: require('./_object-create') });\n","var $export = require('./_export');\n// 19.1.2.3 / 15.2.3.7 Object.defineProperties(O, Properties)\n$export($export.S + $export.F * !require('./_descriptors'), 'Object', { defineProperties: require('./_object-dps') });\n","var $export = require('./_export');\n// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)\n$export($export.S + $export.F * !require('./_descriptors'), 'Object', { defineProperty: require('./_object-dp').f });\n","// 19.1.2.5 Object.freeze(O)\nvar isObject = require('./_is-object');\nvar meta = require('./_meta').onFreeze;\n\nrequire('./_object-sap')('freeze', function ($freeze) {\n  return function freeze(it) {\n    return $freeze && isObject(it) ? $freeze(meta(it)) : it;\n  };\n});\n","// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\nvar toIObject = require('./_to-iobject');\nvar $getOwnPropertyDescriptor = require('./_object-gopd').f;\n\nrequire('./_object-sap')('getOwnPropertyDescriptor', function () {\n  return function getOwnPropertyDescriptor(it, key) {\n    return $getOwnPropertyDescriptor(toIObject(it), key);\n  };\n});\n","// 19.1.2.7 Object.getOwnPropertyNames(O)\nrequire('./_object-sap')('getOwnPropertyNames', function () {\n  return require('./_object-gopn-ext').f;\n});\n","// 19.1.2.9 Object.getPrototypeOf(O)\nvar toObject = require('./_to-object');\nvar $getPrototypeOf = require('./_object-gpo');\n\nrequire('./_object-sap')('getPrototypeOf', function () {\n  return function getPrototypeOf(it) {\n    return $getPrototypeOf(toObject(it));\n  };\n});\n","// 19.1.2.11 Object.isExtensible(O)\nvar isObject = require('./_is-object');\n\nrequire('./_object-sap')('isExtensible', function ($isExtensible) {\n  return function isExtensible(it) {\n    return isObject(it) ? $isExtensible ? $isExtensible(it) : true : false;\n  };\n});\n","// 19.1.2.12 Object.isFrozen(O)\nvar isObject = require('./_is-object');\n\nrequire('./_object-sap')('isFrozen', function ($isFrozen) {\n  return function isFrozen(it) {\n    return isObject(it) ? $isFrozen ? $isFrozen(it) : false : true;\n  };\n});\n","// 19.1.2.13 Object.isSealed(O)\nvar isObject = require('./_is-object');\n\nrequire('./_object-sap')('isSealed', function ($isSealed) {\n  return function isSealed(it) {\n    return isObject(it) ? $isSealed ? $isSealed(it) : false : true;\n  };\n});\n","// 19.1.3.10 Object.is(value1, value2)\nvar $export = require('./_export');\n$export($export.S, 'Object', { is: require('./_same-value') });\n","// 19.1.2.14 Object.keys(O)\nvar toObject = require('./_to-object');\nvar $keys = require('./_object-keys');\n\nrequire('./_object-sap')('keys', function () {\n  return function keys(it) {\n    return $keys(toObject(it));\n  };\n});\n","// 19.1.2.15 Object.preventExtensions(O)\nvar isObject = require('./_is-object');\nvar meta = require('./_meta').onFreeze;\n\nrequire('./_object-sap')('preventExtensions', function ($preventExtensions) {\n  return function preventExtensions(it) {\n    return $preventExtensions && isObject(it) ? $preventExtensions(meta(it)) : it;\n  };\n});\n","// 19.1.2.17 Object.seal(O)\nvar isObject = require('./_is-object');\nvar meta = require('./_meta').onFreeze;\n\nrequire('./_object-sap')('seal', function ($seal) {\n  return function seal(it) {\n    return $seal && isObject(it) ? $seal(meta(it)) : it;\n  };\n});\n","// 19.1.3.19 Object.setPrototypeOf(O, proto)\nvar $export = require('./_export');\n$export($export.S, 'Object', { setPrototypeOf: require('./_set-proto').set });\n","'use strict';\n// 19.1.3.6 Object.prototype.toString()\nvar classof = require('./_classof');\nvar test = {};\ntest[require('./_wks')('toStringTag')] = 'z';\nif (test + '' != '[object z]') {\n  require('./_redefine')(Object.prototype, 'toString', function toString() {\n    return '[object ' + classof(this) + ']';\n  }, true);\n}\n","var $export = require('./_export');\nvar $parseFloat = require('./_parse-float');\n// 18.2.4 parseFloat(string)\n$export($export.G + $export.F * (parseFloat != $parseFloat), { parseFloat: $parseFloat });\n","var $export = require('./_export');\nvar $parseInt = require('./_parse-int');\n// 18.2.5 parseInt(string, radix)\n$export($export.G + $export.F * (parseInt != $parseInt), { parseInt: $parseInt });\n","'use strict';\nvar LIBRARY = require('./_library');\nvar global = require('./_global');\nvar ctx = require('./_ctx');\nvar classof = require('./_classof');\nvar $export = require('./_export');\nvar isObject = require('./_is-object');\nvar aFunction = require('./_a-function');\nvar anInstance = require('./_an-instance');\nvar forOf = require('./_for-of');\nvar speciesConstructor = require('./_species-constructor');\nvar task = require('./_task').set;\nvar microtask = require('./_microtask')();\nvar newPromiseCapabilityModule = require('./_new-promise-capability');\nvar perform = require('./_perform');\nvar userAgent = require('./_user-agent');\nvar promiseResolve = require('./_promise-resolve');\nvar PROMISE = 'Promise';\nvar TypeError = global.TypeError;\nvar process = global.process;\nvar versions = process && process.versions;\nvar v8 = versions && versions.v8 || '';\nvar $Promise = global[PROMISE];\nvar isNode = classof(process) == 'process';\nvar empty = function () { /* empty */ };\nvar Internal, newGenericPromiseCapability, OwnPromiseCapability, Wrapper;\nvar newPromiseCapability = newGenericPromiseCapability = newPromiseCapabilityModule.f;\n\nvar USE_NATIVE = !!function () {\n  try {\n    // correct subclassing with @@species support\n    var promise = $Promise.resolve(1);\n    var FakePromise = (promise.constructor = {})[require('./_wks')('species')] = function (exec) {\n      exec(empty, empty);\n    };\n    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n    return (isNode || typeof PromiseRejectionEvent == 'function')\n      && promise.then(empty) instanceof FakePromise\n      // v8 6.6 (Node 10 and Chrome 66) have a bug with resolving custom thenables\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=830565\n      // we can't detect it synchronously, so just check versions\n      && v8.indexOf('6.6') !== 0\n      && userAgent.indexOf('Chrome/66') === -1;\n  } catch (e) { /* empty */ }\n}();\n\n// helpers\nvar isThenable = function (it) {\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\nvar notify = function (promise, isReject) {\n  if (promise._n) return;\n  promise._n = true;\n  var chain = promise._c;\n  microtask(function () {\n    var value = promise._v;\n    var ok = promise._s == 1;\n    var i = 0;\n    var run = function (reaction) {\n      var handler = ok ? reaction.ok : reaction.fail;\n      var resolve = reaction.resolve;\n      var reject = reaction.reject;\n      var domain = reaction.domain;\n      var result, then, exited;\n      try {\n        if (handler) {\n          if (!ok) {\n            if (promise._h == 2) onHandleUnhandled(promise);\n            promise._h = 1;\n          }\n          if (handler === true) result = value;\n          else {\n            if (domain) domain.enter();\n            result = handler(value); // may throw\n            if (domain) {\n              domain.exit();\n              exited = true;\n            }\n          }\n          if (result === reaction.promise) {\n            reject(TypeError('Promise-chain cycle'));\n          } else if (then = isThenable(result)) {\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch (e) {\n        if (domain && !exited) domain.exit();\n        reject(e);\n      }\n    };\n    while (chain.length > i) run(chain[i++]); // variable length - can't use forEach\n    promise._c = [];\n    promise._n = false;\n    if (isReject && !promise._h) onUnhandled(promise);\n  });\n};\nvar onUnhandled = function (promise) {\n  task.call(global, function () {\n    var value = promise._v;\n    var unhandled = isUnhandled(promise);\n    var result, handler, console;\n    if (unhandled) {\n      result = perform(function () {\n        if (isNode) {\n          process.emit('unhandledRejection', value, promise);\n        } else if (handler = global.onunhandledrejection) {\n          handler({ promise: promise, reason: value });\n        } else if ((console = global.console) && console.error) {\n          console.error('Unhandled promise rejection', value);\n        }\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      promise._h = isNode || isUnhandled(promise) ? 2 : 1;\n    } promise._a = undefined;\n    if (unhandled && result.e) throw result.v;\n  });\n};\nvar isUnhandled = function (promise) {\n  return promise._h !== 1 && (promise._a || promise._c).length === 0;\n};\nvar onHandleUnhandled = function (promise) {\n  task.call(global, function () {\n    var handler;\n    if (isNode) {\n      process.emit('rejectionHandled', promise);\n    } else if (handler = global.onrejectionhandled) {\n      handler({ promise: promise, reason: promise._v });\n    }\n  });\n};\nvar $reject = function (value) {\n  var promise = this;\n  if (promise._d) return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  promise._v = value;\n  promise._s = 2;\n  if (!promise._a) promise._a = promise._c.slice();\n  notify(promise, true);\n};\nvar $resolve = function (value) {\n  var promise = this;\n  var then;\n  if (promise._d) return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  try {\n    if (promise === value) throw TypeError(\"Promise can't be resolved itself\");\n    if (then = isThenable(value)) {\n      microtask(function () {\n        var wrapper = { _w: promise, _d: false }; // wrap\n        try {\n          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n        } catch (e) {\n          $reject.call(wrapper, e);\n        }\n      });\n    } else {\n      promise._v = value;\n      promise._s = 1;\n      notify(promise, false);\n    }\n  } catch (e) {\n    $reject.call({ _w: promise, _d: false }, e); // wrap\n  }\n};\n\n// constructor polyfill\nif (!USE_NATIVE) {\n  // 25.4.3.1 Promise(executor)\n  $Promise = function Promise(executor) {\n    anInstance(this, $Promise, PROMISE, '_h');\n    aFunction(executor);\n    Internal.call(this);\n    try {\n      executor(ctx($resolve, this, 1), ctx($reject, this, 1));\n    } catch (err) {\n      $reject.call(this, err);\n    }\n  };\n  // eslint-disable-next-line no-unused-vars\n  Internal = function Promise(executor) {\n    this._c = [];             // <- awaiting reactions\n    this._a = undefined;      // <- checked in isUnhandled reactions\n    this._s = 0;              // <- state\n    this._d = false;          // <- done\n    this._v = undefined;      // <- value\n    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled\n    this._n = false;          // <- notify\n  };\n  Internal.prototype = require('./_redefine-all')($Promise.prototype, {\n    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n    then: function then(onFulfilled, onRejected) {\n      var reaction = newPromiseCapability(speciesConstructor(this, $Promise));\n      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail = typeof onRejected == 'function' && onRejected;\n      reaction.domain = isNode ? process.domain : undefined;\n      this._c.push(reaction);\n      if (this._a) this._a.push(reaction);\n      if (this._s) notify(this, false);\n      return reaction.promise;\n    },\n    // 25.4.5.1 Promise.prototype.catch(onRejected)\n    'catch': function (onRejected) {\n      return this.then(undefined, onRejected);\n    }\n  });\n  OwnPromiseCapability = function () {\n    var promise = new Internal();\n    this.promise = promise;\n    this.resolve = ctx($resolve, promise, 1);\n    this.reject = ctx($reject, promise, 1);\n  };\n  newPromiseCapabilityModule.f = newPromiseCapability = function (C) {\n    return C === $Promise || C === Wrapper\n      ? new OwnPromiseCapability(C)\n      : newGenericPromiseCapability(C);\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Promise: $Promise });\nrequire('./_set-to-string-tag')($Promise, PROMISE);\nrequire('./_set-species')(PROMISE);\nWrapper = require('./_core')[PROMISE];\n\n// statics\n$export($export.S + $export.F * !USE_NATIVE, PROMISE, {\n  // 25.4.4.5 Promise.reject(r)\n  reject: function reject(r) {\n    var capability = newPromiseCapability(this);\n    var $$reject = capability.reject;\n    $$reject(r);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {\n  // 25.4.4.6 Promise.resolve(x)\n  resolve: function resolve(x) {\n    return promiseResolve(LIBRARY && this === Wrapper ? $Promise : this, x);\n  }\n});\n$export($export.S + $export.F * !(USE_NATIVE && require('./_iter-detect')(function (iter) {\n  $Promise.all(iter)['catch'](empty);\n})), PROMISE, {\n  // 25.4.4.1 Promise.all(iterable)\n  all: function all(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var resolve = capability.resolve;\n    var reject = capability.reject;\n    var result = perform(function () {\n      var values = [];\n      var index = 0;\n      var remaining = 1;\n      forOf(iterable, false, function (promise) {\n        var $index = index++;\n        var alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        C.resolve(promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          values[$index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if (result.e) reject(result.v);\n    return capability.promise;\n  },\n  // 25.4.4.4 Promise.race(iterable)\n  race: function race(iterable) {\n    var C = this;\n    var capability = newPromiseCapability(C);\n    var reject = capability.reject;\n    var result = perform(function () {\n      forOf(iterable, false, function (promise) {\n        C.resolve(promise).then(capability.resolve, reject);\n      });\n    });\n    if (result.e) reject(result.v);\n    return capability.promise;\n  }\n});\n","// 26.1.1 Reflect.apply(target, thisArgument, argumentsList)\nvar $export = require('./_export');\nvar aFunction = require('./_a-function');\nvar anObject = require('./_an-object');\nvar rApply = (require('./_global').Reflect || {}).apply;\nvar fApply = Function.apply;\n// MS Edge argumentsList argument is optional\n$export($export.S + $export.F * !require('./_fails')(function () {\n  rApply(function () { /* empty */ });\n}), 'Reflect', {\n  apply: function apply(target, thisArgument, argumentsList) {\n    var T = aFunction(target);\n    var L = anObject(argumentsList);\n    return rApply ? rApply(T, thisArgument, L) : fApply.call(T, thisArgument, L);\n  }\n});\n","// 26.1.2 Reflect.construct(target, argumentsList [, newTarget])\nvar $export = require('./_export');\nvar create = require('./_object-create');\nvar aFunction = require('./_a-function');\nvar anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar fails = require('./_fails');\nvar bind = require('./_bind');\nvar rConstruct = (require('./_global').Reflect || {}).construct;\n\n// MS Edge supports only 2 arguments and argumentsList argument is optional\n// FF Nightly sets third argument as `new.target`, but does not create `this` from it\nvar NEW_TARGET_BUG = fails(function () {\n  function F() { /* empty */ }\n  return !(rConstruct(function () { /* empty */ }, [], F) instanceof F);\n});\nvar ARGS_BUG = !fails(function () {\n  rConstruct(function () { /* empty */ });\n});\n\n$export($export.S + $export.F * (NEW_TARGET_BUG || ARGS_BUG), 'Reflect', {\n  construct: function construct(Target, args /* , newTarget */) {\n    aFunction(Target);\n    anObject(args);\n    var newTarget = arguments.length < 3 ? Target : aFunction(arguments[2]);\n    if (ARGS_BUG && !NEW_TARGET_BUG) return rConstruct(Target, args, newTarget);\n    if (Target == newTarget) {\n      // w/o altered newTarget, optimization for 0-4 arguments\n      switch (args.length) {\n        case 0: return new Target();\n        case 1: return new Target(args[0]);\n        case 2: return new Target(args[0], args[1]);\n        case 3: return new Target(args[0], args[1], args[2]);\n        case 4: return new Target(args[0], args[1], args[2], args[3]);\n      }\n      // w/o altered newTarget, lot of arguments case\n      var $args = [null];\n      $args.push.apply($args, args);\n      return new (bind.apply(Target, $args))();\n    }\n    // with altered newTarget, not support built-in constructors\n    var proto = newTarget.prototype;\n    var instance = create(isObject(proto) ? proto : Object.prototype);\n    var result = Function.apply.call(Target, instance, args);\n    return isObject(result) ? result : instance;\n  }\n});\n","// 26.1.3 Reflect.defineProperty(target, propertyKey, attributes)\nvar dP = require('./_object-dp');\nvar $export = require('./_export');\nvar anObject = require('./_an-object');\nvar toPrimitive = require('./_to-primitive');\n\n// MS Edge has broken Reflect.defineProperty - throwing instead of returning false\n$export($export.S + $export.F * require('./_fails')(function () {\n  // eslint-disable-next-line no-undef\n  Reflect.defineProperty(dP.f({}, 1, { value: 1 }), 1, { value: 2 });\n}), 'Reflect', {\n  defineProperty: function defineProperty(target, propertyKey, attributes) {\n    anObject(target);\n    propertyKey = toPrimitive(propertyKey, true);\n    anObject(attributes);\n    try {\n      dP.f(target, propertyKey, attributes);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n});\n","// 26.1.4 Reflect.deleteProperty(target, propertyKey)\nvar $export = require('./_export');\nvar gOPD = require('./_object-gopd').f;\nvar anObject = require('./_an-object');\n\n$export($export.S, 'Reflect', {\n  deleteProperty: function deleteProperty(target, propertyKey) {\n    var desc = gOPD(anObject(target), propertyKey);\n    return desc && !desc.configurable ? false : delete target[propertyKey];\n  }\n});\n","'use strict';\n// 26.1.5 Reflect.enumerate(target)\nvar $export = require('./_export');\nvar anObject = require('./_an-object');\nvar Enumerate = function (iterated) {\n  this._t = anObject(iterated); // target\n  this._i = 0;                  // next index\n  var keys = this._k = [];      // keys\n  var key;\n  for (key in iterated) keys.push(key);\n};\nrequire('./_iter-create')(Enumerate, 'Object', function () {\n  var that = this;\n  var keys = that._k;\n  var key;\n  do {\n    if (that._i >= keys.length) return { value: undefined, done: true };\n  } while (!((key = keys[that._i++]) in that._t));\n  return { value: key, done: false };\n});\n\n$export($export.S, 'Reflect', {\n  enumerate: function enumerate(target) {\n    return new Enumerate(target);\n  }\n});\n","// 26.1.7 Reflect.getOwnPropertyDescriptor(target, propertyKey)\nvar gOPD = require('./_object-gopd');\nvar $export = require('./_export');\nvar anObject = require('./_an-object');\n\n$export($export.S, 'Reflect', {\n  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(target, propertyKey) {\n    return gOPD.f(anObject(target), propertyKey);\n  }\n});\n","// 26.1.8 Reflect.getPrototypeOf(target)\nvar $export = require('./_export');\nvar getProto = require('./_object-gpo');\nvar anObject = require('./_an-object');\n\n$export($export.S, 'Reflect', {\n  getPrototypeOf: function getPrototypeOf(target) {\n    return getProto(anObject(target));\n  }\n});\n","// 26.1.6 Reflect.get(target, propertyKey [, receiver])\nvar gOPD = require('./_object-gopd');\nvar getPrototypeOf = require('./_object-gpo');\nvar has = require('./_has');\nvar $export = require('./_export');\nvar isObject = require('./_is-object');\nvar anObject = require('./_an-object');\n\nfunction get(target, propertyKey /* , receiver */) {\n  var receiver = arguments.length < 3 ? target : arguments[2];\n  var desc, proto;\n  if (anObject(target) === receiver) return target[propertyKey];\n  if (desc = gOPD.f(target, propertyKey)) return has(desc, 'value')\n    ? desc.value\n    : desc.get !== undefined\n      ? desc.get.call(receiver)\n      : undefined;\n  if (isObject(proto = getPrototypeOf(target))) return get(proto, propertyKey, receiver);\n}\n\n$export($export.S, 'Reflect', { get: get });\n","// 26.1.9 Reflect.has(target, propertyKey)\nvar $export = require('./_export');\n\n$export($export.S, 'Reflect', {\n  has: function has(target, propertyKey) {\n    return propertyKey in target;\n  }\n});\n","// 26.1.10 Reflect.isExtensible(target)\nvar $export = require('./_export');\nvar anObject = require('./_an-object');\nvar $isExtensible = Object.isExtensible;\n\n$export($export.S, 'Reflect', {\n  isExtensible: function isExtensible(target) {\n    anObject(target);\n    return $isExtensible ? $isExtensible(target) : true;\n  }\n});\n","// 26.1.11 Reflect.ownKeys(target)\nvar $export = require('./_export');\n\n$export($export.S, 'Reflect', { ownKeys: require('./_own-keys') });\n","// 26.1.12 Reflect.preventExtensions(target)\nvar $export = require('./_export');\nvar anObject = require('./_an-object');\nvar $preventExtensions = Object.preventExtensions;\n\n$export($export.S, 'Reflect', {\n  preventExtensions: function preventExtensions(target) {\n    anObject(target);\n    try {\n      if ($preventExtensions) $preventExtensions(target);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n});\n","// 26.1.14 Reflect.setPrototypeOf(target, proto)\nvar $export = require('./_export');\nvar setProto = require('./_set-proto');\n\nif (setProto) $export($export.S, 'Reflect', {\n  setPrototypeOf: function setPrototypeOf(target, proto) {\n    setProto.check(target, proto);\n    try {\n      setProto.set(target, proto);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n});\n","// 26.1.13 Reflect.set(target, propertyKey, V [, receiver])\nvar dP = require('./_object-dp');\nvar gOPD = require('./_object-gopd');\nvar getPrototypeOf = require('./_object-gpo');\nvar has = require('./_has');\nvar $export = require('./_export');\nvar createDesc = require('./_property-desc');\nvar anObject = require('./_an-object');\nvar isObject = require('./_is-object');\n\nfunction set(target, propertyKey, V /* , receiver */) {\n  var receiver = arguments.length < 4 ? target : arguments[3];\n  var ownDesc = gOPD.f(anObject(target), propertyKey);\n  var existingDescriptor, proto;\n  if (!ownDesc) {\n    if (isObject(proto = getPrototypeOf(target))) {\n      return set(proto, propertyKey, V, receiver);\n    }\n    ownDesc = createDesc(0);\n  }\n  if (has(ownDesc, 'value')) {\n    if (ownDesc.writable === false || !isObject(receiver)) return false;\n    if (existingDescriptor = gOPD.f(receiver, propertyKey)) {\n      if (existingDescriptor.get || existingDescriptor.set || existingDescriptor.writable === false) return false;\n      existingDescriptor.value = V;\n      dP.f(receiver, propertyKey, existingDescriptor);\n    } else dP.f(receiver, propertyKey, createDesc(0, V));\n    return true;\n  }\n  return ownDesc.set === undefined ? false : (ownDesc.set.call(receiver, V), true);\n}\n\n$export($export.S, 'Reflect', { set: set });\n","var global = require('./_global');\nvar inheritIfRequired = require('./_inherit-if-required');\nvar dP = require('./_object-dp').f;\nvar gOPN = require('./_object-gopn').f;\nvar isRegExp = require('./_is-regexp');\nvar $flags = require('./_flags');\nvar $RegExp = global.RegExp;\nvar Base = $RegExp;\nvar proto = $RegExp.prototype;\nvar re1 = /a/g;\nvar re2 = /a/g;\n// \"new\" creates a new object, old webkit buggy here\nvar CORRECT_NEW = new $RegExp(re1) !== re1;\n\nif (require('./_descriptors') && (!CORRECT_NEW || require('./_fails')(function () {\n  re2[require('./_wks')('match')] = false;\n  // RegExp constructor can alter flags and IsRegExp works correct with @@match\n  return $RegExp(re1) != re1 || $RegExp(re2) == re2 || $RegExp(re1, 'i') != '/a/i';\n}))) {\n  $RegExp = function RegExp(p, f) {\n    var tiRE = this instanceof $RegExp;\n    var piRE = isRegExp(p);\n    var fiU = f === undefined;\n    return !tiRE && piRE && p.constructor === $RegExp && fiU ? p\n      : inheritIfRequired(CORRECT_NEW\n        ? new Base(piRE && !fiU ? p.source : p, f)\n        : Base((piRE = p instanceof $RegExp) ? p.source : p, piRE && fiU ? $flags.call(p) : f)\n      , tiRE ? this : proto, $RegExp);\n  };\n  var proxy = function (key) {\n    key in $RegExp || dP($RegExp, key, {\n      configurable: true,\n      get: function () { return Base[key]; },\n      set: function (it) { Base[key] = it; }\n    });\n  };\n  for (var keys = gOPN(Base), i = 0; keys.length > i;) proxy(keys[i++]);\n  proto.constructor = $RegExp;\n  $RegExp.prototype = proto;\n  require('./_redefine')(global, 'RegExp', $RegExp);\n}\n\nrequire('./_set-species')('RegExp');\n","'use strict';\nvar regexpExec = require('./_regexp-exec');\nrequire('./_export')({\n  target: 'RegExp',\n  proto: true,\n  forced: regexpExec !== /./.exec\n}, {\n  exec: regexpExec\n});\n","// 21.2.5.3 get RegExp.prototype.flags()\nif (require('./_descriptors') && /./g.flags != 'g') require('./_object-dp').f(RegExp.prototype, 'flags', {\n  configurable: true,\n  get: require('./_flags')\n});\n","'use strict';\n\nvar anObject = require('./_an-object');\nvar toLength = require('./_to-length');\nvar advanceStringIndex = require('./_advance-string-index');\nvar regExpExec = require('./_regexp-exec-abstract');\n\n// @@match logic\nrequire('./_fix-re-wks')('match', 1, function (defined, MATCH, $match, maybeCallNative) {\n  return [\n    // `String.prototype.match` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.match\n    function match(regexp) {\n      var O = defined(this);\n      var fn = regexp == undefined ? undefined : regexp[MATCH];\n      return fn !== undefined ? fn.call(regexp, O) : new RegExp(regexp)[MATCH](String(O));\n    },\n    // `RegExp.prototype[@@match]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@match\n    function (regexp) {\n      var res = maybeCallNative($match, regexp, this);\n      if (res.done) return res.value;\n      var rx = anObject(regexp);\n      var S = String(this);\n      if (!rx.global) return regExpExec(rx, S);\n      var fullUnicode = rx.unicode;\n      rx.lastIndex = 0;\n      var A = [];\n      var n = 0;\n      var result;\n      while ((result = regExpExec(rx, S)) !== null) {\n        var matchStr = String(result[0]);\n        A[n] = matchStr;\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n        n++;\n      }\n      return n === 0 ? null : A;\n    }\n  ];\n});\n","'use strict';\n\nvar anObject = require('./_an-object');\nvar toObject = require('./_to-object');\nvar toLength = require('./_to-length');\nvar toInteger = require('./_to-integer');\nvar advanceStringIndex = require('./_advance-string-index');\nvar regExpExec = require('./_regexp-exec-abstract');\nvar max = Math.max;\nvar min = Math.min;\nvar floor = Math.floor;\nvar SUBSTITUTION_SYMBOLS = /\\$([$&`']|\\d\\d?|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&`']|\\d\\d?)/g;\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// @@replace logic\nrequire('./_fix-re-wks')('replace', 2, function (defined, REPLACE, $replace, maybeCallNative) {\n  return [\n    // `String.prototype.replace` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.replace\n    function replace(searchValue, replaceValue) {\n      var O = defined(this);\n      var fn = searchValue == undefined ? undefined : searchValue[REPLACE];\n      return fn !== undefined\n        ? fn.call(searchValue, O, replaceValue)\n        : $replace.call(String(O), searchValue, replaceValue);\n    },\n    // `RegExp.prototype[@@replace]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@replace\n    function (regexp, replaceValue) {\n      var res = maybeCallNative($replace, regexp, this, replaceValue);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n      var functionalReplace = typeof replaceValue === 'function';\n      if (!functionalReplace) replaceValue = String(replaceValue);\n      var global = rx.global;\n      if (global) {\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n      }\n      var results = [];\n      while (true) {\n        var result = regExpExec(rx, S);\n        if (result === null) break;\n        results.push(result);\n        if (!global) break;\n        var matchStr = String(result[0]);\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n      }\n      var accumulatedResult = '';\n      var nextSourcePosition = 0;\n      for (var i = 0; i < results.length; i++) {\n        result = results[i];\n        var matched = String(result[0]);\n        var position = max(min(toInteger(result.index), S.length), 0);\n        var captures = [];\n        // NOTE: This is equivalent to\n        //   captures = result.slice(1).map(maybeToString)\n        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n        // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n        for (var j = 1; j < result.length; j++) captures.push(maybeToString(result[j]));\n        var namedCaptures = result.groups;\n        if (functionalReplace) {\n          var replacerArgs = [matched].concat(captures, position, S);\n          if (namedCaptures !== undefined) replacerArgs.push(namedCaptures);\n          var replacement = String(replaceValue.apply(undefined, replacerArgs));\n        } else {\n          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n        }\n        if (position >= nextSourcePosition) {\n          accumulatedResult += S.slice(nextSourcePosition, position) + replacement;\n          nextSourcePosition = position + matched.length;\n        }\n      }\n      return accumulatedResult + S.slice(nextSourcePosition);\n    }\n  ];\n\n    // https://tc39.github.io/ecma262/#sec-getsubstitution\n  function getSubstitution(matched, str, position, captures, namedCaptures, replacement) {\n    var tailPos = position + matched.length;\n    var m = captures.length;\n    var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n    if (namedCaptures !== undefined) {\n      namedCaptures = toObject(namedCaptures);\n      symbols = SUBSTITUTION_SYMBOLS;\n    }\n    return $replace.call(replacement, symbols, function (match, ch) {\n      var capture;\n      switch (ch.charAt(0)) {\n        case '$': return '$';\n        case '&': return matched;\n        case '`': return str.slice(0, position);\n        case \"'\": return str.slice(tailPos);\n        case '<':\n          capture = namedCaptures[ch.slice(1, -1)];\n          break;\n        default: // \\d\\d?\n          var n = +ch;\n          if (n === 0) return match;\n          if (n > m) {\n            var f = floor(n / 10);\n            if (f === 0) return match;\n            if (f <= m) return captures[f - 1] === undefined ? ch.charAt(1) : captures[f - 1] + ch.charAt(1);\n            return match;\n          }\n          capture = captures[n - 1];\n      }\n      return capture === undefined ? '' : capture;\n    });\n  }\n});\n","'use strict';\n\nvar anObject = require('./_an-object');\nvar sameValue = require('./_same-value');\nvar regExpExec = require('./_regexp-exec-abstract');\n\n// @@search logic\nrequire('./_fix-re-wks')('search', 1, function (defined, SEARCH, $search, maybeCallNative) {\n  return [\n    // `String.prototype.search` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.search\n    function search(regexp) {\n      var O = defined(this);\n      var fn = regexp == undefined ? undefined : regexp[SEARCH];\n      return fn !== undefined ? fn.call(regexp, O) : new RegExp(regexp)[SEARCH](String(O));\n    },\n    // `RegExp.prototype[@@search]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@search\n    function (regexp) {\n      var res = maybeCallNative($search, regexp, this);\n      if (res.done) return res.value;\n      var rx = anObject(regexp);\n      var S = String(this);\n      var previousLastIndex = rx.lastIndex;\n      if (!sameValue(previousLastIndex, 0)) rx.lastIndex = 0;\n      var result = regExpExec(rx, S);\n      if (!sameValue(rx.lastIndex, previousLastIndex)) rx.lastIndex = previousLastIndex;\n      return result === null ? -1 : result.index;\n    }\n  ];\n});\n","'use strict';\n\nvar isRegExp = require('./_is-regexp');\nvar anObject = require('./_an-object');\nvar speciesConstructor = require('./_species-constructor');\nvar advanceStringIndex = require('./_advance-string-index');\nvar toLength = require('./_to-length');\nvar callRegExpExec = require('./_regexp-exec-abstract');\nvar regexpExec = require('./_regexp-exec');\nvar fails = require('./_fails');\nvar $min = Math.min;\nvar $push = [].push;\nvar $SPLIT = 'split';\nvar LENGTH = 'length';\nvar LAST_INDEX = 'lastIndex';\nvar MAX_UINT32 = 0xffffffff;\n\n// babel-minify transpiles RegExp('x', 'y') -> /x/y and it causes SyntaxError\nvar SUPPORTS_Y = !fails(function () { RegExp(MAX_UINT32, 'y'); });\n\n// @@split logic\nrequire('./_fix-re-wks')('split', 2, function (defined, SPLIT, $split, maybeCallNative) {\n  var internalSplit;\n  if (\n    'abbc'[$SPLIT](/(b)*/)[1] == 'c' ||\n    'test'[$SPLIT](/(?:)/, -1)[LENGTH] != 4 ||\n    'ab'[$SPLIT](/(?:ab)*/)[LENGTH] != 2 ||\n    '.'[$SPLIT](/(.?)(.?)/)[LENGTH] != 4 ||\n    '.'[$SPLIT](/()()/)[LENGTH] > 1 ||\n    ''[$SPLIT](/.?/)[LENGTH]\n  ) {\n    // based on es5-shim implementation, need to rework it\n    internalSplit = function (separator, limit) {\n      var string = String(this);\n      if (separator === undefined && limit === 0) return [];\n      // If `separator` is not a regex, use native split\n      if (!isRegExp(separator)) return $split.call(string, separator, limit);\n      var output = [];\n      var flags = (separator.ignoreCase ? 'i' : '') +\n                  (separator.multiline ? 'm' : '') +\n                  (separator.unicode ? 'u' : '') +\n                  (separator.sticky ? 'y' : '');\n      var lastLastIndex = 0;\n      var splitLimit = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      // Make `global` and avoid `lastIndex` issues by working with a copy\n      var separatorCopy = new RegExp(separator.source, flags + 'g');\n      var match, lastIndex, lastLength;\n      while (match = regexpExec.call(separatorCopy, string)) {\n        lastIndex = separatorCopy[LAST_INDEX];\n        if (lastIndex > lastLastIndex) {\n          output.push(string.slice(lastLastIndex, match.index));\n          if (match[LENGTH] > 1 && match.index < string[LENGTH]) $push.apply(output, match.slice(1));\n          lastLength = match[0][LENGTH];\n          lastLastIndex = lastIndex;\n          if (output[LENGTH] >= splitLimit) break;\n        }\n        if (separatorCopy[LAST_INDEX] === match.index) separatorCopy[LAST_INDEX]++; // Avoid an infinite loop\n      }\n      if (lastLastIndex === string[LENGTH]) {\n        if (lastLength || !separatorCopy.test('')) output.push('');\n      } else output.push(string.slice(lastLastIndex));\n      return output[LENGTH] > splitLimit ? output.slice(0, splitLimit) : output;\n    };\n  // Chakra, V8\n  } else if ('0'[$SPLIT](undefined, 0)[LENGTH]) {\n    internalSplit = function (separator, limit) {\n      return separator === undefined && limit === 0 ? [] : $split.call(this, separator, limit);\n    };\n  } else {\n    internalSplit = $split;\n  }\n\n  return [\n    // `String.prototype.split` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.split\n    function split(separator, limit) {\n      var O = defined(this);\n      var splitter = separator == undefined ? undefined : separator[SPLIT];\n      return splitter !== undefined\n        ? splitter.call(separator, O, limit)\n        : internalSplit.call(String(O), separator, limit);\n    },\n    // `RegExp.prototype[@@split]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@split\n    //\n    // NOTE: This cannot be properly polyfilled in engines that don't support\n    // the 'y' flag.\n    function (regexp, limit) {\n      var res = maybeCallNative(internalSplit, regexp, this, limit, internalSplit !== $split);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n      var C = speciesConstructor(rx, RegExp);\n\n      var unicodeMatching = rx.unicode;\n      var flags = (rx.ignoreCase ? 'i' : '') +\n                  (rx.multiline ? 'm' : '') +\n                  (rx.unicode ? 'u' : '') +\n                  (SUPPORTS_Y ? 'y' : 'g');\n\n      // ^(? + rx + ) is needed, in combination with some S slicing, to\n      // simulate the 'y' flag.\n      var splitter = new C(SUPPORTS_Y ? rx : '^(?:' + rx.source + ')', flags);\n      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      if (lim === 0) return [];\n      if (S.length === 0) return callRegExpExec(splitter, S) === null ? [S] : [];\n      var p = 0;\n      var q = 0;\n      var A = [];\n      while (q < S.length) {\n        splitter.lastIndex = SUPPORTS_Y ? q : 0;\n        var z = callRegExpExec(splitter, SUPPORTS_Y ? S : S.slice(q));\n        var e;\n        if (\n          z === null ||\n          (e = $min(toLength(splitter.lastIndex + (SUPPORTS_Y ? 0 : q)), S.length)) === p\n        ) {\n          q = advanceStringIndex(S, q, unicodeMatching);\n        } else {\n          A.push(S.slice(p, q));\n          if (A.length === lim) return A;\n          for (var i = 1; i <= z.length - 1; i++) {\n            A.push(z[i]);\n            if (A.length === lim) return A;\n          }\n          q = p = e;\n        }\n      }\n      A.push(S.slice(p));\n      return A;\n    }\n  ];\n});\n","'use strict';\nrequire('./es6.regexp.flags');\nvar anObject = require('./_an-object');\nvar $flags = require('./_flags');\nvar DESCRIPTORS = require('./_descriptors');\nvar TO_STRING = 'toString';\nvar $toString = /./[TO_STRING];\n\nvar define = function (fn) {\n  require('./_redefine')(RegExp.prototype, TO_STRING, fn, true);\n};\n\n// 21.2.5.14 RegExp.prototype.toString()\nif (require('./_fails')(function () { return $toString.call({ source: 'a', flags: 'b' }) != '/a/b'; })) {\n  define(function toString() {\n    var R = anObject(this);\n    return '/'.concat(R.source, '/',\n      'flags' in R ? R.flags : !DESCRIPTORS && R instanceof RegExp ? $flags.call(R) : undefined);\n  });\n// FF44- RegExp#toString has a wrong name\n} else if ($toString.name != TO_STRING) {\n  define(function toString() {\n    return $toString.call(this);\n  });\n}\n","'use strict';\nvar strong = require('./_collection-strong');\nvar validate = require('./_validate-collection');\nvar SET = 'Set';\n\n// 23.2 Set Objects\nmodule.exports = require('./_collection')(SET, function (get) {\n  return function Set() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };\n}, {\n  // 23.2.3.1 Set.prototype.add(value)\n  add: function add(value) {\n    return strong.def(validate(this, SET), value = value === 0 ? 0 : value, value);\n  }\n}, strong);\n","'use strict';\n// B.2.3.2 String.prototype.anchor(name)\nrequire('./_string-html')('anchor', function (createHTML) {\n  return function anchor(name) {\n    return createHTML(this, 'a', 'name', name);\n  };\n});\n","'use strict';\n// B.2.3.3 String.prototype.big()\nrequire('./_string-html')('big', function (createHTML) {\n  return function big() {\n    return createHTML(this, 'big', '', '');\n  };\n});\n","'use strict';\n// B.2.3.4 String.prototype.blink()\nrequire('./_string-html')('blink', function (createHTML) {\n  return function blink() {\n    return createHTML(this, 'blink', '', '');\n  };\n});\n","'use strict';\n// B.2.3.5 String.prototype.bold()\nrequire('./_string-html')('bold', function (createHTML) {\n  return function bold() {\n    return createHTML(this, 'b', '', '');\n  };\n});\n","'use strict';\nvar $export = require('./_export');\nvar $at = require('./_string-at')(false);\n$export($export.P, 'String', {\n  // 21.1.3.3 String.prototype.codePointAt(pos)\n  codePointAt: function codePointAt(pos) {\n    return $at(this, pos);\n  }\n});\n","// 21.1.3.6 String.prototype.endsWith(searchString [, endPosition])\n'use strict';\nvar $export = require('./_export');\nvar toLength = require('./_to-length');\nvar context = require('./_string-context');\nvar ENDS_WITH = 'endsWith';\nvar $endsWith = ''[ENDS_WITH];\n\n$export($export.P + $export.F * require('./_fails-is-regexp')(ENDS_WITH), 'String', {\n  endsWith: function endsWith(searchString /* , endPosition = @length */) {\n    var that = context(this, searchString, ENDS_WITH);\n    var endPosition = arguments.length > 1 ? arguments[1] : undefined;\n    var len = toLength(that.length);\n    var end = endPosition === undefined ? len : Math.min(toLength(endPosition), len);\n    var search = String(searchString);\n    return $endsWith\n      ? $endsWith.call(that, search, end)\n      : that.slice(end - search.length, end) === search;\n  }\n});\n","'use strict';\n// B.2.3.6 String.prototype.fixed()\nrequire('./_string-html')('fixed', function (createHTML) {\n  return function fixed() {\n    return createHTML(this, 'tt', '', '');\n  };\n});\n","'use strict';\n// B.2.3.7 String.prototype.fontcolor(color)\nrequire('./_string-html')('fontcolor', function (createHTML) {\n  return function fontcolor(color) {\n    return createHTML(this, 'font', 'color', color);\n  };\n});\n","'use strict';\n// B.2.3.8 String.prototype.fontsize(size)\nrequire('./_string-html')('fontsize', function (createHTML) {\n  return function fontsize(size) {\n    return createHTML(this, 'font', 'size', size);\n  };\n});\n","var $export = require('./_export');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nvar fromCharCode = String.fromCharCode;\nvar $fromCodePoint = String.fromCodePoint;\n\n// length should be 1, old FF problem\n$export($export.S + $export.F * (!!$fromCodePoint && $fromCodePoint.length != 1), 'String', {\n  // 21.1.2.2 String.fromCodePoint(...codePoints)\n  fromCodePoint: function fromCodePoint(x) { // eslint-disable-line no-unused-vars\n    var res = [];\n    var aLen = arguments.length;\n    var i = 0;\n    var code;\n    while (aLen > i) {\n      code = +arguments[i++];\n      if (toAbsoluteIndex(code, 0x10ffff) !== code) throw RangeError(code + ' is not a valid code point');\n      res.push(code < 0x10000\n        ? fromCharCode(code)\n        : fromCharCode(((code -= 0x10000) >> 10) + 0xd800, code % 0x400 + 0xdc00)\n      );\n    } return res.join('');\n  }\n});\n","// 21.1.3.7 String.prototype.includes(searchString, position = 0)\n'use strict';\nvar $export = require('./_export');\nvar context = require('./_string-context');\nvar INCLUDES = 'includes';\n\n$export($export.P + $export.F * require('./_fails-is-regexp')(INCLUDES), 'String', {\n  includes: function includes(searchString /* , position = 0 */) {\n    return !!~context(this, searchString, INCLUDES)\n      .indexOf(searchString, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\n// B.2.3.9 String.prototype.italics()\nrequire('./_string-html')('italics', function (createHTML) {\n  return function italics() {\n    return createHTML(this, 'i', '', '');\n  };\n});\n","'use strict';\nvar $at = require('./_string-at')(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\nrequire('./_iter-define')(String, 'String', function (iterated) {\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var index = this._i;\n  var point;\n  if (index >= O.length) return { value: undefined, done: true };\n  point = $at(O, index);\n  this._i += point.length;\n  return { value: point, done: false };\n});\n","'use strict';\n// B.2.3.10 String.prototype.link(url)\nrequire('./_string-html')('link', function (createHTML) {\n  return function link(url) {\n    return createHTML(this, 'a', 'href', url);\n  };\n});\n","var $export = require('./_export');\nvar toIObject = require('./_to-iobject');\nvar toLength = require('./_to-length');\n\n$export($export.S, 'String', {\n  // 21.1.2.4 String.raw(callSite, ...substitutions)\n  raw: function raw(callSite) {\n    var tpl = toIObject(callSite.raw);\n    var len = toLength(tpl.length);\n    var aLen = arguments.length;\n    var res = [];\n    var i = 0;\n    while (len > i) {\n      res.push(String(tpl[i++]));\n      if (i < aLen) res.push(String(arguments[i]));\n    } return res.join('');\n  }\n});\n","var $export = require('./_export');\n\n$export($export.P, 'String', {\n  // 21.1.3.13 String.prototype.repeat(count)\n  repeat: require('./_string-repeat')\n});\n","'use strict';\n// B.2.3.11 String.prototype.small()\nrequire('./_string-html')('small', function (createHTML) {\n  return function small() {\n    return createHTML(this, 'small', '', '');\n  };\n});\n","// 21.1.3.18 String.prototype.startsWith(searchString [, position ])\n'use strict';\nvar $export = require('./_export');\nvar toLength = require('./_to-length');\nvar context = require('./_string-context');\nvar STARTS_WITH = 'startsWith';\nvar $startsWith = ''[STARTS_WITH];\n\n$export($export.P + $export.F * require('./_fails-is-regexp')(STARTS_WITH), 'String', {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = context(this, searchString, STARTS_WITH);\n    var index = toLength(Math.min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = String(searchString);\n    return $startsWith\n      ? $startsWith.call(that, search, index)\n      : that.slice(index, index + search.length) === search;\n  }\n});\n","'use strict';\n// B.2.3.12 String.prototype.strike()\nrequire('./_string-html')('strike', function (createHTML) {\n  return function strike() {\n    return createHTML(this, 'strike', '', '');\n  };\n});\n","'use strict';\n// B.2.3.13 String.prototype.sub()\nrequire('./_string-html')('sub', function (createHTML) {\n  return function sub() {\n    return createHTML(this, 'sub', '', '');\n  };\n});\n","'use strict';\n// B.2.3.14 String.prototype.sup()\nrequire('./_string-html')('sup', function (createHTML) {\n  return function sup() {\n    return createHTML(this, 'sup', '', '');\n  };\n});\n","'use strict';\n// 21.1.3.25 String.prototype.trim()\nrequire('./_string-trim')('trim', function ($trim) {\n  return function trim() {\n    return $trim(this, 3);\n  };\n});\n","'use strict';\n// ECMAScript 6 symbols shim\nvar global = require('./_global');\nvar has = require('./_has');\nvar DESCRIPTORS = require('./_descriptors');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar META = require('./_meta').KEY;\nvar $fails = require('./_fails');\nvar shared = require('./_shared');\nvar setToStringTag = require('./_set-to-string-tag');\nvar uid = require('./_uid');\nvar wks = require('./_wks');\nvar wksExt = require('./_wks-ext');\nvar wksDefine = require('./_wks-define');\nvar enumKeys = require('./_enum-keys');\nvar isArray = require('./_is-array');\nvar anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar toObject = require('./_to-object');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar createDesc = require('./_property-desc');\nvar _create = require('./_object-create');\nvar gOPNExt = require('./_object-gopn-ext');\nvar $GOPD = require('./_object-gopd');\nvar $GOPS = require('./_object-gops');\nvar $DP = require('./_object-dp');\nvar $keys = require('./_object-keys');\nvar gOPD = $GOPD.f;\nvar dP = $DP.f;\nvar gOPN = gOPNExt.f;\nvar $Symbol = global.Symbol;\nvar $JSON = global.JSON;\nvar _stringify = $JSON && $JSON.stringify;\nvar PROTOTYPE = 'prototype';\nvar HIDDEN = wks('_hidden');\nvar TO_PRIMITIVE = wks('toPrimitive');\nvar isEnum = {}.propertyIsEnumerable;\nvar SymbolRegistry = shared('symbol-registry');\nvar AllSymbols = shared('symbols');\nvar OPSymbols = shared('op-symbols');\nvar ObjectProto = Object[PROTOTYPE];\nvar USE_NATIVE = typeof $Symbol == 'function' && !!$GOPS.f;\nvar QObject = global.QObject;\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDesc = DESCRIPTORS && $fails(function () {\n  return _create(dP({}, 'a', {\n    get: function () { return dP(this, 'a', { value: 7 }).a; }\n  })).a != 7;\n}) ? function (it, key, D) {\n  var protoDesc = gOPD(ObjectProto, key);\n  if (protoDesc) delete ObjectProto[key];\n  dP(it, key, D);\n  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);\n} : dP;\n\nvar wrap = function (tag) {\n  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);\n  sym._k = tag;\n  return sym;\n};\n\nvar isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  return it instanceof $Symbol;\n};\n\nvar $defineProperty = function defineProperty(it, key, D) {\n  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);\n  anObject(it);\n  key = toPrimitive(key, true);\n  anObject(D);\n  if (has(AllSymbols, key)) {\n    if (!D.enumerable) {\n      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));\n      it[HIDDEN][key] = true;\n    } else {\n      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;\n      D = _create(D, { enumerable: createDesc(0, false) });\n    } return setSymbolDesc(it, key, D);\n  } return dP(it, key, D);\n};\nvar $defineProperties = function defineProperties(it, P) {\n  anObject(it);\n  var keys = enumKeys(P = toIObject(P));\n  var i = 0;\n  var l = keys.length;\n  var key;\n  while (l > i) $defineProperty(it, key = keys[i++], P[key]);\n  return it;\n};\nvar $create = function create(it, P) {\n  return P === undefined ? _create(it) : $defineProperties(_create(it), P);\n};\nvar $propertyIsEnumerable = function propertyIsEnumerable(key) {\n  var E = isEnum.call(this, key = toPrimitive(key, true));\n  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;\n  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;\n};\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {\n  it = toIObject(it);\n  key = toPrimitive(key, true);\n  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;\n  var D = gOPD(it, key);\n  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;\n  return D;\n};\nvar $getOwnPropertyNames = function getOwnPropertyNames(it) {\n  var names = gOPN(toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);\n  } return result;\n};\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(it) {\n  var IS_OP = it === ObjectProto;\n  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);\n  } return result;\n};\n\n// 19.4.1.1 Symbol([description])\nif (!USE_NATIVE) {\n  $Symbol = function Symbol() {\n    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');\n    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);\n    var $set = function (value) {\n      if (this === ObjectProto) $set.call(OPSymbols, value);\n      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;\n      setSymbolDesc(this, tag, createDesc(1, value));\n    };\n    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });\n    return wrap(tag);\n  };\n  redefine($Symbol[PROTOTYPE], 'toString', function toString() {\n    return this._k;\n  });\n\n  $GOPD.f = $getOwnPropertyDescriptor;\n  $DP.f = $defineProperty;\n  require('./_object-gopn').f = gOPNExt.f = $getOwnPropertyNames;\n  require('./_object-pie').f = $propertyIsEnumerable;\n  $GOPS.f = $getOwnPropertySymbols;\n\n  if (DESCRIPTORS && !require('./_library')) {\n    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);\n  }\n\n  wksExt.f = function (name) {\n    return wrap(wks(name));\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });\n\nfor (var es6Symbols = (\n  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14\n  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'\n).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);\n\nfor (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);\n\n$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {\n  // 19.4.2.1 Symbol.for(key)\n  'for': function (key) {\n    return has(SymbolRegistry, key += '')\n      ? SymbolRegistry[key]\n      : SymbolRegistry[key] = $Symbol(key);\n  },\n  // 19.4.2.5 Symbol.keyFor(sym)\n  keyFor: function keyFor(sym) {\n    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol!');\n    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;\n  },\n  useSetter: function () { setter = true; },\n  useSimple: function () { setter = false; }\n});\n\n$export($export.S + $export.F * !USE_NATIVE, 'Object', {\n  // 19.1.2.2 Object.create(O [, Properties])\n  create: $create,\n  // 19.1.2.4 Object.defineProperty(O, P, Attributes)\n  defineProperty: $defineProperty,\n  // 19.1.2.3 Object.defineProperties(O, Properties)\n  defineProperties: $defineProperties,\n  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,\n  // 19.1.2.7 Object.getOwnPropertyNames(O)\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // 19.1.2.8 Object.getOwnPropertySymbols(O)\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// Chrome 38 and 39 `Object.getOwnPropertySymbols` fails on primitives\n// https://bugs.chromium.org/p/v8/issues/detail?id=3443\nvar FAILS_ON_PRIMITIVES = $fails(function () { $GOPS.f(1); });\n\n$export($export.S + $export.F * FAILS_ON_PRIMITIVES, 'Object', {\n  getOwnPropertySymbols: function getOwnPropertySymbols(it) {\n    return $GOPS.f(toObject(it));\n  }\n});\n\n// 24.3.2 JSON.stringify(value [, replacer [, space]])\n$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {\n  var S = $Symbol();\n  // MS Edge converts symbol values to JSON as {}\n  // WebKit converts symbol values to JSON as null\n  // V8 throws on boxed symbols\n  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';\n})), 'JSON', {\n  stringify: function stringify(it) {\n    var args = [it];\n    var i = 1;\n    var replacer, $replacer;\n    while (arguments.length > i) args.push(arguments[i++]);\n    $replacer = replacer = args[1];\n    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined\n    if (!isArray(replacer)) replacer = function (key, value) {\n      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);\n      if (!isSymbol(value)) return value;\n    };\n    args[1] = replacer;\n    return _stringify.apply($JSON, args);\n  }\n});\n\n// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)\n$Symbol[PROTOTYPE][TO_PRIMITIVE] || require('./_hide')($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);\n// 19.4.3.5 Symbol.prototype[@@toStringTag]\nsetToStringTag($Symbol, 'Symbol');\n// 20.2.1.9 Math[@@toStringTag]\nsetToStringTag(Math, 'Math', true);\n// 24.3.3 JSON[@@toStringTag]\nsetToStringTag(global.JSON, 'JSON', true);\n","'use strict';\nvar $export = require('./_export');\nvar $typed = require('./_typed');\nvar buffer = require('./_typed-buffer');\nvar anObject = require('./_an-object');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nvar toLength = require('./_to-length');\nvar isObject = require('./_is-object');\nvar ArrayBuffer = require('./_global').ArrayBuffer;\nvar speciesConstructor = require('./_species-constructor');\nvar $ArrayBuffer = buffer.ArrayBuffer;\nvar $DataView = buffer.DataView;\nvar $isView = $typed.ABV && ArrayBuffer.isView;\nvar $slice = $ArrayBuffer.prototype.slice;\nvar VIEW = $typed.VIEW;\nvar ARRAY_BUFFER = 'ArrayBuffer';\n\n$export($export.G + $export.W + $export.F * (ArrayBuffer !== $ArrayBuffer), { ArrayBuffer: $ArrayBuffer });\n\n$export($export.S + $export.F * !$typed.CONSTR, ARRAY_BUFFER, {\n  // 24.1.3.1 ArrayBuffer.isView(arg)\n  isView: function isView(it) {\n    return $isView && $isView(it) || isObject(it) && VIEW in it;\n  }\n});\n\n$export($export.P + $export.U + $export.F * require('./_fails')(function () {\n  return !new $ArrayBuffer(2).slice(1, undefined).byteLength;\n}), ARRAY_BUFFER, {\n  // 24.1.4.3 ArrayBuffer.prototype.slice(start, end)\n  slice: function slice(start, end) {\n    if ($slice !== undefined && end === undefined) return $slice.call(anObject(this), start); // FF fix\n    var len = anObject(this).byteLength;\n    var first = toAbsoluteIndex(start, len);\n    var fin = toAbsoluteIndex(end === undefined ? len : end, len);\n    var result = new (speciesConstructor(this, $ArrayBuffer))(toLength(fin - first));\n    var viewS = new $DataView(this);\n    var viewT = new $DataView(result);\n    var index = 0;\n    while (first < fin) {\n      viewT.setUint8(index++, viewS.getUint8(first++));\n    } return result;\n  }\n});\n\nrequire('./_set-species')(ARRAY_BUFFER);\n","var $export = require('./_export');\n$export($export.G + $export.W + $export.F * !require('./_typed').ABV, {\n  DataView: require('./_typed-buffer').DataView\n});\n","require('./_typed-array')('Float32', 4, function (init) {\n  return function Float32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Float64', 8, function (init) {\n  return function Float64Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Int16', 2, function (init) {\n  return function Int16Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Int32', 4, function (init) {\n  return function Int32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Int8', 1, function (init) {\n  return function Int8Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Uint16', 2, function (init) {\n  return function Uint16Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Uint32', 4, function (init) {\n  return function Uint32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Uint8', 1, function (init) {\n  return function Uint8Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","require('./_typed-array')('Uint8', 1, function (init) {\n  return function Uint8ClampedArray(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n}, true);\n","'use strict';\nvar global = require('./_global');\nvar each = require('./_array-methods')(0);\nvar redefine = require('./_redefine');\nvar meta = require('./_meta');\nvar assign = require('./_object-assign');\nvar weak = require('./_collection-weak');\nvar isObject = require('./_is-object');\nvar validate = require('./_validate-collection');\nvar NATIVE_WEAK_MAP = require('./_validate-collection');\nvar IS_IE11 = !global.ActiveXObject && 'ActiveXObject' in global;\nvar WEAK_MAP = 'WeakMap';\nvar getWeak = meta.getWeak;\nvar isExtensible = Object.isExtensible;\nvar uncaughtFrozenStore = weak.ufstore;\nvar InternalMap;\n\nvar wrapper = function (get) {\n  return function WeakMap() {\n    return get(this, arguments.length > 0 ? arguments[0] : undefined);\n  };\n};\n\nvar methods = {\n  // 23.3.3.3 WeakMap.prototype.get(key)\n  get: function get(key) {\n    if (isObject(key)) {\n      var data = getWeak(key);\n      if (data === true) return uncaughtFrozenStore(validate(this, WEAK_MAP)).get(key);\n      return data ? data[this._i] : undefined;\n    }\n  },\n  // 23.3.3.5 WeakMap.prototype.set(key, value)\n  set: function set(key, value) {\n    return weak.def(validate(this, WEAK_MAP), key, value);\n  }\n};\n\n// 23.3 WeakMap Objects\nvar $WeakMap = module.exports = require('./_collection')(WEAK_MAP, wrapper, methods, weak, true, true);\n\n// IE11 WeakMap frozen keys fix\nif (NATIVE_WEAK_MAP && IS_IE11) {\n  InternalMap = weak.getConstructor(wrapper, WEAK_MAP);\n  assign(InternalMap.prototype, methods);\n  meta.NEED = true;\n  each(['delete', 'has', 'get', 'set'], function (key) {\n    var proto = $WeakMap.prototype;\n    var method = proto[key];\n    redefine(proto, key, function (a, b) {\n      // store frozen objects on internal weakmap shim\n      if (isObject(a) && !isExtensible(a)) {\n        if (!this._f) this._f = new InternalMap();\n        var result = this._f[key](a, b);\n        return key == 'set' ? this : result;\n      // store all the rest on native weakmap\n      } return method.call(this, a, b);\n    });\n  });\n}\n","'use strict';\nvar weak = require('./_collection-weak');\nvar validate = require('./_validate-collection');\nvar WEAK_SET = 'WeakSet';\n\n// 23.4 WeakSet Objects\nrequire('./_collection')(WEAK_SET, function (get) {\n  return function WeakSet() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };\n}, {\n  // 23.4.3.1 WeakSet.prototype.add(value)\n  add: function add(value) {\n    return weak.def(validate(this, WEAK_SET), value, true);\n  }\n}, weak, false, true);\n","'use strict';\n// https://tc39.github.io/proposal-flatMap/#sec-Array.prototype.flatMap\nvar $export = require('./_export');\nvar flattenIntoArray = require('./_flatten-into-array');\nvar toObject = require('./_to-object');\nvar toLength = require('./_to-length');\nvar aFunction = require('./_a-function');\nvar arraySpeciesCreate = require('./_array-species-create');\n\n$export($export.P, 'Array', {\n  flatMap: function flatMap(callbackfn /* , thisArg */) {\n    var O = toObject(this);\n    var sourceLen, A;\n    aFunction(callbackfn);\n    sourceLen = toLength(O.length);\n    A = arraySpeciesCreate(O, 0);\n    flattenIntoArray(A, O, O, sourceLen, 0, 1, callbackfn, arguments[1]);\n    return A;\n  }\n});\n\nrequire('./_add-to-unscopables')('flatMap');\n","'use strict';\n// https://tc39.github.io/proposal-flatMap/#sec-Array.prototype.flatten\nvar $export = require('./_export');\nvar flattenIntoArray = require('./_flatten-into-array');\nvar toObject = require('./_to-object');\nvar toLength = require('./_to-length');\nvar toInteger = require('./_to-integer');\nvar arraySpeciesCreate = require('./_array-species-create');\n\n$export($export.P, 'Array', {\n  flatten: function flatten(/* depthArg = 1 */) {\n    var depthArg = arguments[0];\n    var O = toObject(this);\n    var sourceLen = toLength(O.length);\n    var A = arraySpeciesCreate(O, 0);\n    flattenIntoArray(A, O, O, sourceLen, 0, depthArg === undefined ? 1 : toInteger(depthArg));\n    return A;\n  }\n});\n\nrequire('./_add-to-unscopables')('flatten');\n","'use strict';\n// https://github.com/tc39/Array.prototype.includes\nvar $export = require('./_export');\nvar $includes = require('./_array-includes')(true);\n\n$export($export.P, 'Array', {\n  includes: function includes(el /* , fromIndex = 0 */) {\n    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\nrequire('./_add-to-unscopables')('includes');\n","// https://github.com/rwaldron/tc39-notes/blob/master/es6/2014-09/sept-25.md#510-globalasap-for-enqueuing-a-microtask\nvar $export = require('./_export');\nvar microtask = require('./_microtask')();\nvar process = require('./_global').process;\nvar isNode = require('./_cof')(process) == 'process';\n\n$export($export.G, {\n  asap: function asap(fn) {\n    var domain = isNode && process.domain;\n    microtask(domain ? domain.bind(fn) : fn);\n  }\n});\n","// https://github.com/ljharb/proposal-is-error\nvar $export = require('./_export');\nvar cof = require('./_cof');\n\n$export($export.S, 'Error', {\n  isError: function isError(it) {\n    return cof(it) === 'Error';\n  }\n});\n","// https://github.com/tc39/proposal-global\nvar $export = require('./_export');\n\n$export($export.G, { global: require('./_global') });\n","// https://tc39.github.io/proposal-setmap-offrom/#sec-map.from\nrequire('./_set-collection-from')('Map');\n","// https://tc39.github.io/proposal-setmap-offrom/#sec-map.of\nrequire('./_set-collection-of')('Map');\n","// https://github.com/DavidBruant/Map-Set.prototype.toJSON\nvar $export = require('./_export');\n\n$export($export.P + $export.R, 'Map', { toJSON: require('./_collection-to-json')('Map') });\n","// https://rwaldron.github.io/proposal-math-extensions/\nvar $export = require('./_export');\n\n$export($export.S, 'Math', {\n  clamp: function clamp(x, lower, upper) {\n    return Math.min(upper, Math.max(lower, x));\n  }\n});\n","// https://rwaldron.github.io/proposal-math-extensions/\nvar $export = require('./_export');\n\n$export($export.S, 'Math', { DEG_PER_RAD: Math.PI / 180 });\n","// https://rwaldron.github.io/proposal-math-extensions/\nvar $export = require('./_export');\nvar RAD_PER_DEG = 180 / Math.PI;\n\n$export($export.S, 'Math', {\n  degrees: function degrees(radians) {\n    return radians * RAD_PER_DEG;\n  }\n});\n","// https://rwaldron.github.io/proposal-math-extensions/\nvar $export = require('./_export');\nvar scale = require('./_math-scale');\nvar fround = require('./_math-fround');\n\n$export($export.S, 'Math', {\n  fscale: function fscale(x, inLow, inHigh, outLow, outHigh) {\n    return fround(scale(x, inLow, inHigh, outLow, outHigh));\n  }\n});\n","// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\nvar $export = require('./_export');\n\n$export($export.S, 'Math', {\n  iaddh: function iaddh(x0, x1, y0, y1) {\n    var $x0 = x0 >>> 0;\n    var $x1 = x1 >>> 0;\n    var $y0 = y0 >>> 0;\n    return $x1 + (y1 >>> 0) + (($x0 & $y0 | ($x0 | $y0) & ~($x0 + $y0 >>> 0)) >>> 31) | 0;\n  }\n});\n","// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\nvar $export = require('./_export');\n\n$export($export.S, 'Math', {\n  imulh: function imulh(u, v) {\n    var UINT16 = 0xffff;\n    var $u = +u;\n    var $v = +v;\n    var u0 = $u & UINT16;\n    var v0 = $v & UINT16;\n    var u1 = $u >> 16;\n    var v1 = $v >> 16;\n    var t = (u1 * v0 >>> 0) + (u0 * v0 >>> 16);\n    return u1 * v1 + (t >> 16) + ((u0 * v1 >>> 0) + (t & UINT16) >> 16);\n  }\n});\n","// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\nvar $export = require('./_export');\n\n$export($export.S, 'Math', {\n  isubh: function isubh(x0, x1, y0, y1) {\n    var $x0 = x0 >>> 0;\n    var $x1 = x1 >>> 0;\n    var $y0 = y0 >>> 0;\n    return $x1 - (y1 >>> 0) - ((~$x0 & $y0 | ~($x0 ^ $y0) & $x0 - $y0 >>> 0) >>> 31) | 0;\n  }\n});\n","// https://rwaldron.github.io/proposal-math-extensions/\nvar $export = require('./_export');\n\n$export($export.S, 'Math', { RAD_PER_DEG: 180 / Math.PI });\n","// https://rwaldron.github.io/proposal-math-extensions/\nvar $export = require('./_export');\nvar DEG_PER_RAD = Math.PI / 180;\n\n$export($export.S, 'Math', {\n  radians: function radians(degrees) {\n    return degrees * DEG_PER_RAD;\n  }\n});\n","// https://rwaldron.github.io/proposal-math-extensions/\nvar $export = require('./_export');\n\n$export($export.S, 'Math', { scale: require('./_math-scale') });\n","// http://jfbastien.github.io/papers/Math.signbit.html\nvar $export = require('./_export');\n\n$export($export.S, 'Math', { signbit: function signbit(x) {\n  // eslint-disable-next-line no-self-compare\n  return (x = +x) != x ? x : x == 0 ? 1 / x == Infinity : x > 0;\n} });\n","// https://gist.github.com/BrendanEich/4294d5c212a6d2254703\nvar $export = require('./_export');\n\n$export($export.S, 'Math', {\n  umulh: function umulh(u, v) {\n    var UINT16 = 0xffff;\n    var $u = +u;\n    var $v = +v;\n    var u0 = $u & UINT16;\n    var v0 = $v & UINT16;\n    var u1 = $u >>> 16;\n    var v1 = $v >>> 16;\n    var t = (u1 * v0 >>> 0) + (u0 * v0 >>> 16);\n    return u1 * v1 + (t >>> 16) + ((u0 * v1 >>> 0) + (t & UINT16) >>> 16);\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar aFunction = require('./_a-function');\nvar $defineProperty = require('./_object-dp');\n\n// B.2.2.2 Object.prototype.__defineGetter__(P, getter)\nrequire('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {\n  __defineGetter__: function __defineGetter__(P, getter) {\n    $defineProperty.f(toObject(this), P, { get: aFunction(getter), enumerable: true, configurable: true });\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar aFunction = require('./_a-function');\nvar $defineProperty = require('./_object-dp');\n\n// B.2.2.3 Object.prototype.__defineSetter__(P, setter)\nrequire('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {\n  __defineSetter__: function __defineSetter__(P, setter) {\n    $defineProperty.f(toObject(this), P, { set: aFunction(setter), enumerable: true, configurable: true });\n  }\n});\n","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $entries = require('./_object-to-array')(true);\n\n$export($export.S, 'Object', {\n  entries: function entries(it) {\n    return $entries(it);\n  }\n});\n","// https://github.com/tc39/proposal-object-getownpropertydescriptors\nvar $export = require('./_export');\nvar ownKeys = require('./_own-keys');\nvar toIObject = require('./_to-iobject');\nvar gOPD = require('./_object-gopd');\nvar createProperty = require('./_create-property');\n\n$export($export.S, 'Object', {\n  getOwnPropertyDescriptors: function getOwnPropertyDescriptors(object) {\n    var O = toIObject(object);\n    var getDesc = gOPD.f;\n    var keys = ownKeys(O);\n    var result = {};\n    var i = 0;\n    var key, desc;\n    while (keys.length > i) {\n      desc = getDesc(O, key = keys[i++]);\n      if (desc !== undefined) createProperty(result, key, desc);\n    }\n    return result;\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar toPrimitive = require('./_to-primitive');\nvar getPrototypeOf = require('./_object-gpo');\nvar getOwnPropertyDescriptor = require('./_object-gopd').f;\n\n// B.2.2.4 Object.prototype.__lookupGetter__(P)\nrequire('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {\n  __lookupGetter__: function __lookupGetter__(P) {\n    var O = toObject(this);\n    var K = toPrimitive(P, true);\n    var D;\n    do {\n      if (D = getOwnPropertyDescriptor(O, K)) return D.get;\n    } while (O = getPrototypeOf(O));\n  }\n});\n","'use strict';\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar toPrimitive = require('./_to-primitive');\nvar getPrototypeOf = require('./_object-gpo');\nvar getOwnPropertyDescriptor = require('./_object-gopd').f;\n\n// B.2.2.5 Object.prototype.__lookupSetter__(P)\nrequire('./_descriptors') && $export($export.P + require('./_object-forced-pam'), 'Object', {\n  __lookupSetter__: function __lookupSetter__(P) {\n    var O = toObject(this);\n    var K = toPrimitive(P, true);\n    var D;\n    do {\n      if (D = getOwnPropertyDescriptor(O, K)) return D.set;\n    } while (O = getPrototypeOf(O));\n  }\n});\n","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $values = require('./_object-to-array')(false);\n\n$export($export.S, 'Object', {\n  values: function values(it) {\n    return $values(it);\n  }\n});\n","'use strict';\n// https://github.com/zenparsing/es-observable\nvar $export = require('./_export');\nvar global = require('./_global');\nvar core = require('./_core');\nvar microtask = require('./_microtask')();\nvar OBSERVABLE = require('./_wks')('observable');\nvar aFunction = require('./_a-function');\nvar anObject = require('./_an-object');\nvar anInstance = require('./_an-instance');\nvar redefineAll = require('./_redefine-all');\nvar hide = require('./_hide');\nvar forOf = require('./_for-of');\nvar RETURN = forOf.RETURN;\n\nvar getMethod = function (fn) {\n  return fn == null ? undefined : aFunction(fn);\n};\n\nvar cleanupSubscription = function (subscription) {\n  var cleanup = subscription._c;\n  if (cleanup) {\n    subscription._c = undefined;\n    cleanup();\n  }\n};\n\nvar subscriptionClosed = function (subscription) {\n  return subscription._o === undefined;\n};\n\nvar closeSubscription = function (subscription) {\n  if (!subscriptionClosed(subscription)) {\n    subscription._o = undefined;\n    cleanupSubscription(subscription);\n  }\n};\n\nvar Subscription = function (observer, subscriber) {\n  anObject(observer);\n  this._c = undefined;\n  this._o = observer;\n  observer = new SubscriptionObserver(this);\n  try {\n    var cleanup = subscriber(observer);\n    var subscription = cleanup;\n    if (cleanup != null) {\n      if (typeof cleanup.unsubscribe === 'function') cleanup = function () { subscription.unsubscribe(); };\n      else aFunction(cleanup);\n      this._c = cleanup;\n    }\n  } catch (e) {\n    observer.error(e);\n    return;\n  } if (subscriptionClosed(this)) cleanupSubscription(this);\n};\n\nSubscription.prototype = redefineAll({}, {\n  unsubscribe: function unsubscribe() { closeSubscription(this); }\n});\n\nvar SubscriptionObserver = function (subscription) {\n  this._s = subscription;\n};\n\nSubscriptionObserver.prototype = redefineAll({}, {\n  next: function next(value) {\n    var subscription = this._s;\n    if (!subscriptionClosed(subscription)) {\n      var observer = subscription._o;\n      try {\n        var m = getMethod(observer.next);\n        if (m) return m.call(observer, value);\n      } catch (e) {\n        try {\n          closeSubscription(subscription);\n        } finally {\n          throw e;\n        }\n      }\n    }\n  },\n  error: function error(value) {\n    var subscription = this._s;\n    if (subscriptionClosed(subscription)) throw value;\n    var observer = subscription._o;\n    subscription._o = undefined;\n    try {\n      var m = getMethod(observer.error);\n      if (!m) throw value;\n      value = m.call(observer, value);\n    } catch (e) {\n      try {\n        cleanupSubscription(subscription);\n      } finally {\n        throw e;\n      }\n    } cleanupSubscription(subscription);\n    return value;\n  },\n  complete: function complete(value) {\n    var subscription = this._s;\n    if (!subscriptionClosed(subscription)) {\n      var observer = subscription._o;\n      subscription._o = undefined;\n      try {\n        var m = getMethod(observer.complete);\n        value = m ? m.call(observer, value) : undefined;\n      } catch (e) {\n        try {\n          cleanupSubscription(subscription);\n        } finally {\n          throw e;\n        }\n      } cleanupSubscription(subscription);\n      return value;\n    }\n  }\n});\n\nvar $Observable = function Observable(subscriber) {\n  anInstance(this, $Observable, 'Observable', '_f')._f = aFunction(subscriber);\n};\n\nredefineAll($Observable.prototype, {\n  subscribe: function subscribe(observer) {\n    return new Subscription(observer, this._f);\n  },\n  forEach: function forEach(fn) {\n    var that = this;\n    return new (core.Promise || global.Promise)(function (resolve, reject) {\n      aFunction(fn);\n      var subscription = that.subscribe({\n        next: function (value) {\n          try {\n            return fn(value);\n          } catch (e) {\n            reject(e);\n            subscription.unsubscribe();\n          }\n        },\n        error: reject,\n        complete: resolve\n      });\n    });\n  }\n});\n\nredefineAll($Observable, {\n  from: function from(x) {\n    var C = typeof this === 'function' ? this : $Observable;\n    var method = getMethod(anObject(x)[OBSERVABLE]);\n    if (method) {\n      var observable = anObject(method.call(x));\n      return observable.constructor === C ? observable : new C(function (observer) {\n        return observable.subscribe(observer);\n      });\n    }\n    return new C(function (observer) {\n      var done = false;\n      microtask(function () {\n        if (!done) {\n          try {\n            if (forOf(x, false, function (it) {\n              observer.next(it);\n              if (done) return RETURN;\n            }) === RETURN) return;\n          } catch (e) {\n            if (done) throw e;\n            observer.error(e);\n            return;\n          } observer.complete();\n        }\n      });\n      return function () { done = true; };\n    });\n  },\n  of: function of() {\n    for (var i = 0, l = arguments.length, items = new Array(l); i < l;) items[i] = arguments[i++];\n    return new (typeof this === 'function' ? this : $Observable)(function (observer) {\n      var done = false;\n      microtask(function () {\n        if (!done) {\n          for (var j = 0; j < items.length; ++j) {\n            observer.next(items[j]);\n            if (done) return;\n          } observer.complete();\n        }\n      });\n      return function () { done = true; };\n    });\n  }\n});\n\nhide($Observable.prototype, OBSERVABLE, function () { return this; });\n\n$export($export.G, { Observable: $Observable });\n\nrequire('./_set-species')('Observable');\n","// https://github.com/tc39/proposal-promise-finally\n'use strict';\nvar $export = require('./_export');\nvar core = require('./_core');\nvar global = require('./_global');\nvar speciesConstructor = require('./_species-constructor');\nvar promiseResolve = require('./_promise-resolve');\n\n$export($export.P + $export.R, 'Promise', { 'finally': function (onFinally) {\n  var C = speciesConstructor(this, core.Promise || global.Promise);\n  var isFunction = typeof onFinally == 'function';\n  return this.then(\n    isFunction ? function (x) {\n      return promiseResolve(C, onFinally()).then(function () { return x; });\n    } : onFinally,\n    isFunction ? function (e) {\n      return promiseResolve(C, onFinally()).then(function () { throw e; });\n    } : onFinally\n  );\n} });\n","'use strict';\n// https://github.com/tc39/proposal-promise-try\nvar $export = require('./_export');\nvar newPromiseCapability = require('./_new-promise-capability');\nvar perform = require('./_perform');\n\n$export($export.S, 'Promise', { 'try': function (callbackfn) {\n  var promiseCapability = newPromiseCapability.f(this);\n  var result = perform(callbackfn);\n  (result.e ? promiseCapability.reject : promiseCapability.resolve)(result.v);\n  return promiseCapability.promise;\n} });\n","var metadata = require('./_metadata');\nvar anObject = require('./_an-object');\nvar toMetaKey = metadata.key;\nvar ordinaryDefineOwnMetadata = metadata.set;\n\nmetadata.exp({ defineMetadata: function defineMetadata(metadataKey, metadataValue, target, targetKey) {\n  ordinaryDefineOwnMetadata(metadataKey, metadataValue, anObject(target), toMetaKey(targetKey));\n} });\n","var metadata = require('./_metadata');\nvar anObject = require('./_an-object');\nvar toMetaKey = metadata.key;\nvar getOrCreateMetadataMap = metadata.map;\nvar store = metadata.store;\n\nmetadata.exp({ deleteMetadata: function deleteMetadata(metadataKey, target /* , targetKey */) {\n  var targetKey = arguments.length < 3 ? undefined : toMetaKey(arguments[2]);\n  var metadataMap = getOrCreateMetadataMap(anObject(target), targetKey, false);\n  if (metadataMap === undefined || !metadataMap['delete'](metadataKey)) return false;\n  if (metadataMap.size) return true;\n  var targetMetadata = store.get(target);\n  targetMetadata['delete'](targetKey);\n  return !!targetMetadata.size || store['delete'](target);\n} });\n","var Set = require('./es6.set');\nvar from = require('./_array-from-iterable');\nvar metadata = require('./_metadata');\nvar anObject = require('./_an-object');\nvar getPrototypeOf = require('./_object-gpo');\nvar ordinaryOwnMetadataKeys = metadata.keys;\nvar toMetaKey = metadata.key;\n\nvar ordinaryMetadataKeys = function (O, P) {\n  var oKeys = ordinaryOwnMetadataKeys(O, P);\n  var parent = getPrototypeOf(O);\n  if (parent === null) return oKeys;\n  var pKeys = ordinaryMetadataKeys(parent, P);\n  return pKeys.length ? oKeys.length ? from(new Set(oKeys.concat(pKeys))) : pKeys : oKeys;\n};\n\nmetadata.exp({ getMetadataKeys: function getMetadataKeys(target /* , targetKey */) {\n  return ordinaryMetadataKeys(anObject(target), arguments.length < 2 ? undefined : toMetaKey(arguments[1]));\n} });\n","var metadata = require('./_metadata');\nvar anObject = require('./_an-object');\nvar getPrototypeOf = require('./_object-gpo');\nvar ordinaryHasOwnMetadata = metadata.has;\nvar ordinaryGetOwnMetadata = metadata.get;\nvar toMetaKey = metadata.key;\n\nvar ordinaryGetMetadata = function (MetadataKey, O, P) {\n  var hasOwn = ordinaryHasOwnMetadata(MetadataKey, O, P);\n  if (hasOwn) return ordinaryGetOwnMetadata(MetadataKey, O, P);\n  var parent = getPrototypeOf(O);\n  return parent !== null ? ordinaryGetMetadata(MetadataKey, parent, P) : undefined;\n};\n\nmetadata.exp({ getMetadata: function getMetadata(metadataKey, target /* , targetKey */) {\n  return ordinaryGetMetadata(metadataKey, anObject(target), arguments.length < 3 ? undefined : toMetaKey(arguments[2]));\n} });\n","var metadata = require('./_metadata');\nvar anObject = require('./_an-object');\nvar ordinaryOwnMetadataKeys = metadata.keys;\nvar toMetaKey = metadata.key;\n\nmetadata.exp({ getOwnMetadataKeys: function getOwnMetadataKeys(target /* , targetKey */) {\n  return ordinaryOwnMetadataKeys(anObject(target), arguments.length < 2 ? undefined : toMetaKey(arguments[1]));\n} });\n","var metadata = require('./_metadata');\nvar anObject = require('./_an-object');\nvar ordinaryGetOwnMetadata = metadata.get;\nvar toMetaKey = metadata.key;\n\nmetadata.exp({ getOwnMetadata: function getOwnMetadata(metadataKey, target /* , targetKey */) {\n  return ordinaryGetOwnMetadata(metadataKey, anObject(target)\n    , arguments.length < 3 ? undefined : toMetaKey(arguments[2]));\n} });\n","var metadata = require('./_metadata');\nvar anObject = require('./_an-object');\nvar getPrototypeOf = require('./_object-gpo');\nvar ordinaryHasOwnMetadata = metadata.has;\nvar toMetaKey = metadata.key;\n\nvar ordinaryHasMetadata = function (MetadataKey, O, P) {\n  var hasOwn = ordinaryHasOwnMetadata(MetadataKey, O, P);\n  if (hasOwn) return true;\n  var parent = getPrototypeOf(O);\n  return parent !== null ? ordinaryHasMetadata(MetadataKey, parent, P) : false;\n};\n\nmetadata.exp({ hasMetadata: function hasMetadata(metadataKey, target /* , targetKey */) {\n  return ordinaryHasMetadata(metadataKey, anObject(target), arguments.length < 3 ? undefined : toMetaKey(arguments[2]));\n} });\n","var metadata = require('./_metadata');\nvar anObject = require('./_an-object');\nvar ordinaryHasOwnMetadata = metadata.has;\nvar toMetaKey = metadata.key;\n\nmetadata.exp({ hasOwnMetadata: function hasOwnMetadata(metadataKey, target /* , targetKey */) {\n  return ordinaryHasOwnMetadata(metadataKey, anObject(target)\n    , arguments.length < 3 ? undefined : toMetaKey(arguments[2]));\n} });\n","var $metadata = require('./_metadata');\nvar anObject = require('./_an-object');\nvar aFunction = require('./_a-function');\nvar toMetaKey = $metadata.key;\nvar ordinaryDefineOwnMetadata = $metadata.set;\n\n$metadata.exp({ metadata: function metadata(metadataKey, metadataValue) {\n  return function decorator(target, targetKey) {\n    ordinaryDefineOwnMetadata(\n      metadataKey, metadataValue,\n      (targetKey !== undefined ? anObject : aFunction)(target),\n      toMetaKey(targetKey)\n    );\n  };\n} });\n","// https://tc39.github.io/proposal-setmap-offrom/#sec-set.from\nrequire('./_set-collection-from')('Set');\n","// https://tc39.github.io/proposal-setmap-offrom/#sec-set.of\nrequire('./_set-collection-of')('Set');\n","// https://github.com/DavidBruant/Map-Set.prototype.toJSON\nvar $export = require('./_export');\n\n$export($export.P + $export.R, 'Set', { toJSON: require('./_collection-to-json')('Set') });\n","'use strict';\n// https://github.com/mathiasbynens/String.prototype.at\nvar $export = require('./_export');\nvar $at = require('./_string-at')(true);\n\n$export($export.P, 'String', {\n  at: function at(pos) {\n    return $at(this, pos);\n  }\n});\n","'use strict';\n// https://tc39.github.io/String.prototype.matchAll/\nvar $export = require('./_export');\nvar defined = require('./_defined');\nvar toLength = require('./_to-length');\nvar isRegExp = require('./_is-regexp');\nvar getFlags = require('./_flags');\nvar RegExpProto = RegExp.prototype;\n\nvar $RegExpStringIterator = function (regexp, string) {\n  this._r = regexp;\n  this._s = string;\n};\n\nrequire('./_iter-create')($RegExpStringIterator, 'RegExp String', function next() {\n  var match = this._r.exec(this._s);\n  return { value: match, done: match === null };\n});\n\n$export($export.P, 'String', {\n  matchAll: function matchAll(regexp) {\n    defined(this);\n    if (!isRegExp(regexp)) throw TypeError(regexp + ' is not a regexp!');\n    var S = String(this);\n    var flags = 'flags' in RegExpProto ? String(regexp.flags) : getFlags.call(regexp);\n    var rx = new RegExp(regexp.source, ~flags.indexOf('g') ? flags : 'g' + flags);\n    rx.lastIndex = toLength(regexp.lastIndex);\n    return new $RegExpStringIterator(rx, S);\n  }\n});\n","'use strict';\n// https://github.com/tc39/proposal-string-pad-start-end\nvar $export = require('./_export');\nvar $pad = require('./_string-pad');\nvar userAgent = require('./_user-agent');\n\n// https://github.com/zloirock/core-js/issues/280\nvar WEBKIT_BUG = /Version\\/10\\.\\d+(\\.\\d+)?( Mobile\\/\\w+)? Safari\\//.test(userAgent);\n\n$export($export.P + $export.F * WEBKIT_BUG, 'String', {\n  padEnd: function padEnd(maxLength /* , fillString = ' ' */) {\n    return $pad(this, maxLength, arguments.length > 1 ? arguments[1] : undefined, false);\n  }\n});\n","'use strict';\n// https://github.com/tc39/proposal-string-pad-start-end\nvar $export = require('./_export');\nvar $pad = require('./_string-pad');\nvar userAgent = require('./_user-agent');\n\n// https://github.com/zloirock/core-js/issues/280\nvar WEBKIT_BUG = /Version\\/10\\.\\d+(\\.\\d+)?( Mobile\\/\\w+)? Safari\\//.test(userAgent);\n\n$export($export.P + $export.F * WEBKIT_BUG, 'String', {\n  padStart: function padStart(maxLength /* , fillString = ' ' */) {\n    return $pad(this, maxLength, arguments.length > 1 ? arguments[1] : undefined, true);\n  }\n});\n","'use strict';\n// https://github.com/sebmarkbage/ecmascript-string-left-right-trim\nrequire('./_string-trim')('trimLeft', function ($trim) {\n  return function trimLeft() {\n    return $trim(this, 1);\n  };\n}, 'trimStart');\n","'use strict';\n// https://github.com/sebmarkbage/ecmascript-string-left-right-trim\nrequire('./_string-trim')('trimRight', function ($trim) {\n  return function trimRight() {\n    return $trim(this, 2);\n  };\n}, 'trimEnd');\n","require('./_wks-define')('asyncIterator');\n","require('./_wks-define')('observable');\n","// https://github.com/tc39/proposal-global\nvar $export = require('./_export');\n\n$export($export.S, 'System', { global: require('./_global') });\n","// https://tc39.github.io/proposal-setmap-offrom/#sec-weakmap.from\nrequire('./_set-collection-from')('WeakMap');\n","// https://tc39.github.io/proposal-setmap-offrom/#sec-weakmap.of\nrequire('./_set-collection-of')('WeakMap');\n","// https://tc39.github.io/proposal-setmap-offrom/#sec-weakset.from\nrequire('./_set-collection-from')('WeakSet');\n","// https://tc39.github.io/proposal-setmap-offrom/#sec-weakset.of\nrequire('./_set-collection-of')('WeakSet');\n","var $iterators = require('./es6.array.iterator');\nvar getKeys = require('./_object-keys');\nvar redefine = require('./_redefine');\nvar global = require('./_global');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar wks = require('./_wks');\nvar ITERATOR = wks('iterator');\nvar TO_STRING_TAG = wks('toStringTag');\nvar ArrayValues = Iterators.Array;\n\nvar DOMIterables = {\n  CSSRuleList: true, // TODO: Not spec compliant, should be false.\n  CSSStyleDeclaration: false,\n  CSSValueList: false,\n  ClientRectList: false,\n  DOMRectList: false,\n  DOMStringList: false,\n  DOMTokenList: true,\n  DataTransferItemList: false,\n  FileList: false,\n  HTMLAllCollection: false,\n  HTMLCollection: false,\n  HTMLFormElement: false,\n  HTMLSelectElement: false,\n  MediaList: true, // TODO: Not spec compliant, should be false.\n  MimeTypeArray: false,\n  NamedNodeMap: false,\n  NodeList: true,\n  PaintRequestList: false,\n  Plugin: false,\n  PluginArray: false,\n  SVGLengthList: false,\n  SVGNumberList: false,\n  SVGPathSegList: false,\n  SVGPointList: false,\n  SVGStringList: false,\n  SVGTransformList: false,\n  SourceBufferList: false,\n  StyleSheetList: true, // TODO: Not spec compliant, should be false.\n  TextTrackCueList: false,\n  TextTrackList: false,\n  TouchList: false\n};\n\nfor (var collections = getKeys(DOMIterables), i = 0; i < collections.length; i++) {\n  var NAME = collections[i];\n  var explicit = DOMIterables[NAME];\n  var Collection = global[NAME];\n  var proto = Collection && Collection.prototype;\n  var key;\n  if (proto) {\n    if (!proto[ITERATOR]) hide(proto, ITERATOR, ArrayValues);\n    if (!proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);\n    Iterators[NAME] = ArrayValues;\n    if (explicit) for (key in $iterators) if (!proto[key]) redefine(proto, key, $iterators[key], true);\n  }\n}\n","var $export = require('./_export');\nvar $task = require('./_task');\n$export($export.G + $export.B, {\n  setImmediate: $task.set,\n  clearImmediate: $task.clear\n});\n","// ie9- setTimeout & setInterval additional parameters fix\nvar global = require('./_global');\nvar $export = require('./_export');\nvar userAgent = require('./_user-agent');\nvar slice = [].slice;\nvar MSIE = /MSIE .\\./.test(userAgent); // <- dirty ie9- check\nvar wrap = function (set) {\n  return function (fn, time /* , ...args */) {\n    var boundArgs = arguments.length > 2;\n    var args = boundArgs ? slice.call(arguments, 2) : false;\n    return set(boundArgs ? function () {\n      // eslint-disable-next-line no-new-func\n      (typeof fn == 'function' ? fn : Function(fn)).apply(this, args);\n    } : fn, time);\n  };\n};\n$export($export.G + $export.B + $export.F * MSIE, {\n  setTimeout: wrap(global.setTimeout),\n  setInterval: wrap(global.setInterval)\n});\n","require('./modules/es6.symbol');\nrequire('./modules/es6.object.create');\nrequire('./modules/es6.object.define-property');\nrequire('./modules/es6.object.define-properties');\nrequire('./modules/es6.object.get-own-property-descriptor');\nrequire('./modules/es6.object.get-prototype-of');\nrequire('./modules/es6.object.keys');\nrequire('./modules/es6.object.get-own-property-names');\nrequire('./modules/es6.object.freeze');\nrequire('./modules/es6.object.seal');\nrequire('./modules/es6.object.prevent-extensions');\nrequire('./modules/es6.object.is-frozen');\nrequire('./modules/es6.object.is-sealed');\nrequire('./modules/es6.object.is-extensible');\nrequire('./modules/es6.object.assign');\nrequire('./modules/es6.object.is');\nrequire('./modules/es6.object.set-prototype-of');\nrequire('./modules/es6.object.to-string');\nrequire('./modules/es6.function.bind');\nrequire('./modules/es6.function.name');\nrequire('./modules/es6.function.has-instance');\nrequire('./modules/es6.parse-int');\nrequire('./modules/es6.parse-float');\nrequire('./modules/es6.number.constructor');\nrequire('./modules/es6.number.to-fixed');\nrequire('./modules/es6.number.to-precision');\nrequire('./modules/es6.number.epsilon');\nrequire('./modules/es6.number.is-finite');\nrequire('./modules/es6.number.is-integer');\nrequire('./modules/es6.number.is-nan');\nrequire('./modules/es6.number.is-safe-integer');\nrequire('./modules/es6.number.max-safe-integer');\nrequire('./modules/es6.number.min-safe-integer');\nrequire('./modules/es6.number.parse-float');\nrequire('./modules/es6.number.parse-int');\nrequire('./modules/es6.math.acosh');\nrequire('./modules/es6.math.asinh');\nrequire('./modules/es6.math.atanh');\nrequire('./modules/es6.math.cbrt');\nrequire('./modules/es6.math.clz32');\nrequire('./modules/es6.math.cosh');\nrequire('./modules/es6.math.expm1');\nrequire('./modules/es6.math.fround');\nrequire('./modules/es6.math.hypot');\nrequire('./modules/es6.math.imul');\nrequire('./modules/es6.math.log10');\nrequire('./modules/es6.math.log1p');\nrequire('./modules/es6.math.log2');\nrequire('./modules/es6.math.sign');\nrequire('./modules/es6.math.sinh');\nrequire('./modules/es6.math.tanh');\nrequire('./modules/es6.math.trunc');\nrequire('./modules/es6.string.from-code-point');\nrequire('./modules/es6.string.raw');\nrequire('./modules/es6.string.trim');\nrequire('./modules/es6.string.iterator');\nrequire('./modules/es6.string.code-point-at');\nrequire('./modules/es6.string.ends-with');\nrequire('./modules/es6.string.includes');\nrequire('./modules/es6.string.repeat');\nrequire('./modules/es6.string.starts-with');\nrequire('./modules/es6.string.anchor');\nrequire('./modules/es6.string.big');\nrequire('./modules/es6.string.blink');\nrequire('./modules/es6.string.bold');\nrequire('./modules/es6.string.fixed');\nrequire('./modules/es6.string.fontcolor');\nrequire('./modules/es6.string.fontsize');\nrequire('./modules/es6.string.italics');\nrequire('./modules/es6.string.link');\nrequire('./modules/es6.string.small');\nrequire('./modules/es6.string.strike');\nrequire('./modules/es6.string.sub');\nrequire('./modules/es6.string.sup');\nrequire('./modules/es6.date.now');\nrequire('./modules/es6.date.to-json');\nrequire('./modules/es6.date.to-iso-string');\nrequire('./modules/es6.date.to-string');\nrequire('./modules/es6.date.to-primitive');\nrequire('./modules/es6.array.is-array');\nrequire('./modules/es6.array.from');\nrequire('./modules/es6.array.of');\nrequire('./modules/es6.array.join');\nrequire('./modules/es6.array.slice');\nrequire('./modules/es6.array.sort');\nrequire('./modules/es6.array.for-each');\nrequire('./modules/es6.array.map');\nrequire('./modules/es6.array.filter');\nrequire('./modules/es6.array.some');\nrequire('./modules/es6.array.every');\nrequire('./modules/es6.array.reduce');\nrequire('./modules/es6.array.reduce-right');\nrequire('./modules/es6.array.index-of');\nrequire('./modules/es6.array.last-index-of');\nrequire('./modules/es6.array.copy-within');\nrequire('./modules/es6.array.fill');\nrequire('./modules/es6.array.find');\nrequire('./modules/es6.array.find-index');\nrequire('./modules/es6.array.species');\nrequire('./modules/es6.array.iterator');\nrequire('./modules/es6.regexp.constructor');\nrequire('./modules/es6.regexp.exec');\nrequire('./modules/es6.regexp.to-string');\nrequire('./modules/es6.regexp.flags');\nrequire('./modules/es6.regexp.match');\nrequire('./modules/es6.regexp.replace');\nrequire('./modules/es6.regexp.search');\nrequire('./modules/es6.regexp.split');\nrequire('./modules/es6.promise');\nrequire('./modules/es6.map');\nrequire('./modules/es6.set');\nrequire('./modules/es6.weak-map');\nrequire('./modules/es6.weak-set');\nrequire('./modules/es6.typed.array-buffer');\nrequire('./modules/es6.typed.data-view');\nrequire('./modules/es6.typed.int8-array');\nrequire('./modules/es6.typed.uint8-array');\nrequire('./modules/es6.typed.uint8-clamped-array');\nrequire('./modules/es6.typed.int16-array');\nrequire('./modules/es6.typed.uint16-array');\nrequire('./modules/es6.typed.int32-array');\nrequire('./modules/es6.typed.uint32-array');\nrequire('./modules/es6.typed.float32-array');\nrequire('./modules/es6.typed.float64-array');\nrequire('./modules/es6.reflect.apply');\nrequire('./modules/es6.reflect.construct');\nrequire('./modules/es6.reflect.define-property');\nrequire('./modules/es6.reflect.delete-property');\nrequire('./modules/es6.reflect.enumerate');\nrequire('./modules/es6.reflect.get');\nrequire('./modules/es6.reflect.get-own-property-descriptor');\nrequire('./modules/es6.reflect.get-prototype-of');\nrequire('./modules/es6.reflect.has');\nrequire('./modules/es6.reflect.is-extensible');\nrequire('./modules/es6.reflect.own-keys');\nrequire('./modules/es6.reflect.prevent-extensions');\nrequire('./modules/es6.reflect.set');\nrequire('./modules/es6.reflect.set-prototype-of');\nrequire('./modules/es7.array.includes');\nrequire('./modules/es7.array.flat-map');\nrequire('./modules/es7.array.flatten');\nrequire('./modules/es7.string.at');\nrequire('./modules/es7.string.pad-start');\nrequire('./modules/es7.string.pad-end');\nrequire('./modules/es7.string.trim-left');\nrequire('./modules/es7.string.trim-right');\nrequire('./modules/es7.string.match-all');\nrequire('./modules/es7.symbol.async-iterator');\nrequire('./modules/es7.symbol.observable');\nrequire('./modules/es7.object.get-own-property-descriptors');\nrequire('./modules/es7.object.values');\nrequire('./modules/es7.object.entries');\nrequire('./modules/es7.object.define-getter');\nrequire('./modules/es7.object.define-setter');\nrequire('./modules/es7.object.lookup-getter');\nrequire('./modules/es7.object.lookup-setter');\nrequire('./modules/es7.map.to-json');\nrequire('./modules/es7.set.to-json');\nrequire('./modules/es7.map.of');\nrequire('./modules/es7.set.of');\nrequire('./modules/es7.weak-map.of');\nrequire('./modules/es7.weak-set.of');\nrequire('./modules/es7.map.from');\nrequire('./modules/es7.set.from');\nrequire('./modules/es7.weak-map.from');\nrequire('./modules/es7.weak-set.from');\nrequire('./modules/es7.global');\nrequire('./modules/es7.system.global');\nrequire('./modules/es7.error.is-error');\nrequire('./modules/es7.math.clamp');\nrequire('./modules/es7.math.deg-per-rad');\nrequire('./modules/es7.math.degrees');\nrequire('./modules/es7.math.fscale');\nrequire('./modules/es7.math.iaddh');\nrequire('./modules/es7.math.isubh');\nrequire('./modules/es7.math.imulh');\nrequire('./modules/es7.math.rad-per-deg');\nrequire('./modules/es7.math.radians');\nrequire('./modules/es7.math.scale');\nrequire('./modules/es7.math.umulh');\nrequire('./modules/es7.math.signbit');\nrequire('./modules/es7.promise.finally');\nrequire('./modules/es7.promise.try');\nrequire('./modules/es7.reflect.define-metadata');\nrequire('./modules/es7.reflect.delete-metadata');\nrequire('./modules/es7.reflect.get-metadata');\nrequire('./modules/es7.reflect.get-metadata-keys');\nrequire('./modules/es7.reflect.get-own-metadata');\nrequire('./modules/es7.reflect.get-own-metadata-keys');\nrequire('./modules/es7.reflect.has-metadata');\nrequire('./modules/es7.reflect.has-own-metadata');\nrequire('./modules/es7.reflect.metadata');\nrequire('./modules/es7.asap');\nrequire('./modules/es7.observable');\nrequire('./modules/web.timers');\nrequire('./modules/web.immediate');\nrequire('./modules/web.dom.iterable');\nmodule.exports = require('./modules/_core');\n","(function(a,b){if(\"function\"==typeof define&&define.amd)define([],b);else if(\"undefined\"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){\"use strict\";function b(a,b){return\"undefined\"==typeof b?b={autoBom:!1}:\"object\"!=typeof b&&(console.warn(\"Deprecated: Expected third argument to be a object\"),b={autoBom:!b}),b.autoBom&&/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(a.type)?new Blob([\"\\uFEFF\",a],{type:a.type}):a}function c(b,c,d){var e=new XMLHttpRequest;e.open(\"GET\",b),e.responseType=\"blob\",e.onload=function(){a(e.response,c,d)},e.onerror=function(){console.error(\"could not download file\")},e.send()}function d(a){var b=new XMLHttpRequest;b.open(\"HEAD\",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent(\"click\"))}catch(c){var b=document.createEvent(\"MouseEvents\");b.initMouseEvent(\"click\",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f=\"object\"==typeof window&&window.window===window?window:\"object\"==typeof self&&self.self===self?self:\"object\"==typeof global&&global.global===global?global:void 0,a=f.saveAs||(\"object\"!=typeof window||window!==f?function(){}:\"download\"in HTMLAnchorElement.prototype?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement(\"a\");g=g||b.name||\"download\",j.download=g,j.rel=\"noopener\",\"string\"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target=\"_blank\")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:\"msSaveOrOpenBlob\"in navigator?function(f,g,h){if(g=g||f.name||\"download\",\"string\"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement(\"a\");i.href=f,i.target=\"_blank\",setTimeout(function(){e(i)})}}:function(a,b,d,e){if(e=e||open(\"\",\"_blank\"),e&&(e.document.title=e.document.body.innerText=\"downloading...\"),\"string\"==typeof a)return c(a,b,d);var g=\"application/octet-stream\"===a.type,h=/constructor/i.test(f.HTMLElement)||f.safari,i=/CriOS\\/[\\d]+/.test(navigator.userAgent);if((i||g&&h)&&\"object\"==typeof FileReader){var j=new FileReader;j.onloadend=function(){var a=j.result;a=i?a:a.replace(/^data:[^;]*;/,\"data:attachment/file;\"),e?e.location.href=a:location=a,e=null},j.readAsDataURL(a)}else{var k=f.URL||f.webkitURL,l=k.createObjectURL(a);e?e.location=l:location.href=l,e=null,setTimeout(function(){k.revokeObjectURL(l)},4E4)}});f.saveAs=a.saveAs=a,\"undefined\"!=typeof module&&(module.exports=a)});\n\n//# sourceMappingURL=FileSaver.min.js.map","/**\n * Copyright (c) 2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * https://raw.github.com/facebook/regenerator/master/LICENSE file. An\n * additional grant of patent rights can be found in the PATENTS file in\n * the same directory.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  runtime.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration. If the Promise is rejected, however, the\n          // result for this iteration will be rejected with the same\n          // reason. Note that rejections of yielded Promises are not\n          // thrown back into the generator function, as is the case\n          // when an awaited Promise is rejected. This difference in\n          // behavior between yield and await is important, because it\n          // allows the consumer to decide what to do with the yielded\n          // rejection (swallow it and continue, manually .throw it back\n          // into the generator, abandon iteration, whatever). With\n          // await, by contrast, there is no opportunity to examine the\n          // rejection reason outside the generator function, so the\n          // only option is to throw it from the await expression, and\n          // let the generator function handle the exception.\n          result.value = unwrapped;\n          resolve(result);\n        }, reject);\n      }\n    }\n\n    if (typeof global.process === \"object\" && global.process.domain) {\n      invoke = global.process.domain.bind(invoke);\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  runtime.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        if (delegate.iterator.return) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // Among the various tricks for obtaining a reference to the global\n  // object, this seems to be the most reliable technique that does not\n  // use indirect eval (which violates Content Security Policy).\n  typeof global === \"object\" ? global :\n  typeof window === \"object\" ? window :\n  typeof self === \"object\" ? self : this\n);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module\n// This entry module is referenced by other modules so it can't be inlined\n__webpack_require__(4232);\n"],"sourceRoot":""}